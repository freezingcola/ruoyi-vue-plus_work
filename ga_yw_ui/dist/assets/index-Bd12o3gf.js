import{an as b,d as W,V as ie,r as p,Y as j,aa as ue,b as ce,$ as me,o as S,c as pe,k as e,m as a,w as _,x as G,e as o,t as _e,y as f,a7 as fe,ab as ve,p as H,a3 as ge,D as he,C as be,G as ye,H as Ie,a0 as we,W as ke,X as Ve,a8 as Ce,ac as Ee,a9 as Te,au as Ne,am as Re,v as Fe}from"./index-BoCONcAc.js";/* empty css                *//* empty css                    *//* empty css                       *//* empty css                 *//* empty css                        *//* empty css               */import{_ as Se}from"./index-B4NenLWv.js";/* empty css               *//* empty css                *//* empty css                */import"./el-form-item-l0sNRNKZ.js";const M=s=>b({url:"/demo/tree/list",method:"get",params:s}),qe=s=>b({url:"/demo/tree/"+s,method:"get"}),Ue=s=>b({url:"/demo/tree",method:"post",data:s}),$e=s=>b({url:"/demo/tree",method:"put",data:s}),De=s=>b({url:"/demo/tree/"+s,method:"delete"}),xe={class:"p-2"},Ae={class:"mb-[10px]"},Pe={class:"dialog-footer"},Be=W({name:"Tree"}),Je=W({...Be,setup(s){const{proxy:r}=ie(),C=p([]),E=p([]),y=p(!1),I=p(!0),w=p(!0),v=p(!1),q=p(),T=p(),U=p(),i=j({visible:!1,title:""}),$={id:void 0,parentId:void 0,deptId:void 0,userId:void 0,treeName:void 0},X=j({form:{...$},queryParams:{parentId:void 0,deptId:void 0,userId:void 0,treeName:void 0},rules:{id:[{required:!0,message:"主键不能为空",trigger:"blur"}],parentId:[{required:!0,message:"父id不能为空",trigger:"blur"}],deptId:[{required:!0,message:"部门id不能为空",trigger:"blur"}],userId:[{required:!0,message:"用户id不能为空",trigger:"blur"}],treeName:[{required:!0,message:"值不能为空",trigger:"blur"}]}}),{queryParams:k,form:d,rules:Y}=ue(X),g=async()=>{v.value=!0;const l=await M(k.value),t=r==null?void 0:r.handleTree(l.data,"id","parentId");t&&(C.value=t,v.value=!1)},D=async()=>{const l=await M();E.value=[];const t={id:0,treeName:"顶级节点",children:[]};t.children=r==null?void 0:r.handleTree(l.data,"id","parentId"),E.value.push(t)},z=()=>{N(),i.visible=!1},N=()=>{var l;d.value={...$},(l=T.value)==null||l.resetFields()},R=()=>{g()},J=()=>{var l;(l=q.value)==null||l.resetFields(),R()},x=l=>{N(),D(),l&&l.id?d.value.parentId=l.id:d.value.parentId=0,i.visible=!0,i.title="添加测试树"},Z=()=>{w.value=!w.value,A(C.value,w.value)},A=(l,t)=>{l.forEach(u=>{var c;(c=U.value)==null||c.toggleRowExpansion(u,t),u.children&&u.children.length>0&&A(u.children,t)})},ee=async l=>{N(),await D(),l&&(d.value.parentId=l.id);const t=await qe(l.id);Object.assign(d.value,t.data),i.visible=!0,i.title="修改测试树"},te=()=>{var l;(l=T.value)==null||l.validate(async t=>{t&&(y.value=!0,d.value.id?await $e(d.value).finally(()=>y.value=!1):await Ue(d.value).finally(()=>y.value=!1),r==null||r.$modal.msgSuccess("操作成功"),i.visible=!1,await g())})},ae=async l=>{await(r==null?void 0:r.$modal.confirm('是否确认删除测试树编号为"'+l.id+'"的数据项？')),v.value=!0,await De(l.id).finally(()=>v.value=!1),await g(),r==null||r.$modal.msgSuccess("删除成功")};return ce(()=>{g()}),(l,t)=>{var Q,K;const u=he,c=be,m=ye,P=Ie,B=we,L=ke,le=Se,oe=Ve,h=Ce,F=Ee,ne=Te,re=Ne,de=Re,V=me("hasPermi"),se=Fe;return S(),pe("div",xe,[e(ve,{"enter-active-class":(Q=o(r))==null?void 0:Q.animate.searchAnimate.enter,"leave-active-class":(K=o(r))==null?void 0:K.animate.searchAnimate.leave},{default:a(()=>[_(G("div",Ae,[e(B,{shadow:"hover"},{default:a(()=>[e(P,{ref_key:"queryFormRef",ref:q,model:o(k),inline:!0},{default:a(()=>[e(c,{label:"树节点名",prop:"treeName"},{default:a(()=>[e(u,{modelValue:o(k).treeName,"onUpdate:modelValue":t[0]||(t[0]=n=>o(k).treeName=n),placeholder:"请输入树节点名",clearable:"",onKeyup:_e(R,["enter"])},null,8,["modelValue"])]),_:1}),e(c,null,{default:a(()=>[e(m,{type:"primary",icon:"Search",onClick:R},{default:a(()=>[f("搜索")]),_:1}),e(m,{icon:"Refresh",onClick:J},{default:a(()=>[f("重置")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})],512),[[fe,o(I)]])]),_:1},8,["enter-active-class","leave-active-class"]),e(B,{shadow:"hover"},{header:a(()=>[e(oe,{gutter:10,class:"mb8"},{default:a(()=>[e(L,{span:1.5},{default:a(()=>[_((S(),H(m,{type:"primary",plain:"",icon:"Plus",onClick:t[1]||(t[1]=n=>x())},{default:a(()=>[f("新增")]),_:1})),[[V,["demo:tree:add"]]])]),_:1}),e(L,{span:1.5},{default:a(()=>[e(m,{type:"info",plain:"",icon:"Sort",onClick:Z},{default:a(()=>[f("展开/折叠")]),_:1})]),_:1}),e(le,{showSearch:o(I),"onUpdate:showSearch":t[2]||(t[2]=n=>ge(I)?I.value=n:null),onQueryTable:g},null,8,["showSearch"])]),_:1})]),default:a(()=>[_((S(),H(ne,{ref_key:"treeTableRef",ref:U,data:o(C),"row-key":"id","default-expand-all":o(w),"tree-props":{children:"children",hasChildren:"hasChildren"}},{default:a(()=>[e(h,{label:"父id",align:"center",prop:"parentId"}),e(h,{label:"部门id",align:"center",prop:"deptId"}),e(h,{label:"用户id",align:"center",prop:"userId"}),e(h,{label:"树节点名",align:"center",prop:"treeName"}),e(h,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:a(n=>[e(F,{content:"修改",placement:"top"},{default:a(()=>[_(e(m,{link:"",type:"primary",icon:"Edit",onClick:O=>ee(n.row)},null,8,["onClick"]),[[V,["demo:tree:edit"]]])]),_:2},1024),e(F,{content:"新增",placement:"top"},{default:a(()=>[_(e(m,{link:"",type:"primary",icon:"Plus",onClick:O=>x(n.row)},null,8,["onClick"]),[[V,["demo:tree:add"]]])]),_:2},1024),e(F,{content:"删除",placement:"top"},{default:a(()=>[_(e(m,{link:"",type:"primary",icon:"Delete",onClick:O=>ae(n.row)},null,8,["onClick"]),[[V,["demo:tree:remove"]]])]),_:2},1024)]),_:1})]),_:1},8,["data","default-expand-all"])),[[se,o(v)]])]),_:1}),e(de,{modelValue:o(i).visible,"onUpdate:modelValue":t[7]||(t[7]=n=>o(i).visible=n),title:o(i).title,width:"500px","append-to-body":""},{footer:a(()=>[G("div",Pe,[e(m,{loading:o(y),type:"primary",onClick:te},{default:a(()=>[f("确 定")]),_:1},8,["loading"]),e(m,{onClick:z},{default:a(()=>[f("取 消")]),_:1})])]),default:a(()=>[e(P,{ref_key:"treeFormRef",ref:T,model:o(d),rules:o(Y),"label-width":"80px"},{default:a(()=>[e(c,{label:"父id",prop:"parentId"},{default:a(()=>[e(re,{modelValue:o(d).parentId,"onUpdate:modelValue":t[3]||(t[3]=n=>o(d).parentId=n),data:o(E),props:{value:"id",label:"treeName",children:"children"},"value-key":"id",placeholder:"请选择父id","check-strictly":""},null,8,["modelValue","data"])]),_:1}),e(c,{label:"部门id",prop:"deptId"},{default:a(()=>[e(u,{modelValue:o(d).deptId,"onUpdate:modelValue":t[4]||(t[4]=n=>o(d).deptId=n),placeholder:"请输入部门id"},null,8,["modelValue"])]),_:1}),e(c,{label:"用户id",prop:"userId"},{default:a(()=>[e(u,{modelValue:o(d).userId,"onUpdate:modelValue":t[5]||(t[5]=n=>o(d).userId=n),placeholder:"请输入用户id"},null,8,["modelValue"])]),_:1}),e(c,{label:"值",prop:"treeName"},{default:a(()=>[e(u,{modelValue:o(d).treeName,"onUpdate:modelValue":t[6]||(t[6]=n=>o(d).treeName=n),placeholder:"请输入值"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{Je as default};
