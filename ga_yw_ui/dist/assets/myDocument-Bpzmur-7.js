import{d as re,V as ce,aa as ue,r,b as de,aK as me,$ as pe,o as u,c as _e,k as e,m as n,e as i,a3 as z,ab as fe,w as f,x as O,t as ge,y as h,a7 as T,p as d,q as g,T as R,Y as ve,D as we,aC as he,a0 as ye,W as be,C as ke,G as Ce,H as Se,X as Ve,a8 as Ne,ak as Ee,ac as De,a9 as Te,v as Re}from"./index-BoCONcAc.js";import{_ as $e}from"./submitVerify.vue_vue_type_script_setup_true_lang-GiF9G2vK.js";import{_ as Be}from"./index-B1KNwlHH.js";/* empty css                 *//* empty css                    */import{_ as Ae}from"./index-BXJ8XT-L.js";/* empty css                        *//* empty css               */import{_ as Ie}from"./index-B4NenLWv.js";/* empty css                */import"./el-form-item-l0sNRNKZ.js";/* empty css               *//* empty css                *//* empty css                */import{f as Ke,d as Le,c as Pe}from"./index-LhLwlHgt.js";import{l as Fe}from"./index-BMOFFQpT.js";import{w as Ue}from"./index-BWlz0r_B.js";import"./index-DG7XexN9.js";/* empty css                *//* empty css                    */import"./index-DSKxzbdu.js";import"./index.vue_vue_type_script_setup_true_lang-Bfb_m_-c.js";import"./index-JZ_QvNlG.js";import"./multiInstanceUser.vue_vue_type_script_setup_true_name_User_lang-kSMcaROF.js";const qe={class:"p-2"},xe={class:"mb-[10px]"},pt=re({__name:"myDocument",setup(ze){const{proxy:l}=ce(),{wf_business_status:Q}=ue(l==null?void 0:l.useDict("wf_business_status")),$=r(),B=r(),m=r(!0),A=r([]),H=r(!0),J=r(!0),v=r(!0),V=r(0),I=r([]),N=r([]),y=r(""),b=r("running"),s=r({pageNum:1,pageSize:10,name:void 0,categoryCode:void 0});de(()=>{p(),M()});const Y=a=>{s.value.categoryCode=a.categoryCode,a.categoryCode==="ALL"&&(s.value.categoryCode=""),w()},G=(a,o)=>a?o.categoryName.indexOf(a)!==-1:!0;me(()=>{B.value.filter(y.value)},{flush:"post"});const M=async()=>{const a=await Fe();N.value=[];const o={categoryCode:"ALL",categoryName:"顶级节点",children:[]};o.children=l==null?void 0:l.handleTree(a.data,"id","parentId"),N.value.push(o)},w=()=>{p()},W=()=>{var a;(a=$.value)==null||a.resetFields(),s.value.categoryCode="",s.value.pageNum=1,s.value.pageSize=10,w()},X=a=>{A.value=a.map(o=>o.id),H.value=a.length!==1,J.value=!a.length},p=()=>{m.value=!0,Ke(s.value).then(a=>{I.value=a.rows,V.value=a.total,m.value=!1})},j=async a=>{const o=a.id||A.value;await(l==null?void 0:l.$modal.confirm("是否确认删除id为【"+o+"】的数据项？")),m.value=!0,b.value==="running"&&(await Le(o).finally(()=>m.value=!1),p()),l==null||l.$modal.msgSuccess("删除成功")},Z=async a=>{await(l==null?void 0:l.$modal.confirm("是否确认撤销当前单据？")),m.value=!0,b.value==="running"&&(await Pe(a).finally(()=>m.value=!1),p()),l==null||l.$modal.msgSuccess("撤销成功")},K=async(a,o)=>{const k=ve({wfDefinitionConfigVo:a.wfDefinitionConfigVo,wfNodeConfigVo:a.wfNodeConfigVo,businessKey:a.businessKey,taskId:a.id,type:o});Ue.routerJump(k,l)};return(a,o)=>{const k=we,ee=he,E=ye,L=be,P=ke,_=Ce,te=Se,ae=Ie,F=Ve,c=Ne,U=Ee,ne=Ae,C=De,oe=Te,le=Be,ie=$e,q=pe("hasPermi"),se=Re;return u(),_e("div",qe,[e(F,{gutter:20},{default:n(()=>[e(L,{lg:4,xs:24,style:{}},{default:n(()=>[e(E,{shadow:"hover"},{default:n(()=>[e(k,{modelValue:i(y),"onUpdate:modelValue":o[0]||(o[0]=S=>z(y)?y.value=S:null),placeholder:"请输入流程分类名","prefix-icon":"Search",clearable:""},null,8,["modelValue"]),e(ee,{ref_key:"categoryTreeRef",ref:B,class:"mt-2","node-key":"id",data:i(N),props:{label:"categoryName",children:"children"},"expand-on-click-node":!1,"filter-node-method":G,"highlight-current":"","default-expand-all":"",onNodeClick:Y},null,8,["data"])]),_:1})]),_:1}),e(L,{lg:20,xs:24},{default:n(()=>{var S,x;return[e(fe,{"enter-active-class":(S=i(l))==null?void 0:S.animate.searchAnimate.enter,"leave-active-class":(x=i(l))==null?void 0:x.animate.searchAnimate.leave},{default:n(()=>[f(O("div",xe,[e(E,{shadow:"hover"},{default:n(()=>[f(e(te,{ref_key:"queryFormRef",ref:$,model:i(s),inline:!0,"label-width":"120px"},{default:n(()=>[e(P,{label:"流程定义名称",prop:"name"},{default:n(()=>[e(k,{modelValue:i(s).name,"onUpdate:modelValue":o[1]||(o[1]=t=>i(s).name=t),placeholder:"请输入流程定义名称",onKeyup:ge(w,["enter"])},null,8,["modelValue"])]),_:1}),e(P,null,{default:n(()=>[e(_,{type:"primary",icon:"Search",onClick:w},{default:n(()=>[h("搜索")]),_:1}),e(_,{icon:"Refresh",onClick:W},{default:n(()=>[h("重置")]),_:1})]),_:1})]),_:1},8,["model"]),[[T,i(v)]])]),_:1})],512),[[T,i(v)]])]),_:1},8,["enter-active-class","leave-active-class"]),e(E,{shadow:"hover"},{header:n(()=>[e(F,{gutter:10,class:"mb8"},{default:n(()=>[e(ae,{showSearch:i(v),"onUpdate:showSearch":o[2]||(o[2]=t=>z(v)?v.value=t:null),onQueryTable:w},null,8,["showSearch"])]),_:1})]),default:n(()=>[f((u(),d(oe,{border:"",data:i(I),onSelectionChange:X},{default:n(()=>[e(c,{type:"selection",width:"55",align:"center"}),e(c,{align:"center",type:"index",label:"序号",width:"60"}),g("",!0),e(c,{"show-overflow-tooltip":!0,align:"center",label:"流程定义名称"},{default:n(t=>[O("span",null,R(t.row.processDefinitionName)+"v"+R(t.row.processDefinitionVersion)+".0",1)]),_:1}),e(c,{align:"center",prop:"processDefinitionKey",label:"流程定义KEY"}),e(c,{align:"center",prop:"processDefinitionVersion",label:"版本号",width:"90"},{default:n(t=>[h(" v"+R(t.row.processDefinitionVersion)+".0",1)]),_:1}),i(b)==="running"?(u(),d(c,{key:1,align:"center",prop:"isSuspended",label:"状态","min-width":"70"},{default:n(t=>[t.row.isSuspended?(u(),d(U,{key:1,type:"danger"},{default:n(()=>[h("挂起")]),_:1})):(u(),d(U,{key:0,type:"success"},{default:n(()=>[h("激活")]),_:1}))]),_:1})):g("",!0),e(c,{align:"center",label:"流程状态","min-width":"70"},{default:n(t=>[e(ne,{options:i(Q),value:t.row.businessStatus},null,8,["options","value"])]),_:1}),e(c,{align:"center",prop:"startTime",label:"启动时间",width:"160"}),i(b)==="finish"?(u(),d(c,{key:2,align:"center",prop:"endTime",label:"结束时间",width:"160"})):g("",!0),e(c,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:n(t=>[t.row.businessStatus==="draft"||t.row.businessStatus==="cancel"||t.row.businessStatus==="back"?(u(),d(C,{key:0,content:"修改",placement:"top"},{default:n(()=>[f(e(_,{link:"",type:"primary",icon:"Edit",onClick:D=>K(t.row,"update")},null,8,["onClick"]),[[q,["demo:leave:edit"]]])]),_:2},1024)):g("",!0),t.row.businessStatus==="draft"||t.row.businessStatus==="cancel"||t.row.businessStatus==="back"?(u(),d(C,{key:1,content:"删除",placement:"top"},{default:n(()=>[f(e(_,{link:"",type:"primary",icon:"Delete",onClick:D=>j(t.row)},null,8,["onClick"]),[[q,["demo:leave:remove"]]])]),_:2},1024)):g("",!0),e(C,{placement:"top",content:"查看"},{default:n(()=>[e(_,{link:"",type:"primary",icon:"View",onClick:D=>K(t.row,"view")},null,8,["onClick"])]),_:2},1024),t.row.businessStatus==="waiting"?(u(),d(C,{key:2,content:"撤销",placement:"top"},{default:n(()=>[e(_,{link:"",type:"primary",icon:"Notification",onClick:D=>Z(t.row.id)},null,8,["onClick"])]),_:2},1024)):g("",!0)]),_:1})]),_:1},8,["data"])),[[se,i(m)]]),f(e(le,{page:i(s).pageNum,"onUpdate:page":o[3]||(o[3]=t=>i(s).pageNum=t),limit:i(s).pageSize,"onUpdate:limit":o[4]||(o[4]=t=>i(s).pageSize=t),total:i(V),onPagination:p},null,8,["page","limit","total"]),[[T,i(V)>0]])]),_:1})]}),_:1})]),_:1}),e(ie,{ref:"submitVerifyRef",onSubmitCallback:p},null,512)])}}});export{pt as default};
