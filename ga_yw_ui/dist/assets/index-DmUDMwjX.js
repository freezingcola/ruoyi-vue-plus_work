import{d as te,V as ye,aa as ee,r as f,Y as le,b as we,j as Te,$ as ke,o as u,c as k,k as l,m as o,w as g,x as V,e as a,t as E,M as Y,N as q,p as v,y as b,a7 as ae,ab as Ne,a3 as Ce,T as N,D as Se,C as je,O as he,P as Ue,as as De,G as Pe,H as Ee,a0 as Ye,W as qe,X as Fe,a8 as Me,ac as $e,a9 as Re,am as xe,v as Be}from"./index-BoCONcAc.js";import{_ as He}from"./index-B1KNwlHH.js";/* empty css                 *//* empty css                    */import{_ as Ke}from"./index-BXJ8XT-L.js";/* empty css                        *//* empty css               */import{_ as Le}from"./index-B4NenLWv.js";/* empty css               *//* empty css                *//* empty css                *//* empty css                       */import"./el-form-item-l0sNRNKZ.js";import{a as ze,g as Ae,u as Ie,b as Oe,d as Qe}from"./index-BjZ9Zf1q.js";/* empty css                */const Ge={class:"p-2"},We={class:"mb-[10px]"},Xe=["title"],Je={class:"dialog-footer"},Ze=te({name:"Project"}),_l=te({...Ze,setup(el){const{proxy:i}=ye(),{work_project_type:F,work_project_state:M}=ee(i==null?void 0:i.useDict("work_project_type","work_project_state")),H=f([]),C=f(!1),S=f(!0),j=f(!0),$=f([]),K=f(!0),L=f(!0),R=f(0),z=f(),x=f(),_=le({visible:!1,title:""}),A={id:void 0,proName:void 0,depName:void 0,proContent:void 0,proNum:void 0,proState:void 0,proType:void 0,startTime:void 0,endTime:void 0,proServiceTime:void 0},oe=le({form:{...A},queryParams:{pageNum:1,pageSize:10,proName:void 0,depName:void 0,proContent:void 0,proNum:void 0,proState:void 0,proType:void 0,startTime:void 0,endTime:void 0,proServiceTime:void 0,params:{}},rules:{proName:[{required:!0,message:"项目名称不能为空",trigger:"blur"}],depName:[{required:!0,message:"单位名称不能为空",trigger:"blur"}],proContent:[{required:!0,message:"项目说明不能为空",trigger:"blur"}],proNum:[{required:!0,message:"项目编号不能为空",trigger:"blur"}],proState:[{required:!0,message:"项目状态不能为空",trigger:"change"}],proType:[{required:!0,message:"项目类型不能为空",trigger:"change"}],startTime:[{required:!0,message:"开始时间不能为空",trigger:"blur"}],endTime:[{required:!0,message:"结束时间不能为空",trigger:"blur"}],proServiceTime:[{required:!0,message:"服务时间不能为空",trigger:"blur"}]}}),{queryParams:n,form:p,rules:re}=ee(oe),y=async()=>{S.value=!0;const r=await ze(n.value);H.value=r.rows,R.value=r.total,S.value=!1},ne=()=>{B(),_.visible=!1},B=()=>{var r;p.value={...A},(r=x.value)==null||r.resetFields()},w=()=>{n.value.pageNum=1,y()},pe=()=>{var r;(r=z.value)==null||r.resetFields(),w()},de=r=>{$.value=r.map(t=>t.id),K.value=r.length!=1,L.value=!r.length},ie=()=>{B(),_.visible=!0,_.title="添加项目"},I=async r=>{B();const t=(r==null?void 0:r.id)||$.value[0],m=await Ae(t);Object.assign(p.value,m.data),_.visible=!0,_.title="修改项目"},ue=()=>{var r;(r=x.value)==null||r.validate(async t=>{t&&(C.value=!0,p.value.id?await Ie(p.value).finally(()=>C.value=!1):await Oe(p.value).finally(()=>C.value=!1),i==null||i.$modal.msgSuccess("操作成功"),_.visible=!1,await y())})},O=async r=>{const t=(r==null?void 0:r.id)||$.value;await(i==null?void 0:i.$modal.confirm('是否确认删除项目编号为"'+t+'"的数据项？').finally(()=>S.value=!1)),await Qe(t),i==null||i.$modal.msgSuccess("删除成功"),await y()},se=()=>{i==null||i.download("workProject/project/export",{...n.value},`project_${new Date().getTime()}.xlsx`)};return we(()=>{y()}),(r,t)=>{var J,Z;const m=Se,d=je,h=he,U=Ue,D=De,c=Pe,Q=Ee,G=Ye,P=qe,me=Le,ce=Fe,s=Me,fe=Te("router-link"),W=Ke,X=$e,ve=Re,_e=He,ge=xe,T=ke("hasPermi"),be=Be;return u(),k("div",Ge,[l(Ne,{"enter-active-class":(J=a(i))==null?void 0:J.animate.searchAnimate.enter,"leave-active-class":(Z=a(i))==null?void 0:Z.animate.searchAnimate.leave},{default:o(()=>[g(V("div",We,[l(G,{shadow:"hover"},{default:o(()=>[l(Q,{ref_key:"queryFormRef",ref:z,model:a(n),inline:!0},{default:o(()=>[l(d,{label:"项目名称",prop:"proName"},{default:o(()=>[l(m,{modelValue:a(n).proName,"onUpdate:modelValue":t[0]||(t[0]=e=>a(n).proName=e),placeholder:"请输入项目名称",clearable:"",onKeyup:E(w,["enter"])},null,8,["modelValue"])]),_:1}),l(d,{label:"单位名称",prop:"depName"},{default:o(()=>[l(m,{modelValue:a(n).depName,"onUpdate:modelValue":t[1]||(t[1]=e=>a(n).depName=e),placeholder:"请输入单位名称",clearable:"",onKeyup:E(w,["enter"])},null,8,["modelValue"])]),_:1}),l(d,{label:"项目说明",prop:"proContent"},{default:o(()=>[l(m,{modelValue:a(n).proContent,"onUpdate:modelValue":t[2]||(t[2]=e=>a(n).proContent=e),placeholder:"请输入项目说明",clearable:"",onKeyup:E(w,["enter"])},null,8,["modelValue"])]),_:1}),l(d,{label:"项目编号",prop:"proNum"},{default:o(()=>[l(m,{modelValue:a(n).proNum,"onUpdate:modelValue":t[3]||(t[3]=e=>a(n).proNum=e),placeholder:"请输入项目编号",clearable:"",onKeyup:E(w,["enter"])},null,8,["modelValue"])]),_:1}),l(d,{label:"项目状态",prop:"proState"},{default:o(()=>[l(U,{modelValue:a(n).proState,"onUpdate:modelValue":t[4]||(t[4]=e=>a(n).proState=e),placeholder:"请选择项目状态",clearable:""},{default:o(()=>[(u(!0),k(Y,null,q(a(M),e=>(u(),v(h,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"项目类型",prop:"proType"},{default:o(()=>[l(U,{modelValue:a(n).proType,"onUpdate:modelValue":t[5]||(t[5]=e=>a(n).proType=e),placeholder:"请选择项目类型",clearable:""},{default:o(()=>[(u(!0),k(Y,null,q(a(F),e=>(u(),v(h,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"开始时间",prop:"startTime"},{default:o(()=>[l(D,{clearable:"",modelValue:a(n).startTime,"onUpdate:modelValue":t[6]||(t[6]=e=>a(n).startTime=e),type:"date","value-format":"YYYY-MM-DD",placeholder:"请选择开始时间"},null,8,["modelValue"])]),_:1}),l(d,{label:"结束时间",prop:"endTime"},{default:o(()=>[l(D,{clearable:"",modelValue:a(n).endTime,"onUpdate:modelValue":t[7]||(t[7]=e=>a(n).endTime=e),type:"date","value-format":"YYYY-MM-DD",placeholder:"请选择结束时间"},null,8,["modelValue"])]),_:1}),l(d,null,{default:o(()=>[l(c,{type:"primary",icon:"Search",onClick:w},{default:o(()=>[b("搜索")]),_:1}),l(c,{icon:"Refresh",onClick:pe},{default:o(()=>[b("重置")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})],512),[[ae,a(j)]])]),_:1},8,["enter-active-class","leave-active-class"]),l(G,{shadow:"never"},{header:o(()=>[l(ce,{gutter:10,class:"mb8"},{default:o(()=>[l(P,{span:1.5},{default:o(()=>[g((u(),v(c,{type:"primary",plain:"",icon:"Plus",onClick:ie},{default:o(()=>[b("新增")]),_:1})),[[T,["workProject:project:add"]]])]),_:1}),l(P,{span:1.5},{default:o(()=>[g((u(),v(c,{type:"success",plain:"",icon:"Edit",disabled:a(K),onClick:t[8]||(t[8]=e=>I())},{default:o(()=>[b("修改")]),_:1},8,["disabled"])),[[T,["workProject:project:edit"]]])]),_:1}),l(P,{span:1.5},{default:o(()=>[g((u(),v(c,{type:"danger",plain:"",icon:"Delete",disabled:a(L),onClick:t[9]||(t[9]=e=>O())},{default:o(()=>[b("删除")]),_:1},8,["disabled"])),[[T,["workProject:project:remove"]]])]),_:1}),l(P,{span:1.5},{default:o(()=>[g((u(),v(c,{type:"warning",plain:"",icon:"Download",onClick:se},{default:o(()=>[b("导出")]),_:1})),[[T,["workProject:project:export"]]])]),_:1}),l(me,{showSearch:a(j),"onUpdate:showSearch":t[10]||(t[10]=e=>Ce(j)?j.value=e:null),onQueryTable:y},null,8,["showSearch"])]),_:1})]),default:o(()=>[g((u(),v(ve,{data:a(H),onSelectionChange:de},{default:o(()=>[l(s,{type:"selection",width:"55",align:"left"}),(u(),v(s,{key:0,label:"id",width:"110",align:"left",prop:"id"})),l(s,{label:"项目名称",width:"355",align:"left",prop:"proName"}),l(s,{label:"单位名称",align:"left",prop:"depName"}),l(s,{label:"项目说明",align:"left",prop:"proContent"},{default:o(e=>[V("div",{title:e.row.proContent,style:{overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},N(e.row.proContent),9,Xe)]),_:1}),l(s,{label:"项目编号",align:"left"},{default:o(e=>[l(fe,{to:"/system/project-sla/index/"+e.row.id,class:"link-type"},{default:o(()=>[V("span",null,N(e.row.proNum),1)]),_:2},1032,["to"])]),_:1}),l(s,{label:"项目状态",align:"left",prop:"proState"},{default:o(e=>[l(W,{options:a(M),value:e.row.proState},null,8,["options","value"])]),_:1}),l(s,{label:"项目类型",align:"left",prop:"proType"},{default:o(e=>[l(W,{options:a(F),value:e.row.proType},null,8,["options","value"])]),_:1}),l(s,{label:"开始时间",align:"left",prop:"startTime",width:"180"},{default:o(e=>[V("span",null,N(r.parseTime(e.row.startTime,"{y}-{m}-{d}")),1)]),_:1}),l(s,{label:"结束时间",align:"left",prop:"endTime",width:"180"},{default:o(e=>[V("span",null,N(r.parseTime(e.row.endTime,"{y}-{m}-{d}")),1)]),_:1}),l(s,{label:"服务时间",align:"left"},{default:o(e=>[V("span",null,N(e.row.proServiceTime)+"天",1)]),_:1}),l(s,{label:"操作",align:"left","class-name":"small-padding fixed-width"},{default:o(e=>[l(X,{content:"修改",placement:"top"},{default:o(()=>[g(l(c,{link:"",type:"primary",icon:"Edit",onClick:Ve=>I(e.row)},null,8,["onClick"]),[[T,["workProject:project:edit"]]])]),_:2},1024),l(X,{content:"删除",placement:"top"},{default:o(()=>[g(l(c,{link:"",type:"primary",icon:"Delete",onClick:Ve=>O(e.row)},null,8,["onClick"]),[[T,["workProject:project:delete"]]])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[be,a(S)]]),g(l(_e,{total:a(R),page:a(n).pageNum,"onUpdate:page":t[11]||(t[11]=e=>a(n).pageNum=e),limit:a(n).pageSize,"onUpdate:limit":t[12]||(t[12]=e=>a(n).pageSize=e),onPagination:y},null,8,["total","page","limit"]),[[ae,a(R)>0]])]),_:1}),l(ge,{title:a(_).title,modelValue:a(_).visible,"onUpdate:modelValue":t[22]||(t[22]=e=>a(_).visible=e),width:"500px","append-to-body":""},{footer:o(()=>[V("div",Je,[l(c,{loading:a(C),type:"primary",onClick:ue},{default:o(()=>[b("确 定")]),_:1},8,["loading"]),l(c,{onClick:ne},{default:o(()=>[b("取 消")]),_:1})])]),default:o(()=>[l(Q,{ref_key:"projectFormRef",ref:x,model:a(p),rules:a(re),"label-width":"80px"},{default:o(()=>[l(d,{label:"项目名称",prop:"proName"},{default:o(()=>[l(m,{modelValue:a(p).proName,"onUpdate:modelValue":t[13]||(t[13]=e=>a(p).proName=e),placeholder:"请输入项目名称"},null,8,["modelValue"])]),_:1}),l(d,{label:"单位名称",prop:"depName"},{default:o(()=>[l(m,{modelValue:a(p).depName,"onUpdate:modelValue":t[14]||(t[14]=e=>a(p).depName=e),placeholder:"请输入单位名称"},null,8,["modelValue"])]),_:1}),l(d,{label:"项目说明",prop:"proContent"},{default:o(()=>[l(m,{modelValue:a(p).proContent,"onUpdate:modelValue":t[15]||(t[15]=e=>a(p).proContent=e),type:"textarea",placeholder:"请输入内容"},null,8,["modelValue"])]),_:1}),l(d,{label:"项目编号",prop:"proNum"},{default:o(()=>[l(m,{modelValue:a(p).proNum,"onUpdate:modelValue":t[16]||(t[16]=e=>a(p).proNum=e),placeholder:"请输入项目编号"},null,8,["modelValue"])]),_:1}),l(d,{label:"项目状态",prop:"proState"},{default:o(()=>[l(U,{modelValue:a(p).proState,"onUpdate:modelValue":t[17]||(t[17]=e=>a(p).proState=e),placeholder:"请选择项目状态"},{default:o(()=>[(u(!0),k(Y,null,q(a(M),e=>(u(),v(h,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"项目类型",prop:"proType"},{default:o(()=>[l(U,{modelValue:a(p).proType,"onUpdate:modelValue":t[18]||(t[18]=e=>a(p).proType=e),placeholder:"请选择项目类型"},{default:o(()=>[(u(!0),k(Y,null,q(a(F),e=>(u(),v(h,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"开始时间",prop:"startTime"},{default:o(()=>[l(D,{clearable:"",modelValue:a(p).startTime,"onUpdate:modelValue":t[19]||(t[19]=e=>a(p).startTime=e),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"请选择开始时间"},null,8,["modelValue"])]),_:1}),l(d,{label:"结束时间",prop:"endTime"},{default:o(()=>[l(D,{clearable:"",modelValue:a(p).endTime,"onUpdate:modelValue":t[20]||(t[20]=e=>a(p).endTime=e),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"请选择结束时间"},null,8,["modelValue"])]),_:1}),l(d,{label:"服务时间",prop:"proServiceTime"},{default:o(()=>[l(m,{modelValue:a(p).proServiceTime,"onUpdate:modelValue":t[21]||(t[21]=e=>a(p).proServiceTime=e),placeholder:"请输入服务时间",style:{width:"80px"}},null,8,["modelValue"]),b("天 ")]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}});export{_l as default};
