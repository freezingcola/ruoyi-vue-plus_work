import{d as te,u as Ne,V as Ce,r as d,H as Q,Y as ke,Z as Ve,b as Ee,$ as j,o as r,c as I,k as e,m as n,w as u,x as $,e as o,M as H,N as J,p as b,t as W,a3 as X,y as v,a7 as Z,ab as Se,T as ee,bd as Te,O as De,P as Ie,C as $e,D as Re,as as Ue,G as Pe,W as qe,X as Fe,a8 as Le,ac as Oe,a9 as ze,a0 as Be,aJ as Ye,a4 as xe,a5 as Ge,am as Me,v as Ae}from"./index-BoCONcAc.js";/* empty css                    *//* empty css                *//* empty css                */import{_ as Ke}from"./index-B1KNwlHH.js";/* empty css                 *//* empty css                    *//* empty css                        *//* empty css               */import{_ as Qe}from"./index-B4NenLWv.js";/* empty css               *//* empty css                       */import"./el-form-item-l0sNRNKZ.js";import{b as je,a as He,c as Je,s as We,p as Xe,d as Ze}from"./index-D0p_aBUM.js";import{_ as ae}from"./importTable.vue_vue_type_script_setup_true_lang-a4hEz3dC.js";/* empty css                */const ea={class:"p-2"},aa={class:"search"},ta=te({name:"Gen"}),ya=te({...ta,setup(la){const R=Ne(),{proxy:s}=Ce(),U=d([]),S=d(!0),C=d(!0),k=d([]),P=d(!0),q=d(!0),T=d(0),f=d(["",""]),F=d(""),L=d([]),D=d(Q),O=d(ae),i=d({pageNum:1,pageSize:10,tableName:"",tableComment:"",dataName:""}),h=d({data:{},activeName:"domain.java"}),V=ke({visible:!1,title:"代码预览"});Ve(()=>{const l=R.query.t;l!=null&&l!=F.value&&(F.value=l,i.value.pageNum=Number(R.query.pageNum),f.value=["",""],D.value.resetFields(),g())});const le=async()=>{const l=await He();L.value=l.data},g=async()=>{S.value=!0;const l=await je(s==null?void 0:s.addDateRange(i.value,f.value));U.value=l.rows,T.value=l.total,S.value=!1},y=()=>{i.value.pageNum=1,g()},z=async l=>{const a=(l==null?void 0:l.tableId)||k.value;if(a==""){s==null||s.$modal.msgError("请选择要生成的数据");return}(l==null?void 0:l.genType)==="1"?(await Je(l.tableId),s==null||s.$modal.msgSuccess("成功生成到自定义路径："+l.genPath)):s==null||s.$download.zip("/tool/gen/batchGenCode?tableIdStr="+a,"ruoyi.zip")},ne=async l=>{const a=l.tableId;await(s==null?void 0:s.$modal.confirm('确认要强制同步"'+l.tableName+'"表结构吗？')),await We(a),s==null||s.$modal.msgSuccess("同步成功")},oe=()=>{O.value.show(i.value.dataName)},se=()=>{f.value=["",""],D.value.resetFields(),y()},ie=async l=>{const a=await Xe(l.tableId);h.value.data=a.data,V.visible=!0,h.value.activeName="domain.java"},de=()=>{s==null||s.$modal.msgSuccess("复制成功")},ue=l=>{k.value=l.map(a=>a.tableId),P.value=l.length!=1,q.value=!l.length},B=l=>{const a=(l==null?void 0:l.tableId)||k.value[0];Te.push({path:"/tool/gen-edit/index/"+a,query:{pageNum:i.value.pageNum}})},Y=async l=>{const a=(l==null?void 0:l.tableId)||k.value;await(s==null?void 0:s.$modal.confirm('是否确认删除表编号为"'+a+'"的数据项？')),await Ze(a),g(),s==null||s.$modal.msgSuccess("删除成功")};return Ee(()=>{g(),le()}),(l,a)=>{var A,K;const x=De,ce=Ie,w=$e,G=Re,me=Ue,c=Pe,E=qe,re=Qe,pe=Fe,p=Le,N=Oe,_e=ze,be=Ke,ve=Be,fe=Ye,ge=xe,he=Ge,ye=Me,_=j("hasPermi"),we=Ae,M=j("copyText");return r(),I("div",ea,[e(Se,{"enter-active-class":(A=o(s))==null?void 0:A.animate.searchAnimate.enter,"leave-active-class":(K=o(s))==null?void 0:K.animate.searchAnimate.leave},{default:n(()=>[u($("div",aa,[e(o(Q),{model:o(i),ref_key:"queryFormRef",ref:D,inline:!0,"label-width":"68px"},{default:n(()=>[e(w,{label:"数据源",prop:"dataName"},{default:n(()=>[e(ce,{modelValue:o(i).dataName,"onUpdate:modelValue":a[0]||(a[0]=t=>o(i).dataName=t),filterable:"",clearable:"",placeholder:"请选择/输入数据源名称",style:{width:"200px"}},{default:n(()=>[e(x,{key:"",label:"全部",value:""}),(r(!0),I(H,null,J(o(L),t=>(r(),b(x,{key:t,label:t,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(w,{label:"表名称",prop:"tableName"},{default:n(()=>[e(G,{modelValue:o(i).tableName,"onUpdate:modelValue":a[1]||(a[1]=t=>o(i).tableName=t),placeholder:"请输入表名称",clearable:"",style:{width:"200px"},onKeyup:W(y,["enter"])},null,8,["modelValue"])]),_:1}),e(w,{label:"表描述",prop:"tableComment"},{default:n(()=>[e(G,{modelValue:o(i).tableComment,"onUpdate:modelValue":a[2]||(a[2]=t=>o(i).tableComment=t),placeholder:"请输入表描述",clearable:"",style:{width:"200px"},onKeyup:W(y,["enter"])},null,8,["modelValue"])]),_:1}),e(w,{label:"创建时间",style:{width:"308px"}},{default:n(()=>[e(me,{modelValue:o(f),"onUpdate:modelValue":a[3]||(a[3]=t=>X(f)?f.value=t:null),"value-format":"YYYY-MM-DD",type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])]),_:1}),e(w,null,{default:n(()=>[e(c,{type:"primary",icon:"Search",onClick:y},{default:n(()=>[v("搜索")]),_:1}),e(c,{icon:"Refresh",onClick:se},{default:n(()=>[v("重置")]),_:1})]),_:1})]),_:1},8,["model"])],512),[[Z,o(C)]])]),_:1},8,["enter-active-class","leave-active-class"]),e(ve,{shadow:"never"},{header:n(()=>[e(pe,{gutter:10,class:"mb8"},{default:n(()=>[e(E,{span:1.5},{default:n(()=>[u((r(),b(c,{type:"primary",plain:"",icon:"Download",onClick:a[4]||(a[4]=t=>z())},{default:n(()=>[v("生成")]),_:1})),[[_,["tool:gen:code"]]])]),_:1}),e(E,{span:1.5},{default:n(()=>[u((r(),b(c,{type:"info",plain:"",icon:"Upload",onClick:oe},{default:n(()=>[v("导入")]),_:1})),[[_,["tool:gen:import"]]])]),_:1}),e(E,{span:1.5},{default:n(()=>[u((r(),b(c,{type:"success",plain:"",icon:"Edit",disabled:o(P),onClick:a[5]||(a[5]=t=>B())},{default:n(()=>[v("修改")]),_:1},8,["disabled"])),[[_,["tool:gen:edit"]]])]),_:1}),e(E,{span:1.5},{default:n(()=>[u((r(),b(c,{type:"danger",plain:"",icon:"Delete",disabled:o(q),onClick:a[6]||(a[6]=t=>Y())},{default:n(()=>[v(" 删除 ")]),_:1},8,["disabled"])),[[_,["tool:gen:remove"]]])]),_:1}),e(re,{showSearch:o(C),"onUpdate:showSearch":a[7]||(a[7]=t=>X(C)?C.value=t:null),onQueryTable:g},null,8,["showSearch"])]),_:1})]),default:n(()=>[u((r(),b(_e,{data:o(U),onSelectionChange:ue},{default:n(()=>[e(p,{type:"selection",align:"center",width:"55"}),e(p,{label:"序号",type:"index",width:"50",align:"center"},{default:n(t=>[$("span",null,ee((o(i).pageNum-1)*o(i).pageSize+t.$index+1),1)]),_:1}),e(p,{label:"数据源",align:"center",prop:"dataName","show-overflow-tooltip":!0}),e(p,{label:"表名称",align:"center",prop:"tableName","show-overflow-tooltip":!0}),e(p,{label:"表描述",align:"center",prop:"tableComment","show-overflow-tooltip":!0}),e(p,{label:"实体",align:"center",prop:"className","show-overflow-tooltip":!0}),e(p,{label:"创建时间",align:"center",prop:"createTime",width:"160"}),e(p,{label:"更新时间",align:"center",prop:"updateTime",width:"160"}),e(p,{label:"操作",align:"center",width:"330","class-name":"small-padding fixed-width"},{default:n(t=>[e(N,{content:"预览",placement:"top"},{default:n(()=>[u(e(c,{link:"",type:"primary",icon:"View",onClick:m=>ie(t.row)},null,8,["onClick"]),[[_,["tool:gen:preview"]]])]),_:2},1024),e(N,{content:"编辑",placement:"top"},{default:n(()=>[u(e(c,{link:"",type:"primary",icon:"Edit",onClick:m=>B(t.row)},null,8,["onClick"]),[[_,["tool:gen:edit"]]])]),_:2},1024),e(N,{content:"删除",placement:"top"},{default:n(()=>[u(e(c,{link:"",type:"primary",icon:"Delete",onClick:m=>Y(t.row)},null,8,["onClick"]),[[_,["tool:gen:remove"]]])]),_:2},1024),e(N,{content:"同步",placement:"top"},{default:n(()=>[u(e(c,{link:"",type:"primary",icon:"Refresh",onClick:m=>ne(t.row)},null,8,["onClick"]),[[_,["tool:gen:edit"]]])]),_:2},1024),e(N,{content:"生成代码",placement:"top"},{default:n(()=>[u(e(c,{link:"",type:"primary",icon:"Download",onClick:m=>z(t.row)},null,8,["onClick"]),[[_,["tool:gen:code"]]])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[we,o(S)]]),u(e(be,{total:o(T),page:o(i).pageNum,"onUpdate:page":a[8]||(a[8]=t=>o(i).pageNum=t),limit:o(i).pageSize,"onUpdate:limit":a[9]||(a[9]=t=>o(i).pageSize=t),onPagination:g},null,8,["total","page","limit"]),[[Z,o(T)>0]])]),_:1}),e(ye,{title:o(V).title,modelValue:o(V).visible,"onUpdate:modelValue":a[11]||(a[11]=t=>o(V).visible=t),width:"80%",top:"5vh","append-to-body":"",class:"scrollbar"},{default:n(()=>[e(he,{modelValue:o(h).activeName,"onUpdate:modelValue":a[10]||(a[10]=t=>o(h).activeName=t)},{default:n(()=>[(r(!0),I(H,null,J(o(h).data,(t,m)=>(r(),b(ge,{label:m.substring(m.lastIndexOf("/")+1,m.indexOf(".vm")),name:m.substring(m.lastIndexOf("/")+1,m.indexOf(".vm")),key:t},{default:n(()=>[u((r(),b(fe,{underline:!1,icon:"DocumentCopy",style:{float:"right"}},{default:n(()=>[v(" 复制")]),_:2},1024)),[[M,t],[M,de,"callback"]]),$("pre",null,ee(t),1)]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["title","modelValue"]),e(ae,{ref_key:"importRef",ref:O,onOk:y},null,512)])}}});export{ya as default};
