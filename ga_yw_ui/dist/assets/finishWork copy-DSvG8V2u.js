import{d as T,V as te,r as d,Y as P,aa as oe,b as ae,$ as ne,o as c,c as le,k as t,m as o,w as u,p as f,y as g,e as n,a3 as ie,a7 as se,x as re,G as de,W as me,X as ue,a8 as ce,ac as pe,a9 as _e,a0 as fe,C as ge,H as ve,am as be,v as we}from"./index-BoCONcAc.js";/* empty css                */import{_ as Ce}from"./index-DG7XexN9.js";import"./el-form-item-l0sNRNKZ.js";import{_ as he}from"./index.vue_vue_type_style_index_0_lang-Dyb-nOKR.js";/* empty css                */import{_ as ke}from"./index-B1KNwlHH.js";/* empty css                 *//* empty css                    *//* empty css                        *//* empty css               */import{_ as Le}from"./index-B4NenLWv.js";/* empty css               */import{l as ye,g as $e,u as Ee,a as Ve,d as Se}from"./index-hmiVVuGg.js";/* empty css                *//* empty css                    *//* empty css                */const De={class:"p-2"},Ie={class:"dialog-footer"},Fe=T({name:"InfoLog"}),Ye=T({...Fe,setup(Ne){const{proxy:i}=te(),V=d([]),w=d(!1),C=d(!0),k=d(!0),L=d([]),S=d(!0),D=d(!0),y=d(0);d();const $=d(),m=P({visible:!1,title:""}),I={id:void 0,workContent:void 0,attachs:void 0},q=P({form:{...I},queryParams:{pageNum:1,pageSize:10,workContent:void 0,attachs:void 0,params:{}},rules:{id:[{required:!0,message:"$comment不能为空",trigger:"blur"}],workContent:[{required:!0,message:"$comment不能为空",trigger:"blur"}],attachs:[{required:!0,message:"$comment不能为空",trigger:"blur"}]}}),{queryParams:p,form:s,rules:B}=oe(q),v=async()=>{C.value=!0;const a=await ye(p.value);V.value=a.rows,y.value=a.total,C.value=!1},R=()=>{E(),m.visible=!1},E=()=>{var a;s.value={...I},(a=$.value)==null||a.resetFields()},z=a=>{L.value=a.map(e=>e.id),S.value=a.length!=1,D.value=!a.length},j=()=>{E(),m.visible=!0,m.title="添加工单处理信息"},F=async a=>{E();const e=(a==null?void 0:a.id)||L.value[0],r=await $e(e);Object.assign(s.value,r.data),m.visible=!0,m.title="修改工单处理信息"},A=()=>{var a;(a=$.value)==null||a.validate(async e=>{e&&(w.value=!0,s.value.id?await Ee(s.value).finally(()=>w.value=!1):await Ve(s.value).finally(()=>w.value=!1),i==null||i.$modal.msgSuccess("操作成功"),m.visible=!1,await v())})},N=async a=>{const e=(a==null?void 0:a.id)||L.value;await(i==null?void 0:i.$modal.confirm('是否确认删除工单处理信息编号为"'+e+'"的数据项？').finally(()=>C.value=!1)),await Se(e),i==null||i.$modal.msgSuccess("删除成功"),await v()},G=()=>{i==null||i.download("infolog/infoLog/export",{...p.value},`infoLog_${new Date().getTime()}.xlsx`)};return ae(()=>{v()}),(a,e)=>{const r=de,h=me,H=Le,M=ue,b=ce,U=pe,O=_e,Q=ke,W=fe,X=he,x=ge,Y=Ce,J=ve,K=be,_=ne("hasPermi"),Z=we;return c(),le("div",De,[t(W,{shadow:"never"},{header:o(()=>[t(M,{gutter:10,class:"mb8"},{default:o(()=>[t(h,{span:1.5},{default:o(()=>[u((c(),f(r,{type:"primary",plain:"",icon:"Plus",onClick:j},{default:o(()=>[g("新增")]),_:1})),[[_,["infolog:infoLog:add"]]])]),_:1}),t(h,{span:1.5},{default:o(()=>[u((c(),f(r,{type:"success",plain:"",icon:"Edit",disabled:n(S),onClick:e[0]||(e[0]=l=>F())},{default:o(()=>[g("修改")]),_:1},8,["disabled"])),[[_,["infolog:infoLog:edit"]]])]),_:1}),t(h,{span:1.5},{default:o(()=>[u((c(),f(r,{type:"danger",plain:"",icon:"Delete",disabled:n(D),onClick:e[1]||(e[1]=l=>N())},{default:o(()=>[g("删除")]),_:1},8,["disabled"])),[[_,["infolog:infoLog:remove"]]])]),_:1}),t(h,{span:1.5},{default:o(()=>[u((c(),f(r,{type:"warning",plain:"",icon:"Download",onClick:G},{default:o(()=>[g("导出")]),_:1})),[[_,["infolog:infoLog:export"]]])]),_:1}),t(H,{showSearch:n(k),"onUpdate:showSearch":e[2]||(e[2]=l=>ie(k)?k.value=l:null),onQueryTable:v},null,8,["showSearch"])]),_:1})]),default:o(()=>[u((c(),f(O,{data:n(V),onSelectionChange:z},{default:o(()=>[t(b,{type:"selection",width:"55",align:"center"}),(c(),f(b,{key:0,label:"ID",align:"center",prop:"id"})),t(b,{label:"内容",align:"center",prop:"workContent"}),t(b,{label:"附件",align:"center",prop:"attachs"}),t(b,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:o(l=>[t(U,{content:"修改",placement:"top"},{default:o(()=>[u(t(r,{link:"",type:"primary",icon:"Edit",onClick:ee=>F(l.row)},null,8,["onClick"]),[[_,["infolog:infoLog:edit"]]])]),_:2},1024),t(U,{content:"删除",placement:"top"},{default:o(()=>[u(t(r,{link:"",type:"primary",icon:"Delete",onClick:ee=>N(l.row)},null,8,["onClick"]),[[_,["infolog:infoLog:remove"]]])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[Z,n(C)]]),u(t(Q,{total:n(y),page:n(p).pageNum,"onUpdate:page":e[3]||(e[3]=l=>n(p).pageNum=l),limit:n(p).pageSize,"onUpdate:limit":e[4]||(e[4]=l=>n(p).pageSize=l),onPagination:v},null,8,["total","page","limit"]),[[se,n(y)>0]])]),_:1}),t(K,{title:n(m).title,modelValue:n(m).visible,"onUpdate:modelValue":e[7]||(e[7]=l=>n(m).visible=l),width:"500px","append-to-body":""},{footer:o(()=>[re("div",Ie,[t(r,{loading:n(w),type:"primary",onClick:A},{default:o(()=>[g("确 定")]),_:1},8,["loading"]),t(r,{onClick:R},{default:o(()=>[g("取 消")]),_:1})])]),default:o(()=>[t(J,{ref_key:"infoLogFormRef",ref:$,model:n(s),rules:n(B),"label-width":"80px"},{default:o(()=>[t(x,{label:"${comment}"},{default:o(()=>[t(X,{modelValue:n(s).workContent,"onUpdate:modelValue":e[5]||(e[5]=l=>n(s).workContent=l),"min-height":192},null,8,["modelValue"])]),_:1}),t(x,{label:"${comment}",prop:"attachs"},{default:o(()=>[t(Y,{modelValue:n(s).attachs,"onUpdate:modelValue":e[6]||(e[6]=l=>n(s).attachs=l)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}});export{Ye as default};
