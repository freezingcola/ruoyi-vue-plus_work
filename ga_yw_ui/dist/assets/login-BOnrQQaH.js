import{d as H,h as O,a as j,r,i as C,b as G,j as E,o as u,c as v,k as s,m as n,e as o,p as M,q as w,t as L,x as p,y as q,z as J,A as X,B as Y,C as $,_ as Q,D as W,F as Z,G as ee,H as te,I as ae,J as oe,K as se,L as ne}from"./index-BoCONcAc.js";/* empty css                *//* empty css                    */import"./el-form-item-l0sNRNKZ.js";const z=g=>(ae("data-v-9a83d76d"),g=g(),oe(),g),le={class:"login"},re=z(()=>p("h3",{class:"title"},"集成化运维资源调度与配置平台",-1)),ie={class:"login-code"},ce=["src"],ue={key:0},de={key:1},me={key:0,style:{float:"right"}},pe=z(()=>p("div",{class:"el-login-footer"},[p("span",null,"Copyright © 2018-2024 疯狂的狮子Li All Rights Reserved.")],-1)),ge=H({__name:"login",setup(g){const B=O(),S=j(),e=r({tenantId:"000000",username:"",password:"",rememberMe:!1,code:"",uuid:""}),R={tenantId:[{required:!0,trigger:"blur",message:"请输入您的租户编号"}],username:[{required:!0,trigger:"blur",message:"请输入您的账号"}],password:[{required:!0,trigger:"blur",message:"请输入您的密码"}],code:[{required:!0,trigger:"change",message:"请输入验证码"}]},U={fpsLimit:60,interactivity:{detectsOn:"canvas",events:{onClick:{enable:!0,mode:"push"},onHover:{enable:!0,mode:"grab"},resize:!0},modes:{bubble:{distance:400,duration:2,opacity:.8,size:40},push:{quantity:4},grab:{distance:200,duration:.4},attract:{distance:200,duration:.4,factor:5}}},particles:{color:{value:"#fff"},links:{color:"#fff",distance:150,enable:!0,opacity:.4,width:1.2},collisions:{enable:!0},move:{attract:{enable:!1,rotateX:600,rotateY:1200},bounce:!1,direction:"none",enable:!0,out_mode:"out",random:!1,speed:.5,straight:!1},number:{density:{enable:!0,value_area:800},value:80},opacity:{value:.7},shape:{type:"circle"},size:{random:!0,value:3}},detectRetina:!0},k=r(""),d=r(!1),_=r(!0),b=r(!0),F=r(!1),V=r(void 0),x=r(),f=r([]);C(()=>S.currentRoute.value,a=>{V.value=a.query&&a.query.redirect},{immediate:!0});const I=()=>{var a;(a=x.value)==null||a.validate(async(t,c)=>{if(t){d.value=!0,e.value.rememberMe?(localStorage.setItem("tenantId",String(e.value.tenantId)),localStorage.setItem("username",String(e.value.username)),localStorage.setItem("password",String(e.value.password)),localStorage.setItem("rememberMe",String(e.value.rememberMe))):(localStorage.removeItem("tenantId"),localStorage.removeItem("username"),localStorage.removeItem("password"),localStorage.removeItem("rememberMe"));const[l]=await se(B.login(e.value));if(l)d.value=!1,_.value&&await y();else{const m=V.value||"/";await S.push(m),d.value=!1}}else console.log("error submit!",c)})},y=async()=>{const a=await X(),{data:t}=a;_.value=t.captchaEnabled===void 0?!0:t.captchaEnabled,_.value&&(k.value="data:image/gif;base64,"+t.img,e.value.uuid=t.uuid)},K=()=>{const a=localStorage.getItem("tenantId"),t=localStorage.getItem("username"),c=localStorage.getItem("password"),l=localStorage.getItem("rememberMe");e.value={tenantId:a===null?String(e.value.tenantId):a,username:t===null?String(e.value.username):t,password:String(c===null?e.value.password:c),rememberMe:l===null?!1:!!l}},N=async()=>{const{data:a}=await Y();b.value=a.tenantEnabled===void 0?!0:a.tenantEnabled,b.value&&(f.value=a.voList,f.value!=null&&f.value.length!==0&&(e.value.tenantId=f.value[0].tenantId))};return C(()=>e.value.tenantId,()=>{localStorage.setItem("tenantId",String(e.value.tenantId))}),G(()=>{y(),N(),K()}),(a,t)=>{const c=E("Particles"),l=$,m=Q,h=W,P=Z,T=ee,A=E("router-link"),D=te;return u(),v("div",le,[s(c,{id:"tsparticles",class:"login__particles",options:U}),s(D,{ref_key:"loginRef",ref:x,model:o(e),rules:R,class:"login-form"},{default:n(()=>[re,o(b)?(u(),M(l,{key:0,prop:"tenantId"})):w("",!0),s(l,{prop:"username"},{default:n(()=>[s(h,{modelValue:o(e).username,"onUpdate:modelValue":t[0]||(t[0]=i=>o(e).username=i),type:"text",size:"large","auto-complete":"off",placeholder:"账号"},{prefix:n(()=>[s(m,{"icon-class":"user",class:"el-input__icon input-icon"})]),_:1},8,["modelValue"])]),_:1}),s(l,{prop:"password"},{default:n(()=>[s(h,{modelValue:o(e).password,"onUpdate:modelValue":t[1]||(t[1]=i=>o(e).password=i),type:"password",size:"large","auto-complete":"off",placeholder:"密码",onKeyup:L(I,["enter"])},{prefix:n(()=>[s(m,{"icon-class":"password",class:"el-input__icon input-icon"})]),_:1},8,["modelValue"])]),_:1}),o(_)?(u(),M(l,{key:1,prop:"code"},{default:n(()=>[s(h,{modelValue:o(e).code,"onUpdate:modelValue":t[2]||(t[2]=i=>o(e).code=i),size:"large","auto-complete":"off",placeholder:"验证码",style:{width:"63%"},onKeyup:L(I,["enter"])},{prefix:n(()=>[s(m,{"icon-class":"validCode",class:"el-input__icon input-icon"})]),_:1},8,["modelValue"]),p("div",ie,[p("img",{src:o(k),class:"login-code-img",onClick:y},null,8,ce)])]),_:1})):w("",!0),s(P,{modelValue:o(e).rememberMe,"onUpdate:modelValue":t[3]||(t[3]=i=>o(e).rememberMe=i),style:{margin:"0 0 25px 0",color:"#fff"}},{default:n(()=>[q("记住密码")]),_:1},8,["modelValue"]),s(l,{style:{width:"100%"}},{default:n(()=>[s(T,{loading:o(d),size:"large",type:"primary",style:{width:"100%"},onClick:J(I,["prevent"])},{default:n(()=>[o(d)?(u(),v("span",de,"登 录 中...")):(u(),v("span",ue,"登 录"))]),_:1},8,["loading"]),o(F)?(u(),v("div",me,[s(A,{class:"link-type",to:"/register"},{default:n(()=>[q("立即注册")]),_:1})])):w("",!0)]),_:1})]),_:1},8,["model"]),pe])}}}),Ie=ne(ge,[["__scopeId","data-v-9a83d76d"]]);export{Ie as default};
