import{d as X,V as ve,r as p,Y as j,aa as Ve,b as ye,$ as ke,o as c,c as G,k as e,m as n,w as g,x as D,e as a,t as T,y as b,a7 as W,ab as he,p as v,a3 as we,q,T as Ne,M as Ue,N as Ce,b6 as Te,b7 as Pe,b8 as Ie,b9 as Se,ba as Ee,bb as $e,bc as De,D as qe,C as xe,G as Fe,H as Re,a0 as Be,W as Le,X as Ke,a8 as Ye,ap as Me,ac as ze,a9 as Ae,O as He,P as Oe,as as Qe,am as je,v as Ge}from"./index-BoCONcAc.js";/* empty css                       */import{_ as We}from"./index-B1KNwlHH.js";/* empty css                 *//* empty css                    *//* empty css                        *//* empty css               */import{_ as Xe}from"./index-B4NenLWv.js";/* empty css               *//* empty css                *//* empty css                */import"./el-form-item-l0sNRNKZ.js";import{s as Je}from"./index-DW2VoFzt.js";/* empty css                */const Ze={class:"p-2"},ea={class:"mb-[10px]"},aa={class:"dialog-footer"},la=X({name:"Tenant"}),va=X({...la,setup(ta){const{proxy:d}=ve(),x=p([]),F=p([]),N=p(!1),V=p(!0),U=p(!0),P=p([]),R=p(!0),B=p(!0),I=p(0),L=p(),S=p(),f=j({visible:!1,title:""}),K={id:void 0,tenantId:void 0,contactUserName:"",contactPhone:"",username:"",password:"",companyName:"",licenseNumber:"",domain:"",address:"",intro:"",remark:"",packageId:"",expireTime:"",accountCount:0,status:"0"},J=j({form:{...K},queryParams:{pageNum:1,pageSize:10,tenantId:"",contactUserName:"",contactPhone:"",companyName:""},rules:{id:[{required:!0,message:"id不能为空",trigger:"blur"}],tenantId:[{required:!0,message:"租户编号不能为空",trigger:"blur"}],contactUserName:[{required:!0,message:"联系人不能为空",trigger:"blur"}],contactPhone:[{required:!0,message:"联系电话不能为空",trigger:"blur"}],companyName:[{required:!0,message:"企业名称不能为空",trigger:"blur"}],username:[{required:!0,message:"用户名不能为空",trigger:"blur"},{min:2,max:20,message:"用户名称长度必须介于 2 和 20 之间",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"},{min:5,max:20,message:"用户密码长度必须介于 5 和 20 之间",trigger:"blur"}]}}),{queryParams:i,form:s,rules:Z}=Ve(J),Y=async()=>{const o=await Je();F.value=o.data},y=async()=>{V.value=!0;const o=await Te(i.value);x.value=o.rows,I.value=o.total,V.value=!1},ee=async o=>{let l=o.status==="0"?"启用":"停用";try{await(d==null?void 0:d.$modal.confirm('确认要"'+l+'""'+o.companyName+'"租户吗？')),await Pe(o.id,o.tenantId,o.status),d==null||d.$modal.msgSuccess(l+"成功")}catch{o.status=o.status==="0"?"1":"0"}},ae=()=>{E(),f.visible=!1},E=()=>{var o;s.value={...K},(o=S.value)==null||o.resetFields()},h=()=>{i.value.pageNum=1,y()},le=()=>{var o;(o=L.value)==null||o.resetFields(),h()},te=o=>{P.value=o.map(l=>l.id),R.value=o.length!=1,B.value=!o.length},ne=()=>{E(),Y(),f.visible=!0,f.title="添加租户"},M=async o=>{E(),await Y();const l=(o==null?void 0:o.id)||P.value[0],u=await Ie(l);Object.assign(s.value,u.data),f.visible=!0,f.title="修改租户"},oe=()=>{var o;(o=S.value)==null||o.validate(async l=>{l&&(N.value=!0,s.value.id?await Se(s.value).finally(()=>N.value=!1):await Ee(s.value).finally(()=>N.value=!1),d==null||d.$modal.msgSuccess("操作成功"),f.visible=!1,await y())})},z=async o=>{const l=(o==null?void 0:o.id)||P.value;await(d==null?void 0:d.$modal.confirm('是否确认删除租户编号为"'+l+'"的数据项？')),V.value=!0,await $e(l).finally(()=>V.value=!1),await y(),d==null||d.$modal.msgSuccess("删除成功")},se=async o=>{try{await(d==null?void 0:d.$modal.confirm('是否确认同步租户套餐租户编号为"'+o.tenantId+'"的数据项？')),V.value=!0,await De(o.tenantId,o.packageId),await y(),d==null||d.$modal.msgSuccess("同步成功")}catch{return}finally{V.value=!1}},de=()=>{d==null||d.download("system/tenant/export",{...i.value},`tenant_${new Date().getTime()}.xlsx`)};return ye(()=>{y()}),(o,l)=>{var O,Q;const u=qe,r=xe,m=Fe,A=Re,H=Be,C=Le,re=Xe,ue=Ke,_=Ye,ie=Me,$=ze,me=Ae,pe=We,ce=He,ge=Oe,fe=Qe,_e=je,k=ke("hasPermi"),be=Ge;return c(),G("div",Ze,[e(he,{"enter-active-class":(O=a(d))==null?void 0:O.animate.searchAnimate.enter,"leave-active-class":(Q=a(d))==null?void 0:Q.animate.searchAnimate.leave},{default:n(()=>[g(D("div",ea,[e(H,{shadow:"hover"},{default:n(()=>[e(A,{ref_key:"queryFormRef",ref:L,model:a(i),inline:!0},{default:n(()=>[e(r,{label:"租户编号",prop:"tenantId"},{default:n(()=>[e(u,{modelValue:a(i).tenantId,"onUpdate:modelValue":l[0]||(l[0]=t=>a(i).tenantId=t),placeholder:"请输入租户编号",clearable:"",onKeyup:T(h,["enter"])},null,8,["modelValue"])]),_:1}),e(r,{label:"联系人",prop:"contactUserName"},{default:n(()=>[e(u,{modelValue:a(i).contactUserName,"onUpdate:modelValue":l[1]||(l[1]=t=>a(i).contactUserName=t),placeholder:"请输入联系人",clearable:"",onKeyup:T(h,["enter"])},null,8,["modelValue"])]),_:1}),e(r,{label:"联系电话",prop:"contactPhone"},{default:n(()=>[e(u,{modelValue:a(i).contactPhone,"onUpdate:modelValue":l[2]||(l[2]=t=>a(i).contactPhone=t),placeholder:"请输入联系电话",clearable:"",onKeyup:T(h,["enter"])},null,8,["modelValue"])]),_:1}),e(r,{label:"企业名称",prop:"companyName"},{default:n(()=>[e(u,{modelValue:a(i).companyName,"onUpdate:modelValue":l[3]||(l[3]=t=>a(i).companyName=t),placeholder:"请输入企业名称",clearable:"",onKeyup:T(h,["enter"])},null,8,["modelValue"])]),_:1}),e(r,null,{default:n(()=>[e(m,{type:"primary",icon:"Search",onClick:h},{default:n(()=>[b("搜索")]),_:1}),e(m,{icon:"Refresh",onClick:le},{default:n(()=>[b("重置")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})],512),[[W,a(U)]])]),_:1},8,["enter-active-class","leave-active-class"]),e(H,{shadow:"hover"},{header:n(()=>[e(ue,{gutter:10,class:"mb8"},{default:n(()=>[e(C,{span:1.5},{default:n(()=>[g((c(),v(m,{type:"primary",plain:"",icon:"Plus",onClick:ne},{default:n(()=>[b("新增")]),_:1})),[[k,["system:tenant:add"]]])]),_:1}),e(C,{span:1.5},{default:n(()=>[g((c(),v(m,{type:"success",plain:"",icon:"Edit",disabled:a(R),onClick:l[4]||(l[4]=t=>M())},{default:n(()=>[b("修改")]),_:1},8,["disabled"])),[[k,["system:tenant:edit"]]])]),_:1}),e(C,{span:1.5},{default:n(()=>[g((c(),v(m,{type:"danger",plain:"",icon:"Delete",disabled:a(B),onClick:l[5]||(l[5]=t=>z())},{default:n(()=>[b(" 删除 ")]),_:1},8,["disabled"])),[[k,["system:tenant:remove"]]])]),_:1}),e(C,{span:1.5},{default:n(()=>[g((c(),v(m,{type:"warning",plain:"",icon:"Download",onClick:de},{default:n(()=>[b("导出")]),_:1})),[[k,["system:tenant:export"]]])]),_:1}),e(re,{showSearch:a(U),"onUpdate:showSearch":l[6]||(l[6]=t=>we(U)?U.value=t:null),onQueryTable:y},null,8,["showSearch"])]),_:1})]),default:n(()=>[g((c(),v(me,{data:a(x),onSelectionChange:te},{default:n(()=>[e(_,{type:"selection",width:"55",align:"center"}),q("",!0),e(_,{label:"租户编号",align:"center",prop:"tenantId"}),e(_,{label:"联系人",align:"center",prop:"contactUserName"}),e(_,{label:"联系电话",align:"center",prop:"contactPhone"}),e(_,{label:"企业名称",align:"center",prop:"companyName"}),e(_,{label:"社会信用代码",align:"center",prop:"licenseNumber"}),e(_,{label:"过期时间",align:"center",prop:"expireTime",width:"180"},{default:n(t=>[D("span",null,Ne(o.parseTime(t.row.expireTime,"{y}-{m}-{d}")),1)]),_:1}),e(_,{label:"租户状态",align:"center",prop:"status"},{default:n(t=>[e(ie,{modelValue:t.row.status,"onUpdate:modelValue":w=>t.row.status=w,"active-value":"0","inactive-value":"1",onChange:w=>ee(t.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(_,{width:"150",label:"操作",align:"center",fixed:"right","class-name":"small-padding fixed-width"},{default:n(t=>[e($,{content:"修改",placement:"top"},{default:n(()=>[g(e(m,{link:"",type:"primary",icon:"Edit",onClick:w=>M(t.row)},null,8,["onClick"]),[[k,["system:tenant:edit"]]])]),_:2},1024),e($,{content:"同步套餐",placement:"top"},{default:n(()=>[g(e(m,{link:"",type:"primary",icon:"Refresh",onClick:w=>se(t.row)},null,8,["onClick"]),[[k,["system:tenant:edit"]]])]),_:2},1024),e($,{content:"删除",placement:"top"},{default:n(()=>[g(e(m,{link:"",type:"primary",icon:"Delete",onClick:w=>z(t.row)},null,8,["onClick"]),[[k,["system:tenant:remove"]]])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[be,a(V)]]),g(e(pe,{page:a(i).pageNum,"onUpdate:page":l[7]||(l[7]=t=>a(i).pageNum=t),limit:a(i).pageSize,"onUpdate:limit":l[8]||(l[8]=t=>a(i).pageSize=t),total:a(I),onPagination:y},null,8,["page","limit","total"]),[[W,a(I)>0]])]),_:1}),e(_e,{modelValue:a(f).visible,"onUpdate:modelValue":l[22]||(l[22]=t=>a(f).visible=t),title:a(f).title,width:"500px","append-to-body":""},{footer:n(()=>[D("div",aa,[e(m,{loading:a(N),type:"primary",onClick:oe},{default:n(()=>[b("确 定")]),_:1},8,["loading"]),e(m,{onClick:ae},{default:n(()=>[b("取 消")]),_:1})])]),default:n(()=>[e(A,{ref_key:"tenantFormRef",ref:S,model:a(s),rules:a(Z),"label-width":"80px"},{default:n(()=>[e(r,{label:"企业名称",prop:"companyName"},{default:n(()=>[e(u,{modelValue:a(s).companyName,"onUpdate:modelValue":l[9]||(l[9]=t=>a(s).companyName=t),placeholder:"请输入企业名称"},null,8,["modelValue"])]),_:1}),e(r,{label:"联系人",prop:"contactUserName"},{default:n(()=>[e(u,{modelValue:a(s).contactUserName,"onUpdate:modelValue":l[10]||(l[10]=t=>a(s).contactUserName=t),placeholder:"请输入联系人"},null,8,["modelValue"])]),_:1}),e(r,{label:"联系电话",prop:"contactPhone"},{default:n(()=>[e(u,{modelValue:a(s).contactPhone,"onUpdate:modelValue":l[11]||(l[11]=t=>a(s).contactPhone=t),placeholder:"请输入联系电话"},null,8,["modelValue"])]),_:1}),a(s).id?q("",!0):(c(),v(r,{key:0,label:"用户名",prop:"username"},{default:n(()=>[e(u,{modelValue:a(s).username,"onUpdate:modelValue":l[12]||(l[12]=t=>a(s).username=t),placeholder:"请输入系统用户名",maxlength:"30"},null,8,["modelValue"])]),_:1})),a(s).id?q("",!0):(c(),v(r,{key:1,label:"用户密码",prop:"password"},{default:n(()=>[e(u,{modelValue:a(s).password,"onUpdate:modelValue":l[13]||(l[13]=t=>a(s).password=t),type:"password",placeholder:"请输入系统用户密码",maxlength:"20"},null,8,["modelValue"])]),_:1})),e(r,{label:"租户套餐",prop:"packageId"},{default:n(()=>[e(ge,{modelValue:a(s).packageId,"onUpdate:modelValue":l[14]||(l[14]=t=>a(s).packageId=t),disabled:!!a(s).tenantId,placeholder:"请选择租户套餐",clearable:"",style:{width:"100%"}},{default:n(()=>[(c(!0),G(Ue,null,Ce(a(F),t=>(c(),v(ce,{key:t.packageId,label:t.packageName,value:t.packageId},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),e(r,{label:"过期时间",prop:"expireTime"},{default:n(()=>[e(fe,{modelValue:a(s).expireTime,"onUpdate:modelValue":l[15]||(l[15]=t=>a(s).expireTime=t),clearable:"",type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"请选择过期时间"},null,8,["modelValue"])]),_:1}),e(r,{label:"用户数量",prop:"accountCount"},{default:n(()=>[e(u,{modelValue:a(s).accountCount,"onUpdate:modelValue":l[16]||(l[16]=t=>a(s).accountCount=t),placeholder:"请输入用户数量"},null,8,["modelValue"])]),_:1}),e(r,{label:"绑定域名",prop:"domain"},{default:n(()=>[e(u,{modelValue:a(s).domain,"onUpdate:modelValue":l[17]||(l[17]=t=>a(s).domain=t),placeholder:"请输入绑定域名"},null,8,["modelValue"])]),_:1}),e(r,{label:"企业地址",prop:"address"},{default:n(()=>[e(u,{modelValue:a(s).address,"onUpdate:modelValue":l[18]||(l[18]=t=>a(s).address=t),placeholder:"请输入企业地址"},null,8,["modelValue"])]),_:1}),e(r,{label:"企业代码",prop:"licenseNumber"},{default:n(()=>[e(u,{modelValue:a(s).licenseNumber,"onUpdate:modelValue":l[19]||(l[19]=t=>a(s).licenseNumber=t),placeholder:"请输入统一社会信用代码"},null,8,["modelValue"])]),_:1}),e(r,{label:"企业简介",prop:"intro"},{default:n(()=>[e(u,{modelValue:a(s).intro,"onUpdate:modelValue":l[20]||(l[20]=t=>a(s).intro=t),type:"textarea",placeholder:"请输入企业简介"},null,8,["modelValue"])]),_:1}),e(r,{label:"备注",prop:"remark"},{default:n(()=>[e(u,{modelValue:a(s).remark,"onUpdate:modelValue":l[21]||(l[21]=t=>a(s).remark=t),placeholder:"请输入备注"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{va as default};
