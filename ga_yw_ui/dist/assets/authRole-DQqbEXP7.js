import{d as S,u as K,V as L,r as i,b as P,o as R,c as q,x as s,k as a,m as n,e as t,w as y,p as z,T as C,a6 as G,a7 as H,a3 as E,y as V,n as M,D as W,C as X,W as J,X as Q,H as Y,a8 as Z,a9 as ee,G as te,v as ae}from"./index-BoCONcAc.js";import{_ as oe}from"./index-B1KNwlHH.js";/* empty css                 *//* empty css                    *//* empty css                        *//* empty css                *//* empty css               *//* empty css               */import"./el-form-item-l0sNRNKZ.js";import{u as le,a as ne}from"./index-JZ_QvNlG.js";const se={class:"p-2"},ie={class:"panel"},re=s("h4",{class:"panel-title"},"基本信息",-1),ue={class:"panel"},ce=s("h4",{class:"panel-title"},"角色信息",-1),de={style:{"text-align":"center","margin-left":"-120px","margin-top":"30px"}},me=s("div",null,null,-1),pe=S({name:"AuthRole"}),ye=S({...pe,setup(_e){const h=K(),{proxy:c}=L(),f=i(!0),v=i(0),d=i(1),m=i(10),k=i([]),g=i([]),r=i({nickName:void 0,userName:"",userId:void 0}),b=i(),x=o=>{var e;(e=b.value)==null||e.toggleRowSelection(o,!1)},T=o=>{k.value=o.map(e=>e.roleId)},B=o=>String(o.roleId),w=()=>{const o={fullPath:"",hash:"",matched:[],meta:void 0,name:void 0,params:void 0,query:void 0,redirectedFrom:void 0,path:"/system/user"};c==null||c.$tab.closeOpenPage(o)},$=async()=>{const o=r.value.userId,e=k.value.join(",");await le({userId:o,roleIds:e}),c==null||c.$modal.msgSuccess("授权成功"),w()},j=async()=>{const o=h.params&&h.params.userId;if(o){f.value=!0;const e=await ne(o);Object.assign(r.value,e.data.user),Object.assign(g.value,e.data.roles),v.value=g.value.length,await M(()=>{g.value.forEach(u=>{var _;u!=null&&u.flag&&((_=b.value)==null||_.toggleRowSelection(u,!0))})}),f.value=!1}};return P(()=>{j()}),(o,e)=>{const u=W,_=X,I=J,F=Q,U=Y,p=Z,A=ee,D=oe,N=te,O=ae;return R(),q("div",se,[s("div",ie,[re,a(U,{model:t(r),inline:!0},{default:n(()=>[a(F,{gutter:10},{default:n(()=>[a(I,{span:2.5},{default:n(()=>[a(_,{label:"用户昵称",prop:"nickName"},{default:n(()=>[a(u,{modelValue:t(r).nickName,"onUpdate:modelValue":e[0]||(e[0]=l=>t(r).nickName=l),disabled:""},null,8,["modelValue"])]),_:1})]),_:1}),a(I,{span:2.5},{default:n(()=>[a(_,{label:"登录账号",prop:"userName"},{default:n(()=>[a(u,{modelValue:t(r).userName,"onUpdate:modelValue":e[1]||(e[1]=l=>t(r).userName=l),disabled:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),s("div",ue,[ce,s("div",null,[y((R(),z(A,{ref_key:"tableRef",ref:b,"row-key":B,data:t(g).slice((t(d)-1)*t(m),t(d)*t(m)),onRowClick:x,onSelectionChange:T},{default:n(()=>[a(p,{label:"序号",width:"55",type:"index",align:"center"},{default:n(l=>[s("span",null,C((t(d)-1)*t(m)+l.$index+1),1)]),_:1}),a(p,{type:"selection","reserve-selection":!0,width:"55"}),a(p,{label:"角色编号",align:"center",prop:"roleId"}),a(p,{label:"角色名称",align:"center",prop:"roleName"}),a(p,{label:"权限字符",align:"center",prop:"roleKey"}),a(p,{label:"创建时间",align:"center",prop:"createTime",width:"180"},{default:n(l=>[s("span",null,C(t(G)(l.row.createTime)),1)]),_:1})]),_:1},8,["data"])),[[O,t(f)]]),y(a(D,{page:t(d),"onUpdate:page":e[2]||(e[2]=l=>E(d)?d.value=l:null),limit:t(m),"onUpdate:limit":e[3]||(e[3]=l=>E(m)?m.value=l:null),total:t(v)},null,8,["page","limit","total"]),[[H,t(v)>0]]),s("div",de,[a(N,{type:"primary",onClick:e[4]||(e[4]=l=>$())},{default:n(()=>[V("提交")]),_:1}),a(N,{onClick:e[5]||(e[5]=l=>w())},{default:n(()=>[V("返回")]),_:1})]),me])])])}}});export{ye as default};
