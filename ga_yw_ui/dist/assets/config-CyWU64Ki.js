import{an as K,d as oe,V as Ve,aa as J,r as b,Y as Z,b as Ce,$ as Ke,o as u,c as ee,k as l,m as o,w as V,x as le,e,t as ae,y as c,a7 as te,ab as he,p as r,a3 as we,q as g,M as Ne,N as Se,T as Ue,D as Ee,C as Pe,O as Ie,P as qe,G as Fe,H as Oe,a0 as $e,W as De,X as Re,a8 as Te,ak as xe,ap as Be,ac as He,a9 as Le,ao as ze,a2 as Ae,am as Qe,v as Ge}from"./index-BoCONcAc.js";/* empty css                       *//* empty css                 */import{_ as Me}from"./index-B1KNwlHH.js";/* empty css                 *//* empty css                    *//* empty css                        *//* empty css               */import{_ as je}from"./index-B4NenLWv.js";/* empty css               *//* empty css                *//* empty css                */import"./el-form-item-l0sNRNKZ.js";/* empty css                */function We(f){return K({url:"/resource/oss/config/list",method:"get",params:f})}function Xe(f){return K({url:"/resource/oss/config/"+f,method:"get"})}function Ye(f){return K({url:"/resource/oss/config",method:"post",data:f})}function Je(f){return K({url:"/resource/oss/config",method:"put",data:f})}function Ze(f){return K({url:"/resource/oss/config/"+f,method:"delete"})}function el(f,i,I){return K({url:"/resource/oss/config/changeStatus",method:"put",data:{ossConfigId:f,status:i,configKey:I}})}const ll={class:"p-2"},al={class:"mb-[10px]"},tl={class:"dialog-footer"},ol=oe({name:"OssConfig"}),vl=oe({...ol,setup(f){const{proxy:i}=Ve(),{sys_yes_no:I}=J(i==null?void 0:i.useDict("sys_yes_no")),q=b([]),N=b(!1),h=b(!0),S=b(!0),F=b([]),x=b(!0),B=b(!0),O=b(0),H=b(),$=b(),_=Z({visible:!1,title:""}),v=b([{key:0,label:"主建",visible:!0},{key:1,label:"配置key",visible:!1},{key:2,label:"访问站点",visible:!0},{key:3,label:"自定义域名",visible:!0},{key:4,label:"桶名称",visible:!0},{key:5,label:"前缀",visible:!0},{key:6,label:"域",visible:!0},{key:7,label:"桶权限类型",visible:!0},{key:8,label:"状态",visible:!0}]),L={ossConfigId:void 0,configKey:"",accessKey:"",secretKey:"",bucketName:"",prefix:"",endpoint:"",domain:"",isHttps:"N",accessPolicy:"1",region:"",status:"1",remark:""},se=Z({form:{...L},queryParams:{pageNum:1,pageSize:10,configKey:"",bucketName:"",status:""},rules:{configKey:[{required:!0,message:"configKey不能为空",trigger:"blur"}],accessKey:[{required:!0,message:"accessKey不能为空",trigger:"blur"},{min:2,max:200,message:"accessKey长度必须介于 2 和 100 之间",trigger:"blur"}],secretKey:[{required:!0,message:"secretKey不能为空",trigger:"blur"},{min:2,max:100,message:"secretKey长度必须介于 2 和 100 之间",trigger:"blur"}],bucketName:[{required:!0,message:"bucketName不能为空",trigger:"blur"},{min:2,max:100,message:"bucketName长度必须介于 2 和 100 之间",trigger:"blur"}],endpoint:[{required:!0,message:"endpoint不能为空",trigger:"blur"},{min:2,max:100,message:"endpoint名称长度必须介于 2 和 100 之间",trigger:"blur"}],accessPolicy:[{required:!0,message:"accessPolicy不能为空",trigger:"blur"}]}}),{queryParams:m,form:n,rules:ne}=J(se),C=async()=>{h.value=!0;const s=await We(m.value);q.value=s.rows,O.value=s.total,h.value=!1},ie=()=>{_.visible=!1,D()},D=()=>{var s;n.value={...L},(s=$.value)==null||s.resetFields()},U=()=>{m.value.pageNum=1,C()},ue=()=>{var s;(s=H.value)==null||s.resetFields(),U()},re=s=>{F.value=s.map(a=>a.ossConfigId),x.value=s.length!=1,B.value=!s.length},de=()=>{D(),_.visible=!0,_.title="添加对象存储配置"},z=async s=>{D();const a=(s==null?void 0:s.ossConfigId)||F.value[0],p=await Xe(a);Object.assign(n.value,p.data),_.visible=!0,_.title="修改对象存储配置"},ce=()=>{var s;(s=$.value)==null||s.validate(async a=>{a&&(N.value=!0,n.value.ossConfigId?await Je(n.value).finally(()=>N.value=!1):await Ye(n.value).finally(()=>N.value=!1),i==null||i.$modal.msgSuccess("新增成功"),_.visible=!1,await C())})},me=async s=>{let a=s.status==="0"?"启用":"停用";try{await(i==null?void 0:i.$modal.confirm('确认要"'+a+'""'+s.configKey+'"配置吗?')),await el(s.ossConfigId,s.status,s.configKey),await C(),i==null||i.$modal.msgSuccess(a+"成功")}catch{return}finally{s.status=s.status==="0"?"1":"0"}},A=async s=>{const a=(s==null?void 0:s.ossConfigId)||F.value;await(i==null?void 0:i.$modal.confirm('是否确认删除OSS配置编号为"'+a+'"的数据项?')),h.value=!0,await Ze(a).finally(()=>h.value=!1),await C(),i==null||i.$modal.msgSuccess("删除成功")};return Ce(()=>{C()}),(s,a)=>{var X,Y;const p=Ee,d=Pe,Q=Ie,pe=qe,k=Fe,G=Oe,M=$e,R=De,fe=je,ge=Re,y=Te,T=xe,ye=Be,j=He,be=Le,_e=Me,E=ze,W=Ae,ve=Qe,w=Ke("hasPermi"),ke=Ge;return u(),ee("div",ll,[l(he,{"enter-active-class":(X=e(i))==null?void 0:X.animate.searchAnimate.enter,"leave-active-class":(Y=e(i))==null?void 0:Y.animate.searchAnimate.leave},{default:o(()=>[V(le("div",al,[l(M,{shadow:"hover"},{default:o(()=>[l(G,{ref_key:"queryFormRef",ref:H,model:e(m),inline:!0},{default:o(()=>[l(d,{label:"配置key",prop:"configKey"},{default:o(()=>[l(p,{modelValue:e(m).configKey,"onUpdate:modelValue":a[0]||(a[0]=t=>e(m).configKey=t),placeholder:"配置key",clearable:"",onKeyup:ae(U,["enter"])},null,8,["modelValue"])]),_:1}),l(d,{label:"桶名称",prop:"bucketName"},{default:o(()=>[l(p,{modelValue:e(m).bucketName,"onUpdate:modelValue":a[1]||(a[1]=t=>e(m).bucketName=t),placeholder:"请输入桶名称",clearable:"",onKeyup:ae(U,["enter"])},null,8,["modelValue"])]),_:1}),l(d,{label:"是否默认",prop:"status"},{default:o(()=>[l(pe,{modelValue:e(m).status,"onUpdate:modelValue":a[2]||(a[2]=t=>e(m).status=t),placeholder:"请选择状态",clearable:""},{default:o(()=>[l(Q,{key:"0",label:"是",value:"0"}),l(Q,{key:"1",label:"否",value:"1"})]),_:1},8,["modelValue"])]),_:1}),l(d,null,{default:o(()=>[l(k,{type:"primary",icon:"search",onClick:U},{default:o(()=>[c("搜索")]),_:1}),l(k,{icon:"Refresh",onClick:ue},{default:o(()=>[c("重置")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})],512),[[te,e(S)]])]),_:1},8,["enter-active-class","leave-active-class"]),l(M,{shadow:"hover"},{header:o(()=>[l(ge,{gutter:10,class:"mb8"},{default:o(()=>[l(R,{span:1.5},{default:o(()=>[V((u(),r(k,{type:"primary",plain:"",icon:"Plus",onClick:de},{default:o(()=>[c("新增")]),_:1})),[[w,["system:ossConfig:add"]]])]),_:1}),l(R,{span:1.5},{default:o(()=>[V((u(),r(k,{type:"success",plain:"",icon:"Edit",disabled:e(x),onClick:a[3]||(a[3]=t=>z())},{default:o(()=>[c("修改")]),_:1},8,["disabled"])),[[w,["system:ossConfig:edit"]]])]),_:1}),l(R,{span:1.5},{default:o(()=>[V((u(),r(k,{type:"danger",plain:"",icon:"Delete",disabled:e(B),onClick:a[4]||(a[4]=t=>A())},{default:o(()=>[c(" 删除 ")]),_:1},8,["disabled"])),[[w,["system:ossConfig:remove"]]])]),_:1}),l(fe,{showSearch:e(S),"onUpdate:showSearch":a[5]||(a[5]=t=>we(S)?S.value=t:null),onQueryTable:C},null,8,["showSearch"])]),_:1})]),default:o(()=>[V((u(),r(be,{data:e(q),onSelectionChange:re},{default:o(()=>[l(y,{type:"selection",width:"55",align:"center"}),e(v)[0].visible?(u(),r(y,{key:0,label:"主建",align:"center",prop:"ossConfigId"})):g("",!0),e(v)[1].visible?(u(),r(y,{key:1,label:"配置key",align:"center",prop:"configKey"})):g("",!0),e(v)[2].visible?(u(),r(y,{key:2,label:"访问站点",align:"center",prop:"endpoint",width:"200"})):g("",!0),e(v)[3].visible?(u(),r(y,{key:3,label:"自定义域名",align:"center",prop:"domain",width:"200"})):g("",!0),e(v)[4].visible?(u(),r(y,{key:4,label:"桶名称",align:"center",prop:"bucketName"})):g("",!0),e(v)[5].visible?(u(),r(y,{key:5,label:"前缀",align:"center",prop:"prefix"})):g("",!0),e(v)[6].visible?(u(),r(y,{key:6,label:"域",align:"center",prop:"region"})):g("",!0),e(v)[7].visible?(u(),r(y,{key:7,label:"桶权限类型",align:"center",prop:"accessPolicy"},{default:o(t=>[t.row.accessPolicy==="0"?(u(),r(T,{key:0,type:"warning"},{default:o(()=>[c("private")]),_:1})):g("",!0),t.row.accessPolicy==="1"?(u(),r(T,{key:1,type:"success"},{default:o(()=>[c("public")]),_:1})):g("",!0),t.row.accessPolicy==="2"?(u(),r(T,{key:2,type:"info"},{default:o(()=>[c("custom")]),_:1})):g("",!0)]),_:1})):g("",!0),e(v)[8].visible?(u(),r(y,{key:8,label:"是否默认",align:"center",prop:"status"},{default:o(t=>[l(ye,{modelValue:t.row.status,"onUpdate:modelValue":P=>t.row.status=P,"active-value":"0","inactive-value":"1",onChange:P=>me(t.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})):g("",!0),l(y,{label:"操作",fixed:"right",align:"center",width:"150","class-name":"small-padding"},{default:o(t=>[l(j,{content:"修改",placement:"top"},{default:o(()=>[V(l(k,{link:"",type:"primary",icon:"Edit",onClick:P=>z(t.row)},null,8,["onClick"]),[[w,["system:ossConfig:edit"]]])]),_:2},1024),l(j,{content:"删除",placement:"top"},{default:o(()=>[V(l(k,{link:"",type:"primary",icon:"Delete",onClick:P=>A(t.row)},null,8,["onClick"]),[[w,["system:ossConfig:remove"]]])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[ke,e(h)]]),V(l(_e,{page:e(m).pageNum,"onUpdate:page":a[6]||(a[6]=t=>e(m).pageNum=t),limit:e(m).pageSize,"onUpdate:limit":a[7]||(a[7]=t=>e(m).pageSize=t),total:e(O),onPagination:C},null,8,["page","limit","total"]),[[te,e(O)>0]])]),_:1}),l(ve,{modelValue:e(_).visible,"onUpdate:modelValue":a[19]||(a[19]=t=>e(_).visible=t),title:e(_).title,width:"800px","append-to-body":""},{footer:o(()=>[le("div",tl,[l(k,{loading:e(N),type:"primary",onClick:ce},{default:o(()=>[c("确 定")]),_:1},8,["loading"]),l(k,{onClick:ie},{default:o(()=>[c("取 消")]),_:1})])]),default:o(()=>[l(G,{ref_key:"ossConfigFormRef",ref:$,model:e(n),rules:e(ne),"label-width":"120px"},{default:o(()=>[l(d,{label:"配置key",prop:"configKey"},{default:o(()=>[l(p,{modelValue:e(n).configKey,"onUpdate:modelValue":a[8]||(a[8]=t=>e(n).configKey=t),placeholder:"请输入配置key"},null,8,["modelValue"])]),_:1}),l(d,{label:"访问站点",prop:"endpoint"},{default:o(()=>[l(p,{modelValue:e(n).endpoint,"onUpdate:modelValue":a[9]||(a[9]=t=>e(n).endpoint=t),placeholder:"请输入访问站点"},null,8,["modelValue"])]),_:1}),l(d,{label:"自定义域名",prop:"domain"},{default:o(()=>[l(p,{modelValue:e(n).domain,"onUpdate:modelValue":a[10]||(a[10]=t=>e(n).domain=t),placeholder:"请输入自定义域名"},null,8,["modelValue"])]),_:1}),l(d,{label:"accessKey",prop:"accessKey"},{default:o(()=>[l(p,{modelValue:e(n).accessKey,"onUpdate:modelValue":a[11]||(a[11]=t=>e(n).accessKey=t),placeholder:"请输入accessKey"},null,8,["modelValue"])]),_:1}),l(d,{label:"secretKey",prop:"secretKey"},{default:o(()=>[l(p,{modelValue:e(n).secretKey,"onUpdate:modelValue":a[12]||(a[12]=t=>e(n).secretKey=t),placeholder:"请输入秘钥","show-password":""},null,8,["modelValue"])]),_:1}),l(d,{label:"桶名称",prop:"bucketName"},{default:o(()=>[l(p,{modelValue:e(n).bucketName,"onUpdate:modelValue":a[13]||(a[13]=t=>e(n).bucketName=t),placeholder:"请输入桶名称"},null,8,["modelValue"])]),_:1}),l(d,{label:"前缀",prop:"prefix"},{default:o(()=>[l(p,{modelValue:e(n).prefix,"onUpdate:modelValue":a[14]||(a[14]=t=>e(n).prefix=t),placeholder:"请输入前缀"},null,8,["modelValue"])]),_:1}),l(d,{label:"是否HTTPS"},{default:o(()=>[l(W,{modelValue:e(n).isHttps,"onUpdate:modelValue":a[15]||(a[15]=t=>e(n).isHttps=t)},{default:o(()=>[(u(!0),ee(Ne,null,Se(e(I),t=>(u(),r(E,{key:t.value,value:t.value},{default:o(()=>[c(Ue(t.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"桶权限类型"},{default:o(()=>[l(W,{modelValue:e(n).accessPolicy,"onUpdate:modelValue":a[16]||(a[16]=t=>e(n).accessPolicy=t)},{default:o(()=>[l(E,{value:"0"},{default:o(()=>[c("private")]),_:1}),l(E,{value:"1"},{default:o(()=>[c("public")]),_:1}),l(E,{value:"2"},{default:o(()=>[c("custom")]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"域",prop:"region"},{default:o(()=>[l(p,{modelValue:e(n).region,"onUpdate:modelValue":a[17]||(a[17]=t=>e(n).region=t),placeholder:"请输入域"},null,8,["modelValue"])]),_:1}),l(d,{label:"备注",prop:"remark"},{default:o(()=>[l(p,{modelValue:e(n).remark,"onUpdate:modelValue":a[18]||(a[18]=t=>e(n).remark=t),type:"textarea",placeholder:"请输入内容"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{vl as default};
