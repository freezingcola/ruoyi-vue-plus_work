import{d as M,V as ce,r as m,Y as O,aa as ue,b as me,$ as pe,o as V,c as fe,k as e,m as l,w as f,x as j,e as t,t as z,y as _,a7 as ge,ab as _e,p as S,a3 as ve,n as G,D as ye,C as be,G as he,H as Ce,W as we,X as ke,a8 as Ve,ac as Ne,a9 as Ee,a0 as Ie,au as Te,al as Re,am as Se,v as Fe}from"./index-BoCONcAc.js";/* empty css                        *//* empty css                *//* empty css                    *//* empty css                       *//* empty css                *//* empty css                 *//* empty css                        *//* empty css               */import{_ as Ue}from"./index-B4NenLWv.js";/* empty css               *//* empty css                */import"./el-form-item-l0sNRNKZ.js";import{l as H,g as qe,u as $e,a as De,d as xe}from"./index-BMOFFQpT.js";const Ae={class:"p-2"},Pe={class:"search"},Be={class:"dialog-footer"},Le=M({name:"Category"}),la=M({...Le,setup(Ke){const{proxy:r}=ce(),N=m([]),E=m([]),y=m(!1),b=m(!0),h=m(!0),p=m(!1),F=m(),I=m(),U=m(),d=O({visible:!1,title:""}),q={id:void 0,categoryName:void 0,categoryCode:void 0,parentId:void 0,sortNum:0},W=O({form:{...q},queryParams:{pageNum:1,pageSize:10,categoryName:void 0,categoryCode:void 0},rules:{id:[{required:!0,message:"主键不能为空",trigger:"blur"}],categoryName:[{required:!0,message:"分类名称不能为空",trigger:"blur"}],categoryCode:[{required:!0,message:"分类编码不能为空",trigger:"blur"}],parentId:[{required:!0,message:"父级id不能为空",trigger:"blur"}]}}),{queryParams:g,form:s,rules:X}=ue(W),v=async()=>{p.value=!0;const o=await H(g.value),a=r==null?void 0:r.handleTree(o.data,"id","parentId");a&&(N.value=a,p.value=!1)},$=async()=>{const o=await H();E.value=[];const a={id:0,categoryName:"顶级节点",children:[]};a.children=r==null?void 0:r.handleTree(o.data,"id","parentId"),E.value.push(a)},Y=()=>{T(),d.visible=!1},T=()=>{var o;s.value={...q},(o=I.value)==null||o.resetFields()},C=()=>{v()},J=()=>{var o;(o=F.value)==null||o.resetFields(),C()},D=o=>{d.visible=!0,d.title="添加流程分类",G(()=>{T(),$(),o!=null&&o.id?s.value.parentId=o.id:s.value.parentId=0})},Z=()=>{h.value=!h.value,x(N.value,h.value)},x=(o,a)=>{o.forEach(c=>{var i;(i=U.value)==null||i.toggleRowExpansion(c,a),c.children&&c.children.length>0&&x(c.children,a)})},ee=o=>{p.value=!0,d.visible=!0,d.title="修改流程分类",G(async()=>{T(),await $(),o!=null&&(s.value.parentId=o.id);const a=await qe(o.id);p.value=!1,Object.assign(s.value,a.data)})},ae=()=>{I.value.validate(async o=>{o&&(y.value=!0,s.value.id?await $e(s.value).finally(()=>y.value=!1):await De(s.value).finally(()=>y.value=!1),r==null||r.$modal.msgSuccess("操作成功"),d.visible=!1,await v())})},le=async o=>{await(r==null?void 0:r.$modal.confirm('是否确认删除流程分类编号为"'+o.id+'"的数据项？')),p.value=!0,await xe(o.id).finally(()=>p.value=!1),await v(),r==null||r.$modal.msgSuccess("删除成功")};return me(()=>{v()}),(o,a)=>{var L,K;const c=ye,i=be,u=he,A=Ce,P=we,te=Ue,oe=ke,w=Ve,R=Ne,ne=Ee,re=Ie,se=Te,ie=Re,de=Se,k=pe("hasPermi"),B=Fe;return V(),fe("div",Ae,[e(_e,{"enter-active-class":(L=t(r))==null?void 0:L.animate.searchAnimate.enter,"leave-active-class":(K=t(r))==null?void 0:K.animate.searchAnimate.leave},{default:l(()=>[f(j("div",Pe,[e(A,{ref_key:"queryFormRef",ref:F,model:t(g),inline:!0},{default:l(()=>[e(i,{label:"分类名称",prop:"categoryName"},{default:l(()=>[e(c,{modelValue:t(g).categoryName,"onUpdate:modelValue":a[0]||(a[0]=n=>t(g).categoryName=n),placeholder:"请输入分类名称",clearable:"",onKeyup:z(C,["enter"])},null,8,["modelValue"])]),_:1}),e(i,{label:"分类编码",prop:"categoryCode"},{default:l(()=>[e(c,{modelValue:t(g).categoryCode,"onUpdate:modelValue":a[1]||(a[1]=n=>t(g).categoryCode=n),placeholder:"请输入分类编码",clearable:"",onKeyup:z(C,["enter"])},null,8,["modelValue"])]),_:1}),e(i,null,{default:l(()=>[e(u,{type:"primary",icon:"Search",onClick:C},{default:l(()=>[_("搜索")]),_:1}),e(u,{icon:"Refresh",onClick:J},{default:l(()=>[_("重置")]),_:1})]),_:1})]),_:1},8,["model"])],512),[[ge,t(b)]])]),_:1},8,["enter-active-class","leave-active-class"]),e(re,{shadow:"never"},{header:l(()=>[e(oe,{gutter:10,class:"mb8"},{default:l(()=>[e(P,{span:1.5},{default:l(()=>[f((V(),S(u,{type:"primary",plain:"",icon:"Plus",onClick:a[2]||(a[2]=n=>D())},{default:l(()=>[_("新增")]),_:1})),[[k,["workflow:category:add"]]])]),_:1}),e(P,{span:1.5},{default:l(()=>[e(u,{type:"info",plain:"",icon:"Sort",onClick:Z},{default:l(()=>[_("展开/折叠")]),_:1})]),_:1}),e(te,{showSearch:t(b),"onUpdate:showSearch":a[3]||(a[3]=n=>ve(b)?b.value=n:null),onQueryTable:v},null,8,["showSearch"])]),_:1})]),default:l(()=>[f((V(),S(ne,{ref_key:"categoryTableRef",ref:U,data:t(N),"row-key":"id","default-expand-all":t(h),"tree-props":{children:"children",hasChildren:"hasChildren"}},{default:l(()=>[e(w,{label:"分类名称",prop:"categoryName"}),e(w,{label:"分类编码",align:"center",prop:"categoryCode"}),e(w,{label:"排序",align:"center",prop:"sortNum"}),e(w,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:l(n=>[e(R,{content:"修改",placement:"top"},{default:l(()=>[f(e(u,{link:"",type:"primary",icon:"Edit",onClick:Q=>ee(n.row)},null,8,["onClick"]),[[k,["workflow:category:edit"]]])]),_:2},1024),e(R,{content:"新增",placement:"top"},{default:l(()=>[f(e(u,{link:"",type:"primary",icon:"Plus",onClick:Q=>D(n.row)},null,8,["onClick"]),[[k,["workflow:category:add"]]])]),_:2},1024),e(R,{content:"删除",placement:"top"},{default:l(()=>[f(e(u,{link:"",type:"primary",icon:"Delete",onClick:Q=>le(n.row)},null,8,["onClick"]),[[k,["workflow:category:remove"]]])]),_:2},1024)]),_:1})]),_:1},8,["data","default-expand-all"])),[[B,t(p)]])]),_:1}),e(de,{modelValue:t(d).visible,"onUpdate:modelValue":a[8]||(a[8]=n=>t(d).visible=n),title:t(d).title,width:"500px","append-to-body":""},{footer:l(()=>[j("div",Be,[e(u,{loading:t(y),type:"primary",onClick:ae},{default:l(()=>[_("确 定")]),_:1},8,["loading"]),e(u,{onClick:Y},{default:l(()=>[_("取 消")]),_:1})])]),default:l(()=>[f((V(),S(A,{ref_key:"categoryFormRef",ref:I,model:t(s),rules:t(X),"label-width":"80px"},{default:l(()=>[e(i,{label:"父级分类",prop:"parentId"},{default:l(()=>[e(se,{modelValue:t(s).parentId,"onUpdate:modelValue":a[4]||(a[4]=n=>t(s).parentId=n),data:t(E),props:{value:"id",label:"categoryName",children:"children"},"value-key":"id",placeholder:"请选择父级id","check-strictly":""},null,8,["modelValue","data"])]),_:1}),e(i,{label:"分类名称",prop:"categoryName"},{default:l(()=>[e(c,{modelValue:t(s).categoryName,"onUpdate:modelValue":a[5]||(a[5]=n=>t(s).categoryName=n),placeholder:"请输入分类名称"},null,8,["modelValue"])]),_:1}),e(i,{label:"分类编码",prop:"categoryCode"},{default:l(()=>[e(c,{modelValue:t(s).categoryCode,"onUpdate:modelValue":a[6]||(a[6]=n=>t(s).categoryCode=n),placeholder:"请输入分类编码"},null,8,["modelValue"])]),_:1}),e(i,{label:"排序",prop:"sortNum"},{default:l(()=>[e(ie,{modelValue:t(s).sortNum,"onUpdate:modelValue":a[7]||(a[7]=n=>t(s).sortNum=n),placeholder:"请输入排序","controls-position":"right",min:0},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[B,t(p)]])]),_:1},8,["modelValue","title"])])}}});export{la as default};
