import{d as D,r as T,Y as N,b as A,Z as R,i as k,$ as V,o as w,c as v,x as s,k as h,m,y as u,T as C,w as z,M as O,N as P,a0 as j,W as G,X as M,a1 as X,a2 as J,I as Z,J as q,n as W,L as K}from"./index-BoCONcAc.js";/* empty css                       *//* empty css                        *//* empty css               *//* empty css               *//* empty css                */import{i as b}from"./index-CFduwF1Z.js";import{s as U,g as Y,a as $,b as H,c as Q}from"./index-DABdJVQF.js";const tt="/assets/zgd-DL7_cap9.png",et="/assets/bygd-BSqyyZ4J.png",ot="/assets/ywc-BVun160K.png",st="/assets/wwc-DPkkSMXA.png",c=_=>(Z("data-v-90c25686"),_=_(),q(),_),at={class:"home-container layout-pd"},it={style:{padding:"10px 12px"}},nt={class:"homeCard"},rt={class:"homeCard_l"},lt={class:"homeCard_l_t"},ct=c(()=>s("span",null,null,-1)),dt=c(()=>s("div",{class:"homeCard_l_b"},"总工单数量",-1)),ht=c(()=>s("div",{class:"homeCard_r"},[s("img",{src:tt,alt:""})],-1)),mt={class:"homeCard"},ut={class:"homeCard_l"},pt={class:"homeCard_l_t"},_t=c(()=>s("span",null,null,-1)),ft=c(()=>s("div",{class:"homeCard_l_b"},"本月工单数量",-1)),Ct=c(()=>s("div",{class:"homeCard_r"},[s("img",{src:et,alt:""})],-1)),gt={class:"homeCard"},wt={class:"homeCard_l"},vt={class:"homeCard_l_t"},bt=c(()=>s("span",null,null,-1)),yt=c(()=>s("div",{class:"homeCard_l_b"},"已完成工单数",-1)),xt=c(()=>s("div",{class:"homeCard_r"},[s("img",{src:ot,alt:""})],-1)),kt={class:"homeCard"},Wt={class:"homeCard_l"},Dt={class:"homeCard_l_t"},Lt=c(()=>s("span",null,null,-1)),Ft=c(()=>s("div",{class:"homeCard_l_b"},"未完成工单数",-1)),Bt=c(()=>s("div",{class:"homeCard_r"},[s("img",{src:st,alt:""})],-1)),St=c(()=>s("div",{class:"echarts"},[s("div",{id:"LineChart",style:{width:"100%",height:"380px"}})],-1)),Et=c(()=>s("div",{class:"echarts"},[s("div",{id:"BarChart",style:{width:"100%",height:"380px"}})],-1)),It=c(()=>s("div",{id:"noDataDiv",style:{display:"none"}},"暂无数据",-1)),Tt={class:"echarts"},Nt={id:"deptDataDiv",class:"chart-group-container"},At=["id"],Rt=D({name:"example/home"}),Vt=D({...Rt,setup(_){T();const g=["总","基础设施组","网络安全组","政务云组","系统应用组","运营组"],t=N({week:"本周",CalendarData:new Date,zs:"",monthCount:0,wwc:"1",wc:"2",proName:[],title:"各项目工单总数",times:[],timesCount:[],finish:[],noFinish:[],deptWeekCount:{},global:{homeChartOne:null,homeChartTwo:null,homeCharThree:null,dispose:[null,"",void 0]},myCharts:[],charts:{theme:"",bgColor:"",color:"#303133"}}),L=async i=>{try{const r=await Q(i);if(r.code=="200"){const d=r.rows;for(let e of g)t.deptWeekCount[e]={},t.deptWeekCount[e].times=[],t.deptWeekCount[e].timesCount=[],t.deptWeekCount[e].finish=[],t.deptWeekCount[e].noFinish=[];const o={},a={};var n;for(let e of d)n=e.deptName+":"+e.name,o[e.name]||(o[e.name]={},o[e.name].timesCount=0,o[e.name].finish=0,o[e.name].noFinish=0),a[n]||(a[n]={},a[n].finish=0,a[n].noFinish=0,a[n].timesCount=0),e.finish==1?(a[n].finish+=e.ct,o[e.name].finish+=e.ct):(a[n].noFinish+=e.ct,o[e.name].noFinish+=e.ct),o[e.name].timesCount+=e.ct,a[n].timesCount+=e.ct;let p="总";for(let e in o)t.deptWeekCount[p].times.push(e),t.deptWeekCount[p].timesCount.push(o[e].timesCount),t.deptWeekCount[p].finish.push(o[e].finish),t.deptWeekCount[p].noFinish.push(o[e].noFinish);for(let e in a){var l=e.split(":");let f=l[0],I=l[1];t.deptWeekCount[f].times.push(I),t.deptWeekCount[f].timesCount.push(a[e].timesCount),t.deptWeekCount[f].finish.push(a[e].finish),t.deptWeekCount[f].noFinish.push(a[e].noFinish)}console.info(t.deptWeekCount.系统应用组)}else console.error("获取工单数量失败，接口返回错误信息：",r.message)}catch(r){console.error("发送请求出现错误：",r)}},F=async()=>{try{const i=await U(),n=await Y(),l=await $(),r=await H();if(i.code=="200"?t.zs=i.rows[0].ct:console.error("获取工单总数失败，接口返回错误信息：",n.message),l.code=="200"){const d=l.rows;for(let o of d)t.proName.push({name:o.proName,value:o.ct})}else console.error("获取工单数量失败，接口返回错误信息：",n.message);if(n.code=="200"){const d=n.rows;for(let o of d)o.state==="5"&&(t.wc=o.ct),o.state==="3"&&(t.wwc=o.ct)}else console.error("获取工单数量失败，接口返回错误信息：",n.message);if(r.code=="200"){const d=r.rows,o={};for(let a of d)o[a.name]||(o[a.name]={},o[a.name].ct=0,o[a.name].finish=0,o[a.name].nofinish=0),a.finish==1?o[a.name].finish+=a.ct:o[a.name].nofinish+=a.ct,o[a.name].ct+=a.ct,t.monthCount+=a.ct;for(let a in o)t.times.push(a),t.timesCount.push(o[a].ct),t.finish.push(o[a].finish),t.noFinish.push(o[a].nofinish)}else console.error("获取工单数量失败，接口返回错误信息：",n.message)}catch(i){console.error("发送请求出现错误：",i)}},B=()=>{const i={title:{text:"各项目工单数量",left:"center"},tooltip:{trigger:"item"},legend:{orient:"vertical",left:"left",formatter:function(l){for(var r=t.proName,d=0;d<r.length;d++)if(r[d].name===l)return l+":（"+r[d].value+"）";return l}},series:[{type:"pie",radius:"50%",data:t.proName,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};b(document.getElementById("LineChart")).setOption(i)},S=()=>{const i={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{top:"bottom"},grid:{left:"3%",right:"4%",bottom:"8%",containLabel:!0},title:{text:"当月每日工单数量",left:"center"},yAxis:{type:"value",splitLine:{show:!0,lineStyle:{color:"#D2E6F9",type:"dashed"}},axisLine:{lineStyle:{color:"#D2E6F9"}},axisTick:{show:!1},axisLabel:{color:"#000"}},xAxis:{type:"category",data:t.times,axisLine:{lineStyle:{color:"#D2E6F9"}},axisTick:{show:!1},axisLabel:{color:"#000"}},series:[{name:"已完成",type:"bar",stack:"Ad",itemStyle:{color:"#009dff"},emphasis:{focus:"series"},barWidth:24,data:t.finish,barGap:"40%",label:{show:!0,position:"inside",formatter:function(l){return l.value}}},{name:"未完成",type:"bar",stack:"Ad",itemStyle:{color:"#cd2b2b"},emphasis:{focus:"series"},barWidth:24,data:t.noFinish,barGap:"40%",label:{show:!0,position:"inside",formatter:function(l){return l.value}}},{type:"bar",stack:"Ad",silent:!0,data:t.timesCount,itemStyle:{color:"transparent"},label:{show:!0,position:"bottom",distance:-13,color:"#333",fontWeight:"bold",formatter:"{c}"}}]};b(document.getElementById("BarChart")).setOption(i)},E=i=>{const n={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{top:"bottom"},grid:{left:"3%",right:"4%",bottom:"8%",containLabel:!0},title:{text:i+"工单数量",left:"center"},yAxis:{type:"value",axisTick:{show:!1},axisLabel:{color:"#000"}},xAxis:{type:"category",data:t.deptWeekCount[i].times,axisLine:{lineStyle:{color:"#D2E6F9"}},axisTick:{show:!1},axisLabel:{color:"#000"}},series:[{name:"已完成",type:"bar",stack:"all",itemStyle:{color:"#009dff"},emphasis:{focus:"series"},data:t.deptWeekCount[i].finish,label:{show:!0,position:"inside",formatter:function(r){return r.value}}},{name:"未完成",type:"bar",stack:"all",emphasis:{focus:"series"},barWidth:23,itemStyle:{color:"#cd2b2b"},data:t.deptWeekCount[i].noFinish,label:{show:!0,position:"inside",formatter:function(r){return r.value}}},{type:"bar",stack:"all",silent:!0,data:t.deptWeekCount[i].timesCount,itemStyle:{color:"transparent"},label:{show:!0,position:"bottom",distance:-13,color:"#333",fontWeight:"bold",formatter:"{c}"}}]};b(document.getElementById(i+"Chart")).setOption(n)},y=()=>{W(()=>{for(let i=0;i<t.myCharts.length;i++)setTimeout(()=>{t.myCharts[i].resize()},i*1e3)})},x=async i=>{if(document.getElementById("deptDataDiv")!=null){var l=i==="本周"?0:1;i==="下周"&&(l=2),await L(l);for(let r of g)E(r)}};return A(async()=>{await F(),S(),B(),x("本周")}),R(()=>{y()}),k(()=>!0,()=>{y()}),k(()=>!1,i=>{W(()=>{t.charts.theme=i?"dark":"",t.charts.bgColor=i?"transparent":"",t.charts.color=i?"#dadada":"#303133"})},{deep:!0,immediate:!0}),(i,n)=>{const l=j,r=G,d=M,o=X,a=J,p=V("hasRoles");return w(),v("div",at,[s("div",it,[h(d,{gutter:20,justify:"space-between"},{default:m(()=>[h(r,{xs:24,sm:12,md:12,lg:6,xl:6,style:{"margin-bottom":"20px"}},{default:m(()=>[h(l,null,{default:m(()=>[s("div",nt,[s("div",rt,[s("div",lt,[u(C(t.zs),1),ct]),dt]),ht])]),_:1})]),_:1}),h(r,{xs:24,sm:12,md:12,lg:6,xl:6},{default:m(()=>[h(l,null,{default:m(()=>[s("div",mt,[s("div",ut,[s("div",pt,[u(C(t.monthCount)+"个",1),_t]),ft]),Ct])]),_:1})]),_:1}),h(r,{xs:24,sm:12,md:12,lg:6,xl:6},{default:m(()=>[h(l,null,{default:m(()=>[s("div",gt,[s("div",wt,[s("div",vt,[u(C(t.wc)+"个",1),bt]),yt]),xt])]),_:1})]),_:1}),h(r,{xs:24,sm:12,md:12,lg:6,xl:6},{default:m(()=>[h(l,null,{default:m(()=>[s("div",kt,[s("div",Wt,[s("div",Dt,[u(C(t.wwc)+"个",1),Lt]),Ft]),Bt])]),_:1})]),_:1})]),_:1})]),St,Et,z((w(),v("div",null,[h(a,{modelValue:t.week,"onUpdate:modelValue":n[0]||(n[0]=e=>t.week=e),style:{"margin-bottom":"5px"},onChange:x},{default:m(()=>[h(o,{label:"本周"},{default:m(()=>[u("本周")]),_:1}),h(o,{label:"上周"},{default:m(()=>[u("上周")]),_:1}),h(o,{label:"下周"},{default:m(()=>[u("下周")]),_:1})]),_:1},8,["modelValue"]),It,s("div",Tt,[s("div",Nt,[(w(),v(O,null,P(g,e=>s("div",{id:e+"Chart",key:e,style:{width:"30%",height:"380px"}},null,8,At)),64))])])])),[[p,["wf_leader","superadmin"]]])])}}}),Zt=K(Vt,[["__scopeId","data-v-90c25686"]]);export{Zt as default};
