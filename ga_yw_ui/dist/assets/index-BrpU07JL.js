import{an as h,d as ie,V as Se,aa as q,r as v,Y as ae,b as Ee,j as Ue,$ as De,o as u,c as T,k as e,m as l,w as b,x as $,e as a,t as ne,M as F,N as L,p as g,y as p,a7 as oe,ab as Ke,a3 as qe,T as $e,D as Fe,C as Le,O as Re,P as Ie,G as Ne,H as Pe,W as Be,X as ze,a8 as Ae,ap as Oe,ac as Qe,a9 as je,a0 as Ge,ax as Me,ao as He,a2 as We,am as Xe,v as Ye}from"./index-BoCONcAc.js";/* empty css                       *//* empty css                 *//* empty css                */import{_ as Je}from"./index-B1KNwlHH.js";/* empty css                 *//* empty css                    */import{_ as Ze}from"./index-BXJ8XT-L.js";/* empty css                        *//* empty css               */import{_ as xe}from"./index-B4NenLWv.js";/* empty css               *//* empty css                */import"./el-form-item-l0sNRNKZ.js";/* empty css                */const et=r=>h({url:"/system/client/list",method:"get",params:r}),tt=r=>h({url:"/system/client/"+r,method:"get"}),lt=r=>h({url:"/system/client",method:"post",data:r}),at=r=>h({url:"/system/client",method:"put",data:r}),nt=r=>h({url:"/system/client/"+r,method:"delete"});function ot(r,o){return h({url:"/system/client/changeStatus",method:"put",data:{clientId:r,status:o}})}const it={class:"p-2"},st={class:"search"},ut={class:"dialog-footer"},dt=ie({name:"Client"}),wt=ie({...dt,setup(r){const{proxy:o}=Se(),{sys_normal_disable:R}=q(o==null?void 0:o.useDict("sys_normal_disable")),{sys_grant_type:O}=q(o==null?void 0:o.useDict("sys_grant_type")),{sys_device_type:Q}=q(o==null?void 0:o.useDict("sys_device_type")),j=v([]),C=v(!1),w=v(!0),S=v(!0),I=v([]),G=v(!0),M=v(!0),N=v(0),H=v(),P=v(),f=ae({visible:!1,title:""}),W={id:void 0,clientId:void 0,clientKey:void 0,clientSecret:void 0,grantTypeList:void 0,deviceType:void 0,activeTimeout:void 0,timeout:void 0,status:void 0},se=ae({form:{...W},queryParams:{pageNum:1,pageSize:10,clientId:void 0,clientKey:void 0,clientSecret:void 0,grantType:void 0,deviceType:void 0,activeTimeout:void 0,timeout:void 0,status:void 0},rules:{id:[{required:!0,message:"id不能为空",trigger:"blur"}],clientId:[{required:!0,message:"客户端id不能为空",trigger:"blur"}],clientKey:[{required:!0,message:"客户端key不能为空",trigger:"blur"}],clientSecret:[{required:!0,message:"客户端秘钥不能为空",trigger:"blur"}],grantTypeList:[{required:!0,message:"授权类型不能为空",trigger:"change"}],deviceType:[{required:!0,message:"设备类型不能为空",trigger:"change"}]}}),{queryParams:d,form:s,rules:ue}=q(se),V=async()=>{w.value=!0;const i=await et(d.value);j.value=i.rows,N.value=i.total,w.value=!1},de=()=>{B(),f.visible=!1},B=()=>{var i;s.value={...W},(i=P.value)==null||i.resetFields()},E=()=>{d.value.pageNum=1,V()},re=()=>{var i;(i=H.value)==null||i.resetFields(),E()},ce=i=>{I.value=i.map(n=>n.id),G.value=i.length!=1,M.value=!i.length},me=()=>{B(),f.visible=!0,f.title="添加客户端管理"},X=async i=>{B();const n=(i==null?void 0:i.id)||I.value[0],y=await tt(n);Object.assign(s.value,y.data),f.visible=!0,f.title="修改客户端管理"},pe=()=>{var i;(i=P.value)==null||i.validate(async n=>{n&&(C.value=!0,s.value.id?await at(s.value).finally(()=>C.value=!1):await lt(s.value).finally(()=>C.value=!1),o==null||o.$modal.msgSuccess("修改成功"),f.visible=!1,await V())})},Y=async i=>{const n=(i==null?void 0:i.id)||I.value;await(o==null?void 0:o.$modal.confirm('是否确认删除客户端管理编号为"'+n+'"的数据项？').finally(()=>w.value=!1)),await nt(n),o==null||o.$modal.msgSuccess("删除成功"),await V()},_e=()=>{o==null||o.download("system/client/export",{...d.value},`client_${new Date().getTime()}.xlsx`)},ve=async i=>{let n=i.status==="0"?"启用":"停用";try{await(o==null?void 0:o.$modal.confirm('确认要"'+n+'"吗?')),await ot(i.clientId,i.status),o==null||o.$modal.msgSuccess(n+"成功")}catch{i.status=i.status==="0"?"1":"0"}};return Ee(()=>{V()}),(i,n)=>{var te,le;const y=Fe,c=Le,z=Re,A=Ie,_=Ne,J=Pe,U=Be,ge=xe,fe=ze,m=Ae,Z=Ze,ye=Oe,D=Qe,be=je,Ve=Je,ke=Ge,x=Ue("question-filled"),ee=Me,he=He,Te=We,Ce=Xe,k=De("hasPermi"),we=Ye;return u(),T("div",it,[e(Ke,{"enter-active-class":(te=a(o))==null?void 0:te.animate.searchAnimate.enter,"leave-active-class":(le=a(o))==null?void 0:le.animate.searchAnimate.leave},{default:l(()=>[b($("div",st,[e(J,{ref_key:"queryFormRef",ref:H,model:a(d),inline:!0},{default:l(()=>[e(c,{label:"客户端key",prop:"clientKey"},{default:l(()=>[e(y,{modelValue:a(d).clientKey,"onUpdate:modelValue":n[0]||(n[0]=t=>a(d).clientKey=t),placeholder:"请输入客户端key",clearable:"",onKeyup:ne(E,["enter"])},null,8,["modelValue"])]),_:1}),e(c,{label:"客户端秘钥",prop:"clientSecret"},{default:l(()=>[e(y,{modelValue:a(d).clientSecret,"onUpdate:modelValue":n[1]||(n[1]=t=>a(d).clientSecret=t),placeholder:"请输入客户端秘钥",clearable:"",onKeyup:ne(E,["enter"])},null,8,["modelValue"])]),_:1}),e(c,{label:"状态",prop:"status"},{default:l(()=>[e(A,{modelValue:a(d).status,"onUpdate:modelValue":n[2]||(n[2]=t=>a(d).status=t),placeholder:"状态",clearable:""},{default:l(()=>[(u(!0),T(F,null,L(a(R),t=>(u(),g(z,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(c,null,{default:l(()=>[e(_,{type:"primary",icon:"Search",onClick:E},{default:l(()=>[p("搜索")]),_:1}),e(_,{icon:"Refresh",onClick:re},{default:l(()=>[p("重置")]),_:1})]),_:1})]),_:1},8,["model"])],512),[[oe,a(S)]])]),_:1},8,["enter-active-class","leave-active-class"]),e(ke,{shadow:"never"},{header:l(()=>[e(fe,{gutter:10,class:"mb8"},{default:l(()=>[e(U,{span:1.5},{default:l(()=>[b((u(),g(_,{type:"primary",plain:"",icon:"Plus",onClick:me},{default:l(()=>[p("新增")]),_:1})),[[k,["system:client:add"]]])]),_:1}),e(U,{span:1.5},{default:l(()=>[b((u(),g(_,{type:"success",plain:"",icon:"Edit",disabled:a(G),onClick:n[3]||(n[3]=t=>X())},{default:l(()=>[p(" 修改 ")]),_:1},8,["disabled"])),[[k,["system:client:edit"]]])]),_:1}),e(U,{span:1.5},{default:l(()=>[b((u(),g(_,{type:"danger",plain:"",icon:"Delete",disabled:a(M),onClick:n[4]||(n[4]=t=>Y())},{default:l(()=>[p(" 删除 ")]),_:1},8,["disabled"])),[[k,["system:client:remove"]]])]),_:1}),e(U,{span:1.5},{default:l(()=>[b((u(),g(_,{type:"warning",plain:"",icon:"Download",onClick:_e},{default:l(()=>[p("导出")]),_:1})),[[k,["system:client:export"]]])]),_:1}),e(ge,{showSearch:a(S),"onUpdate:showSearch":n[5]||(n[5]=t=>qe(S)?S.value=t:null),onQueryTable:V},null,8,["showSearch"])]),_:1})]),default:l(()=>[b((u(),g(be,{data:a(j),onSelectionChange:ce},{default:l(()=>[e(m,{type:"selection",width:"55",align:"center"}),(u(),g(m,{key:0,label:"id",align:"center",prop:"id"})),e(m,{label:"客户端id",align:"center",prop:"clientId"}),e(m,{label:"客户端key",align:"center",prop:"clientKey"}),e(m,{label:"客户端秘钥",align:"center",prop:"clientSecret"}),e(m,{label:"授权类型",align:"center"},{default:l(t=>[e(Z,{options:a(O),value:t.row.grantTypeList},null,8,["options","value"])]),_:1}),e(m,{label:"设备类型",align:"center"},{default:l(t=>[e(Z,{options:a(Q),value:t.row.deviceType},null,8,["options","value"])]),_:1}),e(m,{label:"Token活跃超时时间",align:"center",prop:"activeTimeout"}),e(m,{label:"Token固定超时时间",align:"center",prop:"timeout"}),e(m,{key:"status",label:"状态",align:"center"},{default:l(t=>[e(ye,{modelValue:t.row.status,"onUpdate:modelValue":K=>t.row.status=K,"active-value":"0","inactive-value":"1",onChange:K=>ve(t.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(m,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:l(t=>[e(D,{content:"修改",placement:"top"},{default:l(()=>[b(e(_,{link:"",type:"primary",icon:"Edit",onClick:K=>X(t.row)},null,8,["onClick"]),[[k,["system:client:edit"]]])]),_:2},1024),e(D,{content:"删除",placement:"top"},{default:l(()=>[b(e(_,{link:"",type:"primary",icon:"Delete",onClick:K=>Y(t.row)},null,8,["onClick"]),[[k,["system:client:remove"]]])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[we,a(w)]]),b(e(Ve,{page:a(d).pageNum,"onUpdate:page":n[6]||(n[6]=t=>a(d).pageNum=t),limit:a(d).pageSize,"onUpdate:limit":n[7]||(n[7]=t=>a(d).pageSize=t),total:a(N),onPagination:V},null,8,["page","limit","total"]),[[oe,a(N)>0]])]),_:1}),e(Ce,{modelValue:a(f).visible,"onUpdate:modelValue":n[15]||(n[15]=t=>a(f).visible=t),title:a(f).title,width:"500px","append-to-body":""},{footer:l(()=>[$("div",ut,[e(_,{loading:a(C),type:"primary",onClick:pe},{default:l(()=>[p("确 定")]),_:1},8,["loading"]),e(_,{onClick:de},{default:l(()=>[p("取 消")]),_:1})])]),default:l(()=>[e(J,{ref_key:"clientFormRef",ref:P,model:a(s),rules:a(ue),"label-width":"100px"},{default:l(()=>[e(c,{label:"客户端key",prop:"clientKey"},{default:l(()=>[e(y,{modelValue:a(s).clientKey,"onUpdate:modelValue":n[8]||(n[8]=t=>a(s).clientKey=t),disabled:a(s).id!=null,placeholder:"请输入客户端key"},null,8,["modelValue","disabled"])]),_:1}),e(c,{label:"客户端秘钥",prop:"clientSecret"},{default:l(()=>[e(y,{modelValue:a(s).clientSecret,"onUpdate:modelValue":n[9]||(n[9]=t=>a(s).clientSecret=t),disabled:a(s).id!=null,placeholder:"请输入客户端秘钥"},null,8,["modelValue","disabled"])]),_:1}),e(c,{label:"授权类型",prop:"grantTypeList"},{default:l(()=>[e(A,{modelValue:a(s).grantTypeList,"onUpdate:modelValue":n[10]||(n[10]=t=>a(s).grantTypeList=t),multiple:"",placeholder:"请输入授权类型"},{default:l(()=>[(u(!0),T(F,null,L(a(O),t=>(u(),g(z,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(c,{label:"设备类型",prop:"deviceType"},{default:l(()=>[e(A,{modelValue:a(s).deviceType,"onUpdate:modelValue":n[11]||(n[11]=t=>a(s).deviceType=t),placeholder:"请输入设备类型"},{default:l(()=>[(u(!0),T(F,null,L(a(Q),t=>(u(),g(z,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(c,{prop:"activeTimeout","label-width":"auto"},{label:l(()=>[$("span",null,[e(D,{content:"指定时间无操作则过期（单位：秒），默认30分钟（1800秒）",placement:"top"},{default:l(()=>[e(ee,null,{default:l(()=>[e(x)]),_:1})]),_:1}),p(" Token活跃超时时间 ")])]),default:l(()=>[e(y,{modelValue:a(s).activeTimeout,"onUpdate:modelValue":n[12]||(n[12]=t=>a(s).activeTimeout=t),placeholder:"请输入Token活跃超时时间"},null,8,["modelValue"])]),_:1}),e(c,{prop:"timeout","label-width":"auto"},{label:l(()=>[$("span",null,[e(D,{content:"指定时间必定过期（单位：秒），默认七天（604800秒）",placement:"top"},{default:l(()=>[e(ee,null,{default:l(()=>[e(x)]),_:1})]),_:1}),p(" Token固定超时时间 ")])]),default:l(()=>[e(y,{modelValue:a(s).timeout,"onUpdate:modelValue":n[13]||(n[13]=t=>a(s).timeout=t),placeholder:"请输入Token固定超时时间"},null,8,["modelValue"])]),_:1}),e(c,{label:"状态"},{default:l(()=>[e(Te,{modelValue:a(s).status,"onUpdate:modelValue":n[14]||(n[14]=t=>a(s).status=t)},{default:l(()=>[(u(!0),T(F,null,L(a(R),t=>(u(),g(he,{key:t.value,value:t.value},{default:l(()=>[p($e(t.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{wt as default};
