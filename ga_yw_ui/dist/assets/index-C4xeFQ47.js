var Ev=Object.defineProperty;var xv=(e,t,n)=>t in e?Ev(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Qe=(e,t,n)=>(xv(e,typeof t!="symbol"?t+"":t,n),n);import{an as Un,be as wv,r as H,S as vi,d as et,a as Sv,V as yn,aa as Fd,i as Hd,b as yi,j as we,o as le,c as Pe,k as g,m as x,y as G,ab as ll,e as T,w as It,x as W,t as Yo,a7 as un,M as Gt,N as hn,p as He,T as mn,q as Ye,a3 as ze,n as Zt,D as Wt,C as Ot,G as Gn,H as Lt,a0 as zd,ak as Cv,am as _i,ac as qi,aX as vt,Y as wr,O as sa,P as la,ax as _n,a4 as cl,a5 as ul,I as Ud,J as Gd,L as ca,a1 as Tv,al as Wd,a2 as Pv,bf as pl,bg as bi,ap as Rv,bh as Dv,bi as Ei,v as dl,bj as kv,aU as Av,ad as Mv,bk as Iv,aD as Nv,aE as Ov,aF as Lv,aM as $v,aO as Bv,_ as jv,aJ as Vv,aK as Fv,aC as Hv,W as zv,X as Uv,a8 as Gv,a9 as Wv,au as Yv}from"./index-BoCONcAc.js";/* empty css                *//* empty css                    *//* empty css                       */import{_ as Yd}from"./index-B1KNwlHH.js";/* empty css                 *//* empty css                        *//* empty css               */import{_ as qv}from"./index-B4NenLWv.js";/* empty css                */import"./el-form-item-l0sNRNKZ.js";/* empty css               *//* empty css                *//* empty css                */import{B as fl,d as te,I as Kv,i as Te,a as Wn,e as ce,f as en,m as hl,g as L,c as Et,h as Fn,b as gi,j as Xv,V as Ir,k as M,l as be,n as ie,o as Ce,p as ml,s as tn,q as _e,r as Ct,u as Ki,v as _t,w as ot,x as nt,y as Sr,z as Rt,A as vl,C as Ae,D as Tt,O as qd,E as Hi,F as bn,G as Y,H as ua,J as Oe,K as pt,L as Yn,M as ae,N as de,P as pa,Q as ve,R as y,S as qo,T as gl,U as da,W as dn,X as yl,Y as nn,Z as xe,_ as ps,$ as Kd,a0 as En,a1 as Xd,a2 as Zv,a3 as Ne,a4 as Is,a5 as pn,a6 as ht,a7 as Qv,a8 as rt,a9 as _l,aa as Ns,ab as Jv,ac as Zd,ad as Os,ae as vn,af as bl,ag as Ls,ah as eg,ai as Qd,aj as Fi,ak as fa,al as Q,am as Jd,an as mt,ao as Je,ap as Xe,aq as Me,ar as ye,as as gn,at as ha,au as Cr,av as zi,aw as Hn,ax as bt,ay as Se,az as Nr,aA as Tr,aB as ef,aC as $i,aD as Lo,aE as li,aF as uu,aG as tg,aH as ng,aI as ig,aJ as rg,aK as og,aL as tf,aM as nf,aN as Bn,aO as rf,aP as ag,aQ as El,aR as sg,aS as xl,aT as lg,aU as cg,aV as ug,aW as pg,aX as $s,aY as of,aZ as dg,a_ as fg,a$ as pu,b0 as af,b1 as hg,b2 as mg,b3 as vg,b4 as ma,b5 as gg,b6 as sf,b7 as lf,b8 as yg,b9 as _g,ba as du}from"./Event-BS7rISKI.js";/* empty css                        *//* empty css                    */import{u as xi,_ as fu}from"./index.vue_vue_type_script_setup_true_lang-Bfb_m_-c.js";import{_ as bg}from"./index-BXJ8XT-L.js";import{n as hu}from"./index-hgsK1_Ho.js";/* empty css                       *//* empty css                        */import{s as Eg}from"./index-C66yRhhZ.js";import{l as xg}from"./index-BMOFFQpT.js";import"./index-JZ_QvNlG.js";const wg=e=>Un({url:"/workflow/model/list",method:"get",params:e}),cf=e=>Un({url:"/workflow/model/getInfo/"+e,method:"get"}),Sg=e=>Un({url:"/workflow/model/save",method:"post",data:e});function Cg(e){return Un({url:"/workflow/model/update",method:"put",data:e})}function Tg(e){return Un({url:"/workflow/model/editModelXml",method:"put",data:e})}function Pg(e){return Un({url:"/workflow/model/"+e,method:"delete"})}const Rg=e=>Un({url:`/workflow/model/modelDeploy/${e}`,method:"post"}),Dg=e=>Un({url:"/workflow/model/copyModel",method:"post",data:e}),kg={"bpmn:Process":"流程","bpmn:StartEvent":"开始事件","bpmn:IntermediateThrowEvent":"中间事件","bpmn:Task":"任务","bpmn:SendTask":"发送任务","bpmn:ReceiveTask":"接收任务","bpmn:UserTask":"用户任务","bpmn:ManualTask":"手工任务","bpmn:BusinessRuleTask":"业务规则任务","bpmn:ServiceTask":"服务任务","bpmn:ScriptTask":"脚本任务","bpmn:EndEvent":"结束事件","bpmn:SequenceFlow":"流程线","bpmn:ExclusiveGateway":"互斥网关","bpmn:ParallelGateway":"并行网关","bpmn:InclusiveGateway":"相容网关","bpmn:ComplexGateway":"复杂网关","bpmn:EventBasedGateway":"事件网关","bpmn:Participant":"池/参与者","bpmn:SubProcess":"子流程","bpmn:DataObjectReference":"数据对象引用","bpmn:DataStoreReference":"数据存储引用","bpmn:Group":"组"},Ag={"Activate hand tool":"启动手动工具","Activate lasso tool":"启动 Lasso 工具","Activate create/remove space tool":"启动创建/删除空间工具","Activate global connect tool":"启动全局连接工具","Ad-hoc":"Ad-hoc","Add lane above":"在上方添加泳道","Add lane below":"在下方添加泳道","Business rule task":"规则任务","Call activity":"引用流程","Compensation end event":"结束补偿事件","Compensation intermediate throw event":"中间补偿抛出事件","Complex gateway":"复杂网关","Conditional intermediate catch event":"中间条件捕获事件","Conditional start event (non-interrupting)":"条件启动事件 (非中断)","Conditional start event":"条件启动事件","Connect using association":"文本关联","Connect using sequence/message flow or association":"消息关联","Change element":"更改元素","Change type":"更改类型","Create data object reference":"创建数据对象引用","Create data store reference":"创建数据存储引用","Create expanded sub-process":"创建可折叠子流程","Create pool/participant":"创建池/参与者",Collection:"集合","Connect using data input association":"数据输入关联","Data store reference":"数据存储引用","Data object reference":"数据对象引用","Divide into two lanes":"分成两个泳道","Divide into three lanes":"分成三个泳道","End event":"结束事件","Error end event":"结束错误事件","Escalation end event":"结束升级事件","Escalation intermediate throw event":"中间升级抛出事件","Event sub-process":"事件子流程","Event-based gateway":"事件网关","Exclusive gateway":"互斥网关","Empty pool/participant (removes content)":"清空池/参与者 (删除内容)","Empty pool/participant":"清空池/参与者","Expanded pool/participant":"展开池/参与者","Inclusive gateway":"相容网关","Intermediate throw event":"中间抛出事件",Loop:"循环","Link intermediate catch event":"中间链接捕获事件","Link intermediate throw event":"中间链接抛出事件","Manual task":"手动任务","Message end event":"结束消息事件","Message intermediate catch event":"中间消息捕获事件","Message intermediate throw event":"中间消息抛出事件","Message start event":"消息启动事件","Parallel gateway":"并行网关","Parallel multi-instance":"并行多实例","Participant multiplicity":"参与者多重性","Receive task":"接受任务",Remove:"移除","Script task":"脚本任务","Send task":"发送任务","Sequential multi-instance":"串行多实例","Service task":"服务任务","Signal end event":"结束信号事件","Signal intermediate catch event":"中间信号捕获事件","Signal intermediate throw event":"中间信号抛出事件","Signal start event (non-interrupting)":"信号启动事件 (非中断)","Signal start event":"信号启动事件","Start event":"开始事件","Sub-process (collapsed)":"可折叠子流程","Sub-process (expanded)":"可展开子流程","Sub rocess":"子流程",Task:"任务",Transaction:"事务","Terminate end event":"终止边界事件","Timer intermediate catch event":"中间定时捕获事件","Timer start event (non-interrupting)":"定时启动事件 (非中断)","Timer start event":"定时启动事件","User task":"用户任务","Create start event":"创建开始事件","Create gateway":"创建网关","Create intermediate/boundary event":"创建中间/边界事件","Create end event":"创建结束事件","Create group":"创建组","Create startEvent":"开始节点","Create endEvent":"结束节点","Create exclusiveGateway":"互斥网关","Create parallelGateway":"并行网关","Create task":"任务节点","Create userTask":"用户任务节点","Condition type":"条件类型","Append end event":"追加结束事件节点","Append gateway":"追加网关节点","Append task":"追加任务","Append user task":"追加用户任务节点","Append text annotation":"追加文本注释","Append intermediate/boundary event":"追加中间或边界事件","Append receive task":"追加接收任务节点","Append message intermediate catch event":"追加中间消息捕获事件","Append timer intermediate catch event":"追加中间定时捕获事件","Append conditional intermediate catch event":"追加中间条件捕获事件","Append signal intermediate catch event":"追加中间信号捕获事件","flow elements must be children of pools/participants":"流程元素必须是池/参与者的子元素"},wi=e=>{const{element:t}=e;return{parseData:()=>{const i={...t.businessObject,...t.businessObject.$attrs};for(const r in i)if(r.indexOf("flowable:")===0){const o=r.replace("flowable:","");i[o]=i[r],delete i[r]}return{...i}}}},Mg={"bpmn:EndEvent":{},"bpmn:StartEvent":{initiator:!0,formKey:!0},"bpmn:UserTask":{allocationType:!0,specifyDesc:!0,multipleUserAuditType:!0,async:!0,priority:!0,skipExpression:!0,dueDate:!0,taskListener:!0,executionListener:!0},"bpmn:ServiceTask":{async:!0,skipExpression:!0,isForCompensation:!0,triggerable:!0,class:!0},"bpmn:ScriptTask":{async:!0,isForCompensation:!0,autoStoreVariables:!0},"bpmn:ManualTask":{async:!0,isForCompensation:!0},"bpmn:ReceiveTask":{async:!0,isForCompensation:!0},"bpmn:SendTask":{async:!0,isForCompensation:!0},"bpmn:BusinessRuleTask":{async:!0,isForCompensation:!0,ruleVariablesInput:!0,rules:!0,resultVariable:!0,exclude:!0}},Mn={modeler:void 0,moddle:void 0,modeling:void 0,canvas:void 0,elementRegistry:void 0,bpmnFactory:void 0,procDefId:void 0,procDefName:void 0},Ig=wv("modeler",()=>{let e=Mn.modeler,t=Mn.moddle,n=Mn.modeling,i=Mn.canvas,r=Mn.elementRegistry,o=Mn.bpmnFactory;const a=H(Mn.procDefId),l=H(Mn.procDefName);return{getModeler:()=>e,getModdle:()=>t,getModeling:()=>n,getCanvas:()=>i,getElRegistry:()=>r,getBpmnFactory:()=>o,getProcDefId:()=>a.value,getProcDefName:()=>l.value,setModeler:b=>{b?(e=b,n=b.get("modeling"),t=b.get("moddle"),i=b.get("canvas"),o=b.get("bpmnFactory"),r=b.get("elementRegistry")):n=t=i=r=o=void 0},setProcDef:b=>{a.value=b.get("canvas").getRootElement().businessObject.get("id"),l.value=b.get("canvas").getRootElement().businessObject.get("name")}}}),zn=Ig;var Bi=(e=>(e.USER="user",e.CANDIDATE="candidate",e.YOURSELF="yourself",e.SPECIFY="specify",e))(Bi||{}),uf=(e=>(e.SPECIFY_MULTIPLE="specifyMultiple",e.SPECIFY_SINGLE="specifySingle",e))(uf||{}),yt=(e=>(e.SERIAL="serial",e.PARALLEL="parallel",e.NONE="none",e))(yt||{});const xn=e=>{const{element:t}=e,{getModeling:n,getModdle:i}=zn(),r=n(),o=i(),a=vi(()=>{const b=t.businessObject;return b.eventDefinitions?b.eventDefinitions[0].$type:b.$type}),l=vi(()=>Mg[a.value]||{}),s=(b,w,C)=>{const R=o.create(b,w);return C&&(R.$parent=C),R},c=(b=!0)=>{let w=t.businessObject.get("extensionElements");return!w&&b&&(w=s("bpmn:ExtensionElements",{values:[]},t.businessObject),r.updateModdleProperties(t,t.businessObject,{extensionElements:w})),w},p=b=>{b||(b=c());let w=b.values.find(C=>C.$type==="flowable:properties");return w||(w=s("flowable:properties",{values:[]},b),r.updateModdleProperties(t,b,{values:[...b.get("values"),w]})),w},u=b=>{r.updateProperties(t,b)},d=(b,w)=>{r.updateModdleProperties(t,b,w)},f=(b,w)=>{const C=p();let R=C.values.find(D=>D.name===b);return R?(R.name=b,R.value=w):(R=s("flowable:property",{name:b,value:w},C),r.updateModdleProperties(t,C,{values:[...C.get("values"),R]})),R},h=b=>{b&&u({id:b})},m=b=>{b&&u({name:b})},v=b=>{u({formKey:b})},S={MultiInstanceType:[{id:"373d4b81-a0d1-4eb8-8685-0d2fb1b468e2",label:"无",value:yt.NONE},{id:"b5acea7c-b7e5-46b0-8778-390db091bdab",label:"串行",value:yt.SERIAL},{id:"b4f0c683-1ccc-43c4-8380-e1b998986caf",label:"并行",value:yt.PARALLEL}]};return{elementType:a,constant:S,showConfig:l,updateProperties:u,updateProperty:f,updateModdleProperties:d,createModdleElement:s,idChange:h,nameChange:m,formKeyChange:v,getExtensionElements:c,getPropertiesElements:p}},Ng={class:"mb-[10px]"},Og=et({__name:"index",props:{modelValue:{default:void 0},multiple:{type:Boolean,default:!0},data:{default:void 0}},emits:["update:modelValue","confirmCallBack"],setup(e,{expose:t,emit:n}){const i=e,r=n;Sv();const{proxy:o}=yn(),{sys_normal_disable:a}=Fd(o==null?void 0:o.useDict("sys_normal_disable")),l=H(),s=H(!0),c=H(!0),p=H(0),u=H(["",""]),d=H([]),f=xi({title:"角色选择"}),h=H(),m=H(),v=H({pageNum:1,pageSize:10,roleName:"",roleKey:"",status:""}),S=vi(()=>w(i.data)),b=()=>{r("update:modelValue",d.value),r("confirmCallBack",d.value),f.closeDialog()},w=U=>U instanceof Array?[...U]:typeof U=="string"?U.split(","):typeof U=="number"?[U]:(console.warn("<RoleSelect> The data type of data should be array or string or number, but I received other"),[]),C=()=>{s.value=!0,hu.listRole(o==null?void 0:o.addDateRange(v.value,u.value)).then(U=>{l.value=U.rows,p.value=U.total,s.value=!1})},R=async()=>{await C();const U=l.value.filter(O=>d.value.some(B=>B.roleId===O.roleId));await m.value.setCheckboxRow(U,!0)},D=()=>{v.value.pageNum=1,C()},F=()=>{var U;u.value=["",""],(U=h.value)==null||U.resetFields(),D()},A=U=>{!i.multiple&&U.checked&&(m.value.setCheckboxRow(d.value,!1),d.value=[]);const O=U.row;U.checked?d.value.push(O):d.value=d.value.filter(B=>B.roleId!==O.roleId)},I=U=>{const O=l.value;U.checked?O.forEach(B=>{d.value.some(q=>q.roleId===B.roleId)||d.value.push(B)}):d.value=d.value.filter(B=>!O.some(q=>q.roleId===B.roleId))},$=U=>{var re;const O=U.roleId,B=d.value.findIndex(ne=>ne.roleId===O),q=d.value[B];(re=m.value)==null||re.setCheckboxRow(q,!1),d.value.splice(B,1)},V=async()=>{if(S.value.length>0){const{data:U}=await hu.optionSelect(S.value);d.value=U;const O=l.value.filter(B=>S.value.includes(String(B.roleId)));await Zt(()=>{m.value.setCheckboxRow(O,!0)})}},X=()=>{f.closeDialog()};return Hd(()=>f.visible.value,U=>{U?V():(m.value.clearCheckboxReserve(),m.value.clearCheckboxRow(),F(),d.value=[])}),yi(()=>{C()}),t({open:f.openDialog,close:f.closeDialog}),(U,O)=>{const B=Wt,q=Ot,re=Gn,ne=Lt,ge=zd,Le=Cv,Z=we("vxe-column"),pe=bg,oe=we("vxe-table"),De=Yd,lt=_i;return le(),Pe("div",null,[g(lt,{modelValue:T(f).visible.value,"onUpdate:modelValue":O[5]||(O[5]=j=>T(f).visible.value=j),title:T(f).title.value,width:"80%","append-to-body":""},{footer:x(()=>[g(re,{onClick:X},{default:x(()=>[G("取消")]),_:1}),g(re,{type:"primary",onClick:b},{default:x(()=>[G("确定")]),_:1})]),default:x(()=>{var j,k;return[g(ll,{"enter-active-class":(j=T(o))==null?void 0:j.animate.searchAnimate.enter,"leave-active-class":(k=T(o))==null?void 0:k.animate.searchAnimate.leave},{default:x(()=>[It(W("div",Ng,[g(ge,{shadow:"hover"},{default:x(()=>[g(ne,{ref_key:"queryFormRef",ref:h,model:T(v),inline:!0},{default:x(()=>[g(q,{label:"角色名称",prop:"roleName"},{default:x(()=>[g(B,{modelValue:T(v).roleName,"onUpdate:modelValue":O[0]||(O[0]=ee=>T(v).roleName=ee),placeholder:"请输入角色名称",clearable:"",onKeyup:Yo(D,["enter"])},null,8,["modelValue"])]),_:1}),g(q,{label:"权限字符",prop:"roleKey"},{default:x(()=>[g(B,{modelValue:T(v).roleKey,"onUpdate:modelValue":O[1]||(O[1]=ee=>T(v).roleKey=ee),placeholder:"请输入权限字符",clearable:"",onKeyup:Yo(D,["enter"])},null,8,["modelValue"])]),_:1}),g(q,null,{default:x(()=>[g(re,{type:"primary",icon:"Search",onClick:D},{default:x(()=>[G("搜索")]),_:1}),g(re,{icon:"Refresh",onClick:F},{default:x(()=>[G("重置")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})],512),[[un,T(c)]])]),_:1},8,["enter-active-class","leave-active-class"]),g(ge,{shadow:"hover"},{header:x(()=>[(le(!0),Pe(Gt,null,hn(T(d),ee=>(le(),He(Le,{key:ee.roleId,closable:"",style:{margin:"2px"},onClose:fe=>$(ee)},{default:x(()=>[G(mn(ee.roleName),1)]),_:2},1032,["onClose"]))),128))]),default:x(()=>[g(oe,{ref_key:"tableRef",ref:m,height:"400px",border:"","show-overflow":"",data:T(l),loading:T(s),"row-config":{keyField:"roleId"},"checkbox-config":{reserve:!0,checkRowKeys:T(S)},"highlight-current-row":"",onCheckboxAll:I,onCheckboxChange:A},{default:x(()=>[g(Z,{type:"checkbox",width:"50",align:"center"}),Ye("",!0),g(Z,{field:"roleName",title:"角色名称"}),g(Z,{field:"roleKey",title:"权限字符"}),g(Z,{field:"roleSort",title:"显示顺序",width:"100"}),g(Z,{title:"状态",align:"center",width:"100"},{default:x(ee=>[g(pe,{options:T(a),value:ee.row.status},null,8,["options","value"])]),_:1}),g(Z,{field:"createTime",title:"创建时间",align:"center"},{default:x(ee=>[W("span",null,mn(U.parseTime(ee.row.createTime)),1)]),_:1})]),_:1},8,["data","loading","checkbox-config"]),T(p)>0?(le(),He(De,{key:0,total:T(p),"onUpdate:total":O[2]||(O[2]=ee=>ze(p)?p.value=ee:null),page:T(v).pageNum,"onUpdate:page":O[3]||(O[3]=ee=>T(v).pageNum=ee),limit:T(v).pageSize,"onUpdate:limit":O[4]||(O[4]=ee=>T(v).pageSize=ee),onPagination:R},null,8,["total","page","limit"])):Ye("",!0)]),_:1})]}),_:1},8,["modelValue","title"])])}}}),pf=et({__name:"ListenerParam",props:{height:{default:"200px"},tableData:{default:()=>[]}},setup(e,{expose:t}){const{proxy:n}=yn(),i=H({type:[{required:!0,message:"请选择",trigger:"blur"}],name:[{required:!0,message:"请输入",trigger:"blur"}],value:[{required:!0,message:"请输入",trigger:"blur"}]}),{title:r,visible:o,openDialog:a,closeDialog:l}=xi({title:"监听器参数"}),s=[{id:"742fdeb7-23b4-416b-ac66-cd4ec8b901b7",label:"字符串",value:"stringValue"},{id:"660c9c46-8fae-4bae-91a0-0335420019dc",label:"表达式",value:"expression"}],c=H(),p=()=>{const h=c.value;return h?h.getTableData().fullData:[]},u=async()=>{const h=c.value;if(h){const{row:m}=await h.insertAt({},-1);await h.validate(m)}},d=async h=>{await(n==null?void 0:n.$modal.confirm("您确定要删除该数据?"));const m=c.value;m&&await m.remove(h)};return t({closeDialog:l,openDialog:a,validate:async()=>{const h=c.value;if(h)return await h.validate(!0)},getTableData:p}),(h,m)=>{const v=Gn,S=we("vxe-toolbar"),b=we("vxe-column"),w=we("vxe-option"),C=we("vxe-select"),R=we("vxe-input"),D=qi,F=we("vxe-table");return le(),Pe(Gt,null,[g(S,null,{buttons:x(()=>[g(v,{icon:"Plus",onClick:u},{default:x(()=>[G("新增")]),_:1})]),_:1}),g(F,{ref_key:"tableRef",ref:c,height:h.height,border:"","show-overflow":"","keep-source":"",data:h.tableData,"edit-rules":T(i),"edit-config":{trigger:"click",mode:"row",showStatus:!0}},{default:x(()=>[g(b,{type:"seq",width:"40"}),g(b,{field:"type",title:"类型","edit-render":{}},{default:x(A=>{var I;return[W("span",null,mn((I=s.find($=>$.value===A.row.type))==null?void 0:I.label),1)]}),edit:x(A=>[g(C,{modelValue:A.row.type,"onUpdate:modelValue":I=>A.row.type=I},{default:x(()=>[(le(),Pe(Gt,null,hn(s,I=>g(w,{key:I.id,value:I.value,label:I.label},null,8,["value","label"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),g(b,{field:"name",title:"名称","edit-render":{}},{edit:x(A=>[g(R,{modelValue:A.row.name,"onUpdate:modelValue":I=>A.row.name=I,type:"text"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),g(b,{field:"value",title:"值","edit-render":{}},{edit:x(A=>[g(R,{modelValue:A.row.value,"onUpdate:modelValue":I=>A.row.value=I,type:"text"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),g(b,{title:"操作",width:"100","show-overflow":"",align:"center"},{default:x(A=>[g(D,{content:"删除",placement:"top"},{default:x(()=>[g(v,{link:"",type:"danger",icon:"Delete",onClick:I=>d(A.row)},null,8,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["height","data","edit-rules"])],64)}}}),df=e=>(Ud("data-v-685e2ab0"),e=e(),Gd(),e),Lg=df(()=>W("br",null,null,-1)),$g=df(()=>W("br",null,null,-1)),Bg={class:"dialog-footer"},jg=et({__name:"ExecutionListener",props:{element:{}},emits:["close"],setup(e,{emit:t}){const n=e,{proxy:i}=yn(),r=H(),o=xi({title:r.value?"编辑&保存":"新增&保存"}),{showConfig:a,elementType:l,updateProperties:s}=xn({element:vt(n.element)}),{getModdle:c}=zn(),p=c(),u=H(),d=H(),f=H(),h={event:"",type:"",className:"",params:[]},m=H({...h}),v=H([]),S=H({event:[{required:!0,message:"请选择",trigger:"blur"}],type:[{required:!0,message:"请选择",trigger:"blur"}],className:[{required:!0,message:"请输入",trigger:"blur"}]}),b=async()=>{const O=await u.value.validate();await f.value.validate(B=>{if(B&&!O){const q=d.value;q&&(m.value.params=u.value.getTableData(),r.value?Object.assign(r.value,m.value):q.insertAt({...m.value},-1),F(),o.closeDialog())}})},w=async()=>{const O=d.value;O&&(O.getCheckboxRecords().length===0?i==null||i.$modal.msgWarning("请选择行"):(await O.removeCheckboxRow(),F()))},C=async()=>{Object.assign(m.value,h),r.value=null,o.openDialog()},R=O=>{Object.assign(m.value,O),r.value=O,o.openDialog()},D=async O=>{await(i==null?void 0:i.$modal.confirm("您确定要删除该数据?"));const B=d.value;B&&(await B.remove(O),F())},F=()=>{var q,re;const B=d.value.getTableData().fullData;if(B.length){let ne=n.element.businessObject.get("extensionElements");ne||(ne=p.create("bpmn:ExtensionElements")),ne.values=((q=ne.values)==null?void 0:q.filter(ge=>ge.$type!=="flowable:ExecutionListener"))??[],B.forEach(ge=>{const Le=p.create("flowable:ExecutionListener");Le.event=ge.event,Le[ge.type]=ge.className,ge.params&&ge.params.length&&ge.params.forEach(Z=>{const pe=p.create("flowable:Field");pe.name=Z.name,pe[Z.type]=Z.value,Le.get("fields").push(pe)}),ne.get("values").push(Le)}),s({extensionElements:ne})}else{const ne=n.element.businessObject.extensionElements;ne&&(ne.values=((re=ne.values)==null?void 0:re.filter(ge=>ge.$type!=="flowable:ExecutionListener"))??[])}},A=({row:O})=>{R(O)},I=wr({body:{options:[[{code:"edit",name:"编辑",prefixIcon:"vxe-icon-edit",disabled:!1},{code:"remove",name:"删除",prefixIcon:"vxe-icon-delete",disabled:!1}]]},visibleMethod({options:O,column:B}){const q=!B;return O.forEach(re=>{re.forEach(ne=>{ne.disabled=q})}),!0}}),$=({menu:O,row:B,column:q})=>{if(d.value)switch(O.code){case"edit":R(B);break;case"remove":D(B);break}},V=()=>{var O;v.value=((O=n.element.businessObject.extensionElements)==null?void 0:O.values.filter(B=>B.$type==="flowable:ExecutionListener").map(B=>{var re;let q;return"class"in B&&(q="class"),"expression"in B&&(q="expression"),"delegateExpression"in B&&(q="delegateExpression"),{event:B.event,type:q,className:B[q],params:((re=B.fields)==null?void 0:re.map(ne=>{let ge;return"stringValue"in ne&&(ge="stringValue"),"expression"in ne&&(ge="expression"),{name:ne.name,type:ge,value:ne[ge]}}))??[]}}))??[]};yi(()=>{V()});const X=[{id:"742fdeb7-23b4-416b-ac66-cd4ec8b901b7",label:"类",value:"class"},{id:"660c9c46-8fae-4bae-91a0-0335420019dc",label:"表达式",value:"expression"},{id:"4b8135ab-6bc3-4a0f-80be-22f58bc6c5fd",label:"委托表达式",value:"delegateExpression"}],U=[{id:"e6e0a51a-2d5d-4dc4-b847-b5c14f43a6ab",label:"开始",value:"start"},{id:"6da97c1e-15fc-4445-8943-75d09f49778e",label:"结束",value:"end"},{id:"6a2cbcec-e026-4f11-bef7-fff0b5c871e2",label:"启用",value:"take"}];return(O,B)=>{const q=Gn,re=we("vxe-toolbar"),ne=we("vxe-column"),ge=we("vxe-table"),Le=sa,Z=la,pe=Ot,oe=we("QuestionFilled"),De=_n,lt=qi,j=Wt,k=Lt,ee=cl,fe=ul,me=_i;return le(),Pe("div",null,[g(re,null,{buttons:x(()=>[g(q,{type:"primary",link:"",size:"small",onClick:C},{default:x(()=>[G("新增")]),_:1}),g(q,{type:"primary",link:"",size:"small",onClick:w},{default:x(()=>[G("删除")]),_:1})]),_:1}),g(ge,{ref_key:"tableRef",ref:d,size:"mini",height:"100px",border:"","show-overflow":"","keep-source":"",data:T(v),"menu-config":T(I),onCellDblclick:A,onMenuClick:$},{default:x(()=>[g(ne,{type:"checkbox",width:"40"}),g(ne,{type:"seq",width:"40"}),g(ne,{field:"event",title:"事件","min-width":"100px"},{default:x(K=>{var he;return[W("span",null,mn((he=U.find(Ie=>Ie.value===K.row.event))==null?void 0:he.label),1)]}),_:1}),g(ne,{field:"type",title:"类型","min-width":"100px"},{default:x(K=>{var he;return[W("span",null,mn((he=X.find(Ie=>Ie.value===K.row.type))==null?void 0:he.label),1)]}),_:1}),g(ne,{field:"className",title:"Java 类名","min-width":"100px"})]),_:1},8,["data","menu-config"]),g(me,{modelValue:T(o).visible.value,"onUpdate:modelValue":B[3]||(B[3]=K=>T(o).visible.value=K),title:T(o).title.value,width:"600px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,"append-to-body":""},{footer:x(()=>[W("div",Bg,[g(q,{onClick:T(o).closeDialog},{default:x(()=>[G("取 消")]),_:1},8,["onClick"]),g(q,{type:"primary",onClick:b},{default:x(()=>[G("确 定")]),_:1})])]),default:x(()=>[g(k,{ref_key:"formRef",ref:f,model:T(m),rules:T(S),"label-width":"100px"},{default:x(()=>{var K;return[g(pe,{label:"事件",prop:"event"},{default:x(()=>[g(Z,{modelValue:T(m).event,"onUpdate:modelValue":B[0]||(B[0]=he=>T(m).event=he)},{default:x(()=>[(le(),Pe(Gt,null,hn(U,he=>g(Le,{key:he.id,value:he.value,label:he.label},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1}),g(pe,{label:"类型",prop:"type"},{label:x(()=>[W("span",null,[G(" 类型 "),g(lt,{placement:"top"},{content:x(()=>[G(" 类：示例 com.company.MyCustomListener，自定义类必须实现 org.flowable.engine.delegate.TaskListener 接口"),Lg,G(" 表达式：示例 ${myObject.callMethod(task, task.eventName)}"),$g,G(" 委托表达式：示例 ${myListenerSpringBean} ，该 springBean 需要实现 org.flowable.engine.delegate.TaskListener 接口 ")]),default:x(()=>[g(De,null,{default:x(()=>[g(oe)]),_:1})]),_:1})])]),default:x(()=>[g(Z,{modelValue:T(m).type,"onUpdate:modelValue":B[1]||(B[1]=he=>T(m).type=he)},{default:x(()=>[(le(),Pe(Gt,null,hn(X,he=>g(Le,{key:he.id,value:he.value,label:he.label},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1}),g(pe,{label:X.filter(he=>he.value===T(m).type)[0]?(K=X.filter(he=>he.value===T(m).type)[0])==null?void 0:K.label:"表达式",prop:"className"},{default:x(()=>[g(j,{modelValue:T(m).className,"onUpdate:modelValue":B[2]||(B[2]=he=>T(m).className=he),type:"text"},null,8,["modelValue"])]),_:1},8,["label"])]}),_:1},8,["model","rules"]),g(fe,{type:"border-card"},{default:x(()=>[g(ee,{label:"参数"},{default:x(()=>[g(pf,{ref_key:"listenerParamRef",ref:u,"table-data":T(m).params},null,8,["table-data"])]),_:1})]),_:1})]),_:1},8,["modelValue","title"])])}}}),Si=ca(jg,[["__scopeId","data-v-685e2ab0"]]),wl=e=>(Ud("data-v-5dc1a82d"),e=e(),Gd(),e),Vg=wl(()=>W("br",null,null,-1)),Fg=wl(()=>W("br",null,null,-1)),Hg=wl(()=>W("br",null,null,-1)),zg={class:"dialog-footer"},Ug=et({__name:"TaskListener",props:{element:{}},setup(e){const{proxy:t}=yn(),n=e,i=H(),r=xi({title:i.value?"编辑&保存":"新增&保存"}),{showConfig:o,elementType:a,updateProperties:l}=xn({element:vt(n.element)}),{getModdle:s}=zn(),c=s(),p=H(),u=H(),d=H(),f={event:"",type:"",className:"",name:"",params:[]},h=H({...f});H(0);const m=H([]),v=H({event:[{required:!0,message:"请选择",trigger:"blur"}],type:[{required:!0,message:"请选择",trigger:"blur"}],name:[{required:!0,message:"请输入",trigger:"blur"}],className:[{required:!0,message:"请输入",trigger:"blur"}]}),S=async()=>{const U=await p.value.validate();await d.value.validate(O=>{if(O&&!U){const B=u.value;B&&(h.value.params=p.value.getTableData(),i.value?Object.assign(i.value,h.value):B.insertAt({...h.value},-1),D(),r.closeDialog())}})},b=async()=>{Object.assign(h.value,f),i.value=null,r.openDialog()},w=U=>{Object.assign(h.value,U),i.value=U,r.openDialog()},C=async U=>{await(t==null?void 0:t.$modal.confirm("您确定要删除该数据?"));const O=u.value;O&&(await O.remove(U),D())},R=async()=>{const U=u.value;U&&(U.getCheckboxRecords().length===0?t==null||t.$modal.msgWarning("请选择行"):(await U.removeCheckboxRow(),D()))},D=()=>{var B,q;const O=u.value.getTableData().fullData;if(O.length){let re=n.element.businessObject.get("extensionElements");re||(re=c.create("bpmn:ExtensionElements")),re.values=((B=re.values)==null?void 0:B.filter(ne=>ne.$type!=="flowable:TaskListener"))??[],O.forEach(ne=>{const ge=c.create("flowable:TaskListener");ge.event=ne.event,ge[ne.type]=ne.className,ne.params&&ne.params.length&&ne.params.forEach(Le=>{const Z=c.create("flowable:Field");Z.name=Le.name,Z[Le.type]=Le.value,ge.get("fields").push(Z)}),re.get("values").push(ge)}),l({extensionElements:re})}else{const re=n.element.businessObject.extensionElements;re&&(re.values=((q=re.values)==null?void 0:q.filter(ne=>ne.$type!=="flowable:TaskListener"))??[])}},F=({row:U})=>{w(U)},A=wr({body:{options:[[{code:"edit",name:"编辑",prefixIcon:"vxe-icon-edit",disabled:!1},{code:"remove",name:"删除",prefixIcon:"vxe-icon-delete",disabled:!1}]]},visibleMethod({options:U,column:O}){const B=!O;return U.forEach(q=>{q.forEach(re=>{re.disabled=B})}),!0}}),I=({menu:U,row:O,column:B})=>{if(u.value)switch(U.code){case"edit":w(O);break;case"remove":C(O);break}},$=()=>{var U;m.value=((U=n.element.businessObject.extensionElements)==null?void 0:U.values.filter(O=>O.$type==="flowable:TaskListener").map(O=>{var q;let B;return"class"in O&&(B="class"),"expression"in O&&(B="expression"),"delegateExpression"in O&&(B="delegateExpression"),{event:O.event,type:B,className:O[B],params:((q=O.fields)==null?void 0:q.map(re=>{let ne;return"stringValue"in re&&(ne="stringValue"),"expression"in re&&(ne="expression"),{name:re.name,type:ne,value:re[ne]}}))??[]}}))??[]};yi(()=>{$()});const V=[{id:"742fdeb7-23b4-416b-ac66-cd4ec8b901b7",label:"类",value:"class"},{id:"660c9c46-8fae-4bae-91a0-0335420019dc",label:"表达式",value:"expression"},{id:"4b8135ab-6bc3-4a0f-80be-22f58bc6c5fd",label:"委托表达式",value:"delegateExpression"}],X=[{id:"e6e0a51a-2d5d-4dc4-b847-b5c14f43a6ab",label:"创建",value:"create"},{id:"6da97c1e-15fc-4445-8943-75d09f49778e",label:"指派",value:"assignment"},{id:"6a2cbcec-e026-4f11-bef7-fff0b5c871e2",label:"完成",value:"complete"},{id:"68801972-85f1-482f-bd86-1fad015c26ed",label:"删除",value:"delete"}];return(U,O)=>{const B=Gn,q=we("vxe-toolbar"),re=we("vxe-column"),ne=we("vxe-table"),ge=we("QuestionFilled"),Le=_n,Z=qi,pe=sa,oe=la,De=Ot,lt=Wt,j=Lt,k=cl,ee=ul,fe=_i;return le(),Pe("div",null,[g(q,null,{buttons:x(()=>[g(B,{type:"primary",link:"",size:"small",onClick:b},{default:x(()=>[G("新增")]),_:1}),g(B,{type:"primary",link:"",size:"small",onClick:R},{default:x(()=>[G("删除")]),_:1})]),_:1}),g(ne,{ref_key:"tableRef",ref:u,size:"mini",height:"100px",border:"","show-overflow":"","keep-source":"",data:T(m),"menu-config":T(A),onCellDblclick:F,onMenuClick:I},{default:x(()=>[g(re,{type:"checkbox",width:"40"}),g(re,{type:"seq",width:"40"}),g(re,{field:"event",title:"事件","min-width":"100px"},{default:x(me=>{var K;return[W("span",null,mn((K=X.find(he=>he.value===me.row.event))==null?void 0:K.label),1)]}),_:1}),g(re,{field:"type",title:"类型","min-width":"100px"},{default:x(me=>{var K;return[W("span",null,mn((K=V.find(he=>he.value===me.row.type))==null?void 0:K.label),1)]}),_:1}),g(re,{field:"className",title:"Java 类名","min-width":"100px"})]),_:1},8,["data","menu-config"]),g(fe,{modelValue:T(r).visible.value,"onUpdate:modelValue":O[3]||(O[3]=me=>T(r).visible.value=me),title:T(r).title.value,width:"600px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,"append-to-body":""},{footer:x(()=>[W("div",zg,[g(B,{onClick:T(r).closeDialog},{default:x(()=>[G("取 消")]),_:1},8,["onClick"]),g(B,{type:"primary",onClick:S},{default:x(()=>[G("确 定")]),_:1})])]),default:x(()=>[g(j,{ref_key:"formRef",ref:d,model:T(h),rules:T(v),"label-width":"100px"},{default:x(()=>{var me;return[g(De,{label:"事件",prop:"event"},{label:x(()=>[W("span",null,[G(" 事件 "),g(Z,{placement:"top"},{content:x(()=>[G(" create（创建）：当任务已经创建，并且所有任务参数都已经设置时触发。"),Vg,G(" assignment（指派）：当任务已经指派给某人时触发。请注意：当流程执行到达用户任务时，在触发create事件之前，会首先触发assignment事件。"),Fg,G(" complete（完成）：当任务已经完成，从运行时数据中删除前触发。"),Hg,G(" delete（删除）：在任务即将被删除前触发。请注意任务由completeTask正常完成时也会触发。 ")]),default:x(()=>[g(Le,null,{default:x(()=>[g(ge)]),_:1})]),_:1})])]),default:x(()=>[g(oe,{modelValue:T(h).event,"onUpdate:modelValue":O[0]||(O[0]=K=>T(h).event=K)},{default:x(()=>[(le(),Pe(Gt,null,hn(X,K=>g(pe,{key:K.id,value:K.value,label:K.label},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1}),g(De,{label:"类型",prop:"type"},{default:x(()=>[g(oe,{modelValue:T(h).type,"onUpdate:modelValue":O[1]||(O[1]=K=>T(h).type=K)},{default:x(()=>[(le(),Pe(Gt,null,hn(V,K=>g(pe,{key:K.id,value:K.value,label:K.label},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1}),g(De,{label:V.filter(K=>K.value===T(h).type)[0]?(me=V.filter(K=>K.value===T(h).type)[0])==null?void 0:me.label:"表达式",prop:"className"},{default:x(()=>[g(lt,{modelValue:T(h).className,"onUpdate:modelValue":O[2]||(O[2]=K=>T(h).className=K),type:"text"},null,8,["modelValue"])]),_:1},8,["label"])]}),_:1},8,["model","rules"]),g(ee,{type:"border-card"},{default:x(()=>[g(k,{label:"参数"},{default:x(()=>[g(pf,{ref_key:"listenerParamRef",ref:p,"table-data":T(h).params},null,8,["table-data"])]),_:1})]),_:1})]),_:1},8,["modelValue","title"])])}}}),Gg=ca(Ug,[["__scopeId","data-v-5dc1a82d"]]),Wg=et({__name:"DueDate",props:{modelValue:{default:""},data:{default:""}},emits:["update:modelValue","confirmCallBack"],setup(e,{expose:t,emit:n}){const i=e,r=n,{title:o,visible:a,openDialog:l,closeDialog:s}=xi({title:"设置任务到期时间"}),c=H();H();const p=H(""),u=H(""),d=H(""),f=H(""),h=H(1),m=H(1),v=H(1),S=H(1),b=["4","8","12","24"],w=["1","2","3","4"],C=()=>{if(c.value=i.data,i.data){const O=i.data.substring(i.data.length-1);if(O==="H"){const q=i.data.substring(2,i.data.length-1);b.includes(q)?p.value=q:(p.value="自定义",h.value=Number(q))}const B=i.data.substring(1,i.data.length-1);O==="D"&&(w.includes(B)?u.value=B:(u.value="自定义",m.value=Number(B))),O==="W"&&(w.includes(B)?d.value=B:(d.value="自定义",v.value=Number(B))),O==="M"&&(w.includes(B)?f.value=B:(f.value="自定义",S.value=Number(B)))}},R=()=>{r("update:modelValue",c.value),r("confirmCallBack",c.value),s()},D=O=>{c.value=`PT${O}H`,u.value="",d.value="",f.value="",m.value=1,v.value=1,S.value=1},F=O=>{c.value=`P${O}D`,p.value="",d.value="",f.value="",h.value=1,v.value=1,S.value=1},A=O=>{c.value=`P${O}W`,p.value="",u.value="",f.value="",h.value=1,m.value=1,S.value=1},I=O=>{c.value=`P${O}M`,p.value="",u.value="",d.value="",h.value=1,m.value=1,v.value=1},$=O=>{O==="自定义"?c.value=`PT${h.value}H`:c.value=`PT${O}H`,u.value="",d.value="",f.value="",m.value=1,v.value=1,S.value=1},V=O=>{O==="自定义"?c.value=`P${m.value}D`:c.value=`P${O}D`,p.value="",d.value="",f.value="",h.value=1,v.value=1,S.value=1},X=O=>{O==="自定义"?c.value=`P${v.value}W`:c.value=`P${O}W`,p.value="",u.value="",f.value="",h.value=1,m.value=1,S.value=1},U=O=>{O==="自定义"?c.value=`P${S.value}M`:c.value=`P${O}M`,p.value="",u.value="",d.value="",h.value=1,m.value=1,v.value=1};return Hd(()=>a.value,()=>{a.value&&C()}),t({openDialog:l,closeDialog:s}),(O,B)=>{const q=Tv,re=Wd,ne=Pv,ge=Ot,Le=Lt,Z=Gn,pe=_i;return le(),Pe("div",null,[g(pe,{modelValue:T(a),"onUpdate:modelValue":B[8]||(B[8]=oe=>ze(a)?a.value=oe:null),title:T(o),width:"600px","append-to-body":""},{footer:x(()=>[W("div",null,[g(Z,{onClick:T(s)},{default:x(()=>[G("取消")]),_:1},8,["onClick"]),g(Z,{type:"primary",onClick:R},{default:x(()=>[G("确定")]),_:1})])]),default:x(()=>[g(Le,{"label-width":"100px"},{default:x(()=>[g(ge,{label:"小时"},{default:x(()=>[g(ne,{modelValue:T(p),"onUpdate:modelValue":B[1]||(B[1]=oe=>ze(p)?p.value=oe:null),onChange:$},{default:x(()=>[g(q,{label:"4",value:"4"}),g(q,{label:"8",value:"8"}),g(q,{label:"12",value:"12"}),g(q,{label:"24",value:"24"}),g(q,{label:"自定义",value:"自定义"}),It(g(re,{modelValue:T(h),"onUpdate:modelValue":B[0]||(B[0]=oe=>ze(h)?h.value=oe:null),min:1,onChange:D},null,8,["modelValue"]),[[un,T(p)==="自定义"]])]),_:1},8,["modelValue"])]),_:1}),g(ge,{label:"天"},{default:x(()=>[g(ne,{modelValue:T(u),"onUpdate:modelValue":B[3]||(B[3]=oe=>ze(u)?u.value=oe:null),onChange:V},{default:x(()=>[g(q,{label:"1",value:"1"}),g(q,{label:"2",value:"2"}),g(q,{label:"3",value:"3"}),g(q,{label:"4",value:"4"}),g(q,{label:"自定义",value:"自定义"}),It(g(re,{modelValue:T(m),"onUpdate:modelValue":B[2]||(B[2]=oe=>ze(m)?m.value=oe:null),min:1,onChange:F},null,8,["modelValue"]),[[un,T(u)==="自定义"]])]),_:1},8,["modelValue"])]),_:1}),g(ge,{label:"周"},{default:x(()=>[g(ne,{modelValue:T(d),"onUpdate:modelValue":B[5]||(B[5]=oe=>ze(d)?d.value=oe:null),onChange:X},{default:x(()=>[g(q,{label:"1",value:"1"}),g(q,{label:"2",value:"2"}),g(q,{label:"3",value:"3"}),g(q,{label:"4",value:"4"}),g(q,{label:"自定义",value:"自定义"}),It(g(re,{modelValue:T(v),"onUpdate:modelValue":B[4]||(B[4]=oe=>ze(v)?v.value=oe:null),min:1,onChange:A},null,8,["modelValue"]),[[un,T(d)==="自定义"]])]),_:1},8,["modelValue"])]),_:1}),g(ge,{label:"月"},{default:x(()=>[g(ne,{modelValue:T(f),"onUpdate:modelValue":B[7]||(B[7]=oe=>ze(f)?f.value=oe:null),onChange:U},{default:x(()=>[g(q,{label:"1",value:"1"}),g(q,{label:"2",value:"2"}),g(q,{label:"3",value:"3"}),g(q,{label:"4",value:"4"}),g(q,{label:"自定义",value:"自定义"}),It(g(re,{modelValue:T(S),"onUpdate:modelValue":B[6]||(B[6]=oe=>ze(S)?S.value=oe:null),min:1,onChange:I},null,8,["modelValue"]),[[un,T(f)==="自定义"]])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","title"])])}}}),Yg={class:"collapse__title"},qg={class:"collapse__title"},Kg={class:"collapse__title"},Xg={key:0},Zg=W("br",null,null,-1),Qg=W("br",null,null,-1),Jg=W("br",null,null,-1),ey=W("br",null,null,-1),ty=W("br",null,null,-1),ny=W("br",null,null,-1),iy=W("br",null,null,-1),ry={class:"collapse__title"},oy={class:"collapse__title"},ay=et({__name:"TaskPanel",props:{element:{}},setup(e){const t=H([]),n=H(!1),i=e,{showConfig:r,nameChange:o,formKeyChange:a,idChange:l,updateProperties:s,getExtensionElements:c,createModdleElement:p,constant:u}=xn({element:vt(i.element)}),{parseData:d}=wi({element:vt(i.element)}),f={id:"",name:"",dueDate:"",multiInstanceType:yt.NONE,allocationType:Bi.USER,specifyDesc:uf.SPECIFY_SINGLE},h=H({...f,...d()}),m=H({userName:""}),v=H(["1","2"]),S=H(),b=H(),w=H(),C=H();H(!0);const R=()=>{S.value.open()},D=()=>{h.value.assignee.includes("$")&&(h.value.assignee=""),b.value.open()},F=()=>{w.value.open()},A=j=>{C.value.openDialog()},I=j=>{s({"flowable:assignee":j||void 0})},$=j=>{const k=j.length!==0?j[0]:void 0;s({"flowable:assignee":k==null?void 0:k.userId}),m.value=k||{userName:""},h.value.assignee=String(k==null?void 0:k.userId);let ee=c();if(ee.values=ee.get("values").filter(fe=>fe.$type!=="flowable:extAssignee"),k){const fe=p("flowable:extAssignee",{body:""},ee);ee.get("values").push(fe),fe.body=JSON.stringify({userName:k.userName,userId:k.userId})}ee.values.length===0&&(ee=void 0),s({extensionElements:ee})},V=j=>{let k=c();if(k.values=k.values.filter(ee=>ee.$type!=="flowable:extCandidateUsers"),j.length===0)h.value.candidateUsers=void 0,s({"flowable:candidateUsers":void 0});else{const ee=j.map(K=>K.userId).join(",");h.value.candidateUsers=ee,s({"flowable:candidateUsers":ee});const fe=p("flowable:extCandidateUsers",{body:""},k);k.values.push(fe);const me=j.map(K=>({userId:K.userId,userName:K.userName}));fe.body=JSON.stringify(me)}k.values.length===0&&(k=void 0),s({extensionElements:k})},X=j=>{if(j.length===0)h.value.candidateGroups="",s({"flowable:candidateGroups":void 0});else{const k=j.map(ee=>ee.roleId).join(",");h.value.candidateGroups=k,s({"flowable:candidateGroups":k})}},U=j=>{s({"flowable:dueDate":j})},O=j=>{s({"flowable:async":j})},B=j=>{s({"flowable:skipExpression":j&&j.length>0?j:void 0})},q=j=>{s({"flowable:priority":j})},re=j=>{if(j!==yt.NONE){let k=i.element.businessObject.get("loopCharacteristics");k||(k=p("bpmn:MultiInstanceLoopCharacteristics",{},i.element.businessObject)),k.isSequential=j===yt.SERIAL,s({loopCharacteristics:k})}else s({loopCharacteristics:void 0})},ne=j=>{let k=i.element.businessObject.get("loopCharacteristics");k||(k=p("bpmn:MultiInstanceLoopCharacteristics",{},i.element.businessObject)),k.collection=j&&j.length>0?j:void 0,s({loopCharacteristics:k})},ge=j=>{let k=i.element.businessObject.get("loopCharacteristics");k||(k=p("bpmn:MultiInstanceLoopCharacteristics",{},i.element.businessObject)),k.elementVariable=j&&j.length>0?j:void 0,s({loopCharacteristics:k})},Le=j=>{let k=i.element.businessObject.get("loopCharacteristics");k||(k=p("bpmn:MultiInstanceLoopCharacteristics",{},i.element.businessObject)),j&&j.length>0?k.completionCondition?k.completionCondition.body=j:k.completionCondition=p("bpmn:Expression",{body:j},k):k.completionCondition=void 0,s({loopCharacteristics:k})},Z=j=>{s({"flowable:dueDate":j&&j.length>0?j:void 0})},pe=vi(()=>h.value.candidateUsers?h.value.candidateUsers.split(",").length:0),oe=vi(()=>h.value.candidateGroups?h.value.candidateGroups.split(",").length:0);pl(()=>{var k;const j=c(!1);if(j&&j.get("values")){let ee=j.get("values").find(fe=>fe.$type==="flowable:extAssignee");ee&&(m.value=JSON.parse(ee.body))}if(h.value.loopCharacteristics){const ee=h.value.loopCharacteristics;h.value.collection=ee.collection||"",h.value.elementVariable=ee.elementVariable||"",h.value.completionCondition=((k=ee.completionCondition)==null?void 0:k.body)||"",h.value.multiInstanceType=ee.isSequential?yt.SERIAL:yt.PARALLEL}h.value.assignee&&(h.value.fixedAssignee=h.value.assignee)});const De=H({id:[{required:!0,message:"请输入",trigger:"blur"}],name:[{required:!0,message:"请输入",trigger:"blur"}]});Bi.USER,Bi.CANDIDATE,Bi.YOURSELF,Bi.SPECIFY;const lt=async()=>{n.value=!0;const j=await Eg();t.value=j.data,n.value=!1};return yi(()=>{Zt(()=>{lt()})}),(j,k)=>{const ee=we("InfoFilled"),fe=_n,me=Wt,K=Ot,he=sa,Ie=la,ct=bi,Ht=we("Checked"),ke=Rv,Fe=Gn,oi=Dv,Di=cl,Rn=ul,ft=Wd,ar=we("HelpFilled"),Ze=we("QuestionFilled"),Dn=qi,$e=we("BellFilled"),ai=Ei,io=Lt,ro=dl;return le(),Pe("div",null,[g(io,{ref:"formRef",size:"default",model:T(h),rules:T(De),"label-width":"100px"},{default:x(()=>[g(ai,{modelValue:T(v),"onUpdate:modelValue":k[19]||(k[19]=se=>ze(v)?v.value=se:null)},{default:x(()=>[g(ct,{name:"1"},{title:x(()=>[W("div",Yg,[g(fe,null,{default:x(()=>[g(ee)]),_:1}),G(" 常规 ")])]),default:x(()=>[W("div",null,[g(K,{prop:"id",label:"节点 ID"},{default:x(()=>[g(me,{modelValue:T(h).id,"onUpdate:modelValue":k[0]||(k[0]=se=>T(h).id=se),onChange:T(l)},null,8,["modelValue","onChange"])]),_:1}),g(K,{prop:"name",label:"节点名称"},{default:x(()=>[g(me,{modelValue:T(h).name,"onUpdate:modelValue":k[1]||(k[1]=se=>T(h).name=se),onChange:T(o)},null,8,["modelValue","onChange"])]),_:1}),T(r).skipExpression?(le(),He(K,{key:0,prop:"skipExpression",label:"跳过表达式"},{default:x(()=>[g(me,{modelValue:T(h).skipExpression,"onUpdate:modelValue":k[2]||(k[2]=se=>T(h).skipExpression=se),onChange:B},null,8,["modelValue"])]),_:1})):Ye("",!0),It((le(),He(K,{prop:"formKey",label:"表单地址"},{default:x(()=>[g(Ie,{modelValue:T(h).formKey,"onUpdate:modelValue":k[3]||(k[3]=se=>T(h).formKey=se),clearable:"",filterable:"",placeholder:"请选择表单",style:{width:"260px"},onChange:T(a)},{default:x(()=>[(le(!0),Pe(Gt,null,hn(T(t),se=>(le(),He(he,{key:se.id,label:se.formTypeName+":"+se.formName,value:se.formType+":"+se.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),_:1})),[[ro,T(n)]])])]),_:1}),g(ct,{name:"2"},{title:x(()=>[W("div",qg,[g(fe,null,{default:x(()=>[g(Ht)]),_:1}),G(" 任务 ")])]),default:x(()=>[W("div",null,[T(r).async?(le(),He(K,{key:0,prop:"sync",label:"是否异步"},{default:x(()=>[g(ke,{modelValue:T(h).async,"onUpdate:modelValue":k[4]||(k[4]=se=>T(h).async=se),"inline-prompt":"","active-text":"是","inactive-text":"否",onChange:O},null,8,["modelValue"])]),_:1})):Ye("",!0),g(Rn,{"tab-position":"left",class:"demo-tabs"},{default:x(()=>[g(Di,{label:"身份存储"},{default:x(()=>[g(K,{label:"分配人员"},{default:x(()=>[g(me,{modelValue:T(h).assignee,"onUpdate:modelValue":k[5]||(k[5]=se=>T(h).assignee=se),onBlur:k[6]||(k[6]=se=>I(T(h).assignee))},{append:x(()=>[g(Fe,{icon:"Search",type:"primary",onClick:D})]),_:1},8,["modelValue"])]),_:1}),g(K,{label:"候选人员"},{default:x(()=>[g(oi,{value:T(pe),max:99},{default:x(()=>[g(Fe,{size:"small",type:"primary",onClick:R},{default:x(()=>[G("选择人员")]),_:1})]),_:1},8,["value"])]),_:1}),g(K,{label:"候选组"},{default:x(()=>[g(oi,{value:T(oe),max:99},{default:x(()=>[g(Fe,{size:"small",type:"primary",onClick:F},{default:x(()=>[G("选择组")]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),T(r).dueDate?(le(),He(K,{key:1,prop:"dueDate",label:"到期时间"},{default:x(()=>[g(me,{modelValue:T(h).dueDate,"onUpdate:modelValue":k[7]||(k[7]=se=>T(h).dueDate=se),clearable:"",onChange:Z,onClick:A},{append:x(()=>[g(Fe,{icon:"Search",type:"primary",onClick:A})]),_:1},8,["modelValue"])]),_:1})):Ye("",!0),T(r).priority?(le(),He(K,{key:2,prop:"priority",label:"优先级"},{default:x(()=>[g(ft,{modelValue:T(h).priority,"onUpdate:modelValue":k[8]||(k[8]=se=>T(h).priority=se),min:0,onChange:q},null,8,["modelValue"])]),_:1})):Ye("",!0)])]),_:1}),g(ct,{name:"3"},{title:x(()=>[W("div",Kg,[g(fe,null,{default:x(()=>[g(ar)]),_:1}),G(" 多实例 ")])]),default:x(()=>[W("div",null,[g(K,{label:"多实例类型"},{default:x(()=>[g(Ie,{modelValue:T(h).multiInstanceType,"onUpdate:modelValue":k[9]||(k[9]=se=>T(h).multiInstanceType=se),onChange:re},{default:x(()=>[(le(!0),Pe(Gt,null,hn(T(u).MultiInstanceType,se=>(le(),He(he,{key:se.id,value:se.value,label:se.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),T(h).multiInstanceType!==T(yt).NONE?(le(),Pe("div",Xg,[g(K,{label:"集合"},{label:x(()=>[W("span",null,[G(" 集合 "),g(Dn,{placement:"top"},{content:x(()=>[G(" 属性会作为表达式进行解析。如果表达式解析为字符串而不是一个集合，"),Zg,G(" 不论是因为本身配置的就是静态字符串值，还是表达式计算结果为字符串，"),Qg,G(" 这个字符串都会被当做变量名，并从流程变量中用于获取实际的集合。 ")]),default:x(()=>[g(fe,null,{default:x(()=>[g(Ze)]),_:1})]),_:1})])]),default:x(()=>[g(me,{modelValue:T(h).collection,"onUpdate:modelValue":k[10]||(k[10]=se=>T(h).collection=se),onChange:ne},null,8,["modelValue"])]),_:1}),g(K,{label:"元素变量"},{label:x(()=>[W("span",null,[G(" 元素变量 "),g(Dn,{placement:"top"},{content:x(()=>[G(" 每创建一个用户任务前，先以该元素变量为label，集合中的一项为value，"),Jg,G(" 创建（局部）流程变量，该局部流程变量被用于指派用户任务。"),ey,G(" 一般来说，该字符串应与指定人员变量相同。 ")]),default:x(()=>[g(fe,null,{default:x(()=>[g(Ze)]),_:1})]),_:1})])]),default:x(()=>[g(me,{modelValue:T(h).elementVariable,"onUpdate:modelValue":k[11]||(k[11]=se=>T(h).elementVariable=se),onChange:ge},null,8,["modelValue"])]),_:1}),g(K,{label:"完成条件"},{label:x(()=>[W("span",null,[G(" 完成条件 "),g(Dn,{placement:"top"},{content:x(()=>[G(" 多实例活动在所有实例都完成时结束，然而也可以指定一个表达式，在每个实例"),ty,G(" 结束时进行计算。当表达式计算为true时，将销毁所有剩余的实例，并结束多实例"),ny,G(" 活动，继续执行流程。例如 ${nrOfCompletedInstances/nrOfInstances >= 0.6 }，"),iy,G(" 表示当任务完成60%时，该节点就算完成 ")]),default:x(()=>[g(fe,null,{default:x(()=>[g(Ze)]),_:1})]),_:1})])]),default:x(()=>[g(me,{modelValue:T(h).completionCondition,"onUpdate:modelValue":k[12]||(k[12]=se=>T(h).completionCondition=se),onChange:Le},null,8,["modelValue"])]),_:1})])):Ye("",!0)])]),_:1}),T(r).taskListener?(le(),He(ct,{key:0,name:"4"},{title:x(()=>[W("div",ry,[g(fe,null,{default:x(()=>[g($e)]),_:1}),G(" 任务监听器 ")])]),default:x(()=>[W("div",null,[T(r).taskListener?(le(),He(Gg,{key:0,element:j.element},null,8,["element"])):Ye("",!0)])]),_:1})):Ye("",!0),T(r).executionListener?(le(),He(ct,{key:1,name:"5"},{title:x(()=>[W("div",oy,[g(fe,null,{default:x(()=>[g($e)]),_:1}),G(" 执行监听器 ")])]),default:x(()=>[W("div",null,[T(r).executionListener?(le(),He(Si,{key:0,element:j.element},null,8,["element"])):Ye("",!0)])]),_:1})):Ye("",!0),T(r).isForCompensation?(le(),He(K,{key:2,prop:"isForCompensation",label:"是否为补偿"},{default:x(()=>[g(ke,{modelValue:T(h).isForCompensation,"onUpdate:modelValue":k[13]||(k[13]=se=>T(h).isForCompensation=se),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1})):Ye("",!0),T(r).triggerServiceTask?(le(),He(K,{key:3,prop:"triggerServiceTask",label:"服务任务可触发"},{default:x(()=>[g(ke,{modelValue:T(h).triggerServiceTask,"onUpdate:modelValue":k[14]||(k[14]=se=>T(h).triggerServiceTask=se),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1})):Ye("",!0),T(r).autoStoreVariables?(le(),He(K,{key:4,prop:"autoStoreVariables",label:"自动存储变量"},{default:x(()=>[g(ke,{modelValue:T(h).autoStoreVariables,"onUpdate:modelValue":k[15]||(k[15]=se=>T(h).autoStoreVariables=se),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1})):Ye("",!0),T(r).ruleVariablesInput?(le(),He(K,{key:5,prop:"skipExpression",label:"输入变量"},{default:x(()=>[g(me,{modelValue:T(h).ruleVariablesInput,"onUpdate:modelValue":k[16]||(k[16]=se=>T(h).ruleVariablesInput=se)},null,8,["modelValue"])]),_:1})):Ye("",!0),T(r).exclude?(le(),He(K,{key:6,prop:"exclude",label:"排除"},{default:x(()=>[g(ke,{modelValue:T(h).exclude,"onUpdate:modelValue":k[17]||(k[17]=se=>T(h).exclude=se),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1})):Ye("",!0),T(r).class?(le(),He(K,{key:7,prop:"class",label:"类"},{default:x(()=>[g(me,{modelValue:T(h).class,"onUpdate:modelValue":k[18]||(k[18]=se=>T(h).class=se)},null,8,["modelValue"])]),_:1})):Ye("",!0)]),_:1},8,["modelValue"])]),_:1},8,["model","rules"]),g(T(fu),{ref_key:"userSelectRef",ref:S,data:T(h).candidateUsers,onConfirmCallBack:V},null,8,["data"]),g(T(fu),{ref_key:"singleUserSelectRef",ref:b,data:T(h).assignee,multiple:!1,onConfirmCallBack:$},null,8,["data"]),g(T(Og),{ref_key:"roleSelectRef",ref:w,data:T(h).candidateGroups,onConfirmCallBack:X},null,8,["data"]),g(Wg,{ref_key:"dueDateRef",ref:C,modelValue:T(h).dueDate,"onUpdate:modelValue":k[20]||(k[20]=se=>T(h).dueDate=se),data:T(h).dueDate,onConfirmCallBack:U},null,8,["modelValue","data"])])}}}),sy={class:"collapse__title"},ly={class:"collapse__title"},cy=et({__name:"ProcessPanel",props:{element:{}},setup(e){yn();const t=e,{parseData:n}=wi({element:vt(t.element)}),{idChange:i,nameChange:r}=xn({element:vt(t.element)}),o=H(["1","2"]),a=H(n()),l=H({id:[{required:!0,message:"请输入",trigger:"blur"}],name:[{required:!0,message:"请输入",trigger:"blur"}]});return(s,c)=>{const p=we("InfoFilled"),u=_n,d=Wt,f=Ot,h=Lt,m=bi,v=we("BellFilled"),S=Ei;return le(),Pe("div",null,[g(S,{modelValue:T(o),"onUpdate:modelValue":c[2]||(c[2]=b=>ze(o)?o.value=b:null)},{default:x(()=>[g(m,{name:"1"},{title:x(()=>[W("div",sy,[g(u,null,{default:x(()=>[g(p)]),_:1}),G(" 常规 ")])]),default:x(()=>[W("div",null,[g(h,{ref:"formRef",model:T(a),rules:T(l),"label-width":"80px"},{default:x(()=>[g(f,{label:"流程标识",prop:"id"},{default:x(()=>[g(d,{modelValue:T(a).id,"onUpdate:modelValue":c[0]||(c[0]=b=>T(a).id=b),onChange:T(i)},null,8,["modelValue","onChange"])]),_:1}),g(f,{label:"流程名称",prop:"name"},{default:x(()=>[g(d,{modelValue:T(a).name,"onUpdate:modelValue":c[1]||(c[1]=b=>T(a).name=b),onChange:T(r)},null,8,["modelValue","onChange"])]),_:1})]),_:1},8,["model","rules"])])]),_:1}),g(m,{name:"2"},{title:x(()=>[W("div",ly,[g(u,null,{default:x(()=>[g(v)]),_:1}),G(" 执行监听器 ")])]),default:x(()=>[W("div",null,[g(Si,{element:s.element},null,8,["element"])])]),_:1})]),_:1},8,["modelValue"])])}}}),uy={class:"collapse__title"},py={class:"collapse__title"},dy=et({__name:"StartEndPanel",props:{element:{}},setup(e){const t=e,{nameChange:n,idChange:i}=xn({element:vt(t.element)}),{parseData:r}=wi({element:vt(t.element)}),o=H(r()),a=H(["1","2"]),l=H({id:[{required:!0,message:"请输入",trigger:"blur"}],name:[{required:!0,message:"请输入",trigger:"blur"}]});return(s,c)=>{const p=we("InfoFilled"),u=_n,d=Wt,f=Ot,h=Lt,m=bi,v=we("BellFilled"),S=Ei;return le(),Pe("div",null,[g(S,{modelValue:T(a),"onUpdate:modelValue":c[2]||(c[2]=b=>ze(a)?a.value=b:null)},{default:x(()=>[g(m,{name:"1"},{title:x(()=>[W("div",uy,[g(u,null,{default:x(()=>[g(p)]),_:1}),G(" 常规 ")])]),default:x(()=>[W("div",null,[g(h,{ref:"formRef",model:T(o),rules:T(l),"label-width":"90px"},{default:x(()=>[g(f,{prop:"id",label:"节点 ID"},{default:x(()=>[g(d,{modelValue:T(o).id,"onUpdate:modelValue":c[0]||(c[0]=b=>T(o).id=b),onChange:T(i)},null,8,["modelValue","onChange"])]),_:1}),g(f,{prop:"name",label:"节点名称"},{default:x(()=>[g(d,{modelValue:T(o).name,"onUpdate:modelValue":c[1]||(c[1]=b=>T(o).name=b),onChange:T(n)},null,8,["modelValue","onChange"])]),_:1})]),_:1},8,["model","rules"])])]),_:1}),g(m,{name:"2"},{title:x(()=>[W("div",py,[g(u,null,{default:x(()=>[g(v)]),_:1}),G(" 执行监听器 ")])]),default:x(()=>[W("div",null,[g(Si,{element:s.element},null,8,["element"])])]),_:1})]),_:1},8,["modelValue"])])}}}),fy={class:"collapse__title"},hy={class:"collapse__title"},my=et({__name:"GatewayPanel",props:{element:{}},setup(e){const t=e,{nameChange:n,idChange:i}=xn({element:vt(t.element)}),{parseData:r}=wi({element:vt(t.element)}),o=H(["1","2"]),a=H(r()),l=H({processCategory:[{required:!0,message:"请选择",trigger:"blur"}],id:[{required:!0,message:"请输入",trigger:"blur"}],name:[{required:!0,message:"请输入",trigger:"blur"}]});return(s,c)=>{const p=we("InfoFilled"),u=_n,d=Wt,f=Ot,h=Lt,m=bi,v=we("BellFilled"),S=Ei;return le(),Pe("div",null,[g(S,{modelValue:T(o),"onUpdate:modelValue":c[2]||(c[2]=b=>ze(o)?o.value=b:null)},{default:x(()=>[g(m,{name:"1"},{title:x(()=>[W("div",fy,[g(u,null,{default:x(()=>[g(p)]),_:1}),G(" 常规 ")])]),default:x(()=>[W("div",null,[g(h,{ref:"formRef",model:T(a),rules:T(l),"label-width":"80px"},{default:x(()=>[g(f,{prop:"id",label:"节点 ID"},{default:x(()=>[g(d,{modelValue:T(a).id,"onUpdate:modelValue":c[0]||(c[0]=b=>T(a).id=b),onChange:T(i)},null,8,["modelValue","onChange"])]),_:1}),g(f,{prop:"name",label:"节点名称"},{default:x(()=>[g(d,{modelValue:T(a).name,"onUpdate:modelValue":c[1]||(c[1]=b=>T(a).name=b),onChange:T(n)},null,8,["modelValue","onChange"])]),_:1})]),_:1},8,["model","rules"])])]),_:1}),g(m,{name:"2"},{title:x(()=>[W("div",hy,[g(u,null,{default:x(()=>[g(v)]),_:1}),G(" 执行监听器 ")])]),default:x(()=>[W("div",null,[g(Si,{element:s.element},null,8,["element"])])]),_:1})]),_:1},8,["modelValue"])])}}}),vy={class:"collapse__title"},gy={class:"collapse__title"},yy=et({__name:"SequenceFlowPanel",props:{element:{}},setup(e){const t=e,{nameChange:n,idChange:i,updateProperties:r}=xn({element:vt(t.element)}),{parseData:o}=wi({element:vt(t.element)}),a=zn().getModdle(),l=H(["1","2"]),s=H(o()),c=H({processCategory:[{required:!0,message:"请选择",trigger:"blur"}],id:[{required:!0,message:"请输入",trigger:"blur"}],name:[{required:!0,message:"请输入",trigger:"blur"}]}),p=d=>{if(d){const f=a.create("bpmn:FormalExpression",{body:d});r({conditionExpression:f})}else r({conditionExpression:null})},u=d=>{r({"flowable:skipExpression":d})};return pl(()=>{s.value.conditionExpression&&(s.value.conditionExpressionValue=s.value.conditionExpression.body)}),(d,f)=>{const h=we("InfoFilled"),m=_n,v=Wt,S=Ot,b=Lt,w=bi,C=we("BellFilled"),R=Ei;return le(),Pe("div",null,[g(R,{modelValue:T(l),"onUpdate:modelValue":f[4]||(f[4]=D=>ze(l)?l.value=D:null)},{default:x(()=>[g(w,{name:"1"},{title:x(()=>[W("div",vy,[g(m,null,{default:x(()=>[g(h)]),_:1}),G(" 常规 ")])]),default:x(()=>[W("div",null,[g(b,{ref:"formRef",model:T(s),rules:T(c),"label-width":"90px"},{default:x(()=>[g(S,{prop:"id",label:"节点 ID"},{default:x(()=>[g(v,{modelValue:T(s).id,"onUpdate:modelValue":f[0]||(f[0]=D=>T(s).id=D),onChange:T(i)},null,8,["modelValue","onChange"])]),_:1}),g(S,{prop:"name",label:"节点名称"},{default:x(()=>[g(v,{modelValue:T(s).name,"onUpdate:modelValue":f[1]||(f[1]=D=>T(s).name=D),onChange:T(n)},null,8,["modelValue","onChange"])]),_:1}),g(S,{prop:"conditionExpression",label:"跳转条件"},{default:x(()=>[g(v,{modelValue:T(s).conditionExpressionValue,"onUpdate:modelValue":f[2]||(f[2]=D=>T(s).conditionExpressionValue=D),onChange:p},null,8,["modelValue"])]),_:1}),g(S,{prop:"skipExpression",label:"跳过表达式"},{default:x(()=>[g(v,{modelValue:T(s).skipExpression,"onUpdate:modelValue":f[3]||(f[3]=D=>T(s).skipExpression=D),onChange:u},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])]),_:1}),g(w,{name:"2"},{title:x(()=>[W("div",gy,[g(m,null,{default:x(()=>[g(C)]),_:1}),G(" 执行监听器 ")])]),default:x(()=>[W("div",null,[g(Si,{element:d.element},null,8,["element"])])]),_:1})]),_:1},8,["modelValue"])])}}}),_y={class:"collapse__title"},by={class:"collapse__title"},Ey=et({__name:"ParticipantPanel",props:{element:{}},setup(e){const t=e,{nameChange:n,idChange:i}=xn({element:vt(t.element)}),{parseData:r}=wi({element:vt(t.element)}),o=H(r()),a=H(["1","2"]),l=H({id:[{required:!0,message:"请输入",trigger:"blur"}],name:[{required:!0,message:"请输入",trigger:"blur"}]});return(s,c)=>{const p=we("InfoFilled"),u=_n,d=Wt,f=Ot,h=Lt,m=bi,v=we("BellFilled"),S=Ei;return le(),Pe("div",null,[g(S,{modelValue:T(a),"onUpdate:modelValue":c[2]||(c[2]=b=>ze(a)?a.value=b:null)},{default:x(()=>[g(m,{name:"1"},{title:x(()=>[W("div",_y,[g(u,null,{default:x(()=>[g(p)]),_:1}),G(" 常规 ")])]),default:x(()=>[W("div",null,[g(h,{ref:"formRef",model:T(o),rules:T(l),"label-width":"90px"},{default:x(()=>[g(f,{prop:"id",label:"节点 ID"},{default:x(()=>[g(d,{modelValue:T(o).id,"onUpdate:modelValue":c[0]||(c[0]=b=>T(o).id=b),onChange:T(i)},null,8,["modelValue","onChange"])]),_:1}),g(f,{prop:"name",label:"节点名称"},{default:x(()=>[g(d,{modelValue:T(o).name,"onUpdate:modelValue":c[1]||(c[1]=b=>T(o).name=b),onChange:T(n)},null,8,["modelValue","onChange"])]),_:1})]),_:1},8,["model","rules"])])]),_:1}),g(m,{name:"2"},{title:x(()=>[W("div",by,[g(u,null,{default:x(()=>[g(v)]),_:1}),G(" 执行监听器 ")])]),default:x(()=>[W("div",null,[g(Si,{element:s.element},null,8,["element"])])]),_:1})]),_:1},8,["modelValue"])])}}}),xy={class:"collapse__title"},wy={class:"collapse__title"},Sy={class:"collapse__title"},Cy={key:0},Ty=W("br",null,null,-1),Py=W("br",null,null,-1),Ry=W("br",null,null,-1),Dy=W("br",null,null,-1),ky=W("br",null,null,-1),Ay=W("br",null,null,-1),My=W("br",null,null,-1),Iy=et({__name:"SubProcessPanel",props:{element:{}},setup(e){const t=e,{nameChange:n,idChange:i,updateProperties:r,createModdleElement:o,constant:a}=xn({element:vt(t.element)}),{parseData:l}=wi({element:vt(t.element)}),s=H(l()),c=H(["1","2","3"]),p=m=>{if(m!==yt.NONE){let v=t.element.businessObject.get("loopCharacteristics");v||(v=o("bpmn:MultiInstanceLoopCharacteristics",{},t.element.businessObject)),v.isSequential=m===yt.SERIAL,r({loopCharacteristics:v})}else r({loopCharacteristics:void 0})},u=m=>{let v=t.element.businessObject.get("loopCharacteristics");v||(v=o("bpmn:MultiInstanceLoopCharacteristics",{},t.element.businessObject)),v.collection=m&&m.length>0?m:void 0,r({loopCharacteristics:v})},d=m=>{let v=t.element.businessObject.get("loopCharacteristics");v||(v=o("bpmn:MultiInstanceLoopCharacteristics",{},t.element.businessObject)),v.elementVariable=m&&m.length>0?m:void 0,r({loopCharacteristics:v})},f=m=>{let v=t.element.businessObject.get("loopCharacteristics");v||(v=o("bpmn:MultiInstanceLoopCharacteristics",{},t.element.businessObject)),m&&m.length>0?v.completionCondition?v.completionCondition.body=m:v.completionCondition=o("bpmn:Expression",{body:m},v):v.completionCondition=void 0,r({loopCharacteristics:v})};pl(()=>{var m;if(s.value.loopCharacteristics){const v=s.value.loopCharacteristics;s.value.collection=v.collection||"",s.value.elementVariable=v.elementVariable||"",s.value.completionCondition=((m=v.completionCondition)==null?void 0:m.body)||"",s.value.multiInstanceType=v.isSequential?yt.SERIAL:yt.PARALLEL}});const h=H({id:[{required:!0,message:"请输入",trigger:"blur"}],name:[{required:!0,message:"请输入",trigger:"blur"}]});return(m,v)=>{const S=we("InfoFilled"),b=_n,w=Wt,C=Ot,R=bi,D=we("BellFilled"),F=we("HelpFilled"),A=sa,I=la,$=we("QuestionFilled"),V=qi,X=Ei,U=Lt;return le(),Pe("div",null,[g(U,{ref:"formRef",model:T(s),rules:T(h),"label-width":"90px"},{default:x(()=>[g(X,{modelValue:T(c),"onUpdate:modelValue":v[6]||(v[6]=O=>ze(c)?c.value=O:null)},{default:x(()=>[g(R,{name:"1"},{title:x(()=>[W("div",xy,[g(b,null,{default:x(()=>[g(S)]),_:1}),G(" 常规 ")])]),default:x(()=>[W("div",null,[g(C,{prop:"id",label:"节点 ID"},{default:x(()=>[g(w,{modelValue:T(s).id,"onUpdate:modelValue":v[0]||(v[0]=O=>T(s).id=O),onChange:T(i)},null,8,["modelValue","onChange"])]),_:1}),g(C,{prop:"name",label:"节点名称"},{default:x(()=>[g(w,{modelValue:T(s).name,"onUpdate:modelValue":v[1]||(v[1]=O=>T(s).name=O),onChange:T(n)},null,8,["modelValue","onChange"])]),_:1})])]),_:1}),g(R,{name:"2"},{title:x(()=>[W("div",wy,[g(b,null,{default:x(()=>[g(D)]),_:1}),G(" 执行监听器 ")])]),default:x(()=>[W("div",null,[g(Si,{element:m.element},null,8,["element"])])]),_:1}),g(R,{name:"3"},{title:x(()=>[W("div",Sy,[g(b,null,{default:x(()=>[g(F)]),_:1}),G(" 多实例 ")])]),default:x(()=>[W("div",null,[g(C,{label:"多实例类型"},{default:x(()=>[g(I,{modelValue:T(s).multiInstanceType,"onUpdate:modelValue":v[2]||(v[2]=O=>T(s).multiInstanceType=O),onChange:p},{default:x(()=>[(le(!0),Pe(Gt,null,hn(T(a).MultiInstanceType,O=>(le(),He(A,{key:O.id,value:O.value,label:O.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),T(s).multiInstanceType!==T(yt).NONE?(le(),Pe("div",Cy,[g(C,{label:"集合"},{label:x(()=>[W("span",null,[G(" 集合 "),g(V,{placement:"top"},{content:x(()=>[G(" 属性会作为表达式进行解析。如果表达式解析为字符串而不是一个集合，"),Ty,G(" 不论是因为本身配置的就是静态字符串值，还是表达式计算结果为字符串，"),Py,G(" 这个字符串都会被当做变量名，并从流程变量中用于获取实际的集合。 ")]),default:x(()=>[g(b,null,{default:x(()=>[g($)]),_:1})]),_:1})])]),default:x(()=>[g(w,{modelValue:T(s).collection,"onUpdate:modelValue":v[3]||(v[3]=O=>T(s).collection=O),onChange:u},null,8,["modelValue"])]),_:1}),g(C,{label:"元素变量"},{label:x(()=>[W("span",null,[G(" 元素变量 "),g(V,{placement:"top"},{content:x(()=>[G(" 每创建一个用户任务前，先以该元素变量为label，集合中的一项为value，"),Ry,G(" 创建（局部）流程变量，该局部流程变量被用于指派用户任务。"),Dy,G(" 一般来说，该字符串应与指定人员变量相同。 ")]),default:x(()=>[g(b,null,{default:x(()=>[g($)]),_:1})]),_:1})])]),default:x(()=>[g(w,{modelValue:T(s).elementVariable,"onUpdate:modelValue":v[4]||(v[4]=O=>T(s).elementVariable=O),onChange:d},null,8,["modelValue"])]),_:1}),g(C,{label:"完成条件"},{label:x(()=>[W("span",null,[G(" 完成条件 "),g(V,{placement:"top"},{content:x(()=>[G(" 多实例活动在所有实例都完成时结束，然而也可以指定一个表达式，在每个实例"),ky,G(" 结束时进行计算。当表达式计算为true时，将销毁所有剩余的实例，并结束多实例"),Ay,G(" 活动，继续执行流程。例如 ${nrOfCompletedInstances/nrOfInstances >= 0.6 }，"),My,G(" 表示当任务完成60%时，该节点就算完成 ")]),default:x(()=>[g(b,null,{default:x(()=>[g($)]),_:1})]),_:1})])]),default:x(()=>[g(w,{modelValue:T(s).completionCondition,"onUpdate:modelValue":v[5]||(v[5]=O=>T(s).completionCondition=O),onChange:f},null,8,["modelValue"])]),_:1})])):Ye("",!0)])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["model","rules"])])}}}),Ny={ref:"propertyPanel"},Oy={key:0,class:"node-name"},Ly=et({name:"PropertyPanel"}),$y=et({...Ly,props:{modeler:{}},setup(e){yn();const t=e,n=H(),i=H(),r=["bpmn:IntermediateThrowEvent","bpmn:StartEvent","bpmn:EndEvent"],o=["bpmn:UserTask","bpmn:Task","bpmn:SendTask","bpmn:ReceiveTask","bpmn:ManualTask","bpmn:BusinessRuleTask","bpmn:ServiceTask","bpmn:ScriptTask"],a=["bpmn:SequenceFlow"],l=["bpmn:InclusiveGateway","bpmn:ExclusiveGateway","bpmn:ParallelGateway","bpmn:EventBasedGateway","bpmn:ComplexGateway"],s=["bpmn:Process"],c=vi(()=>{if(!n.value)return null;const d=n.value.type;if(r.includes(d))return dy;if(o.includes(d))return ay;if(a.includes(d))return yy;if(l.includes(d))return my;if(s.includes(d))return cy;if(d==="bpmn:Participant")return Ey;if(d==="bpmn:SubProcess")return Iy}),p=vi(()=>{if(n.value){const d=n.value.businessObject,f=d!=null&&d.eventDefinitions&&(d==null?void 0:d.eventDefinitions.length)>0?d.eventDefinitions[0].$type:d.$type;return kg[f]||f}return""}),u=()=>{t.modeler.on("root.added",d=>{n.value=null,d.element.type==="bpmn:Process"&&Zt(()=>{n.value=d.element,i.value=d.element})}),t.modeler.on("element.click",d=>{d.element.type==="bpmn:Process"&&Zt(()=>{n.value=d.element,i.value=d.element})}),t.modeler.on("selection.changed",d=>{n.value=null;const f=d.newSelection[0];f?Zt(()=>{n.value=f}):Zt(()=>{n.value=i.value})})};return yi(()=>{u()}),(d,f)=>(le(),Pe("div",Ny,[T(p)?(le(),Pe("div",Oy,mn(T(p)),1)):Ye("",!0),T(n)?(le(),He(kv(T(c)),{key:1,element:T(n)},null,8,["element"])):Ye("",!0)],512))}}),By=ca($y,[["__scopeId","data-v-b93d2da6"]]);function Or(e){fl.call(this,e),this.on("import.parse.complete",function(t){t.error||this._collectIds(t.definitions,t.elementsById)},this),this.on("diagram.destroy",function(){this.get("moddle").ids.clear()},this)}te(Or,fl);Or.prototype._createModdle=function(e){var t=fl.prototype._createModdle.call(this,e);return t.ids=new Kv([32,36,1]),t};Or.prototype._collectIds=function(e,t){var n=e.$model,i=n.ids,r;i.clear();for(r in t)i.claim(r,t[r])};var jy=["c","C"],Vy=["v","V"],Fy=["y","Y"],ff=["z","Z"];function Hy(e){return e.ctrlKey||e.metaKey||e.shiftKey||e.altKey}function Dt(e){return e.altKey?!1:e.ctrlKey||e.metaKey}function tt(e,t){return e=Te(e)?e:[e],e.indexOf(t.key)!==-1||e.indexOf(t.code)!==-1}function Sl(e){return e.shiftKey}function zy(e){return Dt(e)&&tt(jy,e)}function Uy(e){return Dt(e)&&tt(Vy,e)}function Gy(e){return Dt(e)&&!Sl(e)&&tt(ff,e)}function Wy(e){return Dt(e)&&(tt(Fy,e)||tt(ff,e)&&Sl(e))}var va="keyboard.keydown",Yy="keyboard.keyup",mu="input-handle-modified-keys",qy=1e3;function at(e,t){var n=this;this._config=e||{},this._eventBus=t,this._keydownHandler=this._keydownHandler.bind(this),this._keyupHandler=this._keyupHandler.bind(this),t.on("diagram.destroy",function(){n._fire("destroy"),n.unbind()}),t.on("diagram.init",function(){n._fire("init")}),t.on("attach",function(){e&&e.bindTo&&n.bind(e.bindTo)}),t.on("detach",function(){n.unbind()})}at.$inject=["config.keyboard","eventBus"];at.prototype._keydownHandler=function(e){this._keyHandler(e,va)};at.prototype._keyupHandler=function(e){this._keyHandler(e,Yy)};at.prototype._keyHandler=function(e,t){var n;if(!this._isEventIgnored(e)){var i={keyEvent:e};n=this._eventBus.fire(t||va,i),n&&e.preventDefault()}};at.prototype._isEventIgnored=function(e){return e.defaultPrevented?!0:Ky(e.target)&&this._isModifiedKeyIgnored(e)};at.prototype._isModifiedKeyIgnored=function(e){if(!Dt(e))return!0;var t=this._getAllowedModifiers(e.target);return t.indexOf(e.key)===-1};at.prototype._getAllowedModifiers=function(e){var t=Wn(e,"["+mu+"]",!0);return!t||this._node&&!this._node.contains(t)?[]:t.getAttribute(mu).split(",")};at.prototype.bind=function(e){this.unbind(),this._node=e,ce.bind(e,"keydown",this._keydownHandler),ce.bind(e,"keyup",this._keyupHandler),this._fire("bind")};at.prototype.getBinding=function(){return this._node};at.prototype.unbind=function(){var e=this._node;e&&(this._fire("unbind"),ce.unbind(e,"keydown",this._keydownHandler),ce.unbind(e,"keyup",this._keyupHandler)),this._node=null};at.prototype._fire=function(e){this._eventBus.fire("keyboard."+e,{node:this._node})};at.prototype.addListener=function(e,t,n){en(e)&&(n=t,t=e,e=qy),this._eventBus.on(n||va,e,t)};at.prototype.removeListener=function(e,t){this._eventBus.off(t||va,e)};at.prototype.hasModifier=Hy;at.prototype.isCmd=Dt;at.prototype.isShift=Sl;at.prototype.isKey=tt;function Ky(e){return e&&(hl(e,"input, textarea")||e.contentEditable==="true")}var Xy=500;function Xi(e,t){var n=this;e.on("editorActions.init",Xy,function(i){var r=i.editorActions;n.registerBindings(t,r)})}Xi.$inject=["eventBus","keyboard"];Xi.prototype.registerBindings=function(e,t){function n(i,r){t.isRegistered(i)&&e.addListener(r)}n("undo",function(i){var r=i.keyEvent;if(Gy(r))return t.trigger("undo"),!0}),n("redo",function(i){var r=i.keyEvent;if(Wy(r))return t.trigger("redo"),!0}),n("copy",function(i){var r=i.keyEvent;if(zy(r))return t.trigger("copy"),!0}),n("paste",function(i){var r=i.keyEvent;if(Uy(r))return t.trigger("paste"),!0}),n("stepZoom",function(i){var r=i.keyEvent;if(tt(["+","Add","="],r)&&Dt(r))return t.trigger("stepZoom",{value:1}),!0}),n("stepZoom",function(i){var r=i.keyEvent;if(tt(["-","Subtract"],r)&&Dt(r))return t.trigger("stepZoom",{value:-1}),!0}),n("zoom",function(i){var r=i.keyEvent;if(tt("0",r)&&Dt(r))return t.trigger("zoom",{value:1}),!0}),n("removeSelection",function(i){var r=i.keyEvent;if(tt(["Backspace","Delete","Del"],r))return t.trigger("removeSelection"),!0})};const Cl={__init__:["keyboard","keyboardBindings"],keyboard:["type",at],keyboardBindings:["type",Xi]};var Zy={moveSpeed:50,moveSpeedAccelerated:200};function hf(e,t,n){var i=this;this._config=L({},Zy,e||{}),t.addListener(r);function r(o){var a=o.keyEvent,l=i._config;if(t.isCmd(a)&&t.isKey(["ArrowLeft","Left","ArrowUp","Up","ArrowDown","Down","ArrowRight","Right"],a)){var s=t.isShift(a)?l.moveSpeedAccelerated:l.moveSpeed,c;switch(a.key){case"ArrowLeft":case"Left":c="left";break;case"ArrowUp":case"Up":c="up";break;case"ArrowRight":case"Right":c="right";break;case"ArrowDown":case"Down":c="down";break}return i.moveCanvas({speed:s,direction:c}),!0}}this.moveCanvas=function(o){var a=0,l=0,s=o.speed,c=s/Math.min(Math.sqrt(n.viewbox().scale),1);switch(o.direction){case"left":a=c;break;case"up":l=c;break;case"right":a=-c;break;case"down":l=-c;break}n.scroll({dx:a,dy:l})}}hf.$inject=["config.keyboardMove","keyboard","canvas"];const mf={__depends__:[Cl],__init__:["keyboardMove"],keyboardMove:["type",hf]};var Qy=/^djs-cursor-.*$/;function ga(e){var t=Et(document.body);t.removeMatching(Qy),e&&t.add("djs-cursor-"+e)}function vf(){ga(null)}var Jy=5e3;function gf(e,t){t=t||"element.click";function n(){return!1}return e.once(t,Jy,n),function(){e.off(t,n)}}function yr(e){return{x:e.x+e.width/2,y:e.y+e.height/2}}function Ut(e,t){return{x:e.x-t.x,y:e.y-t.y}}var e_=15;function yf(e,t){var n;e.on("element.mousedown",500,function(a){return o(a.originalEvent)});function i(a){var l=n.start,s=n.button,c=Fn(a),p=Ut(c,l);if(!n.dragging&&t_(p)>e_&&(n.dragging=!0,s===0&&gf(e),ga("grab")),n.dragging){var u=n.last||n.start;p=Ut(c,u),t.scroll({dx:p.x,dy:p.y}),n.last=c}a.preventDefault()}function r(a){ce.unbind(document,"mousemove",i),ce.unbind(document,"mouseup",r),n=null,vf()}function o(a){if(!Wn(a.target,".djs-draggable")){var l=a.button;if(!(l>=2||a.ctrlKey||a.shiftKey||a.altKey))return n={button:l,start:Fn(a)},ce.bind(document,"mousemove",i),ce.bind(document,"mouseup",r),!0}}this.isActive=function(){return!!n}}yf.$inject=["eventBus","canvas"];function t_(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}const _f={__init__:["moveCanvas"],moveCanvas:["type",yf]};function Bs(e){return Math.log(e)/Math.log(10)}function bf(e,t){var n=Bs(e.min),i=Bs(e.max),r=Math.abs(n)+Math.abs(i);return r/t}function n_(e,t){return Math.max(e.min,Math.min(e.max,t))}var i_=Math.sign||function(e){return e>=0?1:-1},Tl={min:.2,max:4},Ef=10,r_=.1,o_=.75;function rn(e,t,n){e=e||{},this._enabled=!1,this._canvas=n,this._container=n._container,this._handleWheel=gi(this._handleWheel,this),this._totalDelta=0,this._scale=e.scale||o_;var i=this;t.on("canvas.init",function(r){i._init(e.enabled!==!1)})}rn.$inject=["config.zoomScroll","eventBus","canvas"];rn.prototype.scroll=function(t){this._canvas.scroll(t)};rn.prototype.reset=function(){this._canvas.zoom("fit-viewport")};rn.prototype.zoom=function(t,n){var i=bf(Tl,Ef*2);this._totalDelta+=t,Math.abs(this._totalDelta)>r_&&(this._zoom(t,n,i),this._totalDelta=0)};rn.prototype._handleWheel=function(t){if(!Wn(t.target,".djs-scrollable",!0)){var n=this._container;t.preventDefault();var i=t.ctrlKey||Xv()&&t.metaKey,r=t.shiftKey,o=-1*this._scale,a;if(i?o*=t.deltaMode===0?.02:.32:o*=t.deltaMode===0?1:16,i){var l=n.getBoundingClientRect(),s={x:t.clientX-l.left,y:t.clientY-l.top};a=Math.sqrt(Math.pow(t.deltaY,2)+Math.pow(t.deltaX,2))*i_(t.deltaY)*o,this.zoom(a,s)}else r?a={dx:o*t.deltaY,dy:0}:a={dx:o*t.deltaX,dy:o*t.deltaY},this.scroll(a)}};rn.prototype.stepZoom=function(t,n){var i=bf(Tl,Ef);this._zoom(t,n,i)};rn.prototype._zoom=function(e,t,n){var i=this._canvas,r=e>0?1:-1,o=Bs(i.zoom()),a=Math.round(o/n)*n;a+=n*r;var l=Math.pow(10,a);i.zoom(n_(Tl,l),t)};rn.prototype.toggle=function(t){var n=this._container,i=this._handleWheel,r=this._enabled;return typeof t>"u"&&(t=!r),r!==t&&ce[t?"bind":"unbind"](n,"wheel",i,!1),this._enabled=t,t};rn.prototype._init=function(e){this.toggle(e)};const xf={__init__:["zoomScroll"],zoomScroll:["type",rn]};function Pr(e){Ir.call(this,e)}te(Pr,Ir);Pr.prototype._navigationModules=[mf,_f,xf];Pr.prototype._modules=[].concat(Ir.prototype._modules,Pr.prototype._navigationModules);var wf={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(e){(function(t,n,i,r){var o=["","webkit","Moz","MS","ms","o"],a=n.createElement("div"),l="function",s=Math.round,c=Math.abs,p=Date.now;function u(_,E,P){return setTimeout(w(_,P),E)}function d(_,E,P){return Array.isArray(_)?(f(_,P[E],P),!0):!1}function f(_,E,P){var N;if(_)if(_.forEach)_.forEach(E,P);else if(_.length!==r)for(N=0;N<_.length;)E.call(P,_[N],N,_),N++;else for(N in _)_.hasOwnProperty(N)&&E.call(P,_[N],N,_)}function h(_,E,P){var N="DEPRECATED METHOD: "+E+`
`+P+` AT 
`;return function(){var z=new Error("get-stack-trace"),J=z&&z.stack?z.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Ee=t.console&&(t.console.warn||t.console.log);return Ee&&Ee.call(t.console,N,J),_.apply(this,arguments)}}var m;typeof Object.assign!="function"?m=function(E){if(E===r||E===null)throw new TypeError("Cannot convert undefined or null to object");for(var P=Object(E),N=1;N<arguments.length;N++){var z=arguments[N];if(z!==r&&z!==null)for(var J in z)z.hasOwnProperty(J)&&(P[J]=z[J])}return P}:m=Object.assign;var v=h(function(E,P,N){for(var z=Object.keys(P),J=0;J<z.length;)(!N||N&&E[z[J]]===r)&&(E[z[J]]=P[z[J]]),J++;return E},"extend","Use `assign`."),S=h(function(E,P){return v(E,P,!0)},"merge","Use `assign`.");function b(_,E,P){var N=E.prototype,z;z=_.prototype=Object.create(N),z.constructor=_,z._super=N,P&&m(z,P)}function w(_,E){return function(){return _.apply(E,arguments)}}function C(_,E){return typeof _==l?_.apply(E&&E[0]||r,E):_}function R(_,E){return _===r?E:_}function D(_,E,P){f($(E),function(N){_.addEventListener(N,P,!1)})}function F(_,E,P){f($(E),function(N){_.removeEventListener(N,P,!1)})}function A(_,E){for(;_;){if(_==E)return!0;_=_.parentNode}return!1}function I(_,E){return _.indexOf(E)>-1}function $(_){return _.trim().split(/\s+/g)}function V(_,E,P){if(_.indexOf&&!P)return _.indexOf(E);for(var N=0;N<_.length;){if(P&&_[N][P]==E||!P&&_[N]===E)return N;N++}return-1}function X(_){return Array.prototype.slice.call(_,0)}function U(_,E,P){for(var N=[],z=[],J=0;J<_.length;){var Ee=_[J][E];V(z,Ee)<0&&N.push(_[J]),z[J]=Ee,J++}return N=N.sort(function(ut,gt){return ut[E]>gt[E]}),N}function O(_,E){for(var P,N,z=E[0].toUpperCase()+E.slice(1),J=0;J<o.length;){if(P=o[J],N=P?P+z:E,N in _)return N;J++}return r}var B=1;function q(){return B++}function re(_){var E=_.ownerDocument||_;return E.defaultView||E.parentWindow||t}var ne=/mobile|tablet|ip(ad|hone|od)|android/i,ge="ontouchstart"in t,Le=O(t,"PointerEvent")!==r,Z=ge&&ne.test(navigator.userAgent),pe="touch",oe="pen",De="mouse",lt="kinect",j=25,k=1,ee=2,fe=4,me=8,K=1,he=2,Ie=4,ct=8,Ht=16,ke=he|Ie,Fe=ct|Ht,oi=ke|Fe,Di=["x","y"],Rn=["clientX","clientY"];function ft(_,E){var P=this;this.manager=_,this.callback=E,this.element=_.element,this.target=_.options.inputTarget,this.domHandler=function(N){C(_.options.enable,[_])&&P.handler(N)},this.init()}ft.prototype={handler:function(){},init:function(){this.evEl&&D(this.element,this.evEl,this.domHandler),this.evTarget&&D(this.target,this.evTarget,this.domHandler),this.evWin&&D(re(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&F(this.element,this.evEl,this.domHandler),this.evTarget&&F(this.target,this.evTarget,this.domHandler),this.evWin&&F(re(this.element),this.evWin,this.domHandler)}};function ar(_){var E,P=_.options.inputClass;return P?E=P:Le?E=ns:Z?E=so:ge?E=is:E=ao,new E(_,Ze)}function Ze(_,E,P){var N=P.pointers.length,z=P.changedPointers.length,J=E&k&&N-z===0,Ee=E&(fe|me)&&N-z===0;P.isFirst=!!J,P.isFinal=!!Ee,J&&(_.session={}),P.eventType=E,Dn(_,P),_.emit("hammer.input",P),_.recognize(P),_.session.prevInput=P}function Dn(_,E){var P=_.session,N=E.pointers,z=N.length;P.firstInput||(P.firstInput=io(E)),z>1&&!P.firstMultiple?P.firstMultiple=io(E):z===1&&(P.firstMultiple=!1);var J=P.firstInput,Ee=P.firstMultiple,it=Ee?Ee.center:J.center,ut=E.center=ro(N);E.timeStamp=p(),E.deltaTime=E.timeStamp-J.timeStamp,E.angle=ts(it,ut),E.distance=oo(it,ut),$e(P,E),E.offsetDirection=Xc(E.deltaX,E.deltaY);var gt=se(E.deltaTime,E.deltaX,E.deltaY);E.overallVelocityX=gt.x,E.overallVelocityY=gt.y,E.overallVelocity=c(gt.x)>c(gt.y)?gt.x:gt.y,E.scale=Ee?ev(Ee.pointers,N):1,E.rotation=Ee?Jm(Ee.pointers,N):0,E.maxPointers=P.prevInput?E.pointers.length>P.prevInput.maxPointers?E.pointers.length:P.prevInput.maxPointers:E.pointers.length,ai(P,E);var Xt=_.element;A(E.srcEvent.target,Xt)&&(Xt=E.srcEvent.target),E.target=Xt}function $e(_,E){var P=E.center,N=_.offsetDelta||{},z=_.prevDelta||{},J=_.prevInput||{};(E.eventType===k||J.eventType===fe)&&(z=_.prevDelta={x:J.deltaX||0,y:J.deltaY||0},N=_.offsetDelta={x:P.x,y:P.y}),E.deltaX=z.x+(P.x-N.x),E.deltaY=z.y+(P.y-N.y)}function ai(_,E){var P=_.lastInterval||E,N=E.timeStamp-P.timeStamp,z,J,Ee,it;if(E.eventType!=me&&(N>j||P.velocity===r)){var ut=E.deltaX-P.deltaX,gt=E.deltaY-P.deltaY,Xt=se(N,ut,gt);J=Xt.x,Ee=Xt.y,z=c(Xt.x)>c(Xt.y)?Xt.x:Xt.y,it=Xc(ut,gt),_.lastInterval=E}else z=P.velocity,J=P.velocityX,Ee=P.velocityY,it=P.direction;E.velocity=z,E.velocityX=J,E.velocityY=Ee,E.direction=it}function io(_){for(var E=[],P=0;P<_.pointers.length;)E[P]={clientX:s(_.pointers[P].clientX),clientY:s(_.pointers[P].clientY)},P++;return{timeStamp:p(),pointers:E,center:ro(E),deltaX:_.deltaX,deltaY:_.deltaY}}function ro(_){var E=_.length;if(E===1)return{x:s(_[0].clientX),y:s(_[0].clientY)};for(var P=0,N=0,z=0;z<E;)P+=_[z].clientX,N+=_[z].clientY,z++;return{x:s(P/E),y:s(N/E)}}function se(_,E,P){return{x:E/_||0,y:P/_||0}}function Xc(_,E){return _===E?K:c(_)>=c(E)?_<0?he:Ie:E<0?ct:Ht}function oo(_,E,P){P||(P=Di);var N=E[P[0]]-_[P[0]],z=E[P[1]]-_[P[1]];return Math.sqrt(N*N+z*z)}function ts(_,E,P){P||(P=Di);var N=E[P[0]]-_[P[0]],z=E[P[1]]-_[P[1]];return Math.atan2(z,N)*180/Math.PI}function Jm(_,E){return ts(E[1],E[0],Rn)+ts(_[1],_[0],Rn)}function ev(_,E){return oo(E[0],E[1],Rn)/oo(_[0],_[1],Rn)}var tv={mousedown:k,mousemove:ee,mouseup:fe},nv="mousedown",iv="mousemove mouseup";function ao(){this.evEl=nv,this.evWin=iv,this.pressed=!1,ft.apply(this,arguments)}b(ao,ft,{handler:function(E){var P=tv[E.type];P&k&&E.button===0&&(this.pressed=!0),P&ee&&E.which!==1&&(P=fe),this.pressed&&(P&fe&&(this.pressed=!1),this.callback(this.manager,P,{pointers:[E],changedPointers:[E],pointerType:De,srcEvent:E}))}});var rv={pointerdown:k,pointermove:ee,pointerup:fe,pointercancel:me,pointerout:me},ov={2:pe,3:oe,4:De,5:lt},Zc="pointerdown",Qc="pointermove pointerup pointercancel";t.MSPointerEvent&&!t.PointerEvent&&(Zc="MSPointerDown",Qc="MSPointerMove MSPointerUp MSPointerCancel");function ns(){this.evEl=Zc,this.evWin=Qc,ft.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}b(ns,ft,{handler:function(E){var P=this.store,N=!1,z=E.type.toLowerCase().replace("ms",""),J=rv[z],Ee=ov[E.pointerType]||E.pointerType,it=Ee==pe,ut=V(P,E.pointerId,"pointerId");J&k&&(E.button===0||it)?ut<0&&(P.push(E),ut=P.length-1):J&(fe|me)&&(N=!0),!(ut<0)&&(P[ut]=E,this.callback(this.manager,J,{pointers:P,changedPointers:[E],pointerType:Ee,srcEvent:E}),N&&P.splice(ut,1))}});var av={touchstart:k,touchmove:ee,touchend:fe,touchcancel:me},sv="touchstart",lv="touchstart touchmove touchend touchcancel";function Jc(){this.evTarget=sv,this.evWin=lv,this.started=!1,ft.apply(this,arguments)}b(Jc,ft,{handler:function(E){var P=av[E.type];if(P===k&&(this.started=!0),!!this.started){var N=cv.call(this,E,P);P&(fe|me)&&N[0].length-N[1].length===0&&(this.started=!1),this.callback(this.manager,P,{pointers:N[0],changedPointers:N[1],pointerType:pe,srcEvent:E})}}});function cv(_,E){var P=X(_.touches),N=X(_.changedTouches);return E&(fe|me)&&(P=U(P.concat(N),"identifier")),[P,N]}var uv={touchstart:k,touchmove:ee,touchend:fe,touchcancel:me},pv="touchstart touchmove touchend touchcancel";function so(){this.evTarget=pv,this.targetIds={},ft.apply(this,arguments)}b(so,ft,{handler:function(E){var P=uv[E.type],N=dv.call(this,E,P);N&&this.callback(this.manager,P,{pointers:N[0],changedPointers:N[1],pointerType:pe,srcEvent:E})}});function dv(_,E){var P=X(_.touches),N=this.targetIds;if(E&(k|ee)&&P.length===1)return N[P[0].identifier]=!0,[P,P];var z,J,Ee=X(_.changedTouches),it=[],ut=this.target;if(J=P.filter(function(gt){return A(gt.target,ut)}),E===k)for(z=0;z<J.length;)N[J[z].identifier]=!0,z++;for(z=0;z<Ee.length;)N[Ee[z].identifier]&&it.push(Ee[z]),E&(fe|me)&&delete N[Ee[z].identifier],z++;if(it.length)return[U(J.concat(it),"identifier"),it]}var fv=2500,eu=25;function is(){ft.apply(this,arguments);var _=w(this.handler,this);this.touch=new so(this.manager,_),this.mouse=new ao(this.manager,_),this.primaryTouch=null,this.lastTouches=[]}b(is,ft,{handler:function(E,P,N){var z=N.pointerType==pe,J=N.pointerType==De;if(!(J&&N.sourceCapabilities&&N.sourceCapabilities.firesTouchEvents)){if(z)hv.call(this,P,N);else if(J&&mv.call(this,N))return;this.callback(E,P,N)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function hv(_,E){_&k?(this.primaryTouch=E.changedPointers[0].identifier,tu.call(this,E)):_&(fe|me)&&tu.call(this,E)}function tu(_){var E=_.changedPointers[0];if(E.identifier===this.primaryTouch){var P={x:E.clientX,y:E.clientY};this.lastTouches.push(P);var N=this.lastTouches,z=function(){var J=N.indexOf(P);J>-1&&N.splice(J,1)};setTimeout(z,fv)}}function mv(_){for(var E=_.srcEvent.clientX,P=_.srcEvent.clientY,N=0;N<this.lastTouches.length;N++){var z=this.lastTouches[N],J=Math.abs(E-z.x),Ee=Math.abs(P-z.y);if(J<=eu&&Ee<=eu)return!0}return!1}var nu=O(a.style,"touchAction"),iu=nu!==r,ru="compute",ou="auto",rs="manipulation",si="none",sr="pan-x",lr="pan-y",lo=gv();function os(_,E){this.manager=_,this.set(E)}os.prototype={set:function(_){_==ru&&(_=this.compute()),iu&&this.manager.element.style&&lo[_]&&(this.manager.element.style[nu]=_),this.actions=_.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var _=[];return f(this.manager.recognizers,function(E){C(E.options.enable,[E])&&(_=_.concat(E.getTouchAction()))}),vv(_.join(" "))},preventDefaults:function(_){var E=_.srcEvent,P=_.offsetDirection;if(this.manager.session.prevented){E.preventDefault();return}var N=this.actions,z=I(N,si)&&!lo[si],J=I(N,lr)&&!lo[lr],Ee=I(N,sr)&&!lo[sr];if(z){var it=_.pointers.length===1,ut=_.distance<2,gt=_.deltaTime<250;if(it&&ut&&gt)return}if(!(Ee&&J)&&(z||J&&P&ke||Ee&&P&Fe))return this.preventSrc(E)},preventSrc:function(_){this.manager.session.prevented=!0,_.preventDefault()}};function vv(_){if(I(_,si))return si;var E=I(_,sr),P=I(_,lr);return E&&P?si:E||P?E?sr:lr:I(_,rs)?rs:ou}function gv(){if(!iu)return!1;var _={},E=t.CSS&&t.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(P){_[P]=E?t.CSS.supports("touch-action",P):!0}),_}var co=1,At=2,ki=4,kn=8,sn=kn,cr=16,Kt=32;function ln(_){this.options=m({},this.defaults,_||{}),this.id=q(),this.manager=null,this.options.enable=R(this.options.enable,!0),this.state=co,this.simultaneous={},this.requireFail=[]}ln.prototype={defaults:{},set:function(_){return m(this.options,_),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(_){if(d(_,"recognizeWith",this))return this;var E=this.simultaneous;return _=uo(_,this),E[_.id]||(E[_.id]=_,_.recognizeWith(this)),this},dropRecognizeWith:function(_){return d(_,"dropRecognizeWith",this)?this:(_=uo(_,this),delete this.simultaneous[_.id],this)},requireFailure:function(_){if(d(_,"requireFailure",this))return this;var E=this.requireFail;return _=uo(_,this),V(E,_)===-1&&(E.push(_),_.requireFailure(this)),this},dropRequireFailure:function(_){if(d(_,"dropRequireFailure",this))return this;_=uo(_,this);var E=V(this.requireFail,_);return E>-1&&this.requireFail.splice(E,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(_){return!!this.simultaneous[_.id]},emit:function(_){var E=this,P=this.state;function N(z){E.manager.emit(z,_)}P<kn&&N(E.options.event+au(P)),N(E.options.event),_.additionalEvent&&N(_.additionalEvent),P>=kn&&N(E.options.event+au(P))},tryEmit:function(_){if(this.canEmit())return this.emit(_);this.state=Kt},canEmit:function(){for(var _=0;_<this.requireFail.length;){if(!(this.requireFail[_].state&(Kt|co)))return!1;_++}return!0},recognize:function(_){var E=m({},_);if(!C(this.options.enable,[this,E])){this.reset(),this.state=Kt;return}this.state&(sn|cr|Kt)&&(this.state=co),this.state=this.process(E),this.state&(At|ki|kn|cr)&&this.tryEmit(E)},process:function(_){},getTouchAction:function(){},reset:function(){}};function au(_){return _&cr?"cancel":_&kn?"end":_&ki?"move":_&At?"start":""}function su(_){return _==Ht?"down":_==ct?"up":_==he?"left":_==Ie?"right":""}function uo(_,E){var P=E.manager;return P?P.get(_):_}function zt(){ln.apply(this,arguments)}b(zt,ln,{defaults:{pointers:1},attrTest:function(_){var E=this.options.pointers;return E===0||_.pointers.length===E},process:function(_){var E=this.state,P=_.eventType,N=E&(At|ki),z=this.attrTest(_);return N&&(P&me||!z)?E|cr:N||z?P&fe?E|kn:E&At?E|ki:At:Kt}});function po(){zt.apply(this,arguments),this.pX=null,this.pY=null}b(po,zt,{defaults:{event:"pan",threshold:10,pointers:1,direction:oi},getTouchAction:function(){var _=this.options.direction,E=[];return _&ke&&E.push(lr),_&Fe&&E.push(sr),E},directionTest:function(_){var E=this.options,P=!0,N=_.distance,z=_.direction,J=_.deltaX,Ee=_.deltaY;return z&E.direction||(E.direction&ke?(z=J===0?K:J<0?he:Ie,P=J!=this.pX,N=Math.abs(_.deltaX)):(z=Ee===0?K:Ee<0?ct:Ht,P=Ee!=this.pY,N=Math.abs(_.deltaY))),_.direction=z,P&&N>E.threshold&&z&E.direction},attrTest:function(_){return zt.prototype.attrTest.call(this,_)&&(this.state&At||!(this.state&At)&&this.directionTest(_))},emit:function(_){this.pX=_.deltaX,this.pY=_.deltaY;var E=su(_.direction);E&&(_.additionalEvent=this.options.event+E),this._super.emit.call(this,_)}});function as(){zt.apply(this,arguments)}b(as,zt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[si]},attrTest:function(_){return this._super.attrTest.call(this,_)&&(Math.abs(_.scale-1)>this.options.threshold||this.state&At)},emit:function(_){if(_.scale!==1){var E=_.scale<1?"in":"out";_.additionalEvent=this.options.event+E}this._super.emit.call(this,_)}});function ss(){ln.apply(this,arguments),this._timer=null,this._input=null}b(ss,ln,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[ou]},process:function(_){var E=this.options,P=_.pointers.length===E.pointers,N=_.distance<E.threshold,z=_.deltaTime>E.time;if(this._input=_,!N||!P||_.eventType&(fe|me)&&!z)this.reset();else if(_.eventType&k)this.reset(),this._timer=u(function(){this.state=sn,this.tryEmit()},E.time,this);else if(_.eventType&fe)return sn;return Kt},reset:function(){clearTimeout(this._timer)},emit:function(_){this.state===sn&&(_&&_.eventType&fe?this.manager.emit(this.options.event+"up",_):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}});function ls(){zt.apply(this,arguments)}b(ls,zt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[si]},attrTest:function(_){return this._super.attrTest.call(this,_)&&(Math.abs(_.rotation)>this.options.threshold||this.state&At)}});function cs(){zt.apply(this,arguments)}b(cs,zt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:ke|Fe,pointers:1},getTouchAction:function(){return po.prototype.getTouchAction.call(this)},attrTest:function(_){var E=this.options.direction,P;return E&(ke|Fe)?P=_.overallVelocity:E&ke?P=_.overallVelocityX:E&Fe&&(P=_.overallVelocityY),this._super.attrTest.call(this,_)&&E&_.offsetDirection&&_.distance>this.options.threshold&&_.maxPointers==this.options.pointers&&c(P)>this.options.velocity&&_.eventType&fe},emit:function(_){var E=su(_.offsetDirection);E&&this.manager.emit(this.options.event+E,_),this.manager.emit(this.options.event,_)}});function fo(){ln.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}b(fo,ln,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[rs]},process:function(_){var E=this.options,P=_.pointers.length===E.pointers,N=_.distance<E.threshold,z=_.deltaTime<E.time;if(this.reset(),_.eventType&k&&this.count===0)return this.failTimeout();if(N&&z&&P){if(_.eventType!=fe)return this.failTimeout();var J=this.pTime?_.timeStamp-this.pTime<E.interval:!0,Ee=!this.pCenter||oo(this.pCenter,_.center)<E.posThreshold;this.pTime=_.timeStamp,this.pCenter=_.center,!Ee||!J?this.count=1:this.count+=1,this._input=_;var it=this.count%E.taps;if(it===0)return this.hasRequireFailures()?(this._timer=u(function(){this.state=sn,this.tryEmit()},E.interval,this),At):sn}return Kt},failTimeout:function(){return this._timer=u(function(){this.state=Kt},this.options.interval,this),Kt},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==sn&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function An(_,E){return E=E||{},E.recognizers=R(E.recognizers,An.defaults.preset),new us(_,E)}An.VERSION="2.0.7",An.defaults={domEvents:!1,touchAction:ru,enable:!0,inputTarget:null,inputClass:null,preset:[[ls,{enable:!1}],[as,{enable:!1},["rotate"]],[cs,{direction:ke}],[po,{direction:ke},["swipe"]],[fo],[fo,{event:"doubletap",taps:2},["tap"]],[ss]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var yv=1,lu=2;function us(_,E){this.options=m({},An.defaults,E||{}),this.options.inputTarget=this.options.inputTarget||_,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=_,this.input=ar(this),this.touchAction=new os(this,this.options.touchAction),cu(this,!0),f(this.options.recognizers,function(P){var N=this.add(new P[0](P[1]));P[2]&&N.recognizeWith(P[2]),P[3]&&N.requireFailure(P[3])},this)}us.prototype={set:function(_){return m(this.options,_),_.touchAction&&this.touchAction.update(),_.inputTarget&&(this.input.destroy(),this.input.target=_.inputTarget,this.input.init()),this},stop:function(_){this.session.stopped=_?lu:yv},recognize:function(_){var E=this.session;if(!E.stopped){this.touchAction.preventDefaults(_);var P,N=this.recognizers,z=E.curRecognizer;(!z||z&&z.state&sn)&&(z=E.curRecognizer=null);for(var J=0;J<N.length;)P=N[J],E.stopped!==lu&&(!z||P==z||P.canRecognizeWith(z))?P.recognize(_):P.reset(),!z&&P.state&(At|ki|kn)&&(z=E.curRecognizer=P),J++}},get:function(_){if(_ instanceof ln)return _;for(var E=this.recognizers,P=0;P<E.length;P++)if(E[P].options.event==_)return E[P];return null},add:function(_){if(d(_,"add",this))return this;var E=this.get(_.options.event);return E&&this.remove(E),this.recognizers.push(_),_.manager=this,this.touchAction.update(),_},remove:function(_){if(d(_,"remove",this))return this;if(_=this.get(_),_){var E=this.recognizers,P=V(E,_);P!==-1&&(E.splice(P,1),this.touchAction.update())}return this},on:function(_,E){if(_!==r&&E!==r){var P=this.handlers;return f($(_),function(N){P[N]=P[N]||[],P[N].push(E)}),this}},off:function(_,E){if(_!==r){var P=this.handlers;return f($(_),function(N){E?P[N]&&P[N].splice(V(P[N],E),1):delete P[N]}),this}},emit:function(_,E){this.options.domEvents&&_v(_,E);var P=this.handlers[_]&&this.handlers[_].slice();if(!(!P||!P.length)){E.type=_,E.preventDefault=function(){E.srcEvent.preventDefault()};for(var N=0;N<P.length;)P[N](E),N++}},destroy:function(){this.element&&cu(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function cu(_,E){var P=_.element;if(P.style){var N;f(_.options.cssProps,function(z,J){N=O(P.style,J),E?(_.oldCssProps[N]=P.style[N],P.style[N]=z):P.style[N]=_.oldCssProps[N]||""}),E||(_.oldCssProps={})}}function _v(_,E){var P=n.createEvent("Event");P.initEvent(_,!0,!0),P.gesture=E,E.target.dispatchEvent(P)}m(An,{INPUT_START:k,INPUT_MOVE:ee,INPUT_END:fe,INPUT_CANCEL:me,STATE_POSSIBLE:co,STATE_BEGAN:At,STATE_CHANGED:ki,STATE_ENDED:kn,STATE_RECOGNIZED:sn,STATE_CANCELLED:cr,STATE_FAILED:Kt,DIRECTION_NONE:K,DIRECTION_LEFT:he,DIRECTION_RIGHT:Ie,DIRECTION_UP:ct,DIRECTION_DOWN:Ht,DIRECTION_HORIZONTAL:ke,DIRECTION_VERTICAL:Fe,DIRECTION_ALL:oi,Manager:us,Input:ft,TouchAction:os,TouchInput:so,MouseInput:ao,PointerEventInput:ns,TouchMouseInput:is,SingleTouchInput:Jc,Recognizer:ln,AttrRecognizer:zt,Tap:fo,Pan:po,Swipe:cs,Pinch:as,Rotate:ls,Press:ss,on:D,off:F,each:f,merge:S,extend:v,assign:m,inherit:b,bindFn:w,prefixed:O});var bv=typeof t<"u"?t:typeof self<"u"?self:{};bv.Hammer=An,e.exports?e.exports=An:t[i]=An})(window,document,"Hammer")})(wf);var a_=wf.exports;const ci=Av(a_);var s_=.2,l_=4,vu=["mousedown","mouseup","mouseover","mouseout","click","dblclick"];function ho(e,t){return t.get(e,!1)}function js(e){e.preventDefault(),typeof e.stopPropagation=="function"?e.stopPropagation():e.srcEvent&&typeof e.srcEvent.stopPropagation=="function"&&e.srcEvent.stopPropagation(),typeof e.stopImmediatePropagation=="function"&&e.stopImmediatePropagation()}function ds(e){function t(c){M(vu,function(p){ce.bind(e,p,js,!0)})}function n(c){setTimeout(function(){M(vu,function(p){ce.unbind(e,p,js,!0)})},500)}ce.bind(e,"touchstart",t,!0),ce.bind(e,"touchend",n,!0),ce.bind(e,"touchcancel",n,!0);var i=new ci.Manager(e,{inputClass:ci.TouchInput,recognizers:[],domEvents:!0}),r=new ci.Tap,o=new ci.Pan({threshold:10}),a=new ci.Press,l=new ci.Pinch,s=new ci.Tap({event:"doubletap",taps:2});return l.requireFailure(o),l.requireFailure(a),i.add([o,a,l,s,r]),i.reset=function(c){var p=this.recognizers,u=this.session;u.stopped||(i.stop(c),setTimeout(function(){var d,f;for(d=0;f=p[d];d++)f.reset(),f.state=8;u.curRecognizer=null},0))},i.on("hammer.input",function(c){c.srcEvent.defaultPrevented&&i.reset(!0)}),i}function Sf(e,t,n,i,r){var o=ho("dragging",e),a=ho("move",e),l=ho("contextPad",e),s=ho("palette",e),c;function p(f,h){return function(m){var v=u(m.target),S=v&&i.get(v);return h&&(m.srcEvent.button=h),r.fire(f,m,S)}}function u(f){var h=Wn(f,"svg, .djs-element",!0);return h}function d(f){c=ds(f);function h(S){var b=0,w=0;function C(D){var F=D.deltaX-b,A=D.deltaY-w;t.scroll({dx:F,dy:A}),b=D.deltaX,w=D.deltaY}function R(D){c.off("panmove",C),c.off("panend",R),c.off("pancancel",R)}c.on("panmove",C),c.on("panend",R),c.on("pancancel",R)}function m(S){var b=u(S.target),w=b&&i.get(b);if(a&&t.getRootElement()!==w)return a.start(S,w,!0);h()}function v(S){var b=t.zoom(),w=S.center;function C(D){var F=1-(1-D.scale)/1.5,A=Math.max(s_,Math.min(l_,F*b));t.zoom(A,w),js(D)}function R(D){c.off("pinchmove",C),c.off("pinchend",R),c.off("pinchcancel",R),c.reset(!0)}c.on("pinchmove",C),c.on("pinchend",R),c.on("pinchcancel",R)}c.on("tap",p("element.click")),c.on("doubletap",p("element.dblclick",1)),c.on("panstart",m),c.on("press",m),c.on("pinchstart",v)}o&&n.on("drag.move",function(f){var h=f.originalEvent;if(!(!h||h instanceof MouseEvent)){var m=Fn(h),v=document.elementFromPoint(m.x,m.y),S=u(v),b=S&&i.get(S);b!==f.hover&&(f.hover&&o.out(f),b&&(o.hover({element:b,gfx:S}),f.hover=b,f.hoverGfx=S))}}),l&&n.on("contextPad.create",function(f){var h=f.pad.html,m=ds(h);m.on("panstart",function(v){l.trigger("dragstart",v,!0)}),m.on("press",function(v){l.trigger("dragstart",v,!0)}),m.on("tap",function(v){l.trigger("click",v)})}),s&&n.on("palette.create",function(f){var h=f.container,m=ds(h);m.on("panstart",function(v){s.trigger("dragstart",v,!0)}),m.on("press",function(v){s.trigger("dragstart",v,!0)}),m.on("tap",function(v){s.trigger("click",v)})}),n.on("canvas.init",function(f){d(f.svg)})}Sf.$inject=["injector","canvas","eventBus","elementRegistry","interactionEvents","touchFix"];function Pl(e){var t=this;e.on("canvas.init",function(n){t.addBBoxMarker(n.svg)})}Pl.$inject=["eventBus"];Pl.prototype.addBBoxMarker=function(e){var t={fill:"none",class:"outer-bound-marker"},n=be("rect");ie(n,{x:-1e4,y:1e4,width:10,height:10}),ie(n,t),Ce(e,n);var i=be("rect");ie(i,{x:1e4,y:1e4,width:10,height:10}),ie(i,t),Ce(e,i)};const c_={__depends__:[ml],__init__:["touchInteractionEvents"],touchInteractionEvents:["type",Sf],touchFix:["type",Pl]},u_={__depends__:[c_]};function fs(e){return e&&e[e.length-1]}function gu(e){return e.y}function yu(e){return e.x}var p_={left:yu,center:yu,right:function(e){return e.x+e.width},top:gu,middle:gu,bottom:function(e){return e.y+e.height}};function Zi(e,t){this._modeling=e,this._rules=t}Zi.$inject=["modeling","rules"];Zi.prototype._getOrientationDetails=function(e){var t=["top","bottom","middle"],n="x",i="width";return t.indexOf(e)!==-1&&(n="y",i="height"),{axis:n,dimension:i}};Zi.prototype._isType=function(e,t){return t.indexOf(e)!==-1};Zi.prototype._alignmentPosition=function(e,t){var n=this._getOrientationDetails(e),i=n.axis,r=n.dimension,o={},a={},l=!1,s,c,p;function u(d,f){return Math.round((d[i]+f[i]+f[r])/2)}if(this._isType(e,["left","top"]))o[e]=t[0][i];else if(this._isType(e,["right","bottom"]))p=fs(t),o[e]=p[i]+p[r];else if(this._isType(e,["center","middle"])){if(M(t,function(d){var f=d[i]+Math.round(d[r]/2);a[f]?a[f].elements.push(d):a[f]={elements:[d],center:f}}),s=tn(a,function(d){return d.elements.length>1&&(l=!0),d.elements.length}),l)return o[e]=fs(s).center,o;c=t[0],t=tn(t,function(d){return d[i]+d[r]}),p=fs(t),o[e]=u(c,p)}return o};Zi.prototype.trigger=function(e,t){var n=this._modeling,i,r=_e(e,function(s){return!(s.waypoints||s.host||s.labelTarget)});if(i=this._rules.allowed("elements.align",{elements:r}),Te(i)&&(r=i),!(r.length<2||!i)){var o=p_[t],a=tn(r,o),l=this._alignmentPosition(t,a);n.alignElements(a,l)}};const d_={__init__:["alignElements"],alignElements:["type",Zi]};var mo=".entry",f_=1e3,_u=12,h_=300;function xt(e,t,n,i){this._canvas=e,this._eventBus=n,this._overlays=i;var r=Ct(t&&t.scale)?t.scale:{min:1,max:1.5};this._overlaysConfig={scale:r},this._current=null,this._init()}xt.$inject=["canvas","config.contextPad","eventBus","overlays"];xt.prototype._init=function(){var e=this;this._eventBus.on("selection.changed",function(t){var n=t.newSelection,i=n.length?n.length===1?n[0]:n:null;i?e.open(i,!0):e.close()}),this._eventBus.on("elements.changed",function(t){var n=t.elements,i=e._current;if(i){var r=i.target,o=Ki(Te(r)?r:[r],function(a){return Cf(n,a)});o&&e.open(r,!0)}})};xt.prototype.registerProvider=function(e,t){t||(t=e,e=f_),this._eventBus.on("contextPad.getProviders",e,function(n){n.providers.push(t)})};xt.prototype.getEntries=function(e){var t=this._getProviders(),n=Te(e)?"getMultiElementContextPadEntries":"getContextPadEntries",i={};return M(t,function(r){if(en(r[n])){var o=r[n](e);en(o)?i=o(i):M(o,function(a,l){i[l]=a})}}),i};xt.prototype.trigger=function(e,t,n){var i,r,o=t.delegateTarget||t.target;return o?(i=_t(o,"data-action"),r=t.originalEvent||t,e==="mouseover"?this._timeout=setTimeout(()=>{this._mouseout=this.triggerEntry(i,"hover",r,n)},h_):e==="mouseout"&&(clearTimeout(this._timeout),this._mouseout&&(this._mouseout(),this._mouseout=null)),this.triggerEntry(i,e,r,n)):t.preventDefault()};xt.prototype.triggerEntry=function(e,t,n,i){if(this.isShown()){var r=this._current.target,o=this._current.entries,a=o[e];if(a){var l=a.action;if(this._eventBus.fire("contextPad.trigger",{entry:a,event:n})!==!1){if(en(l)){if(t==="click")return l(n,r,i)}else if(l[t])return l[t](n,r,i);n.preventDefault()}}}};xt.prototype.open=function(e,t){!t&&this.isOpen(e)||(this.close(),this._updateAndOpen(e))};xt.prototype._getProviders=function(){var e=this._eventBus.createEvent({type:"contextPad.getProviders",providers:[]});return this._eventBus.fire(e),e.providers};xt.prototype._updateAndOpen=function(e){var t=this.getEntries(e),n=this.getPad(e),i=n.html,r;M(t,function(o,a){var l=o.group||"default",s=ot(o.html||'<div class="entry" draggable="true"></div>'),c;_t(s,"data-action",a),c=nt("[data-group="+Sr(l)+"]",i),c||(c=ot('<div class="group"></div>'),_t(c,"data-group",l),i.appendChild(c)),c.appendChild(s),o.className&&m_(s,o.className),o.title&&_t(s,"title",o.title),o.imageUrl&&(r=ot("<img>"),_t(r,"src",o.imageUrl),r.style.width="100%",r.style.height="100%",s.appendChild(r))}),Et(i).add("open"),this._current={target:e,entries:t,pad:n},this._eventBus.fire("contextPad.open",{current:this._current})};xt.prototype.getPad=function(e){if(this.isOpen())return this._current.pad;var t=this,n=this._overlays,i=ot('<div class="djs-context-pad"></div>'),r=this._getPosition(e),o=L({html:i},this._overlaysConfig,r);Rt.bind(i,mo,"click",function(s){t.trigger("click",s)}),Rt.bind(i,mo,"dragstart",function(s){t.trigger("dragstart",s)}),Rt.bind(i,mo,"mouseover",function(s){t.trigger("mouseover",s)}),Rt.bind(i,mo,"mouseout",function(s){t.trigger("mouseout",s)}),ce.bind(i,"mousedown",function(s){s.stopPropagation()});var a=this._canvas.getRootElement();this._overlayId=n.add(a,"context-pad",o);var l=n.get(this._overlayId);return this._eventBus.fire("contextPad.create",{target:e,pad:l}),l};xt.prototype.close=function(){this.isOpen()&&(clearTimeout(this._timeout),this._overlays.remove(this._overlayId),this._overlayId=null,this._eventBus.fire("contextPad.close",{current:this._current}),this._current=null)};xt.prototype.isOpen=function(e){var t=this._current;if(!t)return!1;if(!e)return!0;var n=t.target;return Te(e)!==Te(n)?!1:Te(e)?e.length===n.length&&vl(e,function(i){return Cf(n,i)}):n===e};xt.prototype.isShown=function(){return this.isOpen()&&this._overlays.isShown()};xt.prototype._getPosition=function(e){e=Ae(e)?v_(e):e;var t=Te(e)?e:[e],n=Tt(t);return{position:{left:n.x+n.width+_u,top:n.y-_u/2}}};function m_(e,t){var n=Et(e);t=Te(t)?t:t.split(/\s+/g),t.forEach(function(i){n.add(i)})}function Cf(e,t){return e.indexOf(t)!==-1}function v_(e){return e.waypoints[e.waypoints.length-1]}const Tf={__depends__:[ml,qd],contextPad:["type",xt]};var ya,Be,Pf,fi,bu,Rf,Vs,Rr={},Df=[],g_=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Rl=Array.isArray;function jn(e,t){for(var n in t)e[n]=t[n];return e}function kf(e){var t=e.parentNode;t&&t.removeChild(e)}function Af(e,t,n){var i,r,o,a={};for(o in t)o=="key"?i=t[o]:o=="ref"?r=t[o]:a[o]=t[o];if(arguments.length>2&&(a.children=arguments.length>3?ya.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(o in e.defaultProps)a[o]===void 0&&(a[o]=e.defaultProps[o]);return $o(e,a,i,r,null)}function $o(e,t,n,i,r){var o={type:e,props:t,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:r??++Pf,__i:-1,__u:0};return r==null&&Be.vnode!=null&&Be.vnode(o),o}function _a(e){return e.children}function Bo(e,t){this.props=e,this.context=t}function Ui(e,t){if(t==null)return e.__?Ui(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?Ui(e):null}function Mf(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return Mf(e)}}function Eu(e){(!e.__d&&(e.__d=!0)&&fi.push(e)&&!Ko.__r++||bu!==Be.debounceRendering)&&((bu=Be.debounceRendering)||Rf)(Ko)}function Ko(){var e,t,n,i,r,o,a,l,s;for(fi.sort(Vs);e=fi.shift();)e.__d&&(t=fi.length,i=void 0,o=(r=(n=e).__v).__e,l=[],s=[],(a=n.__P)&&((i=jn({},r)).__v=r.__v+1,Be.vnode&&Be.vnode(i),Dl(a,i,r,n.__n,a.ownerSVGElement!==void 0,32&r.__u?[o]:null,l,o??Ui(r),!!(32&r.__u),s),i.__v=r.__v,i.__.__k[i.__i]=i,Of(l,i,s),i.__e!=o&&Mf(i)),fi.length>t&&fi.sort(Vs));Ko.__r=0}function If(e,t,n,i,r,o,a,l,s,c,p){var u,d,f,h,m,v=i&&i.__k||Df,S=t.length;for(n.__d=s,y_(n,t,v),s=n.__d,u=0;u<S;u++)(f=n.__k[u])!=null&&typeof f!="boolean"&&typeof f!="function"&&(d=f.__i===-1?Rr:v[f.__i]||Rr,f.__i=u,Dl(e,f,d,r,o,a,l,s,c,p),h=f.__e,f.ref&&d.ref!=f.ref&&(d.ref&&kl(d.ref,null,f),p.push(f.ref,f.__c||h,f)),m==null&&h!=null&&(m=h),65536&f.__u||d.__k===f.__k?s=Nf(f,s,e):typeof f.type=="function"&&f.__d!==void 0?s=f.__d:h&&(s=h.nextSibling),f.__d=void 0,f.__u&=-196609);n.__d=s,n.__e=m}function y_(e,t,n){var i,r,o,a,l,s=t.length,c=n.length,p=c,u=0;for(e.__k=[],i=0;i<s;i++)a=i+u,(r=e.__k[i]=(r=t[i])==null||typeof r=="boolean"||typeof r=="function"?null:typeof r=="string"||typeof r=="number"||typeof r=="bigint"||r.constructor==String?$o(null,r,null,null,null):Rl(r)?$o(_a,{children:r},null,null,null):r.constructor===void 0&&r.__b>0?$o(r.type,r.props,r.key,r.ref?r.ref:null,r.__v):r)!=null?(r.__=e,r.__b=e.__b+1,l=__(r,n,a,p),r.__i=l,o=null,l!==-1&&(p--,(o=n[l])&&(o.__u|=131072)),o==null||o.__v===null?(l==-1&&u--,typeof r.type!="function"&&(r.__u|=65536)):l!==a&&(l===a+1?u++:l>a?p>s-a?u+=l-a:u--:l<a?l==a-1&&(u=l-a):u=0,l!==i+u&&(r.__u|=65536))):(o=n[a])&&o.key==null&&o.__e&&!(131072&o.__u)&&(o.__e==e.__d&&(e.__d=Ui(o)),Fs(o,o,!1),n[a]=null,p--);if(p)for(i=0;i<c;i++)(o=n[i])!=null&&!(131072&o.__u)&&(o.__e==e.__d&&(e.__d=Ui(o)),Fs(o,o))}function Nf(e,t,n){var i,r;if(typeof e.type=="function"){for(i=e.__k,r=0;i&&r<i.length;r++)i[r]&&(i[r].__=e,t=Nf(i[r],t,n));return t}e.__e!=t&&(n.insertBefore(e.__e,t||null),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType===8);return t}function __(e,t,n,i){var r=e.key,o=e.type,a=n-1,l=n+1,s=t[n];if(s===null||s&&r==s.key&&o===s.type&&!(131072&s.__u))return n;if(i>(s!=null&&!(131072&s.__u)?1:0))for(;a>=0||l<t.length;){if(a>=0){if((s=t[a])&&!(131072&s.__u)&&r==s.key&&o===s.type)return a;a--}if(l<t.length){if((s=t[l])&&!(131072&s.__u)&&r==s.key&&o===s.type)return l;l++}}return-1}function xu(e,t,n){t[0]==="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||g_.test(t)?n:n+"px"}function vo(e,t,n,i,r){var o;e:if(t==="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof i=="string"&&(e.style.cssText=i=""),i)for(t in i)n&&t in n||xu(e.style,t,"");if(n)for(t in n)i&&n[t]===i[t]||xu(e.style,t,n[t])}else if(t[0]==="o"&&t[1]==="n")o=t!==(t=t.replace(/(PointerCapture)$|Capture$/i,"$1")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+o]=n,n?i?n.u=i.u:(n.u=Date.now(),e.addEventListener(t,o?Su:wu,o)):e.removeEventListener(t,o?Su:wu,o);else{if(r)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!=="width"&&t!=="height"&&t!=="href"&&t!=="list"&&t!=="form"&&t!=="tabIndex"&&t!=="download"&&t!=="rowSpan"&&t!=="colSpan"&&t!=="role"&&t in e)try{e[t]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!=="-"?e.removeAttribute(t):e.setAttribute(t,n))}}function wu(e){if(this.l){var t=this.l[e.type+!1];if(e.t){if(e.t<=t.u)return}else e.t=Date.now();return t(Be.event?Be.event(e):e)}}function Su(e){if(this.l)return this.l[e.type+!0](Be.event?Be.event(e):e)}function Dl(e,t,n,i,r,o,a,l,s,c){var p,u,d,f,h,m,v,S,b,w,C,R,D,F,A,I=t.type;if(t.constructor!==void 0)return null;128&n.__u&&(s=!!(32&n.__u),o=[l=t.__e=n.__e]),(p=Be.__b)&&p(t);e:if(typeof I=="function")try{if(S=t.props,b=(p=I.contextType)&&i[p.__c],w=p?b?b.props.value:p.__:i,n.__c?v=(u=t.__c=n.__c).__=u.__E:("prototype"in I&&I.prototype.render?t.__c=u=new I(S,w):(t.__c=u=new Bo(S,w),u.constructor=I,u.render=E_),b&&b.sub(u),u.props=S,u.state||(u.state={}),u.context=w,u.__n=i,d=u.__d=!0,u.__h=[],u._sb=[]),u.__s==null&&(u.__s=u.state),I.getDerivedStateFromProps!=null&&(u.__s==u.state&&(u.__s=jn({},u.__s)),jn(u.__s,I.getDerivedStateFromProps(S,u.__s))),f=u.props,h=u.state,u.__v=t,d)I.getDerivedStateFromProps==null&&u.componentWillMount!=null&&u.componentWillMount(),u.componentDidMount!=null&&u.__h.push(u.componentDidMount);else{if(I.getDerivedStateFromProps==null&&S!==f&&u.componentWillReceiveProps!=null&&u.componentWillReceiveProps(S,w),!u.__e&&(u.shouldComponentUpdate!=null&&u.shouldComponentUpdate(S,u.__s,w)===!1||t.__v===n.__v)){for(t.__v!==n.__v&&(u.props=S,u.state=u.__s,u.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.forEach(function($){$&&($.__=t)}),C=0;C<u._sb.length;C++)u.__h.push(u._sb[C]);u._sb=[],u.__h.length&&a.push(u);break e}u.componentWillUpdate!=null&&u.componentWillUpdate(S,u.__s,w),u.componentDidUpdate!=null&&u.__h.push(function(){u.componentDidUpdate(f,h,m)})}if(u.context=w,u.props=S,u.__P=e,u.__e=!1,R=Be.__r,D=0,"prototype"in I&&I.prototype.render){for(u.state=u.__s,u.__d=!1,R&&R(t),p=u.render(u.props,u.state,u.context),F=0;F<u._sb.length;F++)u.__h.push(u._sb[F]);u._sb=[]}else do u.__d=!1,R&&R(t),p=u.render(u.props,u.state,u.context),u.state=u.__s;while(u.__d&&++D<25);u.state=u.__s,u.getChildContext!=null&&(i=jn(jn({},i),u.getChildContext())),d||u.getSnapshotBeforeUpdate==null||(m=u.getSnapshotBeforeUpdate(f,h)),If(e,Rl(A=p!=null&&p.type===_a&&p.key==null?p.props.children:p)?A:[A],t,n,i,r,o,a,l,s,c),u.base=t.__e,t.__u&=-161,u.__h.length&&a.push(u),v&&(u.__E=u.__=null)}catch($){t.__v=null,s||o!=null?(t.__e=l,t.__u|=s?160:32,o[o.indexOf(l)]=null):(t.__e=n.__e,t.__k=n.__k),Be.__e($,t,n)}else o==null&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=b_(n.__e,t,n,i,r,o,a,s,c);(p=Be.diffed)&&p(t)}function Of(e,t,n){t.__d=void 0;for(var i=0;i<n.length;i++)kl(n[i],n[++i],n[++i]);Be.__c&&Be.__c(t,e),e.some(function(r){try{e=r.__h,r.__h=[],e.some(function(o){o.call(r)})}catch(o){Be.__e(o,r.__v)}})}function b_(e,t,n,i,r,o,a,l,s){var c,p,u,d,f,h,m,v=n.props,S=t.props,b=t.type;if(b==="svg"&&(r=!0),o!=null){for(c=0;c<o.length;c++)if((f=o[c])&&"setAttribute"in f==!!b&&(b?f.localName===b:f.nodeType===3)){e=f,o[c]=null;break}}if(e==null){if(b===null)return document.createTextNode(S);e=r?document.createElementNS("http://www.w3.org/2000/svg",b):document.createElement(b,S.is&&S),o=null,l=!1}if(b===null)v===S||l&&e.data===S||(e.data=S);else{if(o=o&&ya.call(e.childNodes),v=n.props||Rr,!l&&o!=null)for(v={},c=0;c<e.attributes.length;c++)v[(f=e.attributes[c]).name]=f.value;for(c in v)f=v[c],c=="children"||(c=="dangerouslySetInnerHTML"?u=f:c==="key"||c in S||vo(e,c,null,f,r));for(c in S)f=S[c],c=="children"?d=f:c=="dangerouslySetInnerHTML"?p=f:c=="value"?h=f:c=="checked"?m=f:c==="key"||l&&typeof f!="function"||v[c]===f||vo(e,c,f,v[c],r);if(p)l||u&&(p.__html===u.__html||p.__html===e.innerHTML)||(e.innerHTML=p.__html),t.__k=[];else if(u&&(e.innerHTML=""),If(e,Rl(d)?d:[d],t,n,i,r&&b!=="foreignObject",o,a,o?o[0]:n.__k&&Ui(n,0),l,s),o!=null)for(c=o.length;c--;)o[c]!=null&&kf(o[c]);l||(c="value",h!==void 0&&(h!==e[c]||b==="progress"&&!h||b==="option"&&h!==v[c])&&vo(e,c,h,v[c],!1),c="checked",m!==void 0&&m!==e[c]&&vo(e,c,m,v[c],!1))}return e}function kl(e,t,n){try{typeof e=="function"?e(t):e.current=t}catch(i){Be.__e(i,n)}}function Fs(e,t,n){var i,r;if(Be.unmount&&Be.unmount(e),(i=e.ref)&&(i.current&&i.current!==e.__e||kl(i,null,t)),(i=e.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(o){Be.__e(o,t)}i.base=i.__P=null,e.__c=void 0}if(i=e.__k)for(r=0;r<i.length;r++)i[r]&&Fs(i[r],t,n||typeof e.type!="function");n||e.__e==null||kf(e.__e),e.__=e.__e=e.__d=void 0}function E_(e,t,n){return this.constructor(e,n)}function Lf(e,t,n){var i,r,o,a;Be.__&&Be.__(e,t),r=(i=typeof n=="function")?null:t.__k,o=[],a=[],Dl(t,e=(!i&&n||t).__k=Af(_a,null,[e]),r||Rr,Rr,t.ownerSVGElement!==void 0,!i&&n?[n]:r?null:t.firstChild?ya.call(t.childNodes):null,o,!i&&n?n:r?r.__e:t.firstChild,i,a),Of(o,e,a)}ya=Df.slice,Be={__e:function(e,t,n,i){for(var r,o,a;t=t.__;)if((r=t.__c)&&!r.__)try{if((o=r.constructor)&&o.getDerivedStateFromError!=null&&(r.setState(o.getDerivedStateFromError(e)),a=r.__d),r.componentDidCatch!=null&&(r.componentDidCatch(e,i||{}),a=r.__d),a)return r.__E=r}catch(l){e=l}throw e}},Pf=0,Bo.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=jn({},this.state),typeof e=="function"&&(e=e(jn({},n),this.props)),e&&jn(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),Eu(this))},Bo.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),Eu(this))},Bo.prototype.render=_a,fi=[],Rf=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Vs=function(e,t){return e.__v.__b-t.__v.__b},Ko.__r=0;var $f=function(e,t,n,i){var r;t[0]=0;for(var o=1;o<t.length;o++){var a=t[o++],l=t[o]?(t[0]|=a?1:2,n[t[o++]]):t[++o];a===3?i[0]=l:a===4?i[1]=Object.assign(i[1]||{},l):a===5?(i[1]=i[1]||{})[t[++o]]=l:a===6?i[1][t[++o]]+=l+"":a?(r=e.apply(l,$f(e,l,n,["",null])),i.push(r),l[0]?t[0]|=2:(t[o-2]=0,t[o]=r)):i.push(l)}return i},Cu=new Map;function x_(e){var t=Cu.get(this);return t||(t=new Map,Cu.set(this,t)),(t=$f(this,t.get(e)||(t.set(e,t=function(n){for(var i,r,o=1,a="",l="",s=[0],c=function(d){o===1&&(d||(a=a.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?s.push(0,d,a):o===3&&(d||a)?(s.push(3,d,a),o=2):o===2&&a==="..."&&d?s.push(4,d,0):o===2&&a&&!d?s.push(5,0,!0,a):o>=5&&((a||!d&&o===5)&&(s.push(o,0,a,r),o=6),d&&(s.push(o,d,0,r),o=6)),a=""},p=0;p<n.length;p++){p&&(o===1&&c(),c(p));for(var u=0;u<n[p].length;u++)i=n[p][u],o===1?i==="<"?(c(),s=[s],o=3):a+=i:o===4?a==="--"&&i===">"?(o=1,a=""):a=i+a[0]:l?i===l?l="":a+=i:i==='"'||i==="'"?l=i:i===">"?(c(),o=1):o&&(i==="="?(o=5,r=a,a=""):i==="/"&&(o<5||n[p][u+1]===">")?(c(),o===3&&(s=s[0]),o=s,(s=s[0]).push(2,0,o),o=0):i===" "||i==="	"||i===`
`||i==="\r"?(c(),o=2):a+=i),o===3&&a==="!--"&&(o=4,s=s[0])}return c(),s}(e)),t),arguments,[])).length>1?t:t[0]}var Ke=x_.bind(Af),Gi,Ue,hs,Tu,Dr=0,Bf=[],jo=[],qe=Be,Pu=qe.__b,Ru=qe.__r,Du=qe.diffed,ku=qe.__c,Au=qe.unmount,Mu=qe.__;function ba(e,t){qe.__h&&qe.__h(Ue,e,Dr||t),Dr=0;var n=Ue.__H||(Ue.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({__V:jo}),n.__[e]}function ms(e){return Dr=1,w_(jf,e)}function w_(e,t,n){var i=ba(Gi++,2);if(i.t=e,!i.__c&&(i.__=[jf(void 0,t),function(l){var s=i.__N?i.__N[0]:i.__[0],c=i.t(s,l);s!==c&&(i.__N=[c,i.__[1]],i.__c.setState({}))}],i.__c=Ue,!Ue.u)){var r=function(l,s,c){if(!i.__c.__H)return!0;var p=i.__c.__H.__.filter(function(d){return!!d.__c});if(p.every(function(d){return!d.__N}))return!o||o.call(this,l,s,c);var u=!1;return p.forEach(function(d){if(d.__N){var f=d.__[0];d.__=d.__N,d.__N=void 0,f!==d.__[0]&&(u=!0)}}),!(!u&&i.__c.props===l)&&(!o||o.call(this,l,s,c))};Ue.u=!0;var o=Ue.shouldComponentUpdate,a=Ue.componentWillUpdate;Ue.componentWillUpdate=function(l,s,c){if(this.__e){var p=o;o=void 0,r(l,s,c),o=p}a&&a.call(this,l,s,c)},Ue.shouldComponentUpdate=r}return i.__N||i.__}function vs(e,t){var n=ba(Gi++,3);!qe.__s&&Ml(n.__H,t)&&(n.__=e,n.i=t,Ue.__H.__h.push(n))}function Xo(e,t){var n=ba(Gi++,4);!qe.__s&&Ml(n.__H,t)&&(n.__=e,n.i=t,Ue.__h.push(n))}function Al(e){return Dr=5,kr(function(){return{current:e}},[])}function kr(e,t){var n=ba(Gi++,7);return Ml(n.__H,t)?(n.__V=e(),n.i=t,n.__h=e,n.__V):n.__}function ji(e,t){return Dr=8,kr(function(){return e},t)}function S_(){for(var e;e=Bf.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(Vo),e.__H.__h.forEach(Hs),e.__H.__h=[]}catch(t){e.__H.__h=[],qe.__e(t,e.__v)}}qe.__b=function(e){Ue=null,Pu&&Pu(e)},qe.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),Mu&&Mu(e,t)},qe.__r=function(e){Ru&&Ru(e),Gi=0;var t=(Ue=e.__c).__H;t&&(hs===Ue?(t.__h=[],Ue.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.__V=jo,n.__N=n.i=void 0})):(t.__h.forEach(Vo),t.__h.forEach(Hs),t.__h=[],Gi=0)),hs=Ue},qe.diffed=function(e){Du&&Du(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(Bf.push(t)!==1&&Tu===qe.requestAnimationFrame||((Tu=qe.requestAnimationFrame)||C_)(S_)),t.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.__V!==jo&&(n.__=n.__V),n.i=void 0,n.__V=jo})),hs=Ue=null},qe.__c=function(e,t){t.some(function(n){try{n.__h.forEach(Vo),n.__h=n.__h.filter(function(i){return!i.__||Hs(i)})}catch(i){t.some(function(r){r.__h&&(r.__h=[])}),t=[],qe.__e(i,n.__v)}}),ku&&ku(e,t)},qe.unmount=function(e){Au&&Au(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(i){try{Vo(i)}catch(r){t=r}}),n.__H=void 0,t&&qe.__e(t,n.__v))};var Iu=typeof requestAnimationFrame=="function";function C_(e){var t,n=function(){clearTimeout(i),Iu&&cancelAnimationFrame(t),setTimeout(e)},i=setTimeout(n,100);Iu&&(t=requestAnimationFrame(n))}function Vo(e){var t=Ue,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),Ue=t}function Hs(e){var t=Ue;e.__c=e.__(),Ue=t}function Ml(e,t){return!e||e.length!==t.length||t.some(function(n,i){return n!==e[i]})}function jf(e,t){return typeof t=="function"?t(e):t}function Vf(e){var t,n,i="";if(typeof e=="string"||typeof e=="number")i+=e;else if(typeof e=="object")if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=Vf(e[t]))&&(i&&(i+=" "),i+=n)}else for(n in e)e[n]&&(i&&(i+=" "),i+=n);return i}function Zo(){for(var e,t,n=0,i="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=Vf(e))&&(i&&(i+=" "),i+=t);return i}function T_(e){const{entry:t,selected:n,onMouseEnter:i,onMouseLeave:r,onAction:o}=e;return Ke`
    <li
      class=${Zo("entry",{selected:n})}
      data-id=${t.id}
      title=${t.title||t.label}
      onClick=${o}
      onMouseEnter=${i}
      onMouseLeave=${r}
      onDragStart=${a=>o(a,t,"dragstart")}
      draggable=${!0}
    >
      <div class="djs-popup-entry-content">
        <span
          class=${Zo("djs-popup-entry-name",t.className)}
        >
          ${t.imageUrl&&Ke`<img class="djs-popup-entry-icon" src=${t.imageUrl} alt="" />`||t.imageHtml&&Ke`<div class="djs-popup-entry-icon" dangerouslySetInnerHTML=${{__html:t.imageHtml}} />`}

          ${t.label?Ke`
            <span class="djs-popup-label">
              ${t.label}
            </span>
          `:null}
        </span>
        ${t.description&&Ke`
          <span
            class="djs-popup-entry-description"
            title=${t.description}
          >
            ${t.description}
          </span>
        `}
      </div>
      ${t.documentationRef&&Ke`
        <div class="djs-popup-entry-docs">
          <a
            href="${t.documentationRef}"
            onClick=${a=>a.stopPropagation()}
            title="Open element documentation"
            target="_blank"
            rel="noopener"
          >
            <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd" d="M10.6368 10.6375V5.91761H11.9995V10.6382C11.9995 10.9973 11.8623 11.3141 11.5878 11.5885C11.3134 11.863 10.9966 12.0002 10.6375 12.0002H1.36266C0.982345 12.0002 0.660159 11.8681 0.396102 11.6041C0.132044 11.34 1.52588e-05 11.0178 1.52588e-05 10.6375V1.36267C1.52588e-05 0.98236 0.132044 0.660173 0.396102 0.396116C0.660159 0.132058 0.982345 2.95639e-05 1.36266 2.95639e-05H5.91624V1.36267H1.36266V10.6375H10.6368ZM12 0H7.2794L7.27873 1.36197H9.68701L3.06507 7.98391L4.01541 8.93425L10.6373 2.31231V4.72059H12V0Z" fill="#818798"/>
            </svg>
          </a>
        </div>
      `}
    </li>
  `}function P_(e){const{selectedEntry:t,setSelectedEntry:n,entries:i,...r}=e,o=Al(),a=kr(()=>R_(i),[i]);return Xo(()=>{const l=o.current;if(!l)return;const s=l.querySelector(".selected");s&&D_(s)},[t]),Ke`
    <div class="djs-popup-results" ref=${o}>
      ${a.map(l=>Ke`
        ${l.name&&Ke`
          <div key=${l.id} class="entry-header" title=${l.name}>
            ${l.name}
          </div>
        `}
        <ul class="djs-popup-group" data-group=${l.id}>
          ${l.entries.map(s=>Ke`
            <${T_}
              key=${s.id}
              entry=${s}
              selected=${s===t}
              onMouseEnter=${()=>n(s)}
              onMouseLeave=${()=>n(null)}
              ...${r}
            />
          `)}
        </ul>
      `)}
    </div>
  `}function R_(e){const t=[],n=o=>t.find(a=>o.id===a.id),i=o=>!!n(o),r=o=>typeof o=="string"?{id:o}:o;return e.forEach(o=>{const a=o.group?r(o.group):{id:"default"};i(a)?n(a).entries.push(o):t.push({...a,entries:[o]})}),t}function D_(e){typeof e.scrollIntoViewIfNeeded=="function"?e.scrollIntoViewIfNeeded():e.scrollIntoView({scrollMode:"if-needed",block:"nearest"})}function k_(e){const{onClose:t,onSelect:n,className:i,headerEntries:r,position:o,title:a,width:l,scale:s,search:c,entries:p,onOpened:u,onClosed:d}=e,f=kr(()=>Ct(c)?p.length>5:!1,[c,p]),h=Al(),[m,v]=ms(""),S=ji((V,X)=>{if(!f)return V;const U=O=>{if(!X)return(O.rank||0)>=0;if(O.searchable===!1)return!1;const B=[O.description||"",O.label||"",O.search||""].join("---").toLowerCase();return X.toLowerCase().split(/\s/g).every(q=>B.includes(q))};return V.filter(U)},[f]),[b,w]=ms(S(p,m)),[C,R]=ms(b[0]),D=ji(V=>{(!C||!V.includes(C))&&R(V[0]),w(V)},[C,w,R]);vs(()=>{D(S(p,m))},[m,p]),vs(()=>{const V=X=>{if(X.key==="Escape")return X.preventDefault(),t()};return document.documentElement.addEventListener("keydown",V),()=>{document.documentElement.removeEventListener("keydown",V)}},[]),Xo(()=>{h.current&&h.current.focus()},[]);const F=ji(V=>{let U=b.indexOf(C)+V;U<0&&(U=b.length-1),U>=b.length&&(U=0),R(b[U])},[b,C,R]),A=ji(V=>{if(V.key==="Enter"&&C)return n(V,C);if(V.key==="ArrowUp"||V.key==="Tab"&&V.shiftKey)return F(-1),V.preventDefault();if(V.key==="ArrowDown"||V.key==="Tab")return F(1),V.preventDefault()},[n,t,C,F]),I=ji(V=>{hl(V.target,"input")&&v(()=>V.target.value)},[v]);vs(()=>(u(),()=>{d()}),[]);const $=kr(()=>a||r.length>0,[a,r]);return Ke`
    <${Nu}
      onClose=${t}
      onKeyup=${I}
      onKeydown=${A}
      className=${i}
      position=${o}
      width=${l}
      scale=${s}
    >
      ${$&&Ke`
        <div class="djs-popup-header">
          <h3 class="djs-popup-title" title=${a}>${a}</h3>
          ${r.map(V=>Ke`
            <span
              class=${M_(V,V===C)}
              onClick=${X=>n(X,V)}
              title=${V.title||V.label}
              data-id=${V.id}
              onMouseEnter=${()=>R(V)}
              onMouseLeave=${()=>R(null)}
            >
            ${V.imageUrl&&Ke`<img class="djs-popup-entry-icon" src=${V.imageUrl} alt="" />`||V.imageHtml&&Ke`<div class="djs-popup-entry-icon" dangerouslySetInnerHTML=${{__html:V.imageHtml}} />`}

              ${V.label?Ke`
                <span class="djs-popup-label">${V.label}</span>
              `:null}
            </span>
          `)}
        </div>
      `}
      ${p.length>0&&Ke`
        <div class="djs-popup-body">

          ${f&&Ke`
          <div class="djs-popup-search">
            <svg class="djs-popup-search-icon" width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd" d="M9.0325 8.5H9.625L13.3675 12.25L12.25 13.3675L8.5 9.625V9.0325L8.2975 8.8225C7.4425 9.5575 6.3325 10 5.125 10C2.4325 10 0.25 7.8175 0.25 5.125C0.25 2.4325 2.4325 0.25 5.125 0.25C7.8175 0.25 10 2.4325 10 5.125C10 6.3325 9.5575 7.4425 8.8225 8.2975L9.0325 8.5ZM1.75 5.125C1.75 6.9925 3.2575 8.5 5.125 8.5C6.9925 8.5 8.5 6.9925 8.5 5.125C8.5 3.2575 6.9925 1.75 5.125 1.75C3.2575 1.75 1.75 3.2575 1.75 5.125Z" fill="#22242A"/>
            </svg>
            <input
                ref=${h}
                type="text"
              />
          </div>
          `}

          <${P_}
            entries=${b}
            selectedEntry=${C}
            setSelectedEntry=${R}
            onAction=${n}
          />
        </div>
        ${b.length===0&&Ke`
          <div class="djs-popup-no-results">No matching entries found.</div>
        `}
      `}
    </${Nu}>
  `}function Nu(e){const{onClose:t,onKeydown:n,onKeyup:i,className:r,children:o,position:a}=e,l=Al(),s=ji(c=>{Wn(c.target,".djs-popup",!0)||t()},[t]);return Xo(()=>{if(typeof a!="function")return;const c=l.current,p=a(c);c.style.left=`${p.x}px`,c.style.top=`${p.y}px`},[l.current,a]),Xo(()=>{l.current&&l.current.focus()},[]),Ke`
    <div
      class="djs-popup-backdrop"
      onClick=${s}
    >
      <div
        class=${Zo("djs-popup",r)}
        style=${A_(e)}
        onKeydown=${n}
        onKeyup=${i}
        ref=${l}
        tabIndex="-1"
      >
        ${o}
      </div>
    </div>
  `}function A_(e){return{transform:`scale(${e.scale})`,width:`${e.width}px`}}function M_(e,t){return Zo("entry",e.className,e.active?"active":"",e.disabled?"disabled":"",t?"selected":"")}var I_="data-id",Ff=["contextPad.close","canvas.viewbox.changing","commandStack.changed"],N_=1e3;function Ve(e,t,n){this._eventBus=t,this._canvas=n,this._current=null;var i=Ct(e&&e.scale)?e.scale:{min:1,max:1.5};this._config={scale:i},t.on("diagram.destroy",()=>{this.close()}),t.on("element.changed",r=>{const o=this.isOpen()&&this._current.target;r.element===o&&this._render()})}Ve.$inject=["config.popupMenu","eventBus","canvas"];Ve.prototype._render=function(){const{position:e,className:t,entries:n,headerEntries:i,options:r}=this._current,o=Object.entries(n).map(([u,d])=>({id:u,...d})),a=Object.entries(i).map(([u,d])=>({id:u,...d})),l=e&&(u=>this._ensureVisible(u,e)),s=this._updateScale(this._current.container);Lf(Ke`
      <${k_}
        onClose=${u=>this.close(u)}
        onSelect=${(u,d,f)=>this.trigger(u,d,f)}
        position=${l}
        className=${t}
        entries=${o}
        headerEntries=${a}
        scale=${s}
        onOpened=${this._onOpened.bind(this)}
        onClosed=${this._onClosed.bind(this)}
        ...${{...r}}
      />
    `,this._current.container)};Ve.prototype.open=function(e,t,n,i){if(!e)throw new Error("target is missing");if(!t)throw new Error("providers for <"+t+"> not found");if(!n)throw new Error("position is missing");this.isOpen()&&this.close();const{entries:r,headerEntries:o}=this._getContext(e,t);this._current={position:n,className:t,target:e,entries:r,headerEntries:o,container:this._createContainer({provider:t}),options:i},this._emit("open"),this._bindAutoClose(),this._render()};Ve.prototype._getContext=function(e,t){const n=this._getProviders(t);if(!n||!n.length)throw new Error("provider for <"+t+"> not found");const i=this._getEntries(e,n),r=this._getHeaderEntries(e,n);return{entries:i,headerEntries:r,empty:!(Object.keys(i).length||Object.keys(r).length)}};Ve.prototype.close=function(){this.isOpen()&&(this._emit("close"),this.reset(),this._current=null)};Ve.prototype.reset=function(){const e=this._current.container;Lf(null,e),Hi(e)};Ve.prototype._emit=function(e,t){this._eventBus.fire(`popupMenu.${e}`,t)};Ve.prototype._onOpened=function(){this._emit("opened")};Ve.prototype._onClosed=function(){this._emit("closed")};Ve.prototype._createContainer=function(e){var t=this._canvas,n=t.getContainer();const i=ot(`<div class="djs-popup-parent djs-scrollable" data-popup=${e.provider}></div>`);return n.appendChild(i),i};Ve.prototype._bindAutoClose=function(){this._eventBus.once(Ff,this.close,this)};Ve.prototype._unbindAutoClose=function(){this._eventBus.off(Ff,this.close,this)};Ve.prototype._updateScale=function(){var e=this._canvas.zoom(),t=this._config.scale,n,i,r=e;return t!==!0&&(t===!1?(n=1,i=1):(n=t.min,i=t.max),Ct(n)&&e<n&&(r=n),Ct(i)&&e>i&&(r=i)),r};Ve.prototype._ensureVisible=function(e,t){var n=document.documentElement.getBoundingClientRect(),i=e.getBoundingClientRect(),r={},o=t.x,a=t.y;return t.x+i.width>n.width&&(r.x=!0),t.y+i.height>n.height&&(r.y=!0),r.x&&r.y?(o=t.x-i.width,a=t.y-i.height):r.x?(o=t.x-i.width,a=t.y):r.y&&t.y<i.height?(o=t.x,a=10):r.y&&(o=t.x,a=t.y-i.height),t.y<n.top&&(a=t.y+i.height),{x:o,y:a}};Ve.prototype.isEmpty=function(e,t){if(!e)throw new Error("target is missing");if(!t)throw new Error("provider ID is missing");const n=this._getProviders(t);return!n||!n.length?!0:this._getContext(e,t).empty};Ve.prototype.registerProvider=function(e,t,n){n||(n=t,t=N_),this._eventBus.on("popupMenu.getProviders."+e,t,function(i){i.providers.push(n)})};Ve.prototype._getProviders=function(e){var t=this._eventBus.createEvent({type:"popupMenu.getProviders."+e,providers:[]});return this._eventBus.fire(t),t.providers};Ve.prototype._getEntries=function(e,t){var n={};return M(t,function(i){if(!i.getPopupMenuEntries){M(i.getEntries(e),function(o){var a=o.id;if(!a)throw new Error("entry ID is missing");n[a]=bn(o,["id"])});return}var r=i.getPopupMenuEntries(e);en(r)?n=r(n):M(r,function(o,a){n[a]=o})}),n};Ve.prototype._getHeaderEntries=function(e,t){var n={};return M(t,function(i){if(!i.getPopupMenuHeaderEntries){if(!i.getHeaderEntries)return;M(i.getHeaderEntries(e),function(o){var a=o.id;if(!a)throw new Error("entry ID is missing");n[a]=bn(o,["id"])});return}var r=i.getPopupMenuHeaderEntries(e);en(r)?n=r(n):M(r,function(o,a){n[a]=o})}),n};Ve.prototype.isOpen=function(){return!!this._current};Ve.prototype.trigger=function(e,t,n="click"){if(e.preventDefault(),!t){let r=Wn(e.delegateTarget||e.target,".entry",!0),o=_t(r,I_);t={id:o,...this._getEntry(o)}}const i=t.action;if(this._emit("trigger",{entry:t,event:e})!==!1){if(en(i)){if(n==="click")return i(e,t)}else if(i[n])return i[n](e,t)}};Ve.prototype._getEntry=function(e){var t=this._current.entries[e]||this._current.headerEntries[e];if(!t)throw new Error("entry not found");return t};const Il={__init__:["popupMenu"],popupMenu:["type",Ve]};var Hf={align:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2000 2000">
              <line x1="200" y1="150" x2="200" y2="1850" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>
              <rect x="500" y="150" width="1300" height="700" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
              <rect x="500" y="1150" width="700" height="700" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
          </svg>`,bottom:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">
            <line x1="150" y1="1650" x2="1650" y2="1650" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>
            <rect x="150" y="350" width="600" height="1300" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
            <rect x="1050" y="850" width="600" height="800" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
          </svg>`,center:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">
            <line x1="900" y1="150" x2="900" y2="1650" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>
            <rect x="250" y="150" width="1300" height="600" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
            <rect x="500" y="1050" width="800" height="600" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
          </svg>`,left:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">
            <line x1="100" y1="150" x2="100" y2="1650" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>
            <rect x="100" y="150" width="1300" height="600" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
            <rect x="100" y="1050" width="800" height="600" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
          </svg>`,right:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">
            <line x1="1650" y1="150" x2="1650" y2="1650" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>
            <rect x="350" y="150" width="1300" height="600" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
            <rect x="850" y="1050" width="800" height="600" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
          </svg>`,top:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">
            <line x1="150" y1="150" x2="1650" y2="150" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>
            <rect x="150" y="150" width="600" height="1300" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
            <rect x="1050" y="150" width="600" height="800" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
          </svg>`,middle:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">
            <line x1="150" y1="900" x2="1650" y2="900" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>
            <rect x="150" y="250" width="600" height="1300" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
            <rect x="1050" y="500" width="600" height="800" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
          </svg>`},O_=900;function Qi(e,t,n,i){e.registerProvider(O_,this),this._contextPad=e,this._popupMenu=t,this._translate=n,this._canvas=i}Qi.$inject=["contextPad","popupMenu","translate","canvas"];Qi.prototype.getMultiElementContextPadEntries=function(e){var t={};return this._isAllowed(e)&&L(t,this._getEntries(e)),t};Qi.prototype._isAllowed=function(e){return!this._popupMenu.isEmpty(e,"align-elements")};Qi.prototype._getEntries=function(){var e=this;return{"align-elements":{group:"align-elements",title:e._translate("Align elements"),html:`<div class="entry">${Hf.align}</div>`,action:{click:function(t,n){var i=e._getMenuPosition(n);L(i,{cursor:{x:t.x,y:t.y}}),e._popupMenu.open(n,"align-elements",i)}}}}};Qi.prototype._getMenuPosition=function(e){var t=5,n=this._contextPad.getPad(e).html,i=n.getBoundingClientRect(),r={x:i.left,y:i.bottom+t};return r};var L_=["left","center","right","top","middle","bottom"];function Lr(e,t,n,i){this._alignElements=t,this._translate=n,this._popupMenu=e,this._rules=i,e.registerProvider("align-elements",this)}Lr.$inject=["popupMenu","alignElements","translate","rules"];Lr.prototype.getPopupMenuEntries=function(e){var t={};return this._isAllowed(e)&&L(t,this._getEntries(e)),t};Lr.prototype._isAllowed=function(e){return this._rules.allowed("elements.align",{elements:e})};Lr.prototype._getEntries=function(e){var t=this._alignElements,n=this._translate,i=this._popupMenu,r={};return M(L_,function(o){r["align-elements-"+o]={group:"align",title:n("Align elements "+o),className:"bjs-align-elements-menu-entry",imageHtml:Hf[o],action:function(){t.trigger(e,o),i.close()}}}),r};function $t(e){Y.call(this,e),this.init()}$t.$inject=["eventBus"];te($t,Y);$t.prototype.addRule=function(e,t,n){var i=this;typeof e=="string"&&(e=[e]),e.forEach(function(r){i.canExecute(r,t,function(o,a,l){return n(o)},!0)})};$t.prototype.init=function(){};function Ea(e){$t.call(this,e)}Ea.$inject=["eventBus"];te(Ea,$t);Ea.prototype.init=function(){this.addRule("elements.align",function(e){var t=e.elements,n=_e(t,function(i){return!(i.waypoints||i.host||i.labelTarget)});return n=ua(n),n.length<2?!1:n})};const $_={__depends__:[d_,Tf,Il],__init__:["alignElementsContextPadProvider","alignElementsMenuProvider","bpmnAlignElements"],alignElementsContextPadProvider:["type",Qi],alignElementsMenuProvider:["type",Lr],bpmnAlignElements:["type",Ea]};var B_=10,zf=50,j_=250;function Nl(e,t,n,i){for(var r;r=V_(e,n,t);)n=i(t,n,r);return n}function Ol(e){return function(t,n,i){var r={x:n.x,y:n.y};return["x","y"].forEach(function(o){var a=e[o];if(a){var l=o==="x"?"width":"height",s=a.margin,c=a.minDistance;s<0?r[o]=Math.min(i[o]+s-t[l]/2,n[o]-c+s):r[o]=Math.max(i[o]+i[l]+s+t[l]/2,n[o]+c+s)}}),r}}function V_(e,t,n){var i={x:t.x-n.width/2,y:t.y-n.height/2,width:n.width,height:n.height},r=H_(e);return Oe(r,function(o){if(o===n)return!1;var a=pt(o,i,B_);return a==="intersect"})}function F_(e,t){t||(t={});function n(h){return h.source===e?1:-1}var i=t.defaultDistance||zf,r=t.direction||"e",o=t.filter,a=t.getWeight||n,l=t.maxDistance||j_,s=t.reference||"start";o||(o=G_);function c(h,m){return r==="n"?s==="start"?ae(h).top-ae(m).bottom:s==="center"?ae(h).top-de(m).y:ae(h).top-ae(m).top:r==="w"?s==="start"?ae(h).left-ae(m).right:s==="center"?ae(h).left-de(m).x:ae(h).left-ae(m).left:r==="s"?s==="start"?ae(m).top-ae(h).bottom:s==="center"?de(m).y-ae(h).bottom:ae(m).bottom-ae(h).bottom:s==="start"?ae(m).left-ae(h).right:s==="center"?de(m).x-ae(h).right:ae(m).right-ae(h).right}var p=e.incoming.filter(o).map(function(h){var m=a(h),v=m<0?c(h.source,e):c(e,h.source);return{id:h.source.id,distance:v,weight:m}}),u=e.outgoing.filter(o).map(function(h){var m=a(h),v=m>0?c(e,h.target):c(h.target,e);return{id:h.target.id,distance:v,weight:m}}),d=p.concat(u).reduce(function(h,m){return h[m.id+"__weight_"+m.weight]=m,h},{}),f=Yn(d,function(h,m){var v=m.distance,S=m.weight;return v<0||v>l||(h[String(v)]||(h[String(v)]=0),h[String(v)]+=1*S,(!h.distance||h[h.distance]<h[String(v)])&&(h.distance=v)),h},{});return f.distance||i}function H_(e){var t=gs(e);return e.host&&(t=t.concat(gs(e.host))),e.attachers&&(t=t.concat(e.attachers.reduce(function(n,i){return n.concat(gs(i))},[]))),t}function gs(e){return U_(e).concat(z_(e))}function z_(e){return e.incoming.map(function(t){return t.source})}function U_(e){return e.outgoing.map(function(t){return t.target})}function G_(){return!0}var W_=100;function Uf(e,t,n){e.on("autoPlace",W_,function(i){var r=i.shape,o=i.source;return Y_(o,r)}),e.on("autoPlace.end",function(i){n.scrollToElement(i.shape)}),this.append=function(i,r,o){e.fire("autoPlace.start",{source:i,shape:r});var a=e.fire("autoPlace",{source:i,shape:r}),l=t.appendShape(i,r,a,i.parent,o);return e.fire("autoPlace.end",{source:i,shape:l}),l}}Uf.$inject=["eventBus","modeling","canvas"];function Y_(e,t,n){n||(n={});var i=n.defaultDistance||zf,r=de(e),o=ae(e);return{x:o.right+i+t.width/2,y:r.y}}function Gf(e,t){e.on("autoPlace.end",500,function(n){t.select(n.shape)})}Gf.$inject=["eventBus","selection"];const q_={__init__:["autoPlaceSelectionBehavior"],autoPlace:["type",Uf],autoPlaceSelectionBehavior:["type",Gf]};function Qo(e,t){for(pa(t)&&(t=[t]);e=e.parent;)if(ve(e,t))return e;return null}function Wf(e,t){if(y(t,"bpmn:TextAnnotation"))return Z_(e,t);if(ve(t,["bpmn:DataObjectReference","bpmn:DataStoreReference"]))return Q_(e,t);if(y(t,"bpmn:FlowNode"))return K_(e,t)}function K_(e,t){var n=ae(e),i=de(e),r=F_(e,{filter:function(p){return y(p,"bpmn:SequenceFlow")}}),o=30,a=80,l="left";y(e,"bpmn:BoundaryEvent")&&(l=pt(e,e.host,-25),l.indexOf("top")!==-1&&(o*=-1));var s={x:n.right+r+t.width/2,y:i.y+X_(l,a)},c={y:{margin:o,minDistance:a}};return Nl(e,t,s,Ol(c))}function X_(e,t){return e.includes("top")?-1*t:e.includes("bottom")?t:0}function Z_(e,t){var n=ae(e),i={x:n.right+t.width/2,y:n.top-50-t.height/2};Ae(e)&&(i=de(e),i.x+=100,i.y-=50);var r={y:{margin:-30,minDistance:20}};return Nl(e,t,i,Ol(r))}function Q_(e,t){var n=ae(e),i={x:n.right-10+t.width/2,y:n.bottom+40+t.width/2},r={x:{margin:30,minDistance:30}};return Nl(e,t,i,Ol(r))}function Yf(e){e.on("autoPlace",function(t){var n=t.shape,i=t.source;return Wf(i,n)})}Yf.$inject=["eventBus"];const Ll={__depends__:[q_],__init__:["bpmnAutoPlace"],bpmnAutoPlace:["type",Yf]};function wn(e,t,n,i){Y.call(this,e),this._elementRegistry=t,this._modeling=n,this._rules=i;var r=this;this.postExecuted(["shape.create"],function(o){var a=o.context,l=a.hints||{},s=a.shape,c=a.parent||a.newParent;l.autoResize!==!1&&r._expand([s],c)}),this.postExecuted(["elements.move"],function(o){var a=o.context,l=qo(gl(a.closure.topLevel)),s=a.hints,c=s?s.autoResize:!0;if(c!==!1){var p=da(l,function(u){return u.parent.id});M(p,function(u,d){Te(c)&&(u=u.filter(function(f){return Oe(c,dn({id:f.id}))})),r._expand(u,d)})}}),this.postExecuted(["shape.toggleCollapse"],function(o){var a=o.context,l=a.hints,s=a.shape;l&&l.autoResize===!1||s.collapsed||r._expand(s.children||[],s)}),this.postExecuted(["shape.resize"],function(o){var a=o.context,l=a.hints,s=a.shape,c=s.parent;l&&l.autoResize===!1||c&&r._expand([s],c)})}wn.$inject=["eventBus","elementRegistry","modeling","rules"];te(wn,Y);wn.prototype._getOptimalBounds=function(e,t){var n=this.getOffset(t),i=this.getPadding(t),r=ae(Tt(e)),o=ae(t),a={};return r.top-o.top<i.top&&(a.top=r.top-n.top),r.left-o.left<i.left&&(a.left=r.left-n.left),o.right-r.right<i.right&&(a.right=r.right+n.right),o.bottom-r.bottom<i.bottom&&(a.bottom=r.bottom+n.bottom),yl(L({},o,a))};wn.prototype._expand=function(e,t){typeof t=="string"&&(t=this._elementRegistry.get(t));var n=this._rules.allowed("element.autoResize",{elements:e,target:t});if(n){var i=this._getOptimalBounds(e,t);if(J_(i,t)){var r=eb(nn(t,["x","y","width","height"]),i);this.resize(t,i,{autoResize:r});var o=t.parent;o&&this._expand([t],o)}}};wn.prototype.getOffset=function(e){return{top:60,bottom:60,left:100,right:100}};wn.prototype.getPadding=function(e){return{top:2,bottom:2,left:15,right:15}};wn.prototype.resize=function(e,t,n){this._modeling.resizeShape(e,t,null,n)};function J_(e,t){return e.x!==t.x||e.y!==t.y||e.width!==t.width||e.height!==t.height}function eb(e,t){var n="";return e=ae(e),t=ae(t),e.top>t.top&&(n=n.concat("n")),e.right<t.right&&(n=n.concat("w")),e.bottom<t.bottom&&(n=n.concat("s")),e.left>t.left&&(n=n.concat("e")),n}function xa(e){e.invoke(wn,this)}xa.$inject=["injector"];te(xa,wn);xa.prototype.resize=function(e,t,n){y(e,"bpmn:Participant")?this._modeling.resizeLane(e,t,null,n):this._modeling.resizeShape(e,t,null,n)};function $r(e){$t.call(this,e);var t=this;this.addRule("element.autoResize",function(n){return t.canResize(n.elements,n.target)})}$r.$inject=["eventBus"];te($r,$t);$r.prototype.canResize=function(e,t){return!1};function wa(e,t){$r.call(this,e),this._modeling=t}te(wa,$r);wa.$inject=["eventBus","modeling"];wa.prototype.canResize=function(e,t){if(y(t.di,"bpmndi:BPMNPlane")||!y(t,"bpmn:Participant")&&!y(t,"bpmn:Lane")&&!y(t,"bpmn:SubProcess"))return!1;var n=!0;return M(e,function(i){if(y(i,"bpmn:Lane")||xe(i)){n=!1;return}}),n};const tb={__init__:["bpmnAutoResize","bpmnAutoResizeProvider"],bpmnAutoResize:["type",xa],bpmnAutoResizeProvider:["type",wa]};var Ou=1500;function qf(e,t,n){var i=this,r=n.get("dragging",!1);function o(a){if(!a.hover){var l=a.originalEvent,s=i._findTargetGfx(l),c=s&&e.get(s);s&&c&&(a.stopPropagation(),r.hover({element:c,gfx:s}),r.move(l))}}r&&t.on("drag.start",function(a){t.once("drag.move",Ou,function(l){o(l)})}),function(){var a,l;t.on("element.hover",function(s){a=s.gfx,l=s.element}),t.on("element.hover",Ou,function(s){l&&t.fire("element.out",{element:l,gfx:a})}),t.on("element.out",function(){a=null,l=null})}(),this._findTargetGfx=function(a){var l,s;if(a instanceof MouseEvent)return l=Fn(a),s=document.elementFromPoint(l.x,l.y),nb(s)}}qf.$inject=["elementRegistry","eventBus","injector"];function nb(e){return Wn(e,"svg, .djs-element",!0)}const ib={__init__:["hoverFix"],hoverFix:["type",qf]};var Ai=Math.round,Lu="djs-drag-active";function ui(e){e.preventDefault()}function rb(e){return typeof TouchEvent<"u"&&e instanceof TouchEvent}function ob(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function Kf(e,t,n,i){var r={threshold:5,trapClick:!0},o;function a(w){var C=t.viewbox(),R=t._container.getBoundingClientRect();return{x:C.x+(w.x-R.left)/C.scale,y:C.y+(w.y-R.top)/C.scale}}function l(w,C){C=C||o;var R=e.createEvent(L({},C.payload,C.data,{isTouch:C.isTouch}));return e.fire("drag."+w,R)===!1?!1:e.fire(C.prefix+"."+w,R)}function s(w){var C=w.filter(function(R){return i.get(R.id)});C.length&&n.select(C)}function c(w,C){var R=o.payload,D=o.displacement,F=o.globalStart,A=Fn(w),I=Ut(A,F),$=o.localStart,V=a(A),X=Ut(V,$);if(!o.active&&(C||ob(I)>o.threshold)){if(L(R,{x:Ai($.x+D.x),y:Ai($.y+D.y),dx:0,dy:0},{originalEvent:w}),l("start")===!1)return v();o.active=!0,o.keepSelection||(R.previousSelection=n.get(),n.select(null)),o.cursor&&ga(o.cursor),t.addMarker(t.getRootElement(),Lu)}ps(w),o.active&&(L(R,{x:Ai(V.x+D.x),y:Ai(V.y+D.y),dx:Ai(X.x),dy:Ai(X.y)},{originalEvent:w}),l("move"))}function p(w){var C,R=!0;o.active&&(w&&(o.payload.originalEvent=w,ps(w)),R=l("end")),R===!1&&l("rejected"),C=S(R!==!0),l("ended",C)}function u(w){tt("Escape",w)&&(ui(w),v())}function d(w){var C;o.active&&(C=gf(e),setTimeout(C,400),ui(w)),p(w)}function f(w){c(w)}function h(w){var C=o.payload;C.hoverGfx=w.gfx,C.hover=w.element,l("hover")}function m(w){l("out");var C=o.payload;C.hoverGfx=null,C.hover=null}function v(w){var C;if(o){var R=o.active;R&&l("cancel"),C=S(w),R&&l("canceled",C)}}function S(w){var C,R;l("cleanup"),vf(),o.trapClick?R=d:R=p,ce.unbind(document,"mousemove",c),ce.unbind(document,"dragstart",ui),ce.unbind(document,"selectstart",ui),ce.unbind(document,"mousedown",R,!0),ce.unbind(document,"mouseup",R,!0),ce.unbind(document,"keyup",u),ce.unbind(document,"touchstart",f,!0),ce.unbind(document,"touchcancel",v,!0),ce.unbind(document,"touchmove",c,!0),ce.unbind(document,"touchend",p,!0),e.off("element.hover",h),e.off("element.out",m),t.removeMarker(t.getRootElement(),Lu);var D=o.payload.previousSelection;return w!==!1&&D&&!n.get().length&&s(D),C=o,o=null,C}function b(w,C,R,D){o&&v(!1),typeof C=="string"&&(D=R,R=C,C=null),D=L({},r,D||{});var F=D.data||{},A,I,$,V,X;D.trapClick?V=d:V=p,w?(A=Kd(w)||w,I=Fn(w),ps(w),A.type==="dragstart"&&ui(A)):(A=null,I={x:0,y:0}),$=a(I),C||(C=$),X=rb(A),o=L({prefix:R,data:F,payload:{},globalStart:I,displacement:Ut(C,$),localStart:$,isTouch:X},D),D.manual||(X?(ce.bind(document,"touchstart",f,!0),ce.bind(document,"touchcancel",v,!0),ce.bind(document,"touchmove",c,!0),ce.bind(document,"touchend",p,!0)):(ce.bind(document,"mousemove",c),ce.bind(document,"dragstart",ui),ce.bind(document,"selectstart",ui),ce.bind(document,"mousedown",V,!0),ce.bind(document,"mouseup",V,!0)),ce.bind(document,"keyup",u),e.on("element.hover",h),e.on("element.out",m)),l("init"),D.autoActivate&&c(w,!0)}e.on("diagram.destroy",v),this.init=b,this.move=c,this.hover=h,this.out=m,this.end=p,this.cancel=v,this.context=function(){return o},this.setOptions=function(w){L(r,w)}}Kf.$inject=["eventBus","canvas","selection","elementRegistry"];const Sn={__depends__:[ib,En],dragging:["type",Kf]};function Ji(e,t,n){this._canvas=n,this._opts=L({scrollThresholdIn:[20,20,20,20],scrollThresholdOut:[0,0,0,0],scrollRepeatTimeout:15,scrollStep:10},e);var i=this;t.on("drag.move",function(r){var o=i._toBorderPoint(r);i.startScroll(o)}),t.on(["drag.cleanup"],function(){i.stopScroll()})}Ji.$inject=["config.autoScroll","eventBus","canvas"];Ji.prototype.startScroll=function(e){var t=this._canvas,n=this._opts,i=this,r=t.getContainer().getBoundingClientRect(),o=[e.x,e.y,r.width-e.x,r.height-e.y];this.stopScroll();for(var a=0,l=0,s=0;s<4;s++)ab(o[s],n.scrollThresholdOut[s],n.scrollThresholdIn[s])&&(s===0?a=n.scrollStep:s==1?l=n.scrollStep:s==2?a=-n.scrollStep:s==3&&(l=-n.scrollStep));(a!==0||l!==0)&&(t.scroll({dx:a,dy:l}),this._scrolling=setTimeout(function(){i.startScroll(e)},n.scrollRepeatTimeout))};function ab(e,t,n){return t<e&&e<n}Ji.prototype.stopScroll=function(){clearTimeout(this._scrolling)};Ji.prototype.setOptions=function(e){this._opts=L({},this._opts,e)};Ji.prototype._toBorderPoint=function(e){var t=this._canvas._container.getBoundingClientRect(),n=Fn(e.originalEvent);return{x:n.x-t.left,y:n.y-t.top}};const sb={__depends__:[Sn],__init__:["autoScroll"],autoScroll:["type",Ji]};function $l(e){this._commandStack=e.get("commandStack",!1)}$l.$inject=["injector"];$l.prototype.allowed=function(e,t){var n=!0,i=this._commandStack;return i&&(n=i.canExecute(e,t)),n===void 0?!0:n};const on={__init__:["rules"],rules:["type",$l]};var go=Math.round,lb=Math.max;function cb(e,t){var n=e.x,i=e.y;return[["M",n,i],["m",0,-t],["a",t,t,0,1,1,0,2*t],["a",t,t,0,1,1,0,-2*t],["z"]]}function ub(e){var t=[];return e.forEach(function(n,i){t.push([i===0?"M":"L",n.x,n.y])}),t}var Xf=10;function pb(e,t){var n,i;for(n=0;i=e[n];n++)if(Xd(i,t)<=Xf)return{point:e[n],bendpoint:!0,index:n};return null}function db(e,t){var n=Zv(cb(t,Xf),ub(e)),i=n[0],r=n[n.length-1],o;return i?i!==r?i.segment2!==r.segment2?(o=lb(i.segment2,r.segment2)-1,{point:e[o],bendpoint:!0,index:o}):{point:{x:go(i.x+r.x)/2,y:go(i.y+r.y)/2},index:i.segment2}:{point:{x:go(i.x),y:go(i.y)},index:i.segment2}:null}function zs(e,t){return pb(e,t)||db(e,t)}function Zf(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function $u(e){return Math.atan((e[1].y-e[0].y)/(e[1].x-e[0].x))}function fb(e,t){return t?{x:Math.cos(t)*e.x-Math.sin(t)*e.y,y:Math.sin(t)*e.x+Math.cos(t)*e.y}:e}function hb(e,t,n){var i=[{n:e[0]-n[0],lambda:t[0]},{n:e[1]-n[1],lambda:t[1]}],r=i[0].n*t[0]+i[1].n*t[1],o=i[0].lambda*t[0]+i[1].lambda*t[1];return-r/o}function Bl(e,t){var n=t[0],i=t[1],r={x:i.x-n.x,y:i.y-n.y},o=hb([n.x,n.y],[r.x,r.y],[e.x,e.y]);return{x:n.x+o*r.x,y:n.y+o*r.y}}function Qf(e,t){var n=Bl(e,t),i={x:n.x-e.x,y:n.y-e.y};return Zf(i)}function Jo(e,t){return Zf({x:e.x-t.x,y:e.y-t.y})}var Jf="djs-bendpoint",eh="djs-segment-dragger";function mb(e,t){var n=Fn(t),i=e._container.getBoundingClientRect(),r;r={x:i.left,y:i.top};var o=e.viewbox();return{x:o.x+(n.x-r.x)/o.scale,y:o.y+(n.y-r.y)/o.scale}}function Us(e,t,n){var i=mb(e,n),r=zs(t,i);return r}function Gs(e,t){var n=be("g");Ne(n).add(Jf),Ce(e,n);var i=be("circle");ie(i,{cx:0,cy:0,r:4}),Ne(i).add("djs-visual"),Ce(n,i);var r=be("circle");return ie(r,{cx:0,cy:0,r:10}),Ne(r).add("djs-hit"),Ce(n,r),t&&Ne(n).add(t),n}function vb(e,t,n,i){var r=be("g");Ce(e,r);var o=18,a=6,l=11,s=yb(t,n,i),c=a+l,p=be("rect");ie(p,{x:-o/2,y:-a/2,width:o,height:a}),Ne(p).add("djs-visual"),Ce(r,p);var u=be("rect");return ie(u,{x:-s/2,y:-c/2,width:s,height:c}),Ne(u).add("djs-hit"),Ce(r,u),Qv(r,i==="v"?90:0),r}function th(e,t,n){var i=be("g"),r=Is(t,n),o=pn(t,n);return Ce(e,i),vb(i,t,n,o),Ne(i).add(eh),Ne(i).add(o==="h"?"horizontal":"vertical"),ht(i,r.x,r.y),i}function Ws(e){return Math.abs(Math.round(e*2/3))}function gb(e,t){var n=_b(e,t);return Bl(e,n)}function yb(e,t,n){var i=t.x-e.x,r=t.y-e.y;return Ws(n==="h"?i:r)}function _b(e,t){for(var n=t.waypoints,i=1/0,r,o=0;o<n.length-1;o++){var a=n[o],l=n[o+1],s=Qf(e,[a,l]);s<i&&(i=s,r=o)}return[n[r],n[r+1]]}function nh(e,t,n,i,r){function o(w,C,R){var D=w.index,F=w.point,A,I,$,V,X,U;return D<=0||w.bendpoint?!1:(A=C[D-1],I=C[D],$=Is(A,I),V=pn(A,I),X=Math.abs(F.x-$.x),U=Math.abs(F.y-$.y),V&&X<=R&&U<=R)}function a(w,C){var R=w.waypoints,D,F,A,I;return C.index<=0||C.bendpoint||(D={start:R[C.index-1],end:R[C.index]},F=pn(D.start,D.end),!F)?null:(F==="h"?A=D.end.x-D.start.x:A=D.end.y-D.start.y,I=Ws(A)/2,I)}function l(w,C){var R=C.waypoints,D=Us(t,R,w),F;if(D)return F=a(C,D),o(D,R,F)?r.start(w,C,D.index):i.start(w,C,D.index,!D.bendpoint),!0}function s(w,C,R){ce.bind(w,C,function(D){n.triggerMouseEvent(C,D,R),D.stopPropagation()})}function c(w,C){var R=t.getLayer("overlays"),D=nt('.djs-bendpoints[data-element-id="'+Sr(w.id)+'"]',R);return!D&&C&&(D=be("g"),ie(D,{"data-element-id":w.id}),Ne(D).add("djs-bendpoints"),Ce(R,D),s(D,"mousedown",w),s(D,"click",w),s(D,"dblclick",w)),D}function p(w,C){return nt('.djs-segment-dragger[data-segment-idx="'+w+'"]',C)}function u(w,C){C.waypoints.forEach(function(R,D){var F=Gs(w);Ce(w,F),ht(F,R.x,R.y)}),Gs(w,"floating")}function d(w,C){for(var R=C.waypoints,D,F,A,I=1;I<R.length;I++)D=R[I-1],F=R[I],pn(D,F)&&(A=th(w,D,F),ie(A,{"data-segment-idx":I}),s(A,"mousemove",C))}function f(w){M(Ns("."+Jf,w),function(C){rt(C)})}function h(w){M(Ns("."+eh,w),function(C){rt(C)})}function m(w){var C=c(w);return C||(C=c(w,!0),u(C,w),d(C,w)),C}function v(w){var C=c(w);C&&(h(C),f(C),d(C,w),u(C,w))}function S(w,C){var R=nt(".floating",w),D=C.point;R&&ht(R,D.x,D.y)}function b(w,C,R){var D=p(C.index,w),F=R[C.index-1],A=R[C.index],I=C.point,$=Is(F,A),V=pn(F,A),X,U;D&&(X=bb(D),U={x:I.x-$.x,y:I.y-$.y},V==="v"&&(U={x:U.y,y:U.x}),ht(X,U.x,U.y))}e.on("connection.changed",function(w){v(w.element)}),e.on("connection.remove",function(w){var C=c(w.element);C&&rt(C)}),e.on("element.marker.update",function(w){var C=w.element,R;C.waypoints&&(R=m(C),w.add?Ne(R).add(w.marker):Ne(R).remove(w.marker))}),e.on("element.mousemove",function(w){var C=w.element,R=C.waypoints,D,F;if(R){if(D=c(C,!0),F=Us(t,R,w.originalEvent),!F)return;S(D,F),F.bendpoint||b(D,F,R)}}),e.on("element.mousedown",function(w){if(_l(w)){var C=w.originalEvent,R=w.element;if(R.waypoints)return l(C,R)}}),e.on("selection.changed",function(w){var C=w.newSelection,R=C[0];R&&R.waypoints&&m(R)}),e.on("element.hover",function(w){var C=w.element;C.waypoints&&(m(C),n.registerEvent(w.gfx,"mousemove","element.mousemove"))}),e.on("element.out",function(w){n.unregisterEvent(w.gfx,"mousemove","element.mousemove")}),e.on("element.updateId",function(w){var C=w.element,R=w.newId;if(C.waypoints){var D=c(C);D&&ie(D,{"data-element-id":R})}}),this.addHandles=m,this.updateHandles=v,this.getBendpointsContainer=c,this.getSegmentDragger=p}nh.$inject=["eventBus","canvas","interactionEvents","bendpointMove","connectionSegmentMove"];function bb(e){return nt(".djs-visual",e)}var Bu=Math.round,pi="reconnectStart",di="reconnectEnd",ur="updateWaypoints";function jl(e,t,n,i,r,o){this._injector=e,this.start=function(a,l,s,c){var p=n.getGraphics(l),u=l.source,d=l.target,f=l.waypoints,h;!c&&s===0?h=pi:!c&&s===f.length-1?h=di:h=ur;var m=h===ur?"connection.updateWaypoints":"connection.reconnect",v=r.allowed(m,{connection:l,source:u,target:d});v===!1&&(v=r.allowed(m,{connection:l,source:d,target:u})),v!==!1&&i.init(a,"bendpoint.move",{data:{connection:l,connectionGfx:p,context:{allowed:v,bendpointIndex:s,connection:l,source:u,target:d,insert:c,type:h}}})},t.on("bendpoint.move.hover",function(a){var l=a.context,s=l.connection,c=s.source,p=s.target,u=a.hover,d=l.type;l.hover=u;var f;if(u){var h=d===ur?"connection.updateWaypoints":"connection.reconnect";if(f=l.allowed=r.allowed(h,{connection:s,source:d===pi?u:c,target:d===di?u:p}),f){l.source=d===pi?u:c,l.target=d===di?u:p;return}f===!1&&(f=l.allowed=r.allowed(h,{connection:s,source:d===di?u:p,target:d===pi?u:c})),f&&(l.source=d===di?u:p,l.target=d===pi?u:c)}}),t.on(["bendpoint.move.out","bendpoint.move.cleanup"],function(a){var l=a.context,s=l.type;l.hover=null,l.source=null,l.target=null,s!==ur&&(l.allowed=!1)}),t.on("bendpoint.move.end",function(a){var l=a.context,s=l.allowed,c=l.bendpointIndex,p=l.connection,u=l.insert,d=p.waypoints.slice(),f=l.source,h=l.target,m=l.type,v=l.hints||{},S={x:Bu(a.x),y:Bu(a.y)};if(!s)return!1;m===ur?(u?d.splice(c,0,S):d[c]=S,v.bendpointMove={insert:u,bendpointIndex:c},d=this.cropWaypoints(p,d),o.updateWaypoints(p,Jv(d),v)):(m===pi?(v.docking="source",ea(l)&&(v.docking="target",v.newWaypoints=d.reverse())):m===di&&(v.docking="target",ea(l)&&(v.docking="source",v.newWaypoints=d.reverse())),o.reconnect(p,f,h,S,v))},this)}jl.$inject=["injector","eventBus","canvas","dragging","rules","modeling"];jl.prototype.cropWaypoints=function(e,t){var n=this._injector.get("connectionDocking",!1);if(!n)return t;var i=e.waypoints;return e.waypoints=t,e.waypoints=n.getCroppedWaypoints(e),t=e.waypoints,e.waypoints=i,t};function ea(e){var t=e.hover,n=e.source,i=e.target,r=e.type;if(r===pi)return t&&i&&t===i&&n!==i;if(r===di)return t&&n&&t===n&&n!==i}var Eb="reconnectStart",xb="reconnectEnd",ju="updateWaypoints",pr="connect-ok",yo="connect-not-ok",Vu="connect-hover",Fu="djs-updating",Hu="djs-dragging",zu=1100;function ih(e,t,n,i){this._injector=t;var r=t.get("connectionPreview",!1);n.on("bendpoint.move.start",function(o){var a=o.context,l=a.bendpointIndex,s=a.connection,c=a.insert,p=s.waypoints,u=p.slice();a.waypoints=p,c&&u.splice(l,0,{x:o.x,y:o.y}),s.waypoints=u;var d=a.draggerGfx=Gs(i.getLayer("overlays"));Ne(d).add("djs-dragging"),i.addMarker(s,Hu),i.addMarker(s,Fu)}),n.on("bendpoint.move.hover",function(o){var a=o.context,l=a.allowed,s=a.hover,c=a.type;if(s){if(i.addMarker(s,Vu),c===ju)return;l?(i.removeMarker(s,yo),i.addMarker(s,pr)):l===!1&&(i.removeMarker(s,pr),i.addMarker(s,yo))}}),n.on(["bendpoint.move.out","bendpoint.move.cleanup"],zu,function(o){var a=o.context,l=a.hover,s=a.target;l&&(i.removeMarker(l,Vu),i.removeMarker(l,s?pr:yo))}),n.on("bendpoint.move.move",function(o){var a=o.context,l=a.allowed,s=a.bendpointIndex,c=a.draggerGfx,p=a.hover,u=a.type,d=a.connection,f=d.source,h=d.target,m=d.waypoints.slice(),v={x:o.x,y:o.y},S=a.hints||{},b={};r&&(S.connectionStart&&(b.connectionStart=S.connectionStart),S.connectionEnd&&(b.connectionEnd=S.connectionEnd),u===Eb?ea(a)?(b.connectionEnd=b.connectionEnd||v,b.source=h,b.target=p||f,m=m.reverse()):(b.connectionStart=b.connectionStart||v,b.source=p||f,b.target=h):u===xb?ea(a)?(b.connectionStart=b.connectionStart||v,b.source=p||h,b.target=f,m=m.reverse()):(b.connectionEnd=b.connectionEnd||v,b.source=f,b.target=p||h):(b.noCropping=!0,b.noLayout=!0,m[s]=v),u===ju&&(m=e.cropWaypoints(d,m)),b.waypoints=m,r.drawPreview(a,l,b)),ht(c,o.x,o.y)},this),n.on(["bendpoint.move.end","bendpoint.move.cancel"],zu,function(o){var a=o.context,l=a.connection,s=a.draggerGfx,c=a.hover,p=a.target,u=a.waypoints;l.waypoints=u,rt(s),i.removeMarker(l,Fu),i.removeMarker(l,Hu),c&&(i.removeMarker(c,pr),i.removeMarker(c,p?pr:yo)),r&&r.cleanUp(a)})}ih.$inject=["bendpointMove","injector","eventBus","canvas"];var Uu="connect-hover",Gu="djs-updating";function Wu(e,t,n){return Vl(e,t,e[t]+n)}function Vl(e,t,n){return{x:t==="x"?n:e.x,y:t==="y"?n:e.y}}function wb(e,t,n,i){var r=Math.max(t[i],n[i]),o=Math.min(t[i],n[i]),a=20,l=Math.min(Math.max(o+a,e[i]),r-a);return Vl(t,i,l)}function rh(e){return e==="x"?"y":"x"}function Yu(e,t,n){var i,r;return e.original?e.original:(i=de(t),r=rh(n),Vl(e,r,i[r]))}function oh(e,t,n,i,r,o){var a=e.get("connectionDocking",!1);this.start=function(u,d,f){var h,m=n.getGraphics(d),v=f-1,S=f,b=d.waypoints,w=b[v],C=b[S],R=Us(n,b,u),D,F,A;D=pn(w,C),D&&(F=D==="v"?"x":"y",v===0&&(w=Yu(w,d.source,F)),S===b.length-1&&(C=Yu(C,d.target,F)),R?A=R.point:A={x:(w.x+C.x)/2,y:(w.y+C.y)/2},h={connection:d,segmentStartIndex:v,segmentEndIndex:S,segmentStart:w,segmentEnd:C,axis:F,dragPosition:A},i.init(u,A,"connectionSegment.move",{cursor:F==="x"?"resize-ew":"resize-ns",data:{connection:d,connectionGfx:m,context:h}}))};function l(u,d){if(!a)return d;var f=u.waypoints,h;return u.waypoints=d,h=a.getCroppedWaypoints(u),u.waypoints=f,h}function s(u){r.update("connection",u.connection,u.connectionGfx)}function c(u,d,f){var h=u.newWaypoints,m=u.segmentStartIndex+d,v=h[m],S=u.segmentEndIndex+d,b=h[S],w=rh(u.axis),C=wb(f,v,b,w);ht(u.draggerGfx,C.x,C.y)}function p(u,d){var f=0,h=u.filter(function(m,v){return Zd(u[v-1],u[v+1],m)?(f=v<=d?f-1:f,!1):!0});return{waypoints:h,segmentOffset:f}}t.on("connectionSegment.move.start",function(u){var d=u.context,f=u.connection,h=n.getLayer("overlays");d.originalWaypoints=f.waypoints.slice(),d.draggerGfx=th(h,d.segmentStart,d.segmentEnd),Ne(d.draggerGfx).add("djs-dragging"),n.addMarker(f,Gu)}),t.on("connectionSegment.move.move",function(u){var d=u.context,f=d.connection,h=d.segmentStartIndex,m=d.segmentEndIndex,v=d.segmentStart,S=d.segmentEnd,b=d.axis,w=d.originalWaypoints.slice(),C=Wu(v,b,u["d"+b]),R=Wu(S,b,u["d"+b]),D=w.length,F=0;w[h]=C,w[m]=R;var A,I;h<2&&(A=pt(f.source,C),h===1?A==="intersect"&&(w.shift(),w[0]=C,F--):A!=="intersect"&&(w.unshift(v),F++)),m>D-3&&(I=pt(f.target,R),m===D-2?I==="intersect"&&(w.pop(),w[w.length-1]=R):I!=="intersect"&&w.push(S)),d.newWaypoints=f.waypoints=l(f,w),c(d,F,u),d.newSegmentStartIndex=h+F,s(u)}),t.on("connectionSegment.move.hover",function(u){u.context.hover=u.hover,n.addMarker(u.hover,Uu)}),t.on(["connectionSegment.move.out","connectionSegment.move.cleanup"],function(u){var d=u.context.hover;d&&n.removeMarker(d,Uu)}),t.on("connectionSegment.move.cleanup",function(u){var d=u.context,f=d.connection;d.draggerGfx&&rt(d.draggerGfx),n.removeMarker(f,Gu)}),t.on(["connectionSegment.move.cancel","connectionSegment.move.end"],function(u){var d=u.context,f=d.connection;f.waypoints=d.originalWaypoints,s(u)}),t.on("connectionSegment.move.end",function(u){var d=u.context,f=d.connection,h=d.newWaypoints,m=d.newSegmentStartIndex;h=h.map(function(R){return{original:R.original,x:Math.round(R.x),y:Math.round(R.y)}});var v=p(h,m),S=v.waypoints,b=l(f,S),w=v.segmentOffset,C={segmentMove:{segmentStartIndex:d.segmentStartIndex,newSegmentStartIndex:m+w}};o.updateWaypoints(f,b,C)})}oh.$inject=["injector","eventBus","canvas","dragging","graphicsFactory","modeling"];var Sb=Math.abs,qu=Math.round;function Cb(e,t,n){n=n===void 0?10:n;var i,r;for(i=0;i<t.length;i++)if(r=t[i],Sb(r-e)<=n)return r}function ah(e){return{x:e.x,y:e.y}}function sh(e){return{x:e.x+e.width,y:e.y+e.height}}function Nt(e,t){return!e||isNaN(e.x)||isNaN(e.y)?t:{x:qu(e.x+e.width/2),y:qu(e.y+e.height/2)}}function Wi(e,t){var n=e.snapped;return n?typeof t=="string"?n[t]:n.x&&n.y:!1}function Ge(e,t,n){if(typeof t!="string")throw new Error("axis must be in [x, y]");if(typeof n!="number"&&n!==!1)throw new Error("value must be Number or false");var i,r=e[t],o=e.snapped=e.snapped||{};return n===!1?o[t]=!1:(o[t]=!0,i=n-r,e[t]+=i,e["d"+t]+=i),r}function lh(e){return e.children||[]}var Tb=Math.abs,Ku=Math.round,ys=10;function ch(e){function t(o,a){if(Te(o)){for(var l=o.length;l--;)if(Tb(o[l]-a)<=ys)return o[l]}else{o=+o;var s=a%o;if(s<ys)return a-s;if(s>o-ys)return a-s+o}return a}function n(o,a){if(o.waypoints)return gb(a,o);if(o.width)return{x:Ku(o.width/2+o.x),y:Ku(o.height/2+o.y)}}function i(o){var a=o.context,l=a.snapPoints,s=a.connection,c=s.waypoints,p=a.segmentStart,u=a.segmentStartIndex,d=a.segmentEnd,f=a.segmentEndIndex,h=a.axis;if(l)return l;var m=[c[u-1],p,d,c[f+1]];return u<2&&m.unshift(n(s.source,o)),f>c.length-3&&m.unshift(n(s.target,o)),a.snapPoints=l={horizontal:[],vertical:[]},M(m,function(v){v&&(v=v.original||v,h==="y"&&l.horizontal.push(v.y),h==="x"&&l.vertical.push(v.x))}),l}e.on("connectionSegment.move.move",1500,function(o){var a=i(o),l=o.x,s=o.y,c,p;if(a){c=t(a.vertical,l),p=t(a.horizontal,s);var u=l-c,d=s-p;L(o,{dx:o.dx-u,dy:o.dy-d,x:c,y:p}),(u||a.vertical.indexOf(l)!==-1)&&Ge(o,"x",c),(d||a.horizontal.indexOf(s)!==-1)&&Ge(o,"y",p)}});function r(o){var a=o.snapPoints,l=o.connection.waypoints,s=o.bendpointIndex;if(a)return a;var c=[l[s-1],l[s+1]];return o.snapPoints=a={horizontal:[],vertical:[]},M(c,function(p){p&&(p=p.original||p,a.horizontal.push(p.y),a.vertical.push(p.x))}),a}e.on(["connect.hover","connect.move","connect.end"],1500,function(o){var a=o.context,l=a.hover,s=l&&n(l,o);!Ae(l)||!s||!s.x||!s.y||(Ge(o,"x",s.x),Ge(o,"y",s.y))}),e.on(["bendpoint.move.move","bendpoint.move.end"],1500,function(o){var a=o.context,l=r(a),s=a.hover,c=s&&n(s,o),p=o.x,u=o.y,d,f;if(l){d=t(c?l.vertical.concat([c.x]):l.vertical,p),f=t(c?l.horizontal.concat([c.y]):l.horizontal,u);var h=p-d,m=u-f;L(o,{dx:o.dx-h,dy:o.dy-m,x:o.x-h,y:o.y-m}),(h||l.vertical.indexOf(p)!==-1)&&Ge(o,"x",d),(m||l.horizontal.indexOf(u)!==-1)&&Ge(o,"y",f)}})}ch.$inject=["eventBus"];const Pb={__depends__:[Sn,on],__init__:["bendpoints","bendpointSnapping","bendpointMovePreview"],bendpoints:["type",nh],bendpointMove:["type",jl],bendpointMovePreview:["type",ih],connectionSegmentMove:["type",oh],bendpointSnapping:["type",ch]};function uh(e,t,n,i){function r(a,l){return i.allowed("connection.create",{source:a,target:l})}function o(a,l){return r(l,a)}e.on("connect.hover",function(a){var l=a.context,s=l.start,c=a.hover,p;if(l.hover=c,p=l.canExecute=r(s,c),!Os(p)){if(p!==!1){l.source=s,l.target=c;return}p=l.canExecute=o(s,c),!Os(p)&&p!==!1&&(l.source=c,l.target=s)}}),e.on(["connect.out","connect.cleanup"],function(a){var l=a.context;l.hover=null,l.source=null,l.target=null,l.canExecute=!1}),e.on("connect.end",function(a){var l=a.context,s=l.canExecute,c=l.connectionStart,p={x:a.x,y:a.y},u=l.source,d=l.target;if(!s)return!1;var f=null,h={connectionStart:Ys(l)?p:c,connectionEnd:Ys(l)?c:p};vn(s)&&(f=s),l.connection=n.connect(u,d,f,h)}),this.start=function(a,l,s,c){vn(s)||(c=s,s=de(l)),t.init(a,"connect",{autoActivate:c,data:{shape:l,context:{start:l,connectionStart:s}}})}}uh.$inject=["eventBus","dragging","modeling","rules"];function Ys(e){var t=e.hover,n=e.source,i=e.target;return t&&n&&t===n&&n!==i}var Rb=1100,Db=900,Xu="connect-ok",Zu="connect-not-ok";function ph(e,t,n){var i=e.get("connectionPreview",!1);i&&t.on("connect.move",function(r){var o=r.context,a=o.canExecute,l=o.hover,s=o.source,c=o.start,p=o.startPosition,u=o.target,d=o.connectionStart||p,f=o.connectionEnd||{x:r.x,y:r.y},h=d,m=f;Ys(o)&&(h=f,m=d),i.drawPreview(o,a,{source:s||c,target:u||l,connectionStart:h,connectionEnd:m})}),t.on("connect.hover",Db,function(r){var o=r.context,a=r.hover,l=o.canExecute;l!==null&&n.addMarker(a,l?Xu:Zu)}),t.on(["connect.out","connect.cleanup"],Rb,function(r){var o=r.hover;o&&(n.removeMarker(o,Xu),n.removeMarker(o,Zu))}),i&&t.on("connect.cleanup",function(r){i.cleanUp(r.context)})}ph.$inject=["injector","eventBus","canvas"];const Fl={__depends__:[En,on,Sn],__init__:["connectPreview"],connect:["type",uh],connectPreview:["type",ph]};var kb="djs-dragger";function Cn(e,t,n,i){this._canvas=t,this._graphicsFactory=n,this._elementFactory=i,this._connectionDocking=e.get("connectionDocking",!1),this._layouter=e.get("layouter",!1)}Cn.$inject=["injector","canvas","graphicsFactory","elementFactory"];Cn.prototype.drawPreview=function(e,t,n){n=n||{};var i=e.connectionPreviewGfx,r=e.getConnection,o=n.source,a=n.target,l=n.waypoints,s=n.connectionStart,c=n.connectionEnd,p=n.noLayout,u=n.noCropping,d=n.noNoop,f,h=this;if(i||(i=e.connectionPreviewGfx=this.createConnectionPreviewGfx()),bl(i),r||(r=e.getConnection=Ab(function(m,v,S){return h.getConnection(m,v,S)})),t&&(f=r(t,o,a)),!f){!d&&this.drawNoopPreview(i,n);return}f.waypoints=l||[],this._layouter&&!p&&(f.waypoints=this._layouter.layoutConnection(f,{source:o,target:a,connectionStart:s,connectionEnd:c,waypoints:n.waypoints||f.waypoints})),(!f.waypoints||!f.waypoints.length)&&(f.waypoints=[o?de(o):s,a?de(a):c]),this._connectionDocking&&(o||a)&&!u&&(f.waypoints=this._connectionDocking.getCroppedWaypoints(f,o,a)),this._graphicsFactory.drawConnection(i,f,{stroke:"var(--element-dragger-color)"})};Cn.prototype.drawNoopPreview=function(e,t){var n=t.source,i=t.target,r=t.connectionStart||de(n),o=t.connectionEnd||de(i),a=this.cropWaypoints(r,o,n,i),l=this.createNoopConnection(a[0],a[1]);Ce(e,l)};Cn.prototype.cropWaypoints=function(e,t,n,i){var r=this._graphicsFactory,o=n&&r.getShapePath(n),a=i&&r.getShapePath(i),l=r.getConnectionPath({waypoints:[e,t]});return e=n&&Ls(o,l,!0)||e,t=i&&Ls(a,l,!1)||t,[e,t]};Cn.prototype.cleanUp=function(e){e&&e.connectionPreviewGfx&&rt(e.connectionPreviewGfx)};Cn.prototype.getConnection=function(e){var t=Mb(e);return this._elementFactory.createConnection(t)};Cn.prototype.createConnectionPreviewGfx=function(){var e=be("g");return ie(e,{pointerEvents:"none"}),Ne(e).add(kb),Ce(this._canvas.getActiveLayer(),e),e};Cn.prototype.createNoopConnection=function(e,t){return eg([e,t],{stroke:"#333",strokeDasharray:[1],strokeWidth:2,"pointer-events":"none"})};function Ab(e){var t={};return function(n){var i=JSON.stringify(n),r=t[i];return r||(r=t[i]=e.apply(null,arguments)),r}}function Mb(e){return vn(e)?e:{}}const Ib={__init__:["connectionPreview"],connectionPreview:["type",Cn]};var Nb=["marker-start","marker-mid","marker-end"],Ob=["circle","ellipse","line","path","polygon","polyline","path","rect"];function qn(e,t,n,i){this._elementRegistry=e,this._canvas=n,this._styles=i,this._clonedMarkers={};var r=this;t.on("drag.cleanup",function(){r.cleanUp()})}qn.$inject=["elementRegistry","eventBus","canvas","styles"];qn.prototype.cleanUp=function(){var e=this;M(e._clonedMarkers,function(t){rt(t)}),e._clonedMarkers={}};qn.prototype.getGfx=function(e){return this._elementRegistry.getGraphics(e)};qn.prototype.addDragger=function(e,t,n,i="djs-dragger"){n=n||this.getGfx(e);var r=Qd(n),o=n.getBoundingClientRect();return this._cloneMarkers(Fi(r),i),ie(r,this._styles.cls(i,[],{x:o.top,y:o.left})),Ce(t,r),ie(r,"data-preview-support-element-id",e.id),r};qn.prototype.addFrame=function(e,t){var n=be("rect",{class:"djs-resize-overlay",width:e.width,height:e.height,x:e.x,y:e.y});return Ce(t,n),ie(n,"data-preview-support-element-id",e.id),n};qn.prototype._cloneMarkers=function(e,t="djs-dragger"){var n=this;if(e.childNodes)for(var i=0;i<e.childNodes.length;i++)n._cloneMarkers(e.childNodes[i],t);jb(e)&&Nb.forEach(function(r){if(ie(e,r)){var o=Lb(e,r,n._canvas.getContainer());n._cloneMarker(e,o,r,t)}})};qn.prototype._cloneMarker=function(e,t,n,i="djs-dragger"){var r=t.id+"-"+i,o=this._clonedMarkers[r];if(!o){o=Qd(t);var a=r+"-clone";o.id=a,Ne(o).add(i),this._clonedMarkers[r]=o;var l=nt("defs",this._canvas._svg);l||(l=be("defs"),Ce(this._canvas._svg,l)),Ce(l,o)}var s=Bb(this._clonedMarkers[r].id);ie(e,n,s)};function Lb(e,t,n){var i=$b(ie(e,t));return nt("marker#"+i,n||document)}function $b(e){return e.match(/url\(['"]?#([^'"]*)['"]?\)/)[1]}function Bb(e){return"url(#"+e+")"}function jb(e){return Ob.indexOf(e.nodeName)!==-1}const er={__init__:["previewSupport"],previewSupport:["type",qn]},_o="complex-preview";class dh{constructor(t,n,i){this._canvas=t,this._graphicsFactory=n,this._previewSupport=i,this._markers=[]}create(t){this.cleanUp();const{created:n=[],moved:i=[],removed:r=[],resized:o=[]}=t,a=this._canvas.getLayer(_o);n.filter(l=>!Vb(l)).forEach(l=>{let s;Ae(l)?(s=this._graphicsFactory._createContainer("connection",be("g")),this._graphicsFactory.drawConnection(Fi(s),l)):(s=this._graphicsFactory._createContainer("shape",be("g")),this._graphicsFactory.drawShape(Fi(s),l),ht(s,l.x,l.y)),this._previewSupport.addDragger(l,a,s)}),i.forEach(({element:l,delta:s})=>{this._previewSupport.addDragger(l,a,void 0,"djs-dragging"),this._canvas.addMarker(l,"djs-element-hidden"),this._markers.push([l,"djs-element-hidden"]);const c=this._previewSupport.addDragger(l,a);Ae(l)?ht(c,s.x,s.y):ht(c,l.x+s.x,l.y+s.y)}),r.forEach(l=>{this._previewSupport.addDragger(l,a,void 0,"djs-dragging"),this._canvas.addMarker(l,"djs-element-hidden"),this._markers.push([l,"djs-element-hidden"])}),o.forEach(({shape:l,bounds:s})=>{this._canvas.addMarker(l,"djs-hidden"),this._markers.push([l,"djs-hidden"]),this._previewSupport.addDragger(l,a,void 0,"djs-dragging");const c=this._graphicsFactory._createContainer("shape",be("g"));this._graphicsFactory.drawShape(Fi(c),l,{width:s.width,height:s.height}),ht(c,s.x,s.y),this._previewSupport.addDragger(l,a,c)})}cleanUp(){bl(this._canvas.getLayer(_o)),this._markers.forEach(([t,n])=>this._canvas.removeMarker(t,n)),this._markers=[],this._previewSupport.cleanUp()}show(){this._canvas.showLayer(_o)}hide(){this._canvas.hideLayer(_o)}}dh.$inject=["canvas","graphicsFactory","previewSupport"];function Vb(e){return e.hidden}const Fb={__depends__:[er],__init__:["complexPreview"],complexPreview:["type",dh]};var Hl=["top","bottom","left","right"],bo=10;function zl(e,t){Y.call(this,e),this.postExecuted(["connection.create","connection.layout","connection.updateWaypoints"],function(r){var o=r.context,a=o.connection,l=a.source,s=a.target,c=o.hints||{};c.createElementsBehavior!==!1&&(n(l),n(s))}),this.postExecuted(["label.create"],function(r){var o=r.context,a=o.shape,l=o.hints||{};l.createElementsBehavior!==!1&&n(a.labelTarget)}),this.postExecuted(["elements.create"],function(r){var o=r.context,a=o.elements,l=o.hints||{};l.createElementsBehavior!==!1&&a.forEach(function(s){n(s)})});function n(r){if(fa(r)){var o=Ub(r);o&&i(r,o)}}function i(r,o){var a=de(r),l=r.label,s=de(l);if(l.parent){var c=ae(r),p;switch(o){case"top":p={x:a.x,y:c.top-bo-l.height/2};break;case"left":p={x:c.left-bo-l.width/2,y:a.y};break;case"bottom":p={x:a.x,y:c.bottom+bo+l.height/2};break;case"right":p={x:c.right+bo+l.width/2,y:a.y};break}var u=Ut(p,s);t.moveShape(l,u)}}}te(zl,Y);zl.$inject=["eventBus","modeling"];function Hb(e){var t=e.host,n=de(e),i=pt(n,t),r;i.indexOf("-")>=0?r=i.split("-"):r=[i];var o=Hl.filter(function(a){return r.indexOf(a)===-1});return o}function zb(e){var t=de(e),n=[].concat(e.incoming.map(function(i){return i.waypoints[i.waypoints.length-2]}),e.outgoing.map(function(i){return i.waypoints[1]})).map(function(i){return fh(t,i)});return n}function Ub(e){var t=de(e.label),n=de(e),i=fh(n,t);if(Gb(i)){var r=zb(e);if(e.host){var o=Hb(e);r=r.concat(o)}var a=Hl.filter(function(l){return r.indexOf(l)===-1});if(a.indexOf(i)===-1)return a[0]}}function fh(e,t){return pt(t,e,5)}function Gb(e){return Hl.indexOf(e)!==-1}function Ul(e){Y.call(this,e),this.preExecute("shape.append",function(t){var n=t.source,i=t.shape;t.position||(y(i,"bpmn:TextAnnotation")?t.position={x:n.x+n.width/2+75,y:n.y-50-i.height/2}:t.position={x:n.x+n.width+80+i.width/2,y:n.y+n.height/2})},!0)}te(Ul,Y);Ul.$inject=["eventBus"];function Gl(e,t){e.invoke(Y,this),this.postExecute("shape.move",function(n){var i=n.newParent,r=n.shape,o=_e(r.incoming.concat(r.outgoing),function(a){return y(a,"bpmn:Association")});M(o,function(a){t.moveConnection(a,{x:0,y:0},i)})},!0)}te(Gl,Y);Gl.$inject=["injector","modeling"];var Qu=500;function Sa(e,t){t.invoke(Y,this),this._bpmnReplace=e;var n=this;this.postExecuted("elements.create",Qu,function(i){var r=i.elements;r=r.filter(function(o){var a=o.host;return Ju(o,a)}),r.length===1&&r.map(function(o){return r.indexOf(o)}).forEach(function(o){var a=r[o];i.elements[o]=n._replaceShape(r[o],a)})},!0),this.preExecute("elements.move",Qu,function(i){var r=i.shapes,o=i.newHost;if(r.length===1){var a=r[0];Ju(a,o)&&(i.shapes=[n._replaceShape(a,o)])}},!0)}Sa.$inject=["bpmnReplace","injector"];te(Sa,Y);Sa.prototype._replaceShape=function(e,t){var n=Wb(e),i={type:"bpmn:BoundaryEvent",host:t};return n&&(i.eventDefinitionType=n.$type),this._bpmnReplace.replaceElement(e,i,{layoutConnection:!1})};function Wb(e){var t=Q(e),n=t.eventDefinitions;return n&&n[0]}function Ju(e,t){return!xe(e)&&ve(e,["bpmn:IntermediateThrowEvent","bpmn:IntermediateCatchEvent"])&&!!t}function Wl(e,t){Y.call(this,e);function n(i){return _e(i.attachers,function(r){return y(r,"bpmn:BoundaryEvent")})}this.postExecute("connection.create",function(i){var r=i.context.source,o=i.context.target,a=n(o);y(r,"bpmn:EventBasedGateway")&&y(o,"bpmn:ReceiveTask")&&a.length>0&&t.removeElements(a)}),this.postExecute("connection.reconnect",function(i){var r=i.context.oldSource,o=i.context.newSource;y(r,"bpmn:Gateway")&&y(o,"bpmn:EventBasedGateway")&&M(o.outgoing,function(a){var l=a.target,s=n(l);y(l,"bpmn:ReceiveTask")&&s.length>0&&t.removeElements(s)})})}Wl.$inject=["eventBus","modeling"];te(Wl,Y);function Yl(e,t,n){Y.call(this,e),this.preExecute("shape.replace",l,!0),this.postExecuted("shape.replace",s,!0),this.preExecute("connection.create",r,!0),this.postExecuted("connection.delete",i,!0),this.postExecuted("connection.reconnect",o,!0),this.postExecuted("element.updateProperties",a,!0);function i(v){const S=v.source,b=v.target;Mi(S)&&dr(b)&&p(b)}function r(v){const S=v.connection,b=v.source,w=v.target;Mi(b)&&Eo(w)&&(c(w),d(b,[S]))}function o(v){const S=v.newTarget,b=v.oldSource,w=v.oldTarget;if(w!==S){const C=b;dr(w)&&p(w),Mi(C)&&Eo(S)&&c(S)}}function a(v){const{element:S}=v;dr(S)?(u(S),f(S)):Eo(S)&&h(S)}function l(v){const{newData:S,oldShape:b}=v;if(Mi(v.oldShape)&&S.eventDefinitionType!=="bpmn:CompensateEventDefinition"||S.type!=="bpmn:BoundaryEvent"){const w=b.outgoing.find(({target:C})=>dr(C));w&&w.target&&(v._connectionTarget=w.target)}else if(!Mi(v.oldShape)&&S.eventDefinitionType==="bpmn:CompensateEventDefinition"&&S.type==="bpmn:BoundaryEvent"){const w=b.outgoing.find(({target:C})=>Eo(C));w&&w.target&&(v._connectionTarget=w.target),m(b)}}function s(v){const{_connectionTarget:S,newShape:b}=v;S&&t.connect(b,S)}function c(v){t.updateProperties(v,{isForCompensation:!0})}function p(v){t.updateProperties(v,{isForCompensation:void 0})}function u(v){for(const S of v.incoming)n.canConnect(S.source,v)||t.removeConnection(S);for(const S of v.outgoing)n.canConnect(v,S.target)||t.removeConnection(S)}function d(v,S){v.outgoing.filter(C=>y(C,"bpmn:Association")).filter(C=>dr(C.target)&&!S.includes(C)).forEach(C=>t.removeConnection(C))}function f(v){const S=v.attachers.slice();S.length&&t.removeElements(S)}function h(v){const S=v.incoming.filter(b=>Mi(b.source));t.removeElements(S)}function m(v){const S=v.outgoing.filter(b=>y(b,"bpmn:SequenceFlow"));t.removeElements(S)}}te(Yl,Y);Yl.$inject=["eventBus","modeling","bpmnRules"];function dr(e){const t=Q(e);return t&&t.get("isForCompensation")}function Mi(e){return e&&y(e,"bpmn:BoundaryEvent")&&Jd(e,"bpmn:CompensateEventDefinition")}function Eo(e){return e&&y(e,"bpmn:Activity")&&!mt(e)}function ql(e){e.invoke(Y,this),this.preExecute("shape.create",1500,function(t){var n=t.context,i=n.parent,r=n.shape;y(i,"bpmn:Lane")&&!y(r,"bpmn:Lane")&&(n.parent=Qo(i,"bpmn:Participant"))})}ql.$inject=["injector"];te(ql,Y);function Kl(e,t){Y.call(this,e),this.preExecute("shape.create",function(n){var i=n.context,r=i.shape;if(y(r,"bpmn:DataObjectReference")&&r.type!=="label"){var o=t.create("bpmn:DataObject");r.businessObject.dataObjectRef=o}})}Kl.$inject=["eventBus","bpmnFactory"];te(Kl,Y);var qs=20,Ks=20,hh=30,xo=2e3;function Xl(e,t,n){Y.call(this,t),t.on(["create.start","shape.move.start"],xo,function(r){var o=r.context,a=o.shape,l=e.getRootElement();if(!(!y(a,"bpmn:Participant")||!y(l,"bpmn:Process")||!l.children.length)){var s=l.children.filter(function(u){return!y(u,"bpmn:Group")&&!xe(u)&&!Ae(u)});if(s.length){var c=Tt(s),p=Yb(a,c);L(a,p),o.createConstraints=qb(a,c)}}}),t.on("create.start",xo,function(r){var o=r.context,a=o.shape,l=e.getRootElement(),s=e.getGraphics(l);function c(p){p.element=l,p.gfx=s}y(a,"bpmn:Participant")&&y(l,"bpmn:Process")&&(t.on("element.hover",xo,c),t.once("create.cleanup",function(){t.off("element.hover",c)}))});function i(){var r=e.getRootElement();return y(r,"bpmn:Collaboration")?r:n.makeCollaboration()}this.preExecute("elements.create",xo,function(r){var o=r.elements,a=r.parent,l=Kb(o),s;l&&y(a,"bpmn:Process")&&(r.parent=i(),s=r.hints=r.hints||{},s.participant=l,s.process=a,s.processRef=Q(l).get("processRef"))},!0),this.preExecute("shape.create",function(r){var o=r.parent,a=r.shape;y(a,"bpmn:Participant")&&y(o,"bpmn:Process")&&(r.parent=i(),r.process=o,r.processRef=Q(a).get("processRef"))},!0),this.execute("shape.create",function(r){var o=r.hints||{},a=r.process||o.process,l=r.shape,s=o.participant;a&&(!s||l===s)&&Q(l).set("processRef",Q(a))},!0),this.revert("shape.create",function(r){var o=r.hints||{},a=r.process||o.process,l=r.processRef||o.processRef,s=r.shape,c=o.participant;a&&(!c||s===c)&&Q(s).set("processRef",l)},!0),this.postExecute("shape.create",function(r){var o=r.hints||{},a=r.process||r.hints.process,l=r.shape,s=o.participant;if(a){var c=a.children.slice();s?l===s&&n.moveElements(c,{x:0,y:0},s):n.moveElements(c,{x:0,y:0},l)}},!0)}Xl.$inject=["canvas","eventBus","modeling"];te(Xl,Y);function Yb(e,t){t={width:t.width+qs*2+hh,height:t.height+Ks*2};var n=Math.max(e.width,t.width),i=Math.max(e.height,t.height);return{x:-n/2,y:-i/2,width:n,height:i}}function qb(e,t){return t=ae(t),{bottom:t.top+e.height/2-Ks,left:t.right-e.width/2+qs,top:t.bottom-e.height/2+Ks,right:t.left+e.width/2-qs-hh}}function Kb(e){return Oe(e,function(t){return y(t,"bpmn:Participant")})}var ep="__targetRef_placeholder";function Zl(e,t){Y.call(this,e),this.executed(["connection.create","connection.delete","connection.move","connection.reconnect"],tp(o)),this.reverted(["connection.create","connection.delete","connection.move","connection.reconnect"],tp(o));function n(a,l,s){var c=a.get("dataInputAssociations");return Oe(c,function(p){return p!==s&&p.targetRef===l})}function i(a,l){var s=a.get("properties"),c=Oe(s,function(p){return p.name===ep});return!c&&l&&(c=t.create("bpmn:Property",{name:ep}),Je(s,c)),c}function r(a,l){var s=i(a);s&&(n(a,s,l)||Xe(a.get("properties"),s))}function o(a){var l=a.context,s=l.connection,c=s.businessObject,p=s.target,u=p&&p.businessObject,d=l.newTarget,f=d&&d.businessObject,h=l.oldTarget||l.target,m=h&&h.businessObject,v=s.businessObject,S;m&&m!==u&&r(m,c),f&&f!==u&&r(f,c),u?(S=i(u,!0),v.targetRef=S):v.targetRef=null}}Zl.$inject=["eventBus","bpmnFactory"];te(Zl,Y);function tp(e){return function(t){var n=t.context,i=n.connection;if(y(i,"bpmn:DataInputAssociation"))return e(t)}}function Ca(e){this._bpmnUpdater=e}Ca.$inject=["bpmnUpdater"];Ca.prototype.execute=function(e){var t=e.dataStoreBo,n=e.dataStoreDi,i=e.newSemanticParent,r=e.newDiParent;return e.oldSemanticParent=t.$parent,e.oldDiParent=n.$parent,this._bpmnUpdater.updateSemanticParent(t,i),this._bpmnUpdater.updateDiParent(n,r),[]};Ca.prototype.revert=function(e){var t=e.dataStoreBo,n=e.dataStoreDi,i=e.oldSemanticParent,r=e.oldDiParent;return this._bpmnUpdater.updateSemanticParent(t,i),this._bpmnUpdater.updateDiParent(n,r),[]};function Ql(e,t,n,i){Y.call(this,i),t.registerHandler("dataStore.updateContainment",Ca);function r(){return n.filter(function(l){return y(l,"bpmn:Participant")&&Q(l).processRef})[0]}function o(l){return l.children.filter(function(s){return y(s,"bpmn:DataStoreReference")&&!s.labelTarget})}function a(l,s){var c=l.businessObject||l;if(s=s||r(),s){var p=s.businessObject||s;t.execute("dataStore.updateContainment",{dataStoreBo:c,dataStoreDi:Me(l),newSemanticParent:p.processRef||p,newDiParent:Me(s)})}}this.preExecute("shape.create",function(l){var s=l.context,c=s.shape;y(c,"bpmn:DataStoreReference")&&c.type!=="label"&&(s.hints||(s.hints={}),s.hints.autoResize=!1)}),this.preExecute("elements.move",function(l){var s=l.context,c=s.shapes,p=c.filter(function(u){return y(u,"bpmn:DataStoreReference")});p.length&&(s.hints||(s.hints={}),s.hints.autoResize=c.filter(function(u){return!y(u,"bpmn:DataStoreReference")}))}),this.postExecute("shape.create",function(l){var s=l.context,c=s.shape,p=c.parent;y(c,"bpmn:DataStoreReference")&&c.type!=="label"&&y(p,"bpmn:Collaboration")&&a(c)}),this.postExecute("shape.move",function(l){var s=l.context,c=s.shape,p=s.oldParent,u=c.parent;if(!y(p,"bpmn:Collaboration")&&y(c,"bpmn:DataStoreReference")&&c.type!=="label"&&y(u,"bpmn:Collaboration")){var d=y(p,"bpmn:Participant")?p:Zb(p,"bpmn:Participant");a(c,d)}}),this.postExecute("shape.delete",function(l){var s=l.context,c=s.shape,p=e.getRootElement();ve(c,["bpmn:Participant","bpmn:SubProcess"])&&y(p,"bpmn:Collaboration")&&o(p).filter(function(u){return Xb(u,c)}).forEach(function(u){a(u)})}),this.postExecute("canvas.updateRoot",function(l){var s=l.context,c=s.oldRoot,p=s.newRoot,u=o(c);u.forEach(function(d){y(p,"bpmn:Process")&&a(d,p)})})}Ql.$inject=["canvas","commandStack","elementRegistry","eventBus"];te(Ql,Y);function Xb(e,t){for(var n=e.businessObject||e,i=t.businessObject||t;n.$parent;){if(n.$parent===i.processRef||i)return!0;n=n.$parent}return!1}function Zb(e,t){for(;e.parent;){if(y(e.parent,t))return e.parent;e=e.parent}}var ta=Math.max,na=Math.min,Qb=20;function mh(e,t){return{top:e.top-t.top,right:e.right-t.right,bottom:e.bottom-t.bottom,left:e.left-t.left}}function Jb(e,t,n){var i=n.x,r=n.y,o={x:e.x,y:e.y,width:e.width,height:e.height};return t.indexOf("n")!==-1?(o.y=e.y+r,o.height=e.height-r):t.indexOf("s")!==-1&&(o.height=e.height+r),t.indexOf("e")!==-1?o.width=e.width+i:t.indexOf("w")!==-1&&(o.x=e.x+i,o.width=e.width-i),o}function eE(e,t){return{x:e.x+(t.left||0),y:e.y+(t.top||0),width:e.width-(t.left||0)+(t.right||0),height:e.height-(t.top||0)+(t.bottom||0)}}function wo(e,t,n){var i=t[e],r=n.min&&n.min[e],o=n.max&&n.max[e];return ye(r)&&(i=(/top|left/.test(e)?na:ta)(i,r)),ye(o)&&(i=(/top|left/.test(e)?ta:na)(i,o)),i}function tE(e,t){if(!t)return e;var n=ae(e);return yl({top:wo("top",n,t),right:wo("right",n,t),bottom:wo("bottom",n,t),left:wo("left",n,t)})}function nE(e,t,n,i){var r=ae(t),o={top:/n/.test(e)?r.bottom-n.height:r.top,left:/w/.test(e)?r.right-n.width:r.left,bottom:/s/.test(e)?r.top+n.height:r.bottom,right:/e/.test(e)?r.left+n.width:r.right},a=i?ae(i):o,l={top:na(o.top,a.top),left:na(o.left,a.left),bottom:ta(o.bottom,a.bottom),right:ta(o.right,a.right)};return yl(l)}function fr(e,t){return typeof e<"u"?e:Qb}function iE(e,t){var n,i,r,o;return typeof t=="object"?(n=fr(t.left),i=fr(t.right),r=fr(t.top),o=fr(t.bottom)):n=i=r=o=fr(t),{x:e.x-n,y:e.y-r,width:e.width+n+i,height:e.height+r+o}}function rE(e){return!(e.waypoints||e.type==="label")}function vh(e,t){var n;if(e.length===void 0?n=_e(e.children,rE):n=e,n.length)return iE(Tt(n),t)}var In=Math.abs;function oE(e,t){return mh(ae(t),ae(e))}var aE=["bpmn:Participant","bpmn:Process","bpmn:SubProcess"],Vi=30;function Ta(e,t){return t=t||[],e.children.filter(function(n){y(n,"bpmn:Lane")&&(Ta(n,t),t.push(n))}),t}function Kn(e){return e.children.filter(function(t){return y(t,"bpmn:Lane")})}function Mt(e){return Qo(e,aE)||e}function sE(e,t){var n=Mt(e),i=y(n,"bpmn:Process")?[]:[n],r=Ta(n,i),o=ae(e),a=ae(t),l=oE(e,t),s=[],c=gn(e);return r.forEach(function(p){if(p!==e){var u=c?0:l.top,d=c?l.right:0,f=c?0:l.bottom,h=c?l.left:0,m=ae(p);l.top&&(In(m.bottom-o.top)<10&&(f=a.top-m.bottom),In(m.top-o.top)<5&&(u=a.top-m.top)),l.left&&(In(m.right-o.left)<10&&(d=a.left-m.right),In(m.left-o.left)<5&&(h=a.left-m.left)),l.bottom&&(In(m.top-o.bottom)<10&&(u=a.bottom-m.top),In(m.bottom-o.bottom)<5&&(f=a.bottom-m.bottom)),l.right&&(In(m.left-o.right)<10&&(h=a.right-m.left),In(m.right-o.right)<5&&(d=a.right-m.right)),(u||d||f||h)&&s.push({shape:p,newBounds:eE(p,{top:u,right:d,bottom:f,left:h})})}}),s}var lE=500;function Jl(e,t){Y.call(this,e);function n(i,r){var o=gn(i),a=Kn(r),l=[],s=[],c=[],p=[];if(ha(a,function(v){return o?v.y>i.y?s.push(v):l.push(v):v.x>i.x?p.push(v):c.push(v),v.children}),!!a.length){var u;o?s.length&&l.length?u=i.height/2:u=i.height:p.length&&c.length?u=i.width/2:u=i.width;var d,f,h,m;l.length&&(d=t.calculateAdjustments(l,"y",u,i.y-10),t.makeSpace(d.movingShapes,d.resizingShapes,{x:0,y:u},"s")),s.length&&(f=t.calculateAdjustments(s,"y",-u,i.y+i.height+10),t.makeSpace(f.movingShapes,f.resizingShapes,{x:0,y:-u},"n")),c.length&&(h=t.calculateAdjustments(c,"x",u,i.x-10),t.makeSpace(h.movingShapes,h.resizingShapes,{x:u,y:0},"e")),p.length&&(m=t.calculateAdjustments(p,"x",-u,i.x+i.width+10),t.makeSpace(m.movingShapes,m.resizingShapes,{x:-u,y:0},"w"))}}this.postExecuted("shape.delete",lE,function(i){var r=i.context,o=r.hints,a=r.shape,l=r.oldParent;y(a,"bpmn:Lane")&&(o&&o.nested||n(a,l))})}Jl.$inject=["eventBus","spaceTool"];te(Jl,Y);var np=500;function Pa(e,t){t.invoke(Y,this),this._bpmnReplace=e;var n=this;this.postExecuted("elements.create",np,function(i){var r=i.elements;r.filter(function(o){var a=o.host;return ip(o,a)}).map(function(o){return r.indexOf(o)}).forEach(function(o){i.elements[o]=n._replaceShape(r[o])})},!0),this.preExecute("elements.move",np,function(i){var r=i.shapes,o=i.newHost;r.forEach(function(a,l){var s=a.host;ip(a,uE(r,s)?s:o)&&(r[l]=n._replaceShape(a))})},!0)}Pa.$inject=["bpmnReplace","injector"];te(Pa,Y);Pa.prototype._replaceShape=function(e){var t=cE(e),n;return t?n={type:"bpmn:IntermediateCatchEvent",eventDefinitionType:t.$type}:n={type:"bpmn:IntermediateThrowEvent"},this._bpmnReplace.replaceElement(e,n,{layoutConnection:!1})};function cE(e){var t=Q(e),n=t.eventDefinitions;return n&&n[0]}function ip(e,t){return!xe(e)&&y(e,"bpmn:BoundaryEvent")&&!t}function uE(e,t){return e.indexOf(t)!==-1}function ec(e,t,n){Y.call(this,e);function i(r,o,a){var l=o.waypoints,s,c,p,u,d,f,h,m=r.outgoing.slice(),v=r.incoming.slice(),S;ye(a.width)?S=de(a):S=a;var b=zs(l,S);if(b){if(s=l.slice(0,b.index),c=l.slice(b.index+(b.bendpoint?1:0)),!s.length||!c.length)return;p=b.bendpoint?l[b.index]:S,(s.length===1||!rp(r,s[s.length-1]))&&s.push(op(p)),(c.length===1||!rp(r,c[0]))&&c.unshift(op(p))}u=o.source,d=o.target,t.canConnect(u,r,o)&&(n.reconnectEnd(o,r,s||S),f=o),t.canConnect(r,d,o)&&(f?h=n.connect(r,d,{type:o.type,waypoints:c}):(n.reconnectStart(o,r,c||S),h=o));var w=[].concat(f&&_e(v,function(C){return C.source===f.source})||[],h&&_e(m,function(C){return C.target===h.target})||[]);w.length&&n.removeElements(w)}this.preExecute("elements.move",function(r){var o=r.newParent,a=r.shapes,l=r.delta,s=a[0];if(!(!s||!o)){o&&o.waypoints&&(r.newParent=o=o.parent);var c=de(s),p={x:c.x+l.x,y:c.y+l.y},u=Oe(o.children,function(d){var f=t.canInsert(a,d);return f&&zs(d.waypoints,p)});u&&(r.targetFlow=u,r.position=p)}},!0),this.postExecuted("elements.move",function(r){var o=r.shapes,a=r.targetFlow,l=r.position;a&&i(o[0],a,l)},!0),this.preExecute("shape.create",function(r){var o=r.parent,a=r.shape;t.canInsert(a,o)&&(r.targetFlow=o,r.parent=o.parent)},!0),this.postExecuted("shape.create",function(r){var o=r.shape,a=r.targetFlow,l=r.position;a&&i(o,a,l)},!0)}te(ec,Y);ec.$inject=["eventBus","bpmnRules","modeling"];function rp(e,t){var n=t.x,i=t.y;return n>=e.x&&n<=e.x+e.width&&i>=e.y&&i<=e.y+e.height}function op(e){return L({},e)}function tc(e,t){Y.call(this,e),this.preExecuted("connection.create",function(n){var i=n.context,r=i.connection,o=i.source,a=i.target,l=i.hints;if(!(l&&l.createElementsBehavior===!1)&&Ii(r)){var s=[];y(o,"bpmn:EventBasedGateway")?s=a.incoming.filter(c=>c!==r&&Ii(c)):s=a.incoming.filter(c=>c!==r&&Ii(c)&&y(c.source,"bpmn:EventBasedGateway")),s.forEach(function(c){t.removeConnection(c)})}}),this.preExecuted("shape.replace",function(n){var i=n.context,r=i.newShape;if(y(r,"bpmn:EventBasedGateway")){var o=r.outgoing.filter(Ii).reduce(function(a,l){return a.includes(l.target)?a:a.concat(l.target)},[]);o.forEach(function(a){a.incoming.filter(Ii).forEach(function(l){const s=a.incoming.filter(Ii).filter(function(c){return c.source===r});(l.source!==r||s.length>1)&&t.removeConnection(l)})})}})}tc.$inject=["eventBus","modeling"];te(tc,Y);function Ii(e){return y(e,"bpmn:SequenceFlow")}var So=1500,ap=2e3;function gh(e,t,n){t.on(["create.hover","create.move","create.out","create.end","shape.move.hover","shape.move.move","shape.move.out","shape.move.end"],So,function(i){var r=i.context,o=r.shape||i.shape,a=i.hover;y(a,"bpmn:Lane")&&!ve(o,["bpmn:Lane","bpmn:Participant"])&&(i.hover=Mt(a),i.hoverGfx=e.getGraphics(i.hover));var l=n.getRootElement();a!==l&&(o.labelTarget||ve(o,["bpmn:Group","bpmn:TextAnnotation"]))&&(i.hover=l,i.hoverGfx=e.getGraphics(i.hover))}),t.on(["connect.hover","connect.out","connect.end","connect.cleanup","global-connect.hover","global-connect.out","global-connect.end","global-connect.cleanup"],So,function(i){var r=i.hover;y(r,"bpmn:Lane")&&(i.hover=Mt(r)||r,i.hoverGfx=e.getGraphics(i.hover))}),t.on(["bendpoint.move.hover"],So,function(i){var r=i.context,o=i.hover,a=r.type;y(o,"bpmn:Lane")&&/reconnect/.test(a)&&(i.hover=Mt(o)||o,i.hoverGfx=e.getGraphics(i.hover))}),t.on(["connect.start"],So,function(i){var r=i.context,o=r.start;y(o,"bpmn:Lane")&&(r.start=Mt(o)||o)}),t.on("shape.move.start",ap,function(i){var r=i.shape;y(r,"bpmn:Lane")&&(i.shape=Mt(r)||r)}),t.on("spaceTool.move",ap,function(i){var r=i.hover;r&&y(r,"bpmn:Lane")&&(i.hover=Mt(r))})}gh.$inject=["elementRegistry","eventBus","canvas"];function pE(e){return e.create("bpmn:Category")}function dE(e){return e.create("bpmn:CategoryValue")}function fE(e,t,n){return Je(t.get("categoryValue"),e),e.$parent=t,Je(n.get("rootElements"),t),t.$parent=n,e}function hE(e){var t=e.$parent;return t&&(Xe(t.get("categoryValue"),e),e.$parent=null),e}function mE(e){var t=e.$parent;return t&&(Xe(t.get("rootElements"),e),e.$parent=null),e}var sp=770;function nc(e,t,n,i,r,o){r.invoke(Y,this);function a(){return n.filter(function(h){return y(h,"bpmn:Group")})}function l(h,m){return h.some(function(v){var S=Q(v),b=S.categoryValueRef&&S.categoryValueRef.$parent;return b===m})}function s(h,m){return h.some(function(v){var S=Q(v);return S.categoryValueRef===m})}function c(h,m,v){var S=a().filter(function(b){return b.businessObject!==v});m&&!l(S,m)&&mE(m),h&&!s(S,h)&&hE(h)}function p(h,m){return fE(h,m,t.getDefinitions())}function u(h,m){var v=Q(h),S=v.categoryValueRef;S||(S=v.categoryValueRef=m.categoryValue=m.categoryValue||dE(e));var b=S.$parent;b||(b=S.$parent=m.category=m.category||pE(e)),p(S,b,t.getDefinitions())}function d(h,m){var v=m.category,S=m.categoryValue,b=Q(h);S?(b.categoryValueRef=null,c(S,v,b)):c(null,b.categoryValueRef.$parent,b)}this.execute("label.create",function(h){var m=h.context,v=m.labelTarget;y(v,"bpmn:Group")&&u(v,m)}),this.revert("label.create",function(h){var m=h.context,v=m.labelTarget;y(v,"bpmn:Group")&&d(v,m)}),this.execute("shape.delete",function(h){var m=h.context,v=m.shape,S=Q(v);if(!(!y(v,"bpmn:Group")||v.labelTarget)){var b=m.categoryValue=S.categoryValueRef,w;b&&(w=m.category=b.$parent,c(b,w,S),S.categoryValueRef=null)}}),this.reverted("shape.delete",function(h){var m=h.context,v=m.shape;if(!(!y(v,"bpmn:Group")||v.labelTarget)){var S=m.category,b=m.categoryValue,w=Q(v);b&&(w.categoryValueRef=b,p(b,S))}}),this.execute("shape.create",function(h){var m=h.context,v=m.shape;!y(v,"bpmn:Group")||v.labelTarget||Q(v).categoryValueRef&&u(v,m)}),this.reverted("shape.create",function(h){var m=h.context,v=m.shape;!y(v,"bpmn:Group")||v.labelTarget||Q(v).categoryValueRef&&d(v,m)});function f(h,m){var v=e.create(h.$type);return o.copyElement(h,v,null,m)}i.on("copyPaste.copyElement",sp,function(h){var m=h.descriptor,v=h.element;if(!(!y(v,"bpmn:Group")||v.labelTarget)){var S=Q(v);if(S.categoryValueRef){var b=S.categoryValueRef;m.categoryValue=f(b,!0),b.$parent&&(m.category=f(b.$parent,!0))}}}),i.on("copyPaste.pasteElement",sp,function(h){var m=h.descriptor,v=m.businessObject,S=m.categoryValue,b=m.category;S&&(S=v.categoryValueRef=f(S)),b&&(S.$parent=f(b)),delete m.category,delete m.categoryValue})}nc.$inject=["bpmnFactory","bpmnjs","elementRegistry","eventBus","injector","moddleCopy"];te(nc,Y);function Xs(e,t,n,i){var r,o,a,l,s;return r=(i.y-n.y)*(t.x-e.x)-(i.x-n.x)*(t.y-e.y),r==0?null:(o=e.y-n.y,a=e.x-n.x,s=(i.x-n.x)*o-(i.y-n.y)*a,l=s/r,{x:Math.round(e.x+l*(t.x-e.x)),y:Math.round(e.y+l*(t.y-e.y))})}function yh(e){function t(i,r,o){var a={x:o.x,y:o.y-50},l={x:o.x-50,y:o.y},s=Xs(i,r,o,a),c=Xs(i,r,o,l),p;s&&c?lp(s,o)>lp(c,o)?p=c:p=s:p=s||c,i.original=p}function n(i){var r=i.waypoints;t(r[0],r[1],de(i.source)),t(r[r.length-1],r[r.length-2],de(i.target))}e.on("bpmnElement.added",function(i){var r=i.element;r.waypoints&&n(r)})}yh.$inject=["eventBus"];function lp(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function ic(e){Y.call(this,e);var t=["bpmn:Participant","bpmn:Lane"];this.executed(["shape.move","shape.create","shape.resize"],function(n){var i=n.context.shape,r=Q(i),o=Me(i);if(ve(r,t)){var a=o.get("isHorizontal");a===void 0&&(a=!0),o.set("isHorizontal",a)}})}ic.$inject=["eventBus"];te(ic,Y);var _h=Math.sqrt,bh=Math.min,vE=Math.max,cp=Math.abs;function up(e){return Math.pow(e,2)}function hr(e,t){return _h(up(e.x-t.x)+up(e.y-t.y))}function gE(e,t){var n=0,i,r,o,a,l,s,c,p,u,d,f;for(n=0;n<t.length-1;n++){if(i=t[n],r=t[n+1],dp(i,r)?c=[i]:(o=hr(e,i),a=hr(e,r),s=bh(o,a),c=yE(i,r,e,s)),c.length<1)throw new Error("expected between [1, 2] circle -> line intersections");c.length===1&&(p={type:"bendpoint",position:c[0],segmentIndex:n,bendpointIndex:dp(i,c[0])?n:n+1}),c.length===2&&(l=bE(c[0],c[1]),p={type:"segment",position:l,segmentIndex:n,relativeLocation:hr(i,l)/hr(i,r)}),u=hr(p.position,e),(!f||d>u)&&(f=p,d=u)}return f}function yE(e,t,n,i){var r=t.x-e.x,o=t.y-e.y,a=n.x-e.x,l=n.y-e.y,s=r*r+o*o,c=r*a+o*l,p=a*a+l*l-i*i,u=c/s,d=p/s,f=u*u-d;if(f<0&&f>-1e-6&&(f=0),f<0)return[];var h=_h(f),m=-u+h,v=-u-h,S={x:e.x-r*m,y:e.y-o*m};if(f===0)return[S];var b={x:e.x-r*v,y:e.y-o*v};return[S,b].filter(function(w){return _E(w,e,t)})}function _E(e,t,n){return pp(e.x,t.x,n.x)&&pp(e.y,t.y,n.y)}function pp(e,t,n){return e>=bh(t,n)-ia&&e<=vE(t,n)+ia}function bE(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}var ia=.1;function dp(e,t){return cp(e.x-t.x)<=ia&&cp(e.y-t.y)<=ia}function EE(e,t,n,i){var r=n.segmentIndex,o=t.length-e.length;if(i.segmentMove){var a=i.segmentMove.segmentStartIndex,l=i.segmentMove.newSegmentStartIndex;return r===a?l:r>=l?r+o<l?l:r+o:r}if(i.bendpointMove){var s=i.bendpointMove.insert,c=i.bendpointMove.bendpointIndex,p;if(o===0)return r;if(r>=c&&(p=s?r+1:r-1),r<c&&(p=r,s&&n.type!=="bendpoint"&&c-1===r)){var u=xh(t,c);u<n.relativeLocation&&p++}return p}return o===0?r:i.connectionStart&&r===0?0:i.connectionEnd&&r===e.length-2?t.length-2:Math.floor((t.length-2)/2)}function Eh(e,t,n,i){var r=0,o=0,a={point:e,delta:{x:0,y:0}},l=gE(e,n),s=l.segmentIndex,c=EE(n,t,l,i);if(c<0||c>t.length-2||c===null)return a;var p=fp(n,s),u=fp(t,c),d=l.position,f=wE(p,d),h=xE(p,u);if(l.type==="bendpoint"){var m=t.length-n.length,v=l.bendpointIndex,S=n[v];if(t.indexOf(S)!==-1)return a;if(m===0){var b=t[v];return r=b.x-l.position.x,o=b.y-l.position.y,{delta:{x:r,y:o},point:{x:e.x+r,y:e.y+o}}}m<0&&v!==0&&v<n.length-1&&(f=xh(n,v))}var w={x:(u[1].x-u[0].x)*f+u[0].x,y:(u[1].y-u[0].y)*f+u[0].y},C=fb({x:e.x-d.x,y:e.y-d.y},h);return r=w.x+C.x-e.x,o=w.y+C.y-e.y,{point:Cr(w),delta:Cr({x:r,y:o})}}function xh(e,t){var n=Jo(e[t-1],e[t]),i=Jo(e[t],e[t+1]),r=n/(n+i);return r}function xE(e,t){var n=$u(e),i=$u(t);return i-n}function fp(e,t){return[e[t],e[t+1]]}function wE(e,t){var n=Jo(e[0],e[1]),i=Jo(e[0],t);return n===0?0:i/n}function SE(e,t,n,i){var r=de(e);return Eh(r,t,n,i).delta}function Br(e,t,n){var i=yr(t),r=yr(n),o=Ut(e,i),a={x:o.x*(n.width/t.width),y:o.y*(n.height/t.height)};return Cr({x:r.x+a.x,y:r.y+a.y})}function hp(e,t,n){var i=yr(e),r=yr(t),o=yr(n),a=Ut(e,i),l=Ut(i,r),s=CE(i,t,n);if(s)return s;var c={x:l.x*(n.width/t.width),y:l.y*(n.height/t.height)},p={x:o.x+c.x,y:o.y+c.y};return Cr({x:p.x+a.x-e.x,y:p.y+a.y-e.y})}function CE(e,t,n){var i=ae(t),r=ae(n);if(TE(i,r))return null;var o=pt(t,e),a,l,s;if(o==="top")a={x:0,y:r.bottom-i.bottom};else if(o==="bottom")a={x:0,y:r.top-i.top};else if(o==="right")a={x:r.left-i.left,y:0};else if(o==="left")a={x:r.right-i.right,y:0};else return null;return l={x:e.x+a.x,y:e.y+a.y},s=pt(n,l),s!==o?null:a}function TE(e,t){return PE(e,t)||RE(e,t)}function PE(e,t){return e.right!==t.right&&e.left!==t.left}function RE(e,t){return e.top!==t.top&&e.bottom!==t.bottom}var mp="name",vp="text";function rc(e,t,n,i){Y.call(this,e),this.postExecute("element.updateProperties",r),this.postExecute("element.updateModdleProperties",a=>{Q(a.context.element)===a.context.moddleElement&&r(a)});function r(a){var l=a.context,s=l.element,c=l.properties;if(mp in c&&t.updateLabel(s,c[mp]),vp in c&&y(s,"bpmn:TextAnnotation")){var p=i.getTextAnnotationBounds({x:s.x,y:s.y,width:s.width,height:s.height},c[vp]||"");t.updateLabel(s,c.text,p)}}this.postExecute(["shape.create","connection.create"],function(a){var l=a.context,s=l.hints||{};if(s.createElementsBehavior!==!1){var c=l.shape||l.connection;xe(c)||!zi(c)||Hn(c)&&t.updateLabel(c,Hn(c))}}),this.postExecute("shape.delete",function(a){var l=a.context,s=l.labelTarget,c=l.hints||{};s&&c.unsetLabel!==!1&&t.updateLabel(s,null,null,{removeShape:!1})});function o(a){var l=a.context,s=l.connection,c=s.label,p=L({},l.hints),u=l.newWaypoints||s.waypoints,d=l.oldWaypoints;return typeof p.startChanged>"u"&&(p.startChanged=!!p.connectionStart),typeof p.endChanged>"u"&&(p.endChanged=!!p.connectionEnd),SE(c,u,d,p)}this.postExecute(["connection.layout","connection.updateWaypoints"],function(a){var l=a.context,s=l.hints||{};if(s.labelBehavior!==!1){var c=l.connection,p=c.label,u;!p||!p.parent||(u=o(a),t.moveShape(p,u))}}),this.postExecute(["shape.replace"],function(a){var l=a.context,s=l.newShape,c=l.oldShape,p=Q(s);p&&zi(p)&&c.label&&s.label&&(s.label.x=c.label.x,s.label.y=c.label.y)}),this.postExecute("shape.resize",function(a){var l=a.context,s=l.shape,c=l.newBounds,p=l.oldBounds;if(fa(s)){var u=s.label,d=de(u),f=AE(p),h=kE(d,f),m=DE(h,p,c);t.moveShape(u,m)}})}te(rc,Y);rc.$inject=["eventBus","modeling","bpmnFactory","textRenderer"];function DE(e,t,n){var i=Br(e,t,n);return Cr(Ut(i,e))}function kE(e,t){if(t.length){var n=ME(e,t);return Bl(e,n)}}function AE(e){return[[{x:e.x,y:e.y},{x:e.x+(e.width||0),y:e.y}],[{x:e.x+(e.width||0),y:e.y},{x:e.x+(e.width||0),y:e.y+(e.height||0)}],[{x:e.x,y:e.y+(e.height||0)},{x:e.x+(e.width||0),y:e.y+(e.height||0)}],[{x:e.x,y:e.y},{x:e.x,y:e.y+(e.height||0)}]]}function ME(e,t){var n=t.map(function(r){return{line:r,distance:Qf(e,r)}}),i=tn(n,"distance");return i[0].line}function IE(e,t,n,i){return Eh(e,t,n,i).point}function oc(e,t){Y.call(this,e);function n(i,r){var o=i.context,a=o.connection,l=L({},o.hints),s=o.newWaypoints||a.waypoints,c=o.oldWaypoints;return typeof l.startChanged>"u"&&(l.startChanged=!!l.connectionStart),typeof l.endChanged>"u"&&(l.endChanged=!!l.connectionEnd),IE(r,s,c,l)}this.postExecute(["connection.layout","connection.updateWaypoints"],function(i){var r=i.context,o=r.connection,a=o.outgoing,l=o.incoming;l.forEach(function(s){var c=s.waypoints[s.waypoints.length-1],p=n(i,c),u=[].concat(s.waypoints.slice(0,-1),[p]);t.updateWaypoints(s,u)}),a.forEach(function(s){var c=s.waypoints[0],p=n(i,c),u=[].concat([p],s.waypoints.slice(1));t.updateWaypoints(s,u)})}),this.postExecute(["connection.move"],function(i){var r=i.context,o=r.connection,a=o.outgoing,l=o.incoming,s=r.delta;l.forEach(function(c){var p=c.waypoints[c.waypoints.length-1],u={x:p.x+s.x,y:p.y+s.y},d=[].concat(c.waypoints.slice(0,-1),[u]);t.updateWaypoints(c,d)}),a.forEach(function(c){var p=c.waypoints[0],u={x:p.x+s.x,y:p.y+s.y},d=[].concat([u],c.waypoints.slice(1));t.updateWaypoints(c,d)})})}te(oc,Y);oc.$inject=["eventBus","modeling"];function Ra(e,t,n){var i=ka(e),r=Sh(i,t),o=i[0];return r.length?r[r.length-1]:Br(o.original||o,n,t)}function Da(e,t,n){var i=ka(e),r=Sh(i,t),o=i[i.length-1];return r.length?r[0]:Br(o.original||o,n,t)}function ac(e,t,n){var i=ka(e),r=wh(t,n),o=i[0];return Br(o.original||o,r,t)}function sc(e,t,n){var i=ka(e),r=wh(t,n),o=i[i.length-1];return Br(o.original||o,r,t)}function wh(e,t){return{x:e.x-t.x,y:e.y-t.y,width:e.width,height:e.height}}function ka(e){var t=e.waypoints;if(!t.length)throw new Error("connection#"+e.id+": no waypoints");return t}function Sh(e,t){var n=bt(e,OE);return _e(n,function(i){return NE(i,t)})}function NE(e,t){return pt(t,e,1)==="intersect"}function OE(e){return e.original||e}function lc(e,t){Y.call(this,e),this.postExecute("shape.replace",function(n){var i=n.oldShape,r=n.newShape;if(LE(i,r)){var o=$E(i);o.incoming.forEach(function(a){var l=Da(a,r,i);t.reconnectEnd(a,r,l)}),o.outgoing.forEach(function(a){var l=Ra(a,r,i);t.reconnectStart(a,r,l)})}},!0)}lc.$inject=["eventBus","modeling"];te(lc,Y);function LE(e,t){return y(e,"bpmn:Participant")&&Se(e)&&y(t,"bpmn:Participant")&&!Se(t)}function $E(e){var t=Nr([e],!1),n=[],i=[];return t.forEach(function(r){r!==e&&(r.incoming.forEach(function(o){y(o,"bpmn:MessageFlow")&&n.push(o)}),r.outgoing.forEach(function(o){y(o,"bpmn:MessageFlow")&&i.push(o)}))},[]),{incoming:n,outgoing:i}}const BE=["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:EscalationEventDefinition","bpmn:ConditionalEventDefinition","bpmn:SignalEventDefinition"];function Ch(e){const t=Q(e);if(!y(t,"bpmn:BoundaryEvent")&&!(y(t,"bpmn:StartEvent")&&mt(t.$parent)))return!1;const n=t.get("eventDefinitions");return!n||!n.length?!1:BE.some(i=>y(n[0],i))}function Th(e){return y(e,"bpmn:BoundaryEvent")?"cancelActivity":"isInterrupting"}function cc(e,t){e.invoke(Y,this),this.postExecuted("shape.replace",function(n){const i=n.context.oldShape,r=n.context.newShape,o=n.context.hints;if(!Ch(r))return;const a=Th(r);if(o.targetElement&&o.targetElement[a]!==void 0)return;const s=Q(i).get(a),c=Q(r).get(a);s!==c&&t.updateProperties(r,{[a]:s})})}cc.$inject=["injector","modeling"];te(cc,Y);function uc(e,t){Y.call(this,e),this.preExecute("shape.resize",function(n){var i=n.shape,r=Me(i),o=r&&r.get("label"),a=o&&o.get("bounds");a&&t.updateModdleProperties(i,o,{bounds:void 0})},!0)}te(uc,Y);uc.$inject=["eventBus","modeling"];function pc(e,t,n){Y.call(this,e),this.preExecute("shape.delete",function(i){var r=i.context.shape;if(!(r.incoming.length!==1||r.outgoing.length!==1)){var o=r.incoming[0],a=r.outgoing[0];if(!(!y(o,"bpmn:SequenceFlow")||!y(a,"bpmn:SequenceFlow"))&&t.canConnect(o.source,a.target,o)){var l=jE(o.waypoints,a.waypoints);n.reconnectEnd(o,a.target,l)}}})}te(pc,Y);pc.$inject=["eventBus","bpmnRules","modeling"];function Ni(e){return e.original||e}function jE(e,t){var n=Xs(Ni(e[e.length-2]),Ni(e[e.length-1]),Ni(t[1]),Ni(t[0]));return n?[].concat(e.slice(0,e.length-1),[n],t.slice(1)):[Ni(e[0]),Ni(t[t.length-1])]}function dc(e,t){Y.call(this,e),this.preExecute("shape.delete",function(n){var i=n.shape,r=i.parent;y(i,"bpmn:Participant")&&(n.collaborationRoot=r)},!0),this.postExecute("shape.delete",function(n){var i=n.collaborationRoot;i&&!i.businessObject.participants.length&&t.makeProcess()},!0)}dc.$inject=["eventBus","modeling"];te(dc,Y);function fc(e,t,n,i){Y.call(this,e);var r=i.get("dragging",!1);function o(s){var c=s.source,p=s.target,u=s.parent;if(u){var d,f;y(s,"bpmn:SequenceFlow")&&(n.canConnectSequenceFlow(c,p)||(f=!0),n.canConnectMessageFlow(c,p)&&(d="bpmn:MessageFlow")),y(s,"bpmn:MessageFlow")&&(n.canConnectMessageFlow(c,p)||(f=!0),n.canConnectSequenceFlow(c,p)&&(d="bpmn:SequenceFlow")),f&&t.removeConnection(s),d&&t.connect(c,p,{type:d,waypoints:s.waypoints.slice()})}}function a(s){var c=s.context,p=c.connection,u=c.newSource||p.source,d=c.newTarget||p.target,f,h;f=n.canConnect(u,d),!(!f||f.type===p.type)&&(h=t.connect(u,d,{type:f.type,associationDirection:f.associationDirection,waypoints:p.waypoints.slice()}),p.parent&&t.removeConnection(p),c.connection=h,r&&l(p,h))}function l(s,c){var p=r.context(),u=p&&p.payload.previousSelection,d;!u||!u.length||(d=u.indexOf(s),d!==-1&&u.splice(d,1,c))}this.postExecuted("elements.move",function(s){var c=s.closure,p=c.allConnections;M(p,o)},!0),this.preExecute("connection.reconnect",a),this.postExecuted("element.updateProperties",function(s){var c=s.context,p=c.properties,u=c.element,d=u.businessObject,f;p.default&&(f=Oe(u.outgoing,dn({id:u.businessObject.default.id})),f&&t.updateProperties(f,{conditionExpression:void 0})),p.conditionExpression&&d.sourceRef.default===d&&t.updateProperties(u.source,{default:void 0})})}te(fc,Y);fc.$inject=["eventBus","modeling","bpmnRules","injector"];function Aa(e,t,n,i,r,o){i.invoke(Y,this),this._bpmnReplace=e,this._elementRegistry=n,this._selection=o,this.postExecuted(["elements.create"],500,function(a){var l=a.context,s=l.parent,c=l.elements,p=Yn(c,function(u,d){var f=t.canReplace([d],d.host||d.parent||s);return f?u.concat(f.replacements):u},[]);p.length&&this._replaceElements(c,p)},this),this.postExecuted(["elements.move"],500,function(a){var l=a.context,s=l.newParent,c=l.newHost,p=[];M(l.closure.topLevel,function(d){mt(d)?p=p.concat(d.children):p=p.concat(d)}),p.length===1&&c&&(s=c);var u=t.canReplace(p,s);u&&this._replaceElements(p,u.replacements,c)},this),this.postExecute(["shape.replace"],1500,function(a){var l=a.context,s=l.oldShape,c=l.newShape,p=s.attachers,u;p&&p.length&&(u=t.canReplace(p,c),this._replaceElements(p,u.replacements))},this),this.postExecuted(["shape.replace"],1500,function(a){var l=a.context,s=l.oldShape,c=l.newShape;r.unclaimId(s.businessObject.id,s.businessObject),r.updateProperties(c,{id:s.id})})}te(Aa,Y);Aa.prototype._replaceElements=function(e,t){var n=this._elementRegistry,i=this._bpmnReplace,r=this._selection;M(t,function(o){var a={type:o.newElementType},l=n.get(o.oldElementId),s=e.indexOf(l);e[s]=i.replaceElement(l,a,{select:!1})}),t&&r.select(e)};Aa.$inject=["bpmnReplace","bpmnRules","elementRegistry","injector","modeling","selection"];var VE=1500,FE={width:140,height:120},hc={width:300,height:60},mc={width:60,height:300},Fo={width:300,height:150},Ho={width:150,height:300},Ph={width:140,height:120},Rh={width:50,height:30};function Dh(e){e.on("resize.start",VE,function(t){var n=t.context,i=n.shape,r=n.direction,o=n.balanced;(y(i,"bpmn:Lane")||y(i,"bpmn:Participant"))&&(n.resizeConstraints=WE(i,r,o)),y(i,"bpmn:SubProcess")&&Se(i)&&(n.minDimensions=Ph),y(i,"bpmn:TextAnnotation")&&(n.minDimensions=Rh)})}Dh.$inject=["eventBus"];var Nn=Math.abs,HE=Math.min,zE=Math.max;function kh(e,t,n,i){var r=e[t];e[t]=r===void 0?n:i(n,r)}function Oi(e,t,n){return kh(e,t,n,HE)}function Li(e,t,n){return kh(e,t,n,zE)}var UE={top:20,left:50,right:20,bottom:20},GE={top:50,left:20,right:20,bottom:20};function WE(e,t,n){var i=Mt(e),r=!0,o=!0,a=Ta(i,[i]),l=ae(e),s={},c={},p=gn(e),u=p?hc:mc;/n/.test(t)?c.top=l.bottom-u.height:/e/.test(t)?c.right=l.left+u.width:/s/.test(t)?c.bottom=l.top+u.height:/w/.test(t)&&(c.left=l.right-u.width),a.forEach(function(h){var m=ae(h);/n/.test(t)&&(p&&m.top<l.top-10&&(r=!1),n&&Nn(l.top-m.bottom)<10&&Li(s,"top",m.top+u.height),Nn(l.top-m.top)<5&&Oi(c,"top",m.bottom-u.height)),/e/.test(t)&&(!p&&m.right>l.right+10&&(o=!1),n&&Nn(l.right-m.left)<10&&Oi(s,"right",m.right-u.width),Nn(l.right-m.right)<5&&Li(c,"right",m.left+u.width)),/s/.test(t)&&(p&&m.bottom>l.bottom+10&&(o=!1),n&&Nn(l.bottom-m.top)<10&&Oi(s,"bottom",m.bottom-u.height),Nn(l.bottom-m.bottom)<5&&Li(c,"bottom",m.top+u.height)),/w/.test(t)&&(!p&&m.left<l.left-10&&(r=!1),n&&Nn(l.left-m.right)<10&&Li(s,"left",m.left+u.width),Nn(l.left-m.left)<5&&Oi(c,"left",m.right-u.width))});var d=i.children.filter(function(h){return!h.hidden&&!h.waypoints&&(y(h,"bpmn:FlowElement")||y(h,"bpmn:Artifact"))}),f=p?UE:GE;return d.forEach(function(h){var m=ae(h);r&&/n/.test(t)&&Oi(c,"top",m.top-f.top),o&&/e/.test(t)&&Li(c,"right",m.right+f.right),o&&/s/.test(t)&&Li(c,"bottom",m.bottom+f.bottom),r&&/w/.test(t)&&Oi(c,"left",m.left-f.left)}),{min:c,max:s}}var gp=1001;function Ah(e,t){e.on("resize.start",gp+500,function(n){var i=n.context,r=i.shape;(y(r,"bpmn:Lane")||y(r,"bpmn:Participant"))&&(i.balanced=!Tr(n))}),e.on("resize.end",gp,function(n){var i=n.context,r=i.shape,o=i.canExecute,a=i.newBounds;if(y(r,"bpmn:Lane")||y(r,"bpmn:Participant"))return o&&(a=ef(a),t.resizeLane(r,a,i.balanced)),!1})}Ah.$inject=["eventBus","modeling"];var YE=500;function vc(e,t,n,i,r){n.invoke(Y,this);function o(p){return ve(p,["bpmn:ReceiveTask","bpmn:SendTask"])||qE(p,["bpmn:ErrorEventDefinition","bpmn:EscalationEventDefinition","bpmn:MessageEventDefinition","bpmn:SignalEventDefinition"])}function a(p){var u=e.getDefinitions(),d=u.get("rootElements");return!!Oe(d,dn({id:p.id}))}function l(p){if(y(p,"bpmn:ErrorEventDefinition"))return"errorRef";if(y(p,"bpmn:EscalationEventDefinition"))return"escalationRef";if(y(p,"bpmn:MessageEventDefinition"))return"messageRef";if(y(p,"bpmn:SignalEventDefinition"))return"signalRef"}function s(p){if(ve(p,["bpmn:ReceiveTask","bpmn:SendTask"]))return p.get("messageRef");var u=p.get("eventDefinitions"),d=u[0];return d.get(l(d))}function c(p,u){if(ve(p,["bpmn:ReceiveTask","bpmn:SendTask"]))return p.set("messageRef",u);var d=p.get("eventDefinitions"),f=d[0];return f.set(l(f),u)}this.executed(["shape.create","element.updateProperties","element.updateModdleProperties"],function(p){var u=p.shape||p.element;if(o(u)){var d=Q(u),f=s(d),h;f&&!a(f)&&(h=e.getDefinitions().get("rootElements"),Je(h,f),p.addedRootElement=f)}},!0),this.reverted(["shape.create","element.updateProperties","element.updateModdleProperties"],function(p){var u=p.addedRootElement;if(u){var d=e.getDefinitions().get("rootElements");Xe(d,u)}},!0),t.on("copyPaste.copyElement",function(p){var u=p.descriptor,d=p.element;if(!(d.labelTarget||!o(d))){var f=Q(d),h=s(f);h&&(u.referencedRootElement=h)}}),t.on("copyPaste.pasteElement",YE,function(p){var u=p.descriptor,d=u.businessObject,f=u.referencedRootElement;f&&(a(f)||(f=i.copyElement(f,r.create(f.$type))),c(d,f),delete u.referencedRootElement)})}vc.$inject=["bpmnjs","eventBus","injector","moddleCopy","bpmnFactory"];te(vc,Y);function qE(e,t){return Te(t)||(t=[t]),Ki(t,function(n){return Jd(e,n)})}var Mh=Math.max;function Ih(e){e.on("spaceTool.getMinDimensions",function(t){var n=t.shapes,i=t.axis,r=t.start,o={};return M(n,function(a){var l=a.id;y(a,"bpmn:Participant")&&(o[l]=XE(a,i,r)),y(a,"bpmn:Lane")&&(o[l]=gn(a)?hc:mc),y(a,"bpmn:SubProcess")&&Se(a)&&(o[l]=Ph),y(a,"bpmn:TextAnnotation")&&(o[l]=Rh),y(a,"bpmn:Group")&&(o[l]=FE)}),o})}Ih.$inject=["eventBus"];function KE(e){return e==="x"}function XE(e,t,n){var i=gn(e);if(!JE(e))return i?Fo:Ho;var r=KE(t),o={};return r?i?o=Fo:o={width:QE(e,n,r),height:Ho.height}:i?o={width:Fo.width,height:ZE(e,n,r)}:o=Ho,o}function ZE(e,t,n){var i;return i=ex(e,t,n),Mh(Fo.height,i)}function QE(e,t,n){var i;return i=tx(e,t,n),Mh(Ho.width,i)}function JE(e){return!!Kn(e).length}function ex(e,t,n){var i=Kn(e),r;return r=gc(i,t,n),e.height-r.height+hc.height}function tx(e,t,n){var i=Kn(e),r;return r=gc(i,t,n),e.width-r.width+mc.width}function gc(e,t,n){var i,r,o;for(i=0;i<e.length;i++)if(r=e[i],!n&&t>=r.y&&t<=r.y+r.height||n&&t>=r.x&&t<=r.x+r.width)return o=Kn(r),o.length?gc(o,t,n):r}var yp=400,nx=600,_p={x:180,y:160};function Xn(e,t,n,i,r,o,a){Y.call(this,t),this._canvas=e,this._eventBus=t,this._modeling=n,this._elementFactory=i,this._bpmnFactory=r,this._bpmnjs=o,this._elementRegistry=a;var l=this;function s(u){return y(u,"bpmn:SubProcess")&&!Se(u)}function c(u){var d=u.shape,f=u.newRootElement,h=Q(d);f=l._addDiagram(f||h),u.newRootElement=e.addRootElement(f)}function p(u){var d=u.shape,f=Q(d);l._removeDiagram(f);var h=u.newRootElement=a.get($i(f));e.removeRootElement(h)}this.executed("shape.create",function(u){var d=u.shape;s(d)&&c(u)},!0),this.postExecuted("shape.create",function(u){var d=u.shape,f=u.newRootElement;!f||!d.children||(l._showRecursively(d.children),l._moveChildrenToShape(d,f))},!0),this.reverted("shape.create",function(u){var d=u.shape;s(d)&&p(u)},!0),this.preExecuted("shape.delete",function(u){var d=u.shape;if(s(d)){var f=a.get($i(d));f&&n.removeElements(f.children.slice())}},!0),this.executed("shape.delete",function(u){var d=u.shape;s(d)&&p(u)},!0),this.reverted("shape.delete",function(u){var d=u.shape;s(d)&&c(u)},!0),this.preExecuted("shape.replace",function(u){var d=u.oldShape,f=u.newShape;!s(d)||!s(f)||(u.oldRoot=e.removeRootElement($i(d)))},!0),this.postExecuted("shape.replace",function(u){var d=u.newShape,f=u.oldRoot,h=e.findRoot($i(d));if(!(!f||!h)){var m=f.children;n.moveElements(m,{x:0,y:0},h)}},!0),this.executed("element.updateProperties",function(u){var d=u.element;if(y(d,"bpmn:SubProcess")){var f=u.properties,h=u.oldProperties,m=h.id,v=f.id;if(m!==v){if(Lo(d)){a.updateId(d,li(v)),a.updateId(m,v);return}var S=a.get(li(m));S&&a.updateId(li(m),li(v))}}},!0),this.reverted("element.updateProperties",function(u){var d=u.element;if(y(d,"bpmn:SubProcess")){var f=u.properties,h=u.oldProperties,m=h.id,v=f.id;if(m!==v){if(Lo(d)){a.updateId(d,li(m)),a.updateId(v,m);return}var S=a.get(li(v));S&&a.updateId(S,li(m))}}},!0),t.on("element.changed",function(u){var d=u.element;if(Lo(d)){var f=d,h=a.get(uu(f));!h||h===f||t.fire("element.changed",{element:h})}}),this.executed("shape.toggleCollapse",yp,function(u){var d=u.shape;y(d,"bpmn:SubProcess")&&(Se(d)?p(u):(c(u),l._showRecursively(d.children)))},!0),this.reverted("shape.toggleCollapse",yp,function(u){var d=u.shape;y(d,"bpmn:SubProcess")&&(Se(d)?p(u):(c(u),l._showRecursively(d.children)))},!0),this.postExecuted("shape.toggleCollapse",nx,function(u){var d=u.shape;if(y(d,"bpmn:SubProcess")){var f=u.newRootElement;f&&(Se(d)?l._moveChildrenToShape(f,d):l._moveChildrenToShape(d,f))}},!0),t.on("copyPaste.createTree",function(u){var d=u.element,f=u.children;if(s(d)){var h=$i(d),m=a.get(h);m&&f.push.apply(f,m.children)}}),t.on("copyPaste.copyElement",function(u){var d=u.descriptor,f=u.element,h=u.elements,m=f.parent,v=y(Me(m),"bpmndi:BPMNPlane");if(v){var S=uu(m),b=Oe(h,function(w){return w.id===S});b&&(d.parent=b.id)}}),t.on("copyPaste.pasteElement",function(u){var d=u.descriptor;d.parent&&(s(d.parent)||d.parent.hidden)&&(d.hidden=!0)})}te(Xn,Y);Xn.prototype._moveChildrenToShape=function(e,t){var n=this._modeling,i=e.children,r;if(i){i=i.concat(i.reduce(function(c,p){return p.label&&p.label.parent!==e?c.concat(p.label):c},[]));var o=i.filter(function(c){return!c.hidden});if(!o.length){n.moveElements(i,{x:0,y:0},t,{autoResize:!1});return}var a=Tt(o);if(!t.x)r={x:_p.x-a.x,y:_p.y-a.y};else{var l=de(t),s=de(a);r={x:l.x-s.x,y:l.y-s.y}}n.moveElements(i,r,t,{autoResize:!1})}};Xn.prototype._showRecursively=function(e,t){var n=this,i=[];return e.forEach(function(r){r.hidden=!!t,i=i.concat(r),r.children&&(i=i.concat(n._showRecursively(r.children,r.collapsed||t)))}),i};Xn.prototype._addDiagram=function(e){var t=this._bpmnjs,n=t.getDefinitions().diagrams;return e.businessObject||(e=this._createNewDiagram(e)),n.push(e.di.$parent),e};Xn.prototype._createNewDiagram=function(e){var t=this._bpmnFactory,n=this._elementFactory,i=t.create("bpmndi:BPMNPlane",{bpmnElement:e}),r=t.create("bpmndi:BPMNDiagram",{plane:i});i.$parent=r;var o=n.createRoot({id:$i(e),type:e.$type,di:i,businessObject:e,collapsed:!0});return o};Xn.prototype._removeDiagram=function(e){var t=this._bpmnjs,n=t.getDefinitions().diagrams,i=Oe(n,function(r){return r.plane.bpmnElement.id===e.id});return n.splice(n.indexOf(i),1),i};Xn.$inject=["canvas","eventBus","modeling","elementFactory","bpmnFactory","bpmnjs","elementRegistry"];function yc(e,t){e.invoke(Y,this),this.postExecuted("shape.replace",function(n){var i=n.context.oldShape,r=n.context.newShape;if(!(!y(r,"bpmn:SubProcess")||!(y(i,"bpmn:Task")||y(i,"bpmn:CallActivity"))||!Se(r))){var o=ix(r);t.createShape({type:"bpmn:StartEvent"},o,r)}})}yc.$inject=["injector","modeling"];te(yc,Y);function ix(e){return{x:e.x+e.width/6,y:e.y+e.height/2}}function _c(e){Y.call(this,e),this.preExecute("connection.create",function(t){const{target:n}=t;y(n,"bpmn:TextAnnotation")&&(t.parent=n.parent)},!0),this.preExecute(["shape.create","shape.resize","elements.move"],function(t){const n=t.shapes||[t.shape];n.length===1&&y(n[0],"bpmn:TextAnnotation")&&(t.hints=t.hints||{},t.hints.autoResize=!1)},!0)}te(_c,Y);_c.$inject=["eventBus"];function bc(e,t){Y.call(this,e),this.postExecuted("shape.toggleCollapse",1500,function(n){var i=n.shape;if(Se(i))return;var r=Nr(i);r.forEach(function(a){var l=a.incoming.slice(),s=a.outgoing.slice();M(l,function(c){o(c,!0)}),M(s,function(c){o(c,!1)})});function o(a,l){r.indexOf(a.source)!==-1&&r.indexOf(a.target)!==-1||(l?t.reconnectEnd(a,i,de(i)):t.reconnectStart(a,i,de(i)))}},!0)}te(bc,Y);bc.$inject=["eventBus","modeling"];var _s=500;function Ec(e,t,n){Y.call(this,e);function i(a){a.length&&a.forEach(function(l){l.type==="label"&&!l.businessObject.name&&(l.hidden=!0)})}function r(a,l){var s=a.children,c=l,p,u;return p=rx(s).concat([a]),u=vh(p),u?(c.width=Math.max(u.width,c.width),c.height=Math.max(u.height,c.height),c.x=u.x+(u.width-c.width)/2,c.y=u.y+(u.height-c.height)/2):(c.x=a.x+(a.width-c.width)/2,c.y=a.y+(a.height-c.height)/2),c}function o(a,l){return{x:a.x+(a.width-l.width)/2,y:a.y+(a.height-l.height)/2,width:l.width,height:l.height}}this.executed(["shape.toggleCollapse"],_s,function(a){var l=a.context,s=l.shape;y(s,"bpmn:SubProcess")&&(s.collapsed?Me(s).isExpanded=!1:(i(s.children),Me(s).isExpanded=!0))}),this.reverted(["shape.toggleCollapse"],_s,function(a){var l=a.context,s=l.shape;s.collapsed?Me(s).isExpanded=!1:Me(s).isExpanded=!0}),this.postExecuted(["shape.toggleCollapse"],_s,function(a){var l=a.context.shape,s=t.getDefaultSize(l),c;l.collapsed?c=o(l,s):c=r(l,s),n.resizeShape(l,c,null,{autoResize:l.collapsed?!1:"nwse"})})}te(Ec,Y);Ec.$inject=["eventBus","elementFactory","modeling"];function rx(e){return e.filter(function(t){return!t.hidden})}function xc(e,t,n,i){t.invoke(Y,this),this.preExecute("shape.delete",function(r){var o=r.context,a=o.shape,l=a.businessObject;xe(a)||(y(a,"bpmn:Participant")&&Se(a)&&n.ids.unclaim(l.processRef.id),i.unclaimId(l.id,l))}),this.preExecute("connection.delete",function(r){var o=r.context,a=o.connection,l=a.businessObject;i.unclaimId(l.id,l)}),this.preExecute("canvas.updateRoot",function(){var r=e.getRootElement(),o=r.businessObject;y(r,"bpmn:Collaboration")&&n.ids.unclaim(o.id)})}te(xc,Y);xc.$inject=["canvas","injector","moddle","modeling"];function wc(e,t){Y.call(this,e),this.preExecute("connection.delete",function(n){var i=n.context,r=i.connection,o=r.source;ox(r,o)&&t.updateProperties(o,{default:null})})}te(wc,Y);wc.$inject=["eventBus","modeling"];function ox(e,t){if(!y(e,"bpmn:SequenceFlow"))return!1;var n=Q(t),i=Q(e);return n.get("default")===i}var ax=500,sx=5e3;function Sc(e,t,n){Y.call(this,e);var i;function r(){return i=i||new lx,i.enter(),i}function o(){if(!i)throw new Error(n("out of bounds release"));return i}function a(){if(!i)throw new Error(n("out of bounds release"));var s=i.leave();return s&&(t.updateLaneRefs(i.flowNodes,i.lanes),i=null),s}var l=["spaceTool","lane.add","lane.resize","lane.split","elements.create","elements.delete","elements.move","shape.create","shape.delete","shape.move","shape.resize"];this.preExecute(l,sx,function(s){r()}),this.postExecuted(l,ax,function(s){a()}),this.preExecute(["shape.create","shape.move","shape.delete","shape.resize"],function(s){var c=s.context,p=c.shape,u=o();p.labelTarget||(y(p,"bpmn:Lane")&&u.addLane(p),y(p,"bpmn:FlowNode")&&u.addFlowNode(p))})}Sc.$inject=["eventBus","modeling","translate"];te(Sc,Y);function lx(){this.flowNodes=[],this.lanes=[],this.counter=0,this.addLane=function(e){this.lanes.push(e)},this.addFlowNode=function(e){this.flowNodes.push(e)},this.enter=function(){this.counter++},this.leave=function(){return this.counter--,!this.counter}}const cx={__init__:["adaptiveLabelPositioningBehavior","appendBehavior","associationBehavior","attachEventBehavior","boundaryEventBehavior","compensateBoundaryEventBehaviour","createBehavior","createDataObjectBehavior","createParticipantBehavior","dataInputAssociationBehavior","dataStoreBehavior","deleteLaneBehavior","detachEventBehavior","dropOnFlowBehavior","eventBasedGatewayBehavior","fixHoverBehavior","groupBehavior","importDockingFix","isHorizontalFix","labelBehavior","layoutConnectionBehavior","messageFlowBehavior","nonInterruptingBehavior","removeElementBehavior","removeEmbeddedLabelBoundsBehavior","removeParticipantBehavior","replaceConnectionBehavior","replaceElementBehaviour","resizeBehavior","resizeLaneBehavior","rootElementReferenceBehavior","spaceToolBehavior","subProcessPlaneBehavior","subProcessStartEventBehavior","textAnnotationBehavior","toggleCollapseConnectionBehaviour","toggleElementCollapseBehaviour","unclaimIdBehavior","updateFlowNodeRefsBehavior","unsetDefaultFlowBehavior"],adaptiveLabelPositioningBehavior:["type",zl],appendBehavior:["type",Ul],associationBehavior:["type",Gl],attachEventBehavior:["type",Sa],boundaryEventBehavior:["type",Wl],compensateBoundaryEventBehaviour:["type",Yl],createBehavior:["type",ql],createDataObjectBehavior:["type",Kl],createParticipantBehavior:["type",Xl],dataInputAssociationBehavior:["type",Zl],dataStoreBehavior:["type",Ql],deleteLaneBehavior:["type",Jl],detachEventBehavior:["type",Pa],dropOnFlowBehavior:["type",ec],eventBasedGatewayBehavior:["type",tc],fixHoverBehavior:["type",gh],groupBehavior:["type",nc],importDockingFix:["type",yh],isHorizontalFix:["type",ic],labelBehavior:["type",rc],layoutConnectionBehavior:["type",oc],messageFlowBehavior:["type",lc],nonInterruptingBehavior:["type",cc],removeElementBehavior:["type",pc],removeEmbeddedLabelBoundsBehavior:["type",uc],removeParticipantBehavior:["type",dc],replaceConnectionBehavior:["type",fc],replaceElementBehaviour:["type",Aa],resizeBehavior:["type",Dh],resizeLaneBehavior:["type",Ah],rootElementReferenceBehavior:["type",vc],spaceToolBehavior:["type",Ih],subProcessPlaneBehavior:["type",Xn],subProcessStartEventBehavior:["type",yc],textAnnotationBehavior:["type",_c],toggleCollapseConnectionBehaviour:["type",bc],toggleElementCollapseBehaviour:["type",Ec],unclaimIdBehavior:["type",xc],unsetDefaultFlowBehavior:["type",wc],updateFlowNodeRefsBehavior:["type",Sc]};function Nh(e,t){var n=pt(e,t,-15);return n!=="intersect"?n:null}function st(e){$t.call(this,e)}te(st,$t);st.$inject=["eventBus"];st.prototype.init=function(){this.addRule("connection.start",function(e){var t=e.source;return ux(t)}),this.addRule("connection.create",function(e){var t=e.source,n=e.target,i=e.hints||{},r=i.targetParent,o=i.targetAttach;if(o)return!1;r&&(n.parent=r);try{return zo(t,n)}finally{r&&(n.parent=null)}}),this.addRule("connection.reconnect",function(e){var t=e.connection,n=e.source,i=e.target;return zo(n,i,t)}),this.addRule("connection.updateWaypoints",function(e){return{type:e.connection.type}}),this.addRule("shape.resize",function(e){var t=e.shape,n=e.newBounds;return zh(t,n)}),this.addRule("elements.create",function(e){var t=e.elements,n=e.position,i=e.target;return Ae(i)&&!ra(t,i)?!1:vl(t,function(r){return Ae(r)?zo(r.source,r.target,r):r.host?_r(r,r.host,null,n):el(r,i,null)})}),this.addRule("elements.move",function(e){var t=e.target,n=e.shapes,i=e.position;return _r(n,t,null,i)||Fh(n,t,i)||Hh(n,t)||ra(n,t)}),this.addRule("shape.create",function(e){return el(e.shape,e.target,e.source,e.position)}),this.addRule("shape.attach",function(e){return _r(e.shape,e.target,null,e.position)}),this.addRule("element.copy",function(e){var t=e.element,n=e.elements;return qh(n,t)})};st.prototype.canConnectMessageFlow=Wh;st.prototype.canConnectSequenceFlow=Yh;st.prototype.canConnectDataAssociation=Tc;st.prototype.canConnectAssociation=Uh;st.prototype.canConnectCompensationAssociation=Gh;st.prototype.canMove=Hh;st.prototype.canAttach=_r;st.prototype.canReplace=Fh;st.prototype.canDrop=Yi;st.prototype.canInsert=ra;st.prototype.canCreate=el;st.prototype.canConnect=zo;st.prototype.canResize=zh;st.prototype.canCopy=qh;function ux(e){return Zs(e)?null:ve(e,["bpmn:FlowNode","bpmn:InteractionNode","bpmn:DataObjectReference","bpmn:DataStoreReference","bpmn:Group","bpmn:TextAnnotation"])}function Zs(e){return!e||xe(e)}function px(e,t){return e===t}function bp(e){do{if(y(e,"bpmn:Process"))return Q(e);if(y(e,"bpmn:Participant"))return Q(e).processRef||Q(e)}while(e=e.parent)}function Qs(e){return y(e,"bpmn:TextAnnotation")}function Cc(e){return y(e,"bpmn:Group")&&!e.labelTarget}function Oh(e){return y(e,"bpmn:BoundaryEvent")&&Qt(e,"bpmn:CompensateEventDefinition")}function Ma(e){return Q(e).isForCompensation}function dx(e,t){var n=bp(e),i=bp(t);return n===i}function fx(e){return y(e,"bpmn:InteractionNode")&&!y(e,"bpmn:BoundaryEvent")&&(!y(e,"bpmn:Event")||y(e,"bpmn:ThrowEvent")&&$h(e,"bpmn:MessageEventDefinition"))}function hx(e){return y(e,"bpmn:InteractionNode")&&!Ma(e)&&(!y(e,"bpmn:Event")||y(e,"bpmn:CatchEvent")&&$h(e,"bpmn:MessageEventDefinition"))&&!(y(e,"bpmn:BoundaryEvent")&&!Qt(e,"bpmn:MessageEventDefinition"))}function Ep(e){for(var t=e;t=t.parent;){if(y(t,"bpmn:FlowElementsContainer"))return Q(t);if(y(t,"bpmn:Participant"))return Q(t).processRef}return null}function Lh(e,t){var n=Ep(e),i=Ep(t);return n===i}function Qt(e,t){var n=Q(e);return!!Oe(n.eventDefinitions||[],function(i){return y(i,t)})}function $h(e,t){var n=Q(e);return(n.eventDefinitions||[]).every(function(i){return y(i,t)})}function mx(e){return y(e,"bpmn:FlowNode")&&!y(e,"bpmn:EndEvent")&&!mt(e)&&!(y(e,"bpmn:IntermediateThrowEvent")&&Qt(e,"bpmn:LinkEventDefinition"))&&!Oh(e)&&!Ma(e)}function vx(e){return y(e,"bpmn:FlowNode")&&!y(e,"bpmn:StartEvent")&&!y(e,"bpmn:BoundaryEvent")&&!mt(e)&&!(y(e,"bpmn:IntermediateCatchEvent")&&Qt(e,"bpmn:LinkEventDefinition"))&&!Ma(e)}function gx(e){return y(e,"bpmn:ReceiveTask")||y(e,"bpmn:IntermediateCatchEvent")&&(Qt(e,"bpmn:MessageEventDefinition")||Qt(e,"bpmn:TimerEventDefinition")||Qt(e,"bpmn:ConditionalEventDefinition")||Qt(e,"bpmn:SignalEventDefinition"))}function yx(e){for(var t=[];e;)e=e.parent,e&&t.push(e);return t}function Js(e,t){var n=yx(t);return n.indexOf(e)!==-1}function zo(e,t,n){if(Zs(e)||Zs(t))return null;if(!y(n,"bpmn:DataAssociation")){if(Wh(e,t))return{type:"bpmn:MessageFlow"};if(Yh(e,t))return{type:"bpmn:SequenceFlow"}}var i=Tc(e,t);return i||(Gh(e,t)?{type:"bpmn:Association",associationDirection:"One"}:Uh(e,t)?{type:"bpmn:Association",associationDirection:"None"}:!1)}function Yi(e,t){return xe(e)||Cc(e)?!0:y(t,"bpmn:Participant")&&!Se(t)?!1:y(e,"bpmn:Participant")?y(t,"bpmn:Process")||y(t,"bpmn:Collaboration"):ve(e,["bpmn:DataInput","bpmn:DataOutput"])&&e.parent?t===e.parent:y(e,"bpmn:Lane")?y(t,"bpmn:Participant")||y(t,"bpmn:Lane"):y(e,"bpmn:BoundaryEvent")&&!_x(e)?!1:y(e,"bpmn:FlowElement")&&!y(e,"bpmn:DataStoreReference")?y(t,"bpmn:FlowElementsContainer")?Se(t):ve(t,["bpmn:Participant","bpmn:Lane"]):y(e,"bpmn:DataStoreReference")&&y(t,"bpmn:Collaboration")?Ki(Q(t).get("participants"),function(n){return!!n.get("processRef")}):ve(e,["bpmn:Artifact","bpmn:DataAssociation","bpmn:DataStoreReference"])?ve(t,["bpmn:Collaboration","bpmn:Lane","bpmn:Participant","bpmn:Process","bpmn:SubProcess"]):y(e,"bpmn:MessageFlow")?y(t,"bpmn:Collaboration")||e.source.parent==t||e.target.parent==t:!1}function _x(e){return Q(e).cancelActivity&&(Bh(e)||jh(e))}function bx(e){return!xe(e)&&y(e,"bpmn:BoundaryEvent")}function Ex(e){return y(e,"bpmn:Lane")}function xx(e){return bx(e)||y(e,"bpmn:IntermediateThrowEvent")&&Bh(e)?!0:y(e,"bpmn:IntermediateCatchEvent")&&jh(e)}function Bh(e){var t=Q(e);return t&&!(t.eventDefinitions&&t.eventDefinitions.length)}function jh(e){return Vh(e,["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:SignalEventDefinition","bpmn:ConditionalEventDefinition"])}function Vh(e,t){return t.some(function(n){return Qt(e,n)})}function wx(e){return y(e,"bpmn:ReceiveTask")&&Oe(e.incoming,function(t){return y(t.source,"bpmn:EventBasedGateway")})}function _r(e,t,n,i){if(Array.isArray(e)||(e=[e]),e.length!==1)return!1;var r=e[0];return xe(r)||!xx(r)||mt(t)||!y(t,"bpmn:Activity")||Ma(t)||i&&!Nh(i,t)||wx(t)?!1:"attach"}function Fh(e,t,n){if(!t)return!1;var i={replacements:[]};return M(e,function(r){mt(t)||y(r,"bpmn:StartEvent")&&r.type!=="label"&&Yi(r,t)&&(tg(r)||i.replacements.push({oldElementId:r.id,newElementType:"bpmn:StartEvent"}),(ng(r)||ig(r)||rg(r))&&i.replacements.push({oldElementId:r.id,newElementType:"bpmn:StartEvent"}),Vh(r,["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:SignalEventDefinition","bpmn:ConditionalEventDefinition"])&&y(t,"bpmn:SubProcess")&&i.replacements.push({oldElementId:r.id,newElementType:"bpmn:StartEvent"})),y(t,"bpmn:Transaction")||Qt(r,"bpmn:CancelEventDefinition")&&r.type!=="label"&&(y(r,"bpmn:EndEvent")&&Yi(r,t)&&i.replacements.push({oldElementId:r.id,newElementType:"bpmn:EndEvent"}),y(r,"bpmn:BoundaryEvent")&&_r(r,t,null,n)&&i.replacements.push({oldElementId:r.id,newElementType:"bpmn:BoundaryEvent"}))}),i.replacements.length?i:!1}function Hh(e,t){return Ki(e,Ex)?!1:t?e.every(function(n){return Yi(n,t)}):!0}function el(e,t,n,i){return t?xe(e)||Cc(e)?!0:px(n,t)||n&&Js(n,t)?!1:Yi(e,t)||ra(e,t):!1}function zh(e,t){return y(e,"bpmn:SubProcess")?Se(e)&&(!t||t.width>=100&&t.height>=80):!!(y(e,"bpmn:Lane")||y(e,"bpmn:Participant")||Qs(e)||Cc(e))}function Sx(e,t){var n=Qs(e),i=Qs(t);return(n||i)&&n!==i}function Uh(e,t){return Js(t,e)||Js(e,t)?!1:Sx(e,t)?!0:!!Tc(e,t)}function Gh(e,t){return Lh(e,t)&&Oh(e)&&y(t,"bpmn:Activity")&&!Tx(t,e)&&!mt(t)}function Wh(e,t){return xp(e)&&!xp(t)?!1:fx(e)&&hx(t)&&!dx(e,t)}function Yh(e,t){return mx(e)&&vx(t)&&Lh(e,t)&&!(y(e,"bpmn:EventBasedGateway")&&!gx(t))}function Tc(e,t){return ve(e,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&ve(t,["bpmn:Activity","bpmn:ThrowEvent"])?{type:"bpmn:DataInputAssociation"}:ve(t,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&ve(e,["bpmn:Activity","bpmn:CatchEvent"])?{type:"bpmn:DataOutputAssociation"}:!1}function ra(e,t,n){if(!t)return!1;if(Array.isArray(e)){if(e.length!==1)return!1;e=e[0]}return t.source===e||t.target===e?!1:ve(t,["bpmn:SequenceFlow","bpmn:MessageFlow"])&&!xe(t)&&y(e,"bpmn:FlowNode")&&!y(e,"bpmn:BoundaryEvent")&&Yi(e,t.parent)}function Cx(e,t){return e&&t&&e.indexOf(t)!==-1}function qh(e,t){return xe(t)?!0:!(y(t,"bpmn:Lane")&&!Cx(e,t.parent))}function xp(e){return Qo(e,"bpmn:Process")||Qo(e,"bpmn:Collaboration")}function Tx(e,t){return e.attachers.includes(t)}const Px={__depends__:[on],__init__:["bpmnRules"],bpmnRules:["type",st]};var Rx=2e3;function Kh(e,t){e.on("saveXML.start",Rx,n);function n(){var i=t.getRootElements();M(i,function(r){var o=Me(r),a,l;a=Nr([r],!1),a=_e(a,function(s){return s!==r&&!s.labelTarget}),l=bt(a,Me),o.set("planeElement",l)})}}Kh.$inject=["eventBus","canvas"];const Dx={__init__:["bpmnDiOrdering"],bpmnDiOrdering:["type",Kh]};function Ia(e){Y.call(this,e);var t=this;this.preExecute(["shape.create","connection.create"],function(n){var i=n.context,r=i.shape||i.connection,o=i.parent,a=t.getOrdering(r,o);a&&(a.parent!==void 0&&(i.parent=a.parent),i.parentIndex=a.index)}),this.preExecute(["shape.move","connection.move"],function(n){var i=n.context,r=i.shape||i.connection,o=i.newParent||r.parent,a=t.getOrdering(r,o);a&&(a.parent!==void 0&&(i.newParent=a.parent),i.newParentIndex=a.index)})}Ia.prototype.getOrdering=function(e,t){return null};te(Ia,Y);function Pc(e,t,n){Ia.call(this,e);var i=[{type:"bpmn:SubProcess",order:{level:6}},{type:"bpmn:SequenceFlow",order:{level:9,containers:["bpmn:Participant","bpmn:FlowElementsContainer"]}},{type:"bpmn:DataAssociation",order:{level:9,containers:["bpmn:Collaboration","bpmn:FlowElementsContainer"]}},{type:"bpmn:TextAnnotation",order:{level:9}},{type:"bpmn:MessageFlow",order:{level:9,containers:["bpmn:Collaboration"]}},{type:"bpmn:Association",order:{level:6,containers:["bpmn:Participant","bpmn:FlowElementsContainer","bpmn:Collaboration"]}},{type:"bpmn:BoundaryEvent",order:{level:8}},{type:"bpmn:Group",order:{level:10,containers:["bpmn:Collaboration","bpmn:FlowElementsContainer"]}},{type:"bpmn:FlowElement",order:{level:5}},{type:"bpmn:Participant",order:{level:-2}},{type:"bpmn:Lane",order:{level:-1}}];function r(l){if(l.labelTarget)return{level:10};var s=Oe(i,function(c){return ve(l,[c.type])});return s&&s.order||{level:1}}function o(l){var s=l.order;if(s||(l.order=s=r(l)),!s)throw new Error("no order for <"+l.id+">");return s}function a(l,s,c){for(var p=s;p&&!ve(p,c);)p=p.parent;if(!p)throw new Error("no parent for <"+l.id+"> in <"+(s&&s.id)+">");return p}this.getOrdering=function(l,s){if(l.labelTarget||y(l,"bpmn:TextAnnotation"))return{parent:t.findRoot(s)||t.getRootElement(),index:-1};var c=o(l);c.containers&&(s=a(l,s,c.containers));var p=s.children.indexOf(l),u=og(s.children,function(d){return!l.labelTarget&&d.labelTarget?!1:c.level<o(d).level});return u!==-1&&p!==-1&&p<u&&(u-=1),{index:u,parent:s}}}Pc.$inject=["eventBus","canvas","translate"];te(Pc,Ia);const kx={__depends__:[tf],__init__:["bpmnOrderingProvider"],bpmnOrderingProvider:["type",Pc]};function jr(){}jr.prototype.get=function(){return this._data};jr.prototype.set=function(e){this._data=e};jr.prototype.clear=function(){var e=this._data;return delete this._data,e};jr.prototype.isEmpty=function(){return!this._data};const Ax={clipboard:["type",jr]};var Mx="drop-ok",wp="drop-not-ok",Sp="attach-ok",Cp="new-parent",Tp="create",Ix=2e3;function Xh(e,t,n,i,r){function o(s,c,p,u,d){if(!c)return!1;s=_e(s,function(b){var w=b.labelTarget;return!b.parent&&!(xe(b)&&s.indexOf(w)!==-1)});var f=Oe(s,function(b){return!Ae(b)}),h=!1,m=!1,v=!1;Rp(s)&&(h=r.allowed("shape.attach",{position:p,shape:f,target:c})),h||(Rp(s)?v=r.allowed("shape.create",{position:p,shape:f,source:u,target:c}):v=r.allowed("elements.create",{elements:s,position:p,target:c}));var S=d.connectionTarget;return v||h?(f&&u&&(m=r.allowed("connection.create",{source:S===u?f:u,target:S===u?u:f,hints:{targetParent:c,targetAttach:h}})),{attach:h,connect:m}):v===null||h===null?null:!1}function a(s,c){[Sp,Mx,wp,Cp].forEach(function(p){p===c?e.addMarker(s,p):e.removeMarker(s,p)})}n.on(["create.move","create.hover"],function(s){var c=s.context,p=c.elements,u=s.hover,d=c.source,f=c.hints||{};if(!u){c.canExecute=!1,c.target=null;return}Pp(s);var h={x:s.x,y:s.y},m=c.canExecute=u&&o(p,u,h,d,f);u&&m!==null&&(c.target=u,m&&m.attach?a(u,Sp):a(u,m?Cp:wp))}),n.on(["create.end","create.out","create.cleanup"],function(s){var c=s.hover;c&&a(c,null)}),n.on("create.end",function(s){var c=s.context,p=c.source,u=c.shape,d=c.elements,f=c.target,h=c.canExecute,m=h&&h.attach,v=h&&h.connect,S=c.hints||{};if(h===!1||!f)return!1;Pp(s);var b={x:s.x,y:s.y};v?u=i.appendShape(p,u,b,f,{attach:m,connection:v===!0?{}:v,connectionTarget:S.connectionTarget}):(d=i.createElements(d,b,f,L({},S,{attach:m})),u=Oe(d,function(w){return!Ae(w)})),L(c,{elements:d,shape:u}),L(s,{elements:d,shape:u})});function l(){var s=t.context();s&&s.prefix===Tp&&t.cancel()}n.on("create.init",function(){n.on("elements.changed",l),n.once(["create.cancel","create.end"],Ix,function(){n.off("elements.changed",l)})}),this.start=function(s,c,p){Te(c)||(c=[c]);var u=Oe(c,function(h){return!Ae(h)});if(u){p=L({elements:c,hints:{},shape:u},p||{}),M(c,function(h){ye(h.x)||(h.x=0),ye(h.y)||(h.y=0)});var d=_e(c,function(h){return!h.hidden}),f=Tt(d);M(c,function(h){Ae(h)&&(h.waypoints=bt(h.waypoints,function(m){return{x:m.x-f.x-f.width/2,y:m.y-f.y-f.height/2}})),L(h,{x:h.x-f.x-f.width/2,y:h.y-f.y-f.height/2})}),t.init(s,Tp,{cursor:"grabbing",autoActivate:!0,data:{shape:u,elements:c,context:p}})}}}Xh.$inject=["canvas","dragging","eventBus","modeling","rules"];function Pp(e){var t=e.context,n=t.createConstraints;n&&(n.left&&(e.x=Math.max(e.x,n.left)),n.right&&(e.x=Math.min(e.x,n.right)),n.top&&(e.y=Math.max(e.y,n.top)),n.bottom&&(e.y=Math.min(e.y,n.bottom)))}function Rp(e){return e&&e.length===1&&!Ae(e[0])}var Nx=750;function Zh(e,t,n,i,r){function o(a){var l=be("g");ie(l,r.cls("djs-drag-group",["no-events"]));var s=be("g");return a.forEach(function(c){var p;c.hidden||(c.waypoints?(p=n._createContainer("connection",s),n.drawConnection(Fi(p),c)):(p=n._createContainer("shape",s),n.drawShape(Fi(p),c),ht(p,c.x,c.y)),i.addDragger(c,l,p))}),l}t.on("create.move",Nx,function(a){var l=a.hover,s=a.context,c=s.elements,p=s.dragGroup;p||(p=s.dragGroup=o(c));var u;l?(p.parentNode||(u=e.getActiveLayer(),Ce(u,p)),ht(p,a.x,a.y)):rt(p)}),t.on("create.cleanup",function(a){var l=a.context,s=l.dragGroup;s&&rt(s)})}Zh.$inject=["canvas","eventBus","graphicsFactory","previewSupport","styles"];const Na={__depends__:[Sn,er,on,En],__init__:["create","createPreview"],create:["type",Xh],createPreview:["type",Zh]};function Rc(e){var t=this;this._lastMoveEvent=null;function n(i){t._lastMoveEvent=i}e.on("canvas.init",function(i){var r=t._svg=i.svg;r.addEventListener("mousemove",n)}),e.on("canvas.destroy",function(){t._lastMouseEvent=null,t._svg.removeEventListener("mousemove",n)})}Rc.$inject=["eventBus"];Rc.prototype.getLastMoveEvent=function(){return this._lastMoveEvent||Ox(0,0)};function Ox(e,t){var n=document.createEvent("MouseEvent"),i=e,r=t,o=e,a=t;return n.initMouseEvent&&n.initMouseEvent("mousemove",!0,!0,window,0,i,r,o,a,!1,!1,!1,!1,0,null),n}const Vr={__init__:["mouse"],mouse:["type",Rc]};function Yt(e,t,n,i,r,o,a,l){this._canvas=e,this._create=t,this._clipboard=n,this._elementFactory=i,this._eventBus=r,this._modeling=o,this._mouse=a,this._rules=l,r.on("copyPaste.copyElement",function(s){var c=s.descriptor,p=s.element,u=s.elements;c.priority=1,c.id=p.id;var d=Oe(u,function(f){return f===p.parent});d&&(c.parent=p.parent.id),Lx(p)&&(c.priority=2,c.host=p.host.id),Ae(p)&&(c.priority=3,c.source=p.source.id,c.target=p.target.id,c.waypoints=$x(p)),xe(p)&&(c.priority=4,c.labelTarget=p.labelTarget.id),M(["x","y","width","height"],function(f){ye(p[f])&&(c[f]=p[f])}),c.hidden=p.hidden,c.collapsed=p.collapsed}),r.on("copyPaste.pasteElements",function(s){var c=s.hints;L(c,{createElementsBehavior:!1})})}Yt.$inject=["canvas","create","clipboard","elementFactory","eventBus","modeling","mouse","rules"];Yt.prototype.copy=function(e){var t,n;return Te(e)||(e=e?[e]:[]),t=this._eventBus.fire("copyPaste.canCopyElements",{elements:e}),t===!1?n={}:n=this.createTree(Te(t)?t:e),this._clipboard.set(n),this._eventBus.fire("copyPaste.elementsCopied",{elements:e,tree:n}),n};Yt.prototype.paste=function(e){var t=this._clipboard.get();if(!this._clipboard.isEmpty()){var n=e&&e.hints||{};this._eventBus.fire("copyPaste.pasteElements",{hints:n});var i=this._createElements(t);if(e&&e.element&&e.point)return this._paste(i,e.element,e.point,n);this._create.start(this._mouse.getLastMoveEvent(),i,{hints:n||{}})}};Yt.prototype._paste=function(e,t,n,i){M(e,function(o){ye(o.x)||(o.x=0),ye(o.y)||(o.y=0)});var r=Tt(e);return M(e,function(o){Ae(o)&&(o.waypoints=bt(o.waypoints,function(a){return{x:a.x-r.x-r.width/2,y:a.y-r.y-r.height/2}})),L(o,{x:o.x-r.x-r.width/2,y:o.y-r.y-r.height/2})}),this._modeling.createElements(e,n,t,L({},i))};Yt.prototype._createElements=function(e){var t=this,n=this._eventBus,i={},r=[];return M(e,function(o,a){o=tn(o,"priority"),M(o,function(l){var s=L({},bn(l,["priority"]));i[l.parent]?s.parent=i[l.parent]:delete s.parent,n.fire("copyPaste.pasteElement",{cache:i,descriptor:s});var c;if(Ae(s)){s.source=i[l.source],s.target=i[l.target],c=i[l.id]=t.createConnection(s),r.push(c);return}if(xe(s)){s.labelTarget=i[s.labelTarget],c=i[l.id]=t.createLabel(s),r.push(c);return}s.host&&(s.host=i[s.host]),c=i[l.id]=t.createShape(s),r.push(c)})}),r};Yt.prototype.createConnection=function(e){var t=this._elementFactory.createConnection(bn(e,["id"]));return t};Yt.prototype.createLabel=function(e){var t=this._elementFactory.createLabel(bn(e,["id"]));return t};Yt.prototype.createShape=function(e){var t=this._elementFactory.createShape(bn(e,["id"]));return t};Yt.prototype.hasRelations=function(e,t){var n,i,r;return!(Ae(e)&&(i=Oe(t,dn({id:e.source.id})),r=Oe(t,dn({id:e.target.id})),!i||!r)||xe(e)&&(n=Oe(t,dn({id:e.labelTarget.id})),!n))};Yt.prototype.createTree=function(e){var t=this._rules,n=this,i={},r=[],o=ua(e);function a(c,p){return t.allowed("element.copy",{element:c,elements:p})}function l(c,p){var u=Oe(r,function(d){return c===d.element});if(!u){r.push({element:c,depth:p});return}u.depth<p&&(r=s(u,r),r.push({element:u.element,depth:p}))}function s(c,p){var u=p.indexOf(c);return u!==-1&&p.splice(u,1),p}return ha(o,function(c,p,u){if(xe(c))return;M(c.labels,function(h){l(h,u)});function d(h){h&&h.length&&M(h,function(m){M(m.labels,function(v){l(v,u)}),l(m,u)})}M([c.attachers,c.incoming,c.outgoing],d),l(c,u);var f=[];return c.children&&(f=c.children.slice()),n._eventBus.fire("copyPaste.createTree",{element:c,children:f}),f}),e=bt(r,function(c){return c.element}),r=bt(r,function(c){return c.descriptor={},n._eventBus.fire("copyPaste.copyElement",{descriptor:c.descriptor,element:c.element,elements:e}),c}),r=tn(r,function(c){return c.descriptor.priority}),e=bt(r,function(c){return c.element}),M(r,function(c){var p=c.depth;if(!n.hasRelations(c.element,e)){kp(c.element,e);return}if(!a(c.element,e)){kp(c.element,e);return}i[p]||(i[p]=[]),i[p].push(c.descriptor)}),i};function Lx(e){return!!e.host}function $x(e){return bt(e.waypoints,function(t){return t=Dp(t),t.original&&(t.original=Dp(t.original)),t})}function Dp(e){return L({},e)}function kp(e,t){var n=t.indexOf(e);return n===-1?t:t.splice(n,1)}const Bx={__depends__:[Ax,Na,Vr,on],__init__:["copyPaste"],copyPaste:["type",Yt]};function bs(e,t,n){Te(n)||(n=[n]),M(n,function(i){nf(e[i])||(t[i]=e[i])})}var Es=750;function Qh(e,t,n){function i(s,c){var p=e.create(s.$type);return n.copyElement(s,p,null,c)}t.on("copyPaste.copyElement",Es,function(s){var c=s.descriptor,p=s.element,u=Q(p);if(xe(p))return c;var d=c.businessObject=i(u,!0),f=c.di=i(Me(p),!0);f.bpmnElement=d,bs(d,c,"name"),bs(f,c,"isExpanded"),u.default&&(c.default=u.default.id)});var r="-bpmn-js-refs";function o(s){return s[r]=s[r]||{}}function a(s,c){s[r]=c}function l(s,c,p){var u=Q(s);return s.default&&(p[s.default]={element:u,property:"default"}),s.host&&(Q(s).attachedToRef=Q(c[s.host])),bn(p,Yn(p,function(d,f,h){var m=f.element,v=f.property;return h===s.id&&(m.set(v,u),d.push(s.id)),d},[]))}t.on("copyPaste.pasteElement",function(s){var c=s.cache,p=s.descriptor,u=p.businessObject,d=p.di;if(xe(p)){p.businessObject=Q(c[p.labelTarget]),p.di=Me(c[p.labelTarget]);return}u=p.businessObject=i(u),d=p.di=i(d),d.bpmnElement=u,bs(p,u,["isExpanded","name"]),p.type=u.$type}),t.on("copyPaste.copyElement",Es,function(s){var c=s.descriptor,p=s.element;if(y(p,"bpmn:Participant")){var u=Q(p);u.processRef&&(c.processRef=i(u.processRef,!0))}}),t.on("copyPaste.pasteElement",function(s){var c=s.descriptor,p=c.processRef;p&&(c.processRef=i(p))}),t.on("copyPaste.pasteElement",Es,function(s){var c=s.cache,p=s.descriptor;a(c,l(p,c,o(c)))})}Qh.$inject=["bpmnFactory","eventBus","moddleCopy"];var jx=["artifacts","dataInputAssociations","dataOutputAssociations","default","flowElements","lanes","incoming","outgoing","categoryValue"];function Fr(e,t,n){this._bpmnFactory=t,this._eventBus=e,this._moddle=n,e.on("moddleCopy.canCopyProperties",function(i){var r=i.propertyNames;if(!(!r||!r.length))return tn(r,function(o){return o==="extensionElements"})}),e.on("moddleCopy.canCopyProperty",function(i){var r=i.parent,o=vn(r)&&r.$descriptor,a=i.propertyName;if(a&&jx.indexOf(a)!==-1||a&&o&&!Oe(o.properties,dn({name:a})))return!1}),e.on("moddleCopy.canSetCopiedProperty",function(i){var r=i.property;if(Vx(r,"bpmn:ExtensionElements")&&(!r.values||!r.values.length))return!1})}Fr.$inject=["eventBus","bpmnFactory","moddle"];Fr.prototype.copyElement=function(e,t,n,i=!1){var r=this;n&&!Te(n)&&(n=[n]),n=n||tl(e.$descriptor);var o=this._eventBus.fire("moddleCopy.canCopyProperties",{propertyNames:n,sourceElement:e,targetElement:t,clone:i});return o===!1||(Te(o)&&(n=o),M(n,function(a){var l;Bn(e,a)&&(l=e.get(a));var s=r.copyProperty(l,t,a,i);if(Ct(s)){var c=r._eventBus.fire("moddleCopy.canSetCopiedProperty",{parent:t,property:s,propertyName:a});c!==!1&&t.set(a,s)}})),t};Fr.prototype.copyProperty=function(e,t,n,i=!1){var r=this,o=this._eventBus.fire("moddleCopy.canCopyProperty",{parent:t,property:e,propertyName:n,clone:i});if(o!==!1){if(o)return vn(o)&&o.$type&&!o.$parent&&(o.$parent=t),o;var a=this._moddle.getPropertyDescriptor(t,n);if(!a.isReference)return a.isId?e&&this._copyId(e,t,i):Te(e)?Yn(e,function(l,s){return o=r.copyProperty(s,t,n,i),o?l.concat(o):l},[]):vn(e)&&e.$type?this._moddle.getElementDescriptor(e).isGeneric?void 0:(o=r._bpmnFactory.create(e.$type),o.$parent=t,o=r.copyElement(e,o,null,i),o):e}};Fr.prototype._copyId=function(e,t,n=!1){if(n)return e;if(!this._moddle.ids.assigned(e))return this._moddle.ids.claim(e,t),e};function tl(e,t){return Yn(e.properties,function(n,i){return t&&i.default?n:n.concat(i.name)},[])}function Vx(e,t){return e&&en(e.$instanceOf)&&e.$instanceOf(t)}const Jh={__depends__:[Bx],__init__:["bpmnCopyPaste","moddleCopy"],bpmnCopyPaste:["type",Qh],moddleCopy:["type",Fr]};var Ap=Math.round;function Dc(e,t){this._modeling=e,this._eventBus=t}Dc.$inject=["modeling","eventBus"];Dc.prototype.replaceElement=function(e,t,n){if(e.waypoints)return null;var i=this._modeling,r=this._eventBus;r.fire("replace.start",{element:e,attrs:t,hints:n});var o=t.width||e.width,a=t.height||e.height,l=t.x||e.x,s=t.y||e.y,c=Ap(l+o/2),p=Ap(s+a/2),u=i.replaceShape(e,L({},t,{x:c,y:p,width:o,height:a}),n);return r.fire("replace.end",{element:e,newElement:u,hints:n}),u};function em(e,t){t.on("replace.end",500,function(n){const{newElement:i,hints:r={}}=n;r.select!==!1&&e.select(i)})}em.$inject=["selection","eventBus"];const Fx={__init__:["replace","replaceSelectionBehavior"],replaceSelectionBehavior:["type",em],replace:["type",Dc]};function Hx(e,t,n){Te(n)||(n=[n]),M(n,function(i){nf(e[i])||(t[i]=e[i])})}var zx=["cancelActivity","instantiate","eventGatewayType","triggeredByEvent","isInterrupting"];function Ux(e,t){var n=e&&Bn(e,"collapsed")?e.collapsed:!Se(e),i;return t&&(Bn(t,"collapsed")||Bn(t,"isExpanded"))?i=Bn(t,"collapsed")?t.collapsed:!t.isExpanded:i=n,n!==i}function tm(e,t,n,i,r,o){function a(l,s,c){c=c||{};var p=s.type,u=l.businessObject;if(Co(u)&&p==="bpmn:SubProcess"&&Ux(l,s))return i.toggleCollapse(l),l;var d=e.create(p),f={type:p,businessObject:d};f.di={},p==="bpmn:ExclusiveGateway"&&(f.di.isMarkerVisible=!0),Hx(l.di,f.di,["fill","stroke","background-color","border-color","color"]);var h=tl(u.$descriptor),m=tl(d.$descriptor,!0),v=Gx(h,m);L(d,nn(s,zx));var S=_e(v,function(w){return w==="eventDefinitions"?Mp(l,s.eventDefinitionType):w==="loopCharacteristics"?!mt(d):Bn(d,w)||w==="processRef"&&s.isExpanded===!1||w==="triggeredByEvent"?!1:w==="isForCompensation"?!mt(d):!0});if(d=n.copyElement(u,d,S),s.eventDefinitionType&&(Mp(d,s.eventDefinitionType)||(f.eventDefinitionType=s.eventDefinitionType,f.eventDefinitionAttrs=s.eventDefinitionAttrs)),y(u,"bpmn:Activity")){if(Co(u))f.isExpanded=Se(l);else if(s&&Bn(s,"isExpanded")){f.isExpanded=s.isExpanded;var b=t.getDefaultSize(d,{isExpanded:f.isExpanded});f.width=b.width,f.height=b.height,f.x=l.x-(f.width-l.width)/2,f.y=l.y-(f.height-l.height)/2}Se(l)&&!y(u,"bpmn:Task")&&f.isExpanded&&(f.width=l.width,f.height=l.height)}return Co(u)&&!Co(d)&&(c.moveChildren=!1),y(u,"bpmn:Participant")&&(s.isExpanded===!0?d.processRef=e.create("bpmn:Process"):c.moveChildren=!1,f.width=l.width,f.height=t.getDefaultSize(f).height),o.allowed("shape.resize",{shape:d})||(f.height=t.getDefaultSize(f).height,f.width=t.getDefaultSize(f).width),d.name=u.name,ve(u,["bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:Activity"])&&ve(d,["bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:Activity"])&&(d.default=u.default),s.host&&!y(u,"bpmn:BoundaryEvent")&&y(d,"bpmn:BoundaryEvent")&&(f.host=s.host),(f.type==="bpmn:DataStoreReference"||f.type==="bpmn:DataObjectReference")&&(f.x=l.x+(l.width-f.width)/2),r.replaceElement(l,f,{...c,targetElement:s})}this.replaceElement=a}tm.$inject=["bpmnFactory","elementFactory","moddleCopy","modeling","replace","rules"];function Co(e){return y(e,"bpmn:SubProcess")}function Mp(e,t){var n=Q(e);return t&&n.get("eventDefinitions").some(function(i){return y(i,t)})}function Gx(e,t){return e.filter(function(n){return t.includes(n)})}const nm={__depends__:[Jh,Fx,En],bpmnReplace:["type",tm]};var Wx=250;function Ci(e,t){this._eventBus=e,this._dragging=t,this._tools=[],this._active=null}Ci.$inject=["eventBus","dragging"];Ci.prototype.registerTool=function(e,t){var n=this._tools;if(!t)throw new Error(`A tool has to be registered with it's "events"`);n.push(e),this.bindEvents(e,t)};Ci.prototype.isActive=function(e){return e&&this._active===e};Ci.prototype.length=function(e){return this._tools.length};Ci.prototype.setActive=function(e){var t=this._eventBus;this._active!==e&&(this._active=e,t.fire("tool-manager.update",{tool:e}))};Ci.prototype.bindEvents=function(e,t){var n=this._eventBus,i=this._dragging,r=[];n.on(t.tool+".init",function(o){var a=o.context;if(!a.reactivate&&this.isActive(e)){this.setActive(null),i.cancel();return}this.setActive(e)},this),M(t,function(o){r.push(o+".ended"),r.push(o+".canceled")}),n.on(r,Wx,function(o){this._active&&(Yx(o)||this.setActive(null))},this)};function Yx(e){var t=e.originalEvent&&e.originalEvent.target;return t&&Wn(t,'.group[data-group="tools"]')}const Oa={__depends__:[Sn],__init__:["toolManager"],toolManager:["type",Ci]};function qx(e,t){if(e==="x"){if(t>0)return"e";if(t<0)return"w"}if(e==="y"){if(t>0)return"s";if(t<0)return"n"}return null}function Kx(e,t){var n=[];return M(e.concat(t),function(i){var r=i.incoming,o=i.outgoing;M(r.concat(o),function(a){var l=a.source,s=a.target;(mr(e,l)||mr(e,s)||mr(t,l)||mr(t,s))&&(mr(n,a)||n.push(a))})}),n}function mr(e,t){return e.indexOf(t)!==-1}function Xx(e,t,n){var i=e.x,r=e.y,o=e.width,a=e.height,l=n.x,s=n.y;switch(t){case"n":return{x:i,y:r+s,width:o,height:a-s};case"s":return{x:i,y:r,width:o,height:a+s};case"w":return{x:i+l,y:r,width:o-l,height:a};case"e":return{x:i,y:r,width:o+l,height:a};default:throw new Error("unknown direction: "+t)}}var xs=Math.abs,Zx=Math.round,cn={x:"width",y:"height"},im="crosshair",On={n:"top",w:"left",s:"bottom",e:"right"},Qx=1500,To={n:"s",w:"e",s:"n",e:"w"},Po=20;function Bt(e,t,n,i,r,o,a){this._canvas=e,this._dragging=t,this._eventBus=n,this._modeling=i,this._rules=r,this._toolManager=o,this._mouse=a;var l=this;o.registerTool("space",{tool:"spaceTool.selection",dragging:"spaceTool"}),n.on("spaceTool.selection.end",function(s){n.once("spaceTool.selection.ended",function(){l.activateMakeSpace(s.originalEvent)})}),n.on("spaceTool.move",Qx,function(s){var c=s.context,p=c.initialized;p||(p=c.initialized=l.init(s,c)),p&&Np(s)}),n.on("spaceTool.end",function(s){var c=s.context,p=c.axis,u=c.direction,d=c.movingShapes,f=c.resizingShapes,h=c.start;if(c.initialized){Np(s);var m={x:0,y:0};m[p]=Zx(s["d"+p]),l.makeSpace(d,f,m,u,h),n.once("spaceTool.ended",function(v){l.activateSelection(v.originalEvent,!0,!0)})}})}Bt.$inject=["canvas","dragging","eventBus","modeling","rules","toolManager","mouse"];Bt.prototype.activateSelection=function(e,t,n){this._dragging.init(e,"spaceTool.selection",{autoActivate:t,cursor:im,data:{context:{reactivate:n}},trapClick:!1})};Bt.prototype.activateMakeSpace=function(e){this._dragging.init(e,"spaceTool",{autoActivate:!0,cursor:im,data:{context:{}}})};Bt.prototype.makeSpace=function(e,t,n,i,r){return this._modeling.createSpace(e,t,n,i,r)};Bt.prototype.init=function(e,t){var n=xs(e.dx)>xs(e.dy)?"x":"y",i=e["d"+n],r=e[n]-i;if(xs(i)<5)return!1;i<0&&(i*=-1),Tr(e)&&(i*=-1);var o=qx(n,i),a=this._canvas.getRootElement();!rf(e)&&e.hover&&(a=e.hover);var l=[...Nr(a,!0),...a.attachers||[]],s=this.calculateAdjustments(l,n,i,r),c=this._eventBus.fire("spaceTool.getMinDimensions",{axis:n,direction:o,shapes:s.resizingShapes,start:r}),p=Jx(s,n,o,r,c);return L(t,s,{axis:n,direction:o,spaceToolConstraints:p,start:r}),ga("resize-"+(n==="x"?"ew":"ns")),!0};Bt.prototype.calculateAdjustments=function(e,t,n,i){var r=this._rules,o=[],a=[],l=[],s=[];function c(d){o.includes(d)||o.push(d);var f=d.label;f&&!o.includes(f)&&o.push(f)}function p(d){a.includes(d)||a.push(d)}M(e,function(d){if(!(!d.parent||xe(d))){if(Ae(d)){s.push(d);return}var f=d[t],h=f+d[cn[t]];if(ew(d)&&(n>0&&de(d)[t]>i||n<0&&de(d)[t]<i)){l.push(d);return}if(n>0&&f>i||n<0&&h<i){c(d);return}if(f<i&&h>i&&r.allowed("shape.resize",{shape:d})){p(d);return}}}),M(o,function(d){var f=d.attachers;f&&M(f,function(h){c(h)})});var u=o.concat(a);return M(l,function(d){var f=d.host;hi(u,f)&&c(d)}),u=o.concat(a),M(s,function(d){var f=d.source,h=d.target,m=d.label;hi(u,f)&&hi(u,h)&&m&&c(m)}),{movingShapes:o,resizingShapes:a}};Bt.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateSelection(e,!!e)};Bt.prototype.isActive=function(){var e=this._dragging.context();return e?/^spaceTool/.test(e.prefix):!1};function Ip(e){return{top:e.top-Po,right:e.right+Po,bottom:e.bottom+Po,left:e.left-Po}}function Np(e){var t=e.context,n=t.spaceToolConstraints;if(n){var i,r;ye(n.left)&&(i=Math.max(e.x,n.left),e.dx=e.dx+i-e.x,e.x=i),ye(n.right)&&(i=Math.min(e.x,n.right),e.dx=e.dx+i-e.x,e.x=i),ye(n.top)&&(r=Math.max(e.y,n.top),e.dy=e.dy+r-e.y,e.y=r),ye(n.bottom)&&(r=Math.min(e.y,n.bottom),e.dy=e.dy+r-e.y,e.y=r)}}function Jx(e,t,n,i,r){var o=e.movingShapes,a=e.resizingShapes;if(a.length){var l={},s,c;return M(a,function(p){var u=p.attachers,d=p.children,f=ae(p),h=_e(d,function($){return!Ae($)&&!xe($)&&!hi(o,$)&&!hi(a,$)}),m=_e(d,function($){return!Ae($)&&!xe($)&&hi(o,$)}),v,S,b,w=[],C=[],R,D,F,A;h.length&&(S=Ip(ae(Tt(h))),v=i-f[On[n]]+S[On[n]],n==="n"?l.bottom=c=ye(c)?Math.min(c,v):v:n==="w"?l.right=c=ye(c)?Math.min(c,v):v:n==="s"?l.top=s=ye(s)?Math.max(s,v):v:n==="e"&&(l.left=s=ye(s)?Math.max(s,v):v)),m.length&&(b=Ip(ae(Tt(m))),v=i-b[On[To[n]]]+f[On[To[n]]],n==="n"?l.bottom=c=ye(c)?Math.min(c,v):v:n==="w"?l.right=c=ye(c)?Math.min(c,v):v:n==="s"?l.top=s=ye(s)?Math.max(s,v):v:n==="e"&&(l.left=s=ye(s)?Math.max(s,v):v)),u&&u.length&&(u.forEach(function($){hi(o,$)?w.push($):C.push($)}),w.length&&(R=ae(Tt(w.map(de))),D=f[On[To[n]]]-(R[On[To[n]]]-i)),C.length&&(F=ae(Tt(C.map(de))),A=F[On[n]]-(f[On[n]]-i)),n==="n"?(v=Math.min(D||1/0,A||1/0),l.bottom=c=ye(c)?Math.min(c,v):v):n==="w"?(v=Math.min(D||1/0,A||1/0),l.right=c=ye(c)?Math.min(c,v):v):n==="s"?(v=Math.max(D||-1/0,A||-1/0),l.top=s=ye(s)?Math.max(s,v):v):n==="e"&&(v=Math.max(D||-1/0,A||-1/0),l.left=s=ye(s)?Math.max(s,v):v));var I=r&&r[p.id];I&&(n==="n"?(v=i+p[cn[t]]-I[cn[t]],l.bottom=c=ye(c)?Math.min(c,v):v):n==="w"?(v=i+p[cn[t]]-I[cn[t]],l.right=c=ye(c)?Math.min(c,v):v):n==="s"?(v=i-p[cn[t]]+I[cn[t]],l.top=s=ye(s)?Math.max(s,v):v):n==="e"&&(v=i-p[cn[t]]+I[cn[t]],l.left=s=ye(s)?Math.max(s,v):v))}),l}}function hi(e,t){return e.indexOf(t)!==-1}function ew(e){return!!e.host}var ws="djs-dragging",Op="djs-resizing",tw=250,Ro=Math.max;function rm(e,t,n,i,r){function o(a,l){M(a,function(s){r.addDragger(s,l),n.addMarker(s,ws)})}e.on("spaceTool.selection.start",function(a){var l=n.getLayer("space"),s=a.context,c={x:"M 0,-10000 L 0,10000",y:"M -10000,0 L 10000,0"},p=be("g");ie(p,i.cls("djs-crosshair-group",["no-events"])),Ce(l,p);var u=be("path");ie(u,"d",c.x),Ne(u).add("djs-crosshair"),Ce(p,u);var d=be("path");ie(d,"d",c.y),Ne(d).add("djs-crosshair"),Ce(p,d),s.crosshairGroup=p}),e.on("spaceTool.selection.move",function(a){var l=a.context.crosshairGroup;ht(l,a.x,a.y)}),e.on("spaceTool.selection.cleanup",function(a){var l=a.context,s=l.crosshairGroup;s&&rt(s)}),e.on("spaceTool.move",tw,function(a){var l=a.context,s=l.line,c=l.axis,p=l.movingShapes,u=l.resizingShapes;if(l.initialized){if(!l.dragGroup){var d=n.getLayer("space");s=be("path"),ie(s,"d","M0,0 L0,0"),Ne(s).add("djs-crosshair"),Ce(d,s),l.line=s;var f=be("g");ie(f,i.cls("djs-drag-group",["no-events"])),Ce(n.getActiveLayer(),f),o(p,f);var h=l.movingConnections=t.filter(function(C){var R=!1;M(p,function(I){M(I.outgoing,function($){C===$&&(R=!0)})});var D=!1;M(p,function(I){M(I.incoming,function($){C===$&&(D=!0)})});var F=!1;M(u,function(I){M(I.outgoing,function($){C===$&&(F=!0)})});var A=!1;return M(u,function(I){M(I.incoming,function($){C===$&&(A=!0)})}),Ae(C)&&(R||F)&&(D||A)});o(h,f),l.dragGroup=f}if(!l.frameGroup){var m=be("g");ie(m,i.cls("djs-frame-group",["no-events"])),Ce(n.getActiveLayer(),m);var v=[];M(u,function(C){var R=r.addFrame(C,m),D=R.getBBox();v.push({element:R,initialBounds:D}),n.addMarker(C,Op)}),l.frameGroup=m,l.frames=v}var S={x:"M"+a.x+", -10000 L"+a.x+", 10000",y:"M -10000, "+a.y+" L 10000, "+a.y};ie(s,{d:S[c]});var b={x:"y",y:"x"},w={x:a.dx,y:a.dy};w[b[l.axis]]=0,ht(l.dragGroup,w.x,w.y),M(l.frames,function(C){var R=C.element,D=C.initialBounds,F,A;l.direction==="e"?ie(R,{width:Ro(D.width+w.x,5)}):(F=Ro(D.width-w.x,5),ie(R,{width:F,x:D.x+D.width-F})),l.direction==="s"?ie(R,{height:Ro(D.height+w.y,5)}):(A=Ro(D.height-w.y,5),ie(R,{height:A,y:D.y+D.height-A}))})}}),e.on("spaceTool.cleanup",function(a){var l=a.context,s=l.movingShapes,c=l.movingConnections,p=l.resizingShapes,u=l.line,d=l.dragGroup,f=l.frameGroup;M(s,function(h){n.removeMarker(h,ws)}),M(c,function(h){n.removeMarker(h,ws)}),d&&(rt(u),rt(d)),M(p,function(h){n.removeMarker(h,Op)}),f&&rt(f)})}rm.$inject=["eventBus","elementRegistry","canvas","styles","previewSupport"];const nw={__init__:["spaceToolPreview"],__depends__:[Sn,on,Oa,er,Vr],spaceTool:["type",Bt],spaceToolPreview:["type",rm]};function La(e){e.invoke(Bt,this)}La.$inject=["injector"];te(La,Bt);La.prototype.calculateAdjustments=function(e,t,n,i){var r=Bt.prototype.calculateAdjustments.call(this,e,t,n,i);return r.resizingShapes=r.resizingShapes.filter(function(o){return!(y(o,"bpmn:TextAnnotation")||iw(o)&&(t==="y"&&gn(o)||t==="x"&&!gn(o)))}),r};function iw(e){return y(e,"bpmn:Participant")&&!Q(e).processRef}const om={__depends__:[nw],spaceTool:["type",La]};function je(e,t){this._handlerMap={},this._stack=[],this._stackIdx=-1,this._currentExecution={actions:[],dirty:[],trigger:null},this._injector=t,this._eventBus=e,this._uid=1,e.on(["diagram.destroy","diagram.clear"],function(){this.clear(!1)},this)}je.$inject=["eventBus","injector"];je.prototype.execute=function(e,t){if(!e)throw new Error("command required");this._currentExecution.trigger="execute";const n={command:e,context:t};this._pushAction(n),this._internalExecute(n),this._popAction()};je.prototype.canExecute=function(e,t){const n={command:e,context:t},i=this._getHandler(e);let r=this._fire(e,"canExecute",n);if(r===void 0){if(!i)return!1;i.canExecute&&(r=i.canExecute(t))}return r};je.prototype.clear=function(e){this._stack.length=0,this._stackIdx=-1,e!==!1&&this._fire("changed",{trigger:"clear"})};je.prototype.undo=function(){let e=this._getUndoAction(),t;if(e){for(this._currentExecution.trigger="undo",this._pushAction(e);e&&(this._internalUndo(e),t=this._getUndoAction(),!(!t||t.id!==e.id));)e=t;this._popAction()}};je.prototype.redo=function(){let e=this._getRedoAction(),t;if(e){for(this._currentExecution.trigger="redo",this._pushAction(e);e&&(this._internalExecute(e,!0),t=this._getRedoAction(),!(!t||t.id!==e.id));)e=t;this._popAction()}};je.prototype.register=function(e,t){this._setHandler(e,t)};je.prototype.registerHandler=function(e,t){if(!e||!t)throw new Error("command and handlerCls must be defined");const n=this._injector.instantiate(t);this.register(e,n)};je.prototype.canUndo=function(){return!!this._getUndoAction()};je.prototype.canRedo=function(){return!!this._getRedoAction()};je.prototype._getRedoAction=function(){return this._stack[this._stackIdx+1]};je.prototype._getUndoAction=function(){return this._stack[this._stackIdx]};je.prototype._internalUndo=function(e){const t=e.command,n=e.context,i=this._getHandler(t);this._atomicDo(()=>{this._fire(t,"revert",e),i.revert&&this._markDirty(i.revert(n)),this._revertedAction(e),this._fire(t,"reverted",e)})};je.prototype._fire=function(e,t,n){arguments.length<3&&(n=t,t=null);const i=t?[e+"."+t,t]:[e];let r;n=this._eventBus.createEvent(n);for(const o of i)if(r=this._eventBus.fire("commandStack."+o,n),n.cancelBubble)break;return r};je.prototype._createId=function(){return this._uid++};je.prototype._atomicDo=function(e){const t=this._currentExecution;t.atomic=!0;try{e()}finally{t.atomic=!1}};je.prototype._internalExecute=function(e,t){const n=e.command,i=e.context,r=this._getHandler(n);if(!r)throw new Error("no command handler registered for <"+n+">");this._pushAction(e),t||(this._fire(n,"preExecute",e),r.preExecute&&r.preExecute(i),this._fire(n,"preExecuted",e)),this._atomicDo(()=>{this._fire(n,"execute",e),r.execute&&this._markDirty(r.execute(i)),this._executedAction(e,t),this._fire(n,"executed",e)}),t||(this._fire(n,"postExecute",e),r.postExecute&&r.postExecute(i),this._fire(n,"postExecuted",e)),this._popAction()};je.prototype._pushAction=function(e){const t=this._currentExecution,n=t.actions,i=n[0];if(t.atomic)throw new Error("illegal invocation in <execute> or <revert> phase (action: "+e.command+")");e.id||(e.id=i&&i.id||this._createId()),n.push(e)};je.prototype._popAction=function(){const e=this._currentExecution,t=e.trigger,n=e.actions,i=e.dirty;n.pop(),n.length||(this._eventBus.fire("elements.changed",{elements:ag("id",i.reverse())}),i.length=0,this._fire("changed",{trigger:t}),e.trigger=null)};je.prototype._markDirty=function(e){const t=this._currentExecution;e&&(e=Te(e)?e:[e],t.dirty=t.dirty.concat(e))};je.prototype._executedAction=function(e,t){const n=++this._stackIdx;t||this._stack.splice(n,this._stack.length,e)};je.prototype._revertedAction=function(e){this._stackIdx--};je.prototype._getHandler=function(e){return this._handlerMap[e]};je.prototype._setHandler=function(e,t){if(!e||!t)throw new Error("command and handler required");if(this._handlerMap[e])throw new Error("overriding handler for command <"+e+">");this._handlerMap[e]=t};const rw={commandStack:["type",je]};function Vn(e,t){if(typeof t!="function")throw new Error("removeFn iterator must be a function");if(e){for(var n;n=e[0];)t(n);return e}}var ow=250,Lp=1400;function kc(e,t,n){Y.call(this,t);var i=e.get("movePreview",!1);t.on("shape.move.start",Lp,function(r){var o=r.context,a=o.shapes,l=o.validatedShapes;o.shapes=$p(a),o.validatedShapes=$p(l)}),i&&t.on("shape.move.start",ow,function(r){var o=r.context,a=o.shapes,l=[];M(a,function(s){M(s.labels,function(c){!c.hidden&&o.shapes.indexOf(c)===-1&&l.push(c),s.labelTarget&&l.push(s)})}),M(l,function(s){i.makeDraggable(o,s,!0)})}),this.preExecuted("elements.move",Lp,function(r){var o=r.context,a=o.closure,l=a.enclosedElements,s=[];M(l,function(c){M(c.labels,function(p){l[p.id]||s.push(p)})}),a.addAll(s)}),this.preExecute(["connection.delete","shape.delete"],function(r){var o=r.context,a=o.connection||o.shape;Vn(a.labels,function(l){n.removeShape(l,{nested:!0})})}),this.execute("shape.delete",function(r){var o=r.context,a=o.shape,l=a.labelTarget;l&&(o.labelTargetIndex=El(l.labels,a),o.labelTarget=l,a.labelTarget=null)}),this.revert("shape.delete",function(r){var o=r.context,a=o.shape,l=o.labelTarget,s=o.labelTargetIndex;l&&(Je(l.labels,a,s),a.labelTarget=l)})}te(kc,Y);kc.$inject=["injector","eventBus","modeling"];function $p(e){return _e(e,function(t){return e.indexOf(t.labelTarget)===-1})}const aw={__init__:["labelSupport"],labelSupport:["type",kc]};var sw=251,Bp=1401,jp="attach-ok";function Ac(e,t,n,i,r){Y.call(this,t);var o=e.get("movePreview",!1);t.on("shape.move.start",Bp,function(a){var l=a.context,s=l.shapes,c=l.validatedShapes;l.shapes=lw(s),l.validatedShapes=cw(c)}),o&&t.on("shape.move.start",sw,function(a){var l=a.context,s=l.shapes,c=nl(s);M(c,function(p){o.makeDraggable(l,p,!0),M(p.labels,function(u){o.makeDraggable(l,u,!0)})})}),o&&t.on("shape.move.start",function(a){var l=a.context,s=l.shapes;if(s.length===1){var c=s[0],p=c.host;p&&(n.addMarker(p,jp),t.once(["shape.move.out","shape.move.cleanup"],function(){n.removeMarker(p,jp)}))}}),this.preExecuted("elements.move",Bp,function(a){var l=a.context,s=l.closure,c=l.shapes,p=nl(c);M(p,function(u){s.add(u,s.topLevel[u.host.id])})}),this.postExecuted("elements.move",function(a){var l=a.context,s=l.shapes,c=l.newHost,p;c&&s.length!==1||(c?p=s:p=_e(s,function(u){var d=u.host;return uw(u)&&!pw(s,d)}),M(p,function(u){r.updateAttachment(u,c)}))}),this.postExecuted("elements.move",function(a){var l=a.context.shapes;M(l,function(s){M(s.attachers,function(c){M(c.outgoing.slice(),function(p){var u=i.allowed("connection.reconnect",{connection:p,source:p.source,target:p.target});u||r.removeConnection(p)}),M(c.incoming.slice(),function(p){var u=i.allowed("connection.reconnect",{connection:p,source:p.source,target:p.target});u||r.removeConnection(p)})})})}),this.postExecute("shape.create",function(a){var l=a.context,s=l.shape,c=l.host;c&&r.updateAttachment(s,c)}),this.postExecute("shape.replace",function(a){var l=a.context,s=l.oldShape,c=l.newShape;Vn(s.attachers,function(p){var u=i.allowed("elements.move",{target:c,shapes:[p]});u==="attach"?r.updateAttachment(p,c):r.removeShape(p)}),c.attachers.length&&M(c.attachers,function(p){var u=hp(p,s,c);r.moveShape(p,u,p.parent)})}),this.postExecute("shape.resize",function(a){var l=a.context,s=l.shape,c=l.oldBounds,p=l.newBounds,u=s.attachers,d=l.hints||{};d.attachSupport!==!1&&M(u,function(f){var h=hp(f,c,p);r.moveShape(f,h,f.parent),M(f.labels,function(m){r.moveShape(m,h,m.parent)})})}),this.preExecute("shape.delete",function(a){var l=a.context.shape;Vn(l.attachers,function(s){r.removeShape(s)}),l.host&&r.updateAttachment(l,null)})}te(Ac,Y);Ac.$inject=["injector","eventBus","canvas","rules","modeling"];function nl(e){return qo(bt(e,function(t){return t.attachers||[]}))}function lw(e){var t=nl(e);return sg("id",e,t)}function cw(e){var t=da(e,"id");return _e(e,function(n){for(;n;){if(n.host&&t[n.host.id])return!1;n=n.parent}return!0})}function uw(e){return!!e.host}function pw(e,t){return e.indexOf(t)!==-1}const dw={__depends__:[on],__init__:["attachSupport"],attachSupport:["type",Ac]};function jt(e){this._model=e}jt.$inject=["moddle"];jt.prototype._needsId=function(e){return ve(e,["bpmn:RootElement","bpmn:FlowElement","bpmn:MessageFlow","bpmn:DataAssociation","bpmn:Artifact","bpmn:Participant","bpmn:Lane","bpmn:LaneSet","bpmn:Process","bpmn:Collaboration","bpmndi:BPMNShape","bpmndi:BPMNEdge","bpmndi:BPMNDiagram","bpmndi:BPMNPlane","bpmn:Property","bpmn:CategoryValue"])};jt.prototype._ensureId=function(e){if(e.id){this._model.ids.claim(e.id,e);return}var t;y(e,"bpmn:Activity")?t="Activity":y(e,"bpmn:Event")?t="Event":y(e,"bpmn:Gateway")?t="Gateway":ve(e,["bpmn:SequenceFlow","bpmn:MessageFlow"])?t="Flow":t=(e.$type||"").replace(/^[^:]*:/g,""),t+="_",!e.id&&this._needsId(e)&&(e.id=this._model.ids.nextPrefixed(t,e))};jt.prototype.create=function(e,t){var n=this._model.create(e,t||{});return this._ensureId(n),n};jt.prototype.createDiLabel=function(){return this.create("bpmndi:BPMNLabel",{bounds:this.createDiBounds()})};jt.prototype.createDiShape=function(e,t){return this.create("bpmndi:BPMNShape",L({bpmnElement:e,bounds:this.createDiBounds()},t))};jt.prototype.createDiBounds=function(e){return this.create("dc:Bounds",e)};jt.prototype.createDiWaypoints=function(e){var t=this;return bt(e,function(n){return t.createDiWaypoint(n)})};jt.prototype.createDiWaypoint=function(e){return this.create("dc:Point",nn(e,["x","y"]))};jt.prototype.createDiEdge=function(e,t){return this.create("bpmndi:BPMNEdge",L({bpmnElement:e,waypoint:this.createDiWaypoints([])},t))};jt.prototype.createDiPlane=function(e,t){return this.create("bpmndi:BPMNPlane",L({bpmnElement:e},t))};function Pt(e,t,n,i){Y.call(this,e),this._bpmnFactory=t,this._translate=i;var r=this;function o(h){var m=h.context,v=m.hints||{},S;!m.cropped&&v.createElementsBehavior!==!1&&(S=m.connection,S.waypoints=n.getCroppedWaypoints(S),m.cropped=!0)}this.executed(["connection.layout","connection.create"],o),this.reverted(["connection.layout"],function(h){delete h.context.cropped});function a(h){var m=h.context;r.updateParent(m.shape||m.connection,m.oldParent)}function l(h){var m=h.context,v=m.shape||m.connection,S=m.parent||m.newParent;r.updateParent(v,S)}this.executed(["shape.move","shape.create","shape.delete","connection.create","connection.move","connection.delete"],St(a)),this.reverted(["shape.move","shape.create","shape.delete","connection.create","connection.move","connection.delete"],St(l));function s(h){var m=h.context,v=m.oldRoot,S=v.children;M(S,function(b){y(b,"bpmn:BaseElement")&&r.updateParent(b)})}this.executed(["canvas.updateRoot"],s),this.reverted(["canvas.updateRoot"],s);function c(h){var m=h.context.shape;y(m,"bpmn:BaseElement")&&r.updateBounds(m)}this.executed(["shape.move","shape.create","shape.resize"],St(function(h){h.context.shape.type!=="label"&&c(h)})),this.reverted(["shape.move","shape.create","shape.resize"],St(function(h){h.context.shape.type!=="label"&&c(h)})),e.on("shape.changed",function(h){h.element.type==="label"&&c({context:{shape:h.element}})});function p(h){r.updateConnection(h.context)}this.executed(["connection.create","connection.move","connection.delete","connection.reconnect"],St(p)),this.reverted(["connection.create","connection.move","connection.delete","connection.reconnect"],St(p));function u(h){r.updateConnectionWaypoints(h.context.connection)}this.executed(["connection.layout","connection.move","connection.updateWaypoints"],St(u)),this.reverted(["connection.layout","connection.move","connection.updateWaypoints"],St(u)),this.executed("connection.reconnect",St(function(h){var m=h.context,v=m.connection,S=m.oldSource,b=m.newSource,w=Q(v),C=Q(S),R=Q(b);w.conditionExpression&&!ve(R,["bpmn:Activity","bpmn:ExclusiveGateway","bpmn:InclusiveGateway"])&&(m.oldConditionExpression=w.conditionExpression,delete w.conditionExpression),S!==b&&C.default===w&&(m.oldDefault=C.default,delete C.default)})),this.reverted("connection.reconnect",St(function(h){var m=h.context,v=m.connection,S=m.oldSource,b=m.newSource,w=Q(v),C=Q(S),R=Q(b);m.oldConditionExpression&&(w.conditionExpression=m.oldConditionExpression),m.oldDefault&&(C.default=m.oldDefault,delete R.default)}));function d(h){r.updateAttachment(h.context)}this.executed(["element.updateAttachment"],St(d)),this.reverted(["element.updateAttachment"],St(d)),this.executed("element.updateLabel",St(f)),this.reverted("element.updateLabel",St(f));function f(h){const{element:m}=h.context,v=Hn(m),S=Me(m),b=S&&S.get("label");zi(m)||Lo(m)||(v&&!b?S.set("label",t.create("bpmndi:BPMNLabel")):!v&&b&&S.set("label",void 0))}}te(Pt,Y);Pt.$inject=["eventBus","bpmnFactory","connectionDocking","translate"];Pt.prototype.updateAttachment=function(e){var t=e.shape,n=t.businessObject,i=t.host;n.attachedToRef=i&&i.businessObject};Pt.prototype.updateParent=function(e,t){if(!xe(e)&&!(y(e,"bpmn:DataStoreReference")&&e.parent&&y(e.parent,"bpmn:Collaboration"))){var n=e.parent,i=e.businessObject,r=Me(e),o=n&&n.businessObject,a=Me(n);y(e,"bpmn:FlowNode")&&this.updateFlowNodeRefs(i,o,t&&t.businessObject),y(e,"bpmn:DataOutputAssociation")&&(e.source?o=e.source.businessObject:o=null),y(e,"bpmn:DataInputAssociation")&&(e.target?o=e.target.businessObject:o=null),this.updateSemanticParent(i,o),y(e,"bpmn:DataObjectReference")&&i.dataObjectRef&&this.updateSemanticParent(i.dataObjectRef,o),this.updateDiParent(r,a)}};Pt.prototype.updateBounds=function(e){var t=Me(e),n=hw(e);if(n){var i=Ut(n,t.get("bounds"));L(n,{x:e.x+i.x,y:e.y+i.y})}var r=xe(e)?this._getLabel(t):t,o=r.bounds;o||(o=this._bpmnFactory.createDiBounds(),r.set("bounds",o)),L(o,{x:e.x,y:e.y,width:e.width,height:e.height})};Pt.prototype.updateFlowNodeRefs=function(e,t,n){if(n!==t){var i,r;y(n,"bpmn:Lane")&&(i=n.get("flowNodeRef"),Xe(i,e)),y(t,"bpmn:Lane")&&(r=t.get("flowNodeRef"),Je(r,e))}};Pt.prototype.updateDiConnection=function(e,t,n){var i=Me(e),r=Me(t),o=Me(n);i.sourceElement&&i.sourceElement.bpmnElement!==Q(t)&&(i.sourceElement=t&&r),i.targetElement&&i.targetElement.bpmnElement!==Q(n)&&(i.targetElement=n&&o)};Pt.prototype.updateDiParent=function(e,t){if(t&&!y(t,"bpmndi:BPMNPlane")&&(t=t.$parent),e.$parent!==t){var n=(t||e.$parent).get("planeElement");t?(n.push(e),e.$parent=t):(Xe(n,e),e.$parent=null)}};function fw(e){for(;e&&!y(e,"bpmn:Definitions");)e=e.$parent;return e}Pt.prototype.getLaneSet=function(e){var t,n;return y(e,"bpmn:Lane")?(t=e.childLaneSet,t||(t=this._bpmnFactory.create("bpmn:LaneSet"),e.childLaneSet=t,t.$parent=e),t):(y(e,"bpmn:Participant")&&(e=e.processRef),n=e.get("laneSets"),t=n[0],t||(t=this._bpmnFactory.create("bpmn:LaneSet"),t.$parent=e,n.push(t)),t)};Pt.prototype.updateSemanticParent=function(e,t,n){var i,r=this._translate;if(e.$parent!==t&&!((y(e,"bpmn:DataInput")||y(e,"bpmn:DataOutput"))&&(y(t,"bpmn:Participant")&&"processRef"in t&&(t=t.processRef),"ioSpecification"in t&&t.ioSpecification===e.$parent))){if(y(e,"bpmn:Lane"))t&&(t=this.getLaneSet(t)),i="lanes";else if(y(e,"bpmn:FlowElement")){if(t){if(y(t,"bpmn:Participant"))t=t.processRef;else if(y(t,"bpmn:Lane"))do t=t.$parent.$parent;while(y(t,"bpmn:Lane"))}i="flowElements"}else if(y(e,"bpmn:Artifact")){for(;t&&!y(t,"bpmn:Process")&&!y(t,"bpmn:SubProcess")&&!y(t,"bpmn:Collaboration");)if(y(t,"bpmn:Participant")){t=t.processRef;break}else t=t.$parent;i="artifacts"}else if(y(e,"bpmn:MessageFlow"))i="messageFlows";else if(y(e,"bpmn:Participant")){i="participants";var o=e.processRef,a;o&&(a=fw(e.$parent||t),e.$parent&&(Xe(a.get("rootElements"),o),o.$parent=null),t&&(Je(a.get("rootElements"),o),o.$parent=a))}else y(e,"bpmn:DataOutputAssociation")?i="dataOutputAssociations":y(e,"bpmn:DataInputAssociation")&&(i="dataInputAssociations");if(!i)throw new Error(r("no parent for {element} in {parent}",{element:e.id,parent:t.id}));var l;if(e.$parent&&(l=e.$parent.get(i),Xe(l,e)),t?(l=t.get(i),l.push(e),e.$parent=t):e.$parent=null,n){var s=n.get(i);Xe(l,e),t&&(s||(s=[],t.set(i,s)),s.push(e))}}};Pt.prototype.updateConnectionWaypoints=function(e){var t=Me(e);t.set("waypoint",this._bpmnFactory.createDiWaypoints(e.waypoints))};Pt.prototype.updateConnection=function(e){var t=e.connection,n=Q(t),i=t.source,r=Q(i),o=t.target,a=Q(t.target),l;if(y(n,"bpmn:DataAssociation"))y(n,"bpmn:DataInputAssociation")?(n.get("sourceRef")[0]=r,l=e.parent||e.newParent||a,this.updateSemanticParent(n,a,l)):y(n,"bpmn:DataOutputAssociation")&&(l=e.parent||e.newParent||r,this.updateSemanticParent(n,r,l),n.targetRef=a);else{var s=y(n,"bpmn:SequenceFlow");n.sourceRef!==r&&(s&&(Xe(n.sourceRef&&n.sourceRef.get("outgoing"),n),r&&r.get("outgoing")&&r.get("outgoing").push(n)),n.sourceRef=r),n.targetRef!==a&&(s&&(Xe(n.targetRef&&n.targetRef.get("incoming"),n),a&&a.get("incoming")&&a.get("incoming").push(n)),n.targetRef=a)}this.updateConnectionWaypoints(t),this.updateDiConnection(t,i,o)};Pt.prototype._getLabel=function(e){return e.label||(e.label=this._bpmnFactory.createDiLabel()),e.label};function St(e){return function(t){var n=t.context,i=n.shape||n.connection||n.element;y(i,"bpmn:BaseElement")&&e(t)}}function hw(e){if(y(e,"bpmn:Activity")){var t=Me(e);if(t){var n=t.get("label");if(n)return n.get("bounds")}}}function Zn(e,t,n){xl.call(this),this._bpmnFactory=e,this._moddle=t,this._translate=n}te(Zn,xl);Zn.$inject=["bpmnFactory","moddle","translate"];Zn.prototype._baseCreate=xl.prototype.create;Zn.prototype.create=function(e,t){if(e==="label"){var n=t.di||this._bpmnFactory.createDiLabel();return this._baseCreate(e,L({type:"label",di:n},lg,t))}return this.createElement(e,t)};Zn.prototype.createElement=function(e,t){var n,i=this._translate;t=L({},t||{});var r=t.businessObject,o=t.di;if(!r){if(!t.type)throw new Error(i("no shape type specified"));r=this._bpmnFactory.create(t.type),cg(r)}if(!vw(o)){var a=L({},o||{},{id:r.id+"_di"});e==="root"?o=this._bpmnFactory.createDiPlane(r,a):e==="connection"?o=this._bpmnFactory.createDiEdge(r,a):o=this._bpmnFactory.createDiShape(r,a)}y(r,"bpmn:Group")&&(t=L({isFrame:!0},t)),t=mw(r,t,["processRef","isInterrupting","associationDirection","isForCompensation"]),t.isExpanded&&(t=il(o,t,"isExpanded")),y(r,"bpmn:SubProcess")&&(t.collapsed=!Se(r,o)),y(r,"bpmn:ExclusiveGateway")&&(Bn(t,"isMarkerVisible")?t.isMarkerVisible===void 0?o.isMarkerVisible=!1:t=il(o,t,"isMarkerVisible"):o.isMarkerVisible=!0),Ct(t.triggeredByEvent)&&(r.triggeredByEvent=t.triggeredByEvent,delete t.triggeredByEvent),Ct(t.cancelActivity)&&(r.cancelActivity=t.cancelActivity,delete t.cancelActivity);var l,s;return t.eventDefinitionType&&(l=r.get("eventDefinitions")||[],s=this._bpmnFactory.create(t.eventDefinitionType,t.eventDefinitionAttrs),t.eventDefinitionType==="bpmn:ConditionalEventDefinition"&&(s.condition=this._bpmnFactory.create("bpmn:FormalExpression")),l.push(s),s.$parent=r,r.eventDefinitions=l,delete t.eventDefinitionType),n=this.getDefaultSize(r,o),t=L({id:r.id},n,t,{businessObject:r,di:o}),this._baseCreate(e,t)};Zn.prototype.getDefaultSize=function(e,t){var n=Q(e);return t=t||Me(e),y(n,"bpmn:SubProcess")?Se(n,t)?{width:350,height:200}:{width:100,height:80}:y(n,"bpmn:Task")?{width:100,height:80}:y(n,"bpmn:Gateway")?{width:50,height:50}:y(n,"bpmn:Event")?{width:36,height:36}:y(n,"bpmn:Participant")?Se(n,t)?{width:600,height:250}:{width:400,height:60}:y(n,"bpmn:Lane")?{width:400,height:100}:y(n,"bpmn:DataObjectReference")?{width:36,height:50}:y(n,"bpmn:DataStoreReference")?{width:50,height:50}:y(n,"bpmn:TextAnnotation")?{width:100,height:30}:y(n,"bpmn:Group")?{width:300,height:300}:{width:100,height:80}};Zn.prototype.createParticipantShape=function(e){return vn(e)||(e={isExpanded:e}),e=L({type:"bpmn:Participant"},e||{}),e.isExpanded!==!1&&(e.processRef=this._bpmnFactory.create("bpmn:Process")),this.createShape(e)};function mw(e,t,n){return M(n,function(i){t=il(e,t,i)}),t}function il(e,t,n){return t[n]===void 0?t:(e[n]=t[n],bn(t,[n]))}function vw(e){return ve(e,["bpmndi:BPMNShape","bpmndi:BPMNEdge","bpmndi:BPMNDiagram","bpmndi:BPMNPlane"])}function $a(e,t){this._modeling=e,this._canvas=t}$a.$inject=["modeling","canvas"];$a.prototype.preExecute=function(e){var t=this._modeling,n=e.elements,i=e.alignment;M(n,function(r){var o={x:0,y:0};Ct(i.left)?o.x=i.left-r.x:Ct(i.right)?o.x=i.right-r.width-r.x:Ct(i.center)?o.x=i.center-Math.round(r.width/2)-r.x:Ct(i.top)?o.y=i.top-r.y:Ct(i.bottom)?o.y=i.bottom-r.height-r.y:Ct(i.middle)&&(o.y=i.middle-Math.round(r.height/2)-r.y),t.moveElements([r],o,r.parent)})};$a.prototype.postExecute=function(e){};function Ba(e){this._modeling=e}Ba.$inject=["modeling"];Ba.prototype.preExecute=function(e){var t=e.source;if(!t)throw new Error("source required");var n=e.target||t.parent,i=e.shape,r=e.hints||{};i=e.shape=this._modeling.createShape(i,e.position,n,{attach:r.attach}),e.shape=i};Ba.prototype.postExecute=function(e){var t=e.hints||{};gw(e.source,e.shape)||(t.connectionTarget===e.source?this._modeling.connect(e.shape,e.source,e.connection):this._modeling.connect(e.source,e.shape,e.connection))};function gw(e,t){return Ki(e.outgoing,function(n){return n.target===t})}function ja(e,t){this._canvas=e,this._layouter=t}ja.$inject=["canvas","layouter"];ja.prototype.execute=function(e){var t=e.connection,n=e.source,i=e.target,r=e.parent,o=e.parentIndex,a=e.hints;if(!n||!i)throw new Error("source and target required");if(!r)throw new Error("parent required");return t.source=n,t.target=i,t.waypoints||(t.waypoints=this._layouter.layoutConnection(t,a)),this._canvas.addConnection(t,r,o),t};ja.prototype.revert=function(e){var t=e.connection;return this._canvas.removeConnection(t),t.source=null,t.target=null,t};var Do=Math.round;function Mc(e){this._modeling=e}Mc.$inject=["modeling"];Mc.prototype.preExecute=function(e){var t=e.elements,n=e.parent,i=e.parentIndex,r=e.position,o=e.hints,a=this._modeling;M(t,function(u){ye(u.x)||(u.x=0),ye(u.y)||(u.y=0)});var l=_e(t,function(u){return!u.hidden}),s=Tt(l);M(t,function(u){Ae(u)&&(u.waypoints=bt(u.waypoints,function(d){return{x:Do(d.x-s.x-s.width/2+r.x),y:Do(d.y-s.y-s.height/2+r.y)}})),L(u,{x:Do(u.x-s.x-s.width/2+r.x),y:Do(u.y-s.y-s.height/2+r.y)})});var c=ua(t),p={};M(t,function(u){if(Ae(u)){p[u.id]=ye(i)?a.createConnection(p[u.source.id],p[u.target.id],i,u,u.parent||n,o):a.createConnection(p[u.source.id],p[u.target.id],u,u.parent||n,o);return}var d=L({},o);c.indexOf(u)===-1&&(d.autoResize=!1),xe(u)&&(d=bn(d,["attach"])),p[u.id]=ye(i)?a.createShape(u,nn(u,["x","y","width","height"]),u.parent||n,i,d):a.createShape(u,nn(u,["x","y","width","height"]),u.parent||n,d)}),e.elements=gl(p)};var Vp=Math.round;function Qn(e){this._canvas=e}Qn.$inject=["canvas"];Qn.prototype.execute=function(e){var t=e.shape,n=e.position,i=e.parent,r=e.parentIndex;if(!i)throw new Error("parent required");if(!n)throw new Error("position required");return n.width!==void 0?L(t,n):L(t,{x:n.x-Vp(t.width/2),y:n.y-Vp(t.height/2)}),this._canvas.addShape(t,i,r),t};Qn.prototype.revert=function(e){var t=e.shape;return this._canvas.removeShape(t),t};function Hr(e){Qn.call(this,e)}te(Hr,Qn);Hr.$inject=["canvas"];var yw=Qn.prototype.execute;Hr.prototype.execute=function(e){var t=e.shape;return bw(t),t.labelTarget=e.labelTarget,yw.call(this,e)};var _w=Qn.prototype.revert;Hr.prototype.revert=function(e){return e.shape.labelTarget=null,_w.call(this,e)};function bw(e){["width","height"].forEach(function(t){typeof e[t]>"u"&&(e[t]=0)})}function zr(e,t){this._canvas=e,this._modeling=t}zr.$inject=["canvas","modeling"];zr.prototype.preExecute=function(e){var t=this._modeling,n=e.connection;Vn(n.incoming,function(i){t.removeConnection(i,{nested:!0})}),Vn(n.outgoing,function(i){t.removeConnection(i,{nested:!0})})};zr.prototype.execute=function(e){var t=e.connection,n=t.parent;return e.parent=n,e.parentIndex=El(n.children,t),e.source=t.source,e.target=t.target,this._canvas.removeConnection(t),t.source=null,t.target=null,t};zr.prototype.revert=function(e){var t=e.connection,n=e.parent,i=e.parentIndex;return t.source=e.source,t.target=e.target,Je(n.children,t,i),this._canvas.addConnection(t,n),t};function Ic(e,t){this._modeling=e,this._elementRegistry=t}Ic.$inject=["modeling","elementRegistry"];Ic.prototype.postExecute=function(e){var t=this._modeling,n=this._elementRegistry,i=e.elements;M(i,function(r){n.get(r.id)&&(r.waypoints?t.removeConnection(r):t.removeShape(r))})};function Ur(e,t){this._canvas=e,this._modeling=t}Ur.$inject=["canvas","modeling"];Ur.prototype.preExecute=function(e){var t=this._modeling,n=e.shape;Vn(n.incoming,function(i){t.removeConnection(i,{nested:!0})}),Vn(n.outgoing,function(i){t.removeConnection(i,{nested:!0})}),Vn(n.children,function(i){Ae(i)?t.removeConnection(i,{nested:!0}):t.removeShape(i,{nested:!0})})};Ur.prototype.execute=function(e){var t=this._canvas,n=e.shape,i=n.parent;return e.oldParent=i,e.oldParentIndex=El(i.children,n),t.removeShape(n),n};Ur.prototype.revert=function(e){var t=this._canvas,n=e.shape,i=e.oldParent,r=e.oldParentIndex;return Je(i.children,n,r),t.addShape(n,i),n};function Va(e){this._modeling=e}Va.$inject=["modeling"];var Fp={x:"y",y:"x"};Va.prototype.preExecute=function(e){var t=this._modeling,n=e.groups,i=e.axis,r=e.dimension;function o(v,S){v.range.min=Math.min(S[i],v.range.min),v.range.max=Math.max(S[i]+S[r],v.range.max)}function a(v){return v[i]+v[r]/2}function l(v){return v.length-1}function s(v){return v.max-v.min}function c(v,S){var b={y:0};b[i]=v-a(S),b[i]&&(b[Fp[i]]=0,t.moveElements([S],b,S.parent))}var p=n[0],u=l(n),d=n[u],f,h,m=0;M(n,function(v,S){var b,w,C;if(v.elements.length<2){S&&S!==n.length-1&&(o(v,v.elements[0]),m+=s(v.range));return}b=tn(v.elements,i),w=b[0],S===u&&(w=b[l(b)]),C=a(w),v.range=null,M(b,function(R){if(c(C,R),v.range===null){v.range={min:R[i],max:R[i]+R[r]};return}o(v,R)}),S&&S!==n.length-1&&(m+=s(v.range))}),h=Math.abs(d.range.min-p.range.max),f=Math.round((h-m)/(n.length-1)),!(f<n.length-1)&&M(n,function(v,S){var b={},w;v===p||v===d||(w=n[S-1],v.range.max=0,M(v.elements,function(C,R){b[Fp[i]]=0,b[i]=w.range.max-C[i]+f,v.range.min!==C[i]&&(b[i]+=C[i]-v.range.min),b[i]&&t.moveElements([C],b,C.parent),v.range.max=Math.max(C[i]+C[r],R?v.range.max:0)}))})};Va.prototype.postExecute=function(e){};function Fa(e,t){this._layouter=e,this._canvas=t}Fa.$inject=["layouter","canvas"];Fa.prototype.execute=function(e){var t=e.connection,n=t.waypoints;return L(e,{oldWaypoints:n}),t.waypoints=this._layouter.layoutConnection(t,e.hints),t};Fa.prototype.revert=function(e){var t=e.connection;return t.waypoints=e.oldWaypoints,t};function Nc(){}Nc.prototype.execute=function(e){var t=e.connection,n=e.delta,i=e.newParent||t.parent,r=e.newParentIndex,o=t.parent;return e.oldParent=o,e.oldParentIndex=Xe(o.children,t),Je(i.children,t,r),t.parent=i,M(t.waypoints,function(a){a.x+=n.x,a.y+=n.y,a.original&&(a.original.x+=n.x,a.original.y+=n.y)}),t};Nc.prototype.revert=function(e){var t=e.connection,n=t.parent,i=e.oldParent,r=e.oldParentIndex,o=e.delta;return Xe(n.children,t),Je(i.children,t,r),t.parent=i,M(t.waypoints,function(a){a.x-=o.x,a.y-=o.y,a.original&&(a.original.x-=o.x,a.original.y-=o.y)}),t};function Oc(){this.allShapes={},this.allConnections={},this.enclosedElements={},this.enclosedConnections={},this.topLevel={}}Oc.prototype.add=function(e,t){return this.addAll([e],t)};Oc.prototype.addAll=function(e,t){var n=ug(e,!!t,this);return L(this,n),this};function Gr(e){this._modeling=e}Gr.prototype.moveRecursive=function(e,t,n){return e?this.moveClosure(this.getClosure(e),t,n):[]};Gr.prototype.moveClosure=function(e,t,n,i,r){var o=this._modeling,a=e.allShapes,l=e.allConnections,s=e.enclosedConnections,c=e.topLevel,p=!1;r&&r.parent===n&&(p=!0),M(a,function(u){o.moveShape(u,t,c[u.id]&&!p&&n,{recurse:!1,layout:!1})}),M(l,function(u){var d=!!a[u.source.id],f=!!a[u.target.id];s[u.id]&&d&&f?o.moveConnection(u,t,c[u.id]&&!p&&n):o.layoutConnection(u,{connectionStart:d&&ac(u,u.source,t),connectionEnd:f&&sc(u,u.target,t)})})};Gr.prototype.getClosure=function(e){return new Oc().addAll(e,!0)};function Ha(e){this._helper=new Gr(e)}Ha.$inject=["modeling"];Ha.prototype.preExecute=function(e){e.closure=this._helper.getClosure(e.shapes)};Ha.prototype.postExecute=function(e){var t=e.hints,n;t&&t.primaryShape&&(n=t.primaryShape,t.oldParent=n.parent),this._helper.moveClosure(e.closure,e.delta,e.newParent,e.newHost,n)};function Ti(e){this._modeling=e,this._helper=new Gr(e)}Ti.$inject=["modeling"];Ti.prototype.execute=function(e){var t=e.shape,n=e.delta,i=e.newParent||t.parent,r=e.newParentIndex,o=t.parent;return e.oldBounds=nn(t,["x","y","width","height"]),e.oldParent=o,e.oldParentIndex=Xe(o.children,t),Je(i.children,t,r),L(t,{parent:i,x:t.x+n.x,y:t.y+n.y}),t};Ti.prototype.postExecute=function(e){var t=e.shape,n=e.delta,i=e.hints,r=this._modeling;i.layout!==!1&&(M(t.incoming,function(o){r.layoutConnection(o,{connectionEnd:sc(o,t,n)})}),M(t.outgoing,function(o){r.layoutConnection(o,{connectionStart:ac(o,t,n)})})),i.recurse!==!1&&this.moveChildren(e)};Ti.prototype.revert=function(e){var t=e.shape,n=e.oldParent,i=e.oldParentIndex,r=e.delta;return Je(n.children,t,i),L(t,{parent:n,x:t.x-r.x,y:t.y-r.y}),t};Ti.prototype.moveChildren=function(e){var t=e.delta,n=e.shape;this._helper.moveRecursive(n.children,t,null)};Ti.prototype.getNewParent=function(e){return e.newParent||e.shape.parent};function Wr(e){this._modeling=e}Wr.$inject=["modeling"];Wr.prototype.execute=function(e){var t=e.newSource,n=e.newTarget,i=e.connection,r=e.dockingOrPoints;if(!t&&!n)throw new Error("newSource or newTarget required");return Te(r)&&(e.oldWaypoints=i.waypoints,i.waypoints=r),t&&(e.oldSource=i.source,i.source=t),n&&(e.oldTarget=i.target,i.target=n),i};Wr.prototype.postExecute=function(e){var t=e.connection,n=e.newSource,i=e.newTarget,r=e.dockingOrPoints,o=e.hints||{},a={};o.connectionStart&&(a.connectionStart=o.connectionStart),o.connectionEnd&&(a.connectionEnd=o.connectionEnd),o.layoutConnection!==!1&&(n&&(!i||o.docking==="source")&&(a.connectionStart=a.connectionStart||Hp(Te(r)?r[0]:r)),i&&(!n||o.docking==="target")&&(a.connectionEnd=a.connectionEnd||Hp(Te(r)?r[r.length-1]:r)),o.newWaypoints&&(a.waypoints=o.newWaypoints),this._modeling.layoutConnection(t,a))};Wr.prototype.revert=function(e){var t=e.oldSource,n=e.oldTarget,i=e.oldWaypoints,r=e.connection;return t&&(r.source=t),n&&(r.target=n),i&&(r.waypoints=i),r};function Hp(e){return e.original||e}function Tn(e,t){this._modeling=e,this._rules=t}Tn.$inject=["modeling","rules"];Tn.prototype.preExecute=function(e){var t=this,n=this._modeling,i=this._rules,r=e.oldShape,o=e.newData,a=e.hints||{},l;function s(h,m,v){return i.allowed("connection.reconnect",{connection:v,source:h,target:m})}var c={x:o.x,y:o.y},p={x:r.x,y:r.y,width:r.width,height:r.height};l=e.newShape=e.newShape||t.createShape(o,c,r.parent,a),r.host&&n.updateAttachment(l,r.host);var u;a.moveChildren!==!1&&(u=r.children.slice(),n.moveElements(u,{x:0,y:0},l,a));var d=r.incoming.slice(),f=r.outgoing.slice();M(d,function(h){var m=h.source,v=s(m,l,h);v&&t.reconnectEnd(h,l,Da(h,l,p),a)}),M(f,function(h){var m=h.target,v=s(l,m,h);v&&t.reconnectStart(h,l,Ra(h,l,p),a)})};Tn.prototype.postExecute=function(e){var t=e.oldShape;this._modeling.removeShape(t)};Tn.prototype.execute=function(e){};Tn.prototype.revert=function(e){};Tn.prototype.createShape=function(e,t,n,i){return this._modeling.createShape(e,t,n,i)};Tn.prototype.reconnectStart=function(e,t,n,i){this._modeling.reconnectStart(e,t,n,i)};Tn.prototype.reconnectEnd=function(e,t,n,i){this._modeling.reconnectEnd(e,t,n,i)};function Yr(e){this._modeling=e}Yr.$inject=["modeling"];Yr.prototype.execute=function(e){var t=e.shape,n=e.newBounds,i=e.minBounds;if(n.x===void 0||n.y===void 0||n.width===void 0||n.height===void 0)throw new Error("newBounds must have {x, y, width, height} properties");if(i&&(n.width<i.width||n.height<i.height))throw new Error("width and height cannot be less than minimum height and width");if(!i&&n.width<10||n.height<10)throw new Error("width and height cannot be less than 10px");return e.oldBounds={width:t.width,height:t.height,x:t.x,y:t.y},L(t,{width:n.width,height:n.height,x:n.x,y:n.y}),t};Yr.prototype.postExecute=function(e){var t=this._modeling,n=e.shape,i=e.oldBounds,r=e.hints||{};r.layout!==!1&&(M(n.incoming,function(o){t.layoutConnection(o,{connectionEnd:Da(o,n,i)})}),M(n.outgoing,function(o){t.layoutConnection(o,{connectionStart:Ra(o,n,i)})}))};Yr.prototype.revert=function(e){var t=e.shape,n=e.oldBounds;return L(t,{width:n.width,height:n.height,x:n.x,y:n.y}),t};function Jn(e){this._modeling=e}Jn.$inject=["modeling"];Jn.prototype.preExecute=function(e){var t=e.delta,n=e.direction,i=e.movingShapes,r=e.resizingShapes,o=e.start,a={};this.moveShapes(i,t),M(r,function(l){a[l.id]=xw(l)}),this.resizeShapes(r,t,n),this.updateConnectionWaypoints(Kx(i,r),t,n,o,i,r,a)};Jn.prototype.execute=function(){};Jn.prototype.revert=function(){};Jn.prototype.moveShapes=function(e,t){var n=this;M(e,function(i){n._modeling.moveShape(i,t,null,{autoResize:!1,layout:!1,recurse:!1})})};Jn.prototype.resizeShapes=function(e,t,n){var i=this;M(e,function(r){var o=Xx(r,n,t);i._modeling.resizeShape(r,o,null,{attachSupport:!1,autoResize:!1,layout:!1})})};Jn.prototype.updateConnectionWaypoints=function(e,t,n,i,r,o,a){var l=this,s=r.concat(o);M(e,function(c){var p=c.source,u=c.target,d=Ew(c),f=am(n),h={};Ln(s,p)&&Ln(s,u)?(d=bt(d,function(m){return Up(m,i,n)&&(m[f]=m[f]+t[f]),m.original&&Up(m.original,i,n)&&(m.original[f]=m.original[f]+t[f]),m}),l._modeling.updateWaypoints(c,d,{labelBehavior:!1})):(Ln(s,p)||Ln(s,u))&&(Ln(r,p)?h.connectionStart=ac(c,p,t):Ln(r,u)?h.connectionEnd=sc(c,u,t):Ln(o,p)?h.connectionStart=Ra(c,p,a[p.id]):Ln(o,u)&&(h.connectionEnd=Da(c,u,a[u.id])),l._modeling.layoutConnection(c,h))})};function zp(e){return L({},e)}function Ew(e){return bt(e.waypoints,function(t){return t=zp(t),t.original&&(t.original=zp(t.original)),t})}function am(e){switch(e){case"n":return"y";case"w":return"x";case"s":return"y";case"e":return"x"}}function Up(e,t,n){var i=am(n);if(/e|s/.test(n))return e[i]>t;if(/n|w/.test(n))return e[i]<t}function Ln(e,t){return e.indexOf(t)!==-1}function xw(e){return{x:e.x,y:e.y,height:e.height,width:e.width}}function za(e){this._modeling=e}za.$inject=["modeling"];za.prototype.execute=function(e){var t=e.shape,n=t.children;e.oldChildrenVisibility=sm(n),t.collapsed=!t.collapsed;var i=lm(n,t.collapsed);return[t].concat(i)};za.prototype.revert=function(e){var t=e.shape,n=e.oldChildrenVisibility,i=t.children,r=cm(i,n);return t.collapsed=!t.collapsed,[t].concat(r)};function sm(e){var t={};return M(e,function(n){t[n.id]=n.hidden,n.children&&(t=L({},t,sm(n.children)))}),t}function lm(e,t){var n=[];return M(e,function(i){i.hidden=t,n=n.concat(i),i.children&&(n=n.concat(lm(i.children,i.collapsed||t)))}),n}function cm(e,t){var n=[];return M(e,function(i){i.hidden=t[i.id],n=n.concat(i),i.children&&(n=n.concat(cm(i.children,t)))}),n}function Ua(e){this._modeling=e}Ua.$inject=["modeling"];Ua.prototype.execute=function(e){var t=e.shape,n=e.newHost,i=t.host;return e.oldHost=i,e.attacherIdx=um(i,t),pm(n,t),t.host=n,t};Ua.prototype.revert=function(e){var t=e.shape,n=e.newHost,i=e.oldHost,r=e.attacherIdx;return t.host=i,um(n,t),pm(i,t,r),t};function um(e,t){return Xe(e&&e.attachers,t)}function pm(e,t,n){if(e){var i=e.attachers;i||(e.attachers=i=[]),Je(i,t,n)}}function Lc(){}Lc.prototype.execute=function(e){var t=e.connection,n=e.newWaypoints;return e.oldWaypoints=t.waypoints,t.waypoints=n,t};Lc.prototype.revert=function(e){var t=e.connection,n=e.oldWaypoints;return t.waypoints=n,t};function Re(e,t,n){this._eventBus=e,this._elementFactory=t,this._commandStack=n;var i=this;e.on("diagram.init",function(){i.registerHandlers(n)})}Re.$inject=["eventBus","elementFactory","commandStack"];Re.prototype.getHandlers=function(){return{"shape.append":Ba,"shape.create":Qn,"shape.delete":Ur,"shape.move":Ti,"shape.resize":Yr,"shape.replace":Tn,"shape.toggleCollapse":za,spaceTool:Jn,"label.create":Hr,"connection.create":ja,"connection.delete":zr,"connection.move":Nc,"connection.layout":Fa,"connection.updateWaypoints":Lc,"connection.reconnect":Wr,"elements.create":Mc,"elements.move":Ha,"elements.delete":Ic,"elements.distribute":Va,"elements.align":$a,"element.updateAttachment":Ua}};Re.prototype.registerHandlers=function(e){M(this.getHandlers(),function(t,n){e.registerHandler(n,t)})};Re.prototype.moveShape=function(e,t,n,i,r){typeof i=="object"&&(r=i,i=null);var o={shape:e,delta:t,newParent:n,newParentIndex:i,hints:r||{}};this._commandStack.execute("shape.move",o)};Re.prototype.updateAttachment=function(e,t){var n={shape:e,newHost:t};this._commandStack.execute("element.updateAttachment",n)};Re.prototype.moveElements=function(e,t,n,i){i=i||{};var r=i.attach,o=n,a;r===!0?(a=n,o=n.parent):r===!1&&(a=null);var l={shapes:e,delta:t,newParent:o,newHost:a,hints:i};this._commandStack.execute("elements.move",l)};Re.prototype.moveConnection=function(e,t,n,i,r){typeof i=="object"&&(r=i,i=void 0);var o={connection:e,delta:t,newParent:n,newParentIndex:i,hints:r||{}};this._commandStack.execute("connection.move",o)};Re.prototype.layoutConnection=function(e,t){var n={connection:e,hints:t||{}};this._commandStack.execute("connection.layout",n)};Re.prototype.createConnection=function(e,t,n,i,r,o){typeof n=="object"&&(o=r,r=i,i=n,n=void 0),i=this._create("connection",i);var a={source:e,target:t,parent:r,parentIndex:n,connection:i,hints:o};return this._commandStack.execute("connection.create",a),a.connection};Re.prototype.createShape=function(e,t,n,i,r){typeof i!="number"&&(r=i,i=void 0),r=r||{};var o=r.attach,a,l;e=this._create("shape",e),o?(a=n.parent,l=n):a=n;var s={position:t,shape:e,parent:a,parentIndex:i,host:l,hints:r};return this._commandStack.execute("shape.create",s),s.shape};Re.prototype.createElements=function(e,t,n,i,r){Te(e)||(e=[e]),typeof i!="number"&&(r=i,i=void 0),r=r||{};var o={position:t,elements:e,parent:n,parentIndex:i,hints:r};return this._commandStack.execute("elements.create",o),o.elements};Re.prototype.createLabel=function(e,t,n,i){n=this._create("label",n);var r={labelTarget:e,position:t,parent:i||e.parent,shape:n};return this._commandStack.execute("label.create",r),r.shape};Re.prototype.appendShape=function(e,t,n,i,r){r=r||{},t=this._create("shape",t);var o={source:e,position:n,target:i,shape:t,connection:r.connection,connectionParent:r.connectionParent,hints:r};return this._commandStack.execute("shape.append",o),o.shape};Re.prototype.removeElements=function(e){var t={elements:e};this._commandStack.execute("elements.delete",t)};Re.prototype.distributeElements=function(e,t,n){var i={groups:e,axis:t,dimension:n};this._commandStack.execute("elements.distribute",i)};Re.prototype.removeShape=function(e,t){var n={shape:e,hints:t||{}};this._commandStack.execute("shape.delete",n)};Re.prototype.removeConnection=function(e,t){var n={connection:e,hints:t||{}};this._commandStack.execute("connection.delete",n)};Re.prototype.replaceShape=function(e,t,n){var i={oldShape:e,newData:t,hints:n||{}};return this._commandStack.execute("shape.replace",i),i.newShape};Re.prototype.alignElements=function(e,t){var n={elements:e,alignment:t};this._commandStack.execute("elements.align",n)};Re.prototype.resizeShape=function(e,t,n,i){var r={shape:e,newBounds:t,minBounds:n,hints:i};this._commandStack.execute("shape.resize",r)};Re.prototype.createSpace=function(e,t,n,i,r){var o={delta:n,direction:i,movingShapes:e,resizingShapes:t,start:r};this._commandStack.execute("spaceTool",o)};Re.prototype.updateWaypoints=function(e,t,n){var i={connection:e,newWaypoints:t,hints:n||{}};this._commandStack.execute("connection.updateWaypoints",i)};Re.prototype.reconnect=function(e,t,n,i,r){var o={connection:e,newSource:t,newTarget:n,dockingOrPoints:i,hints:r||{}};this._commandStack.execute("connection.reconnect",o)};Re.prototype.reconnectStart=function(e,t,n,i){i||(i={}),this.reconnect(e,t,e.target,n,L(i,{docking:"source"}))};Re.prototype.reconnectEnd=function(e,t,n,i){i||(i={}),this.reconnect(e,e.source,t,n,L(i,{docking:"target"}))};Re.prototype.connect=function(e,t,n,i){return this.createConnection(e,t,n||{},e.parent,i)};Re.prototype._create=function(e,t){return pg(t)?t:this._elementFactory.create(e,t)};Re.prototype.toggleCollapse=function(e,t){var n={shape:e,hints:t||{}};this._commandStack.execute("shape.toggleCollapse",n)};function qr(e){this._elementRegistry=e}qr.$inject=["elementRegistry"];qr.prototype.execute=function(e){var t=e.element,n=e.moddleElement,i=e.properties;if(!n)throw new Error("<moddleElement> required");var r=e.changed||this._getVisualReferences(n).concat(t),o=e.oldProperties||ww(n,$s(i));return dm(n,i),e.oldProperties=o,e.changed=r,r};qr.prototype.revert=function(e){var t=e.oldProperties,n=e.moddleElement,i=e.changed;return dm(n,t),i};qr.prototype._getVisualReferences=function(e){var t=this._elementRegistry;return y(e,"bpmn:DataObject")?Sw(e,t):[]};function ww(e,t){return Yn(t,function(n,i){return n[i]=e.get(i),n},{})}function dm(e,t){M(t,function(n,i){e.set(i,n)})}function Sw(e,t){return t.filter(function(n){return y(n,"bpmn:DataObjectReference")&&Q(n).dataObjectRef===e})}var vr="default",fn="id",fm="di",Cw={width:0,height:0};function Kr(e,t,n,i,r){this._elementRegistry=e,this._moddle=t,this._translate=n,this._modeling=i,this._textRenderer=r}Kr.$inject=["elementRegistry","moddle","translate","modeling","textRenderer"];Kr.prototype.execute=function(e){var t=e.element,n=[t],i=this._translate;if(!t)throw new Error(i("element required"));var r=this._elementRegistry,o=this._moddle.ids,a=t.businessObject,l=kw(e.properties),s=e.oldProperties||Tw(t,l);return hm(l,a)&&(o.unclaim(a[fn]),r.updateId(t,l[fn]),o.claim(l[fn],a)),vr in l&&(l[vr]&&n.push(r.get(l[vr].id)),a[vr]&&n.push(r.get(a[vr].id))),mm(t,l),e.oldProperties=s,e.changed=n,n};Kr.prototype.postExecute=function(e){var t=e.element,n=t.label,i=n&&Q(n).name;if(i){var r=this._textRenderer.getExternalLabelBounds(n,i);this._modeling.resizeShape(n,r,Cw)}};Kr.prototype.revert=function(e){var t=e.element,n=e.properties,i=e.oldProperties,r=t.businessObject,o=this._elementRegistry,a=this._moddle.ids;return mm(t,i),hm(n,r)&&(a.unclaim(n[fn]),o.updateId(t,i[fn]),a.claim(i[fn],r)),e.changed};function hm(e,t){return fn in e&&e[fn]!==t[fn]}function Tw(e,t){var n=$s(t),i=e.businessObject,r=Me(e);return Yn(n,function(o,a){return a!==fm?o[a]=i.get(a):o[a]=Pw(r,$s(t.di)),o},{})}function Pw(e,t){return Yn(t,function(n,i){return n[i]=e&&e.get(i),n},{})}function mm(e,t){var n=e.businessObject,i=Me(e);M(t,function(r,o){o!==fm?n.set(o,r):i&&Rw(i,r)})}function Rw(e,t){M(t,function(n,i){e.set(i,n)})}var Dw=["default"];function kw(e){var t=L({},e);return Dw.forEach(function(n){n in e&&(t[n]=Q(t[n]))}),t}function Ga(e,t){this._canvas=e,this._modeling=t}Ga.$inject=["canvas","modeling"];Ga.prototype.execute=function(e){var t=this._canvas,n=e.newRoot,i=n.businessObject,r=t.getRootElement(),o=r.businessObject,a=o.$parent,l=Me(r);return t.setRootElement(n),t.removeRootElement(r),Je(a.rootElements,i),i.$parent=a,Xe(a.rootElements,o),o.$parent=null,r.di=null,l.bpmnElement=i,n.di=l,e.oldRoot=r,[]};Ga.prototype.revert=function(e){var t=this._canvas,n=e.newRoot,i=n.businessObject,r=e.oldRoot,o=r.businessObject,a=i.$parent,l=Me(n);return t.setRootElement(r),t.removeRootElement(n),Xe(a.rootElements,i),i.$parent=null,Je(a.rootElements,o),o.$parent=a,n.di=null,l.bpmnElement=o,r.di=l,[]};function $c(e,t){this._modeling=e,this._spaceTool=t}$c.$inject=["modeling","spaceTool"];$c.prototype.preExecute=function(e){var t=this._spaceTool,n=this._modeling,i=e.shape,r=e.location,o=Mt(i),a=o===i,l=a?i:i.parent,s=Kn(l);s.length||n.createShape({type:"bpmn:Lane"},{x:i.x+Vi,y:i.y,width:i.width-Vi,height:i.height},l);var c=[];ha(o,function(m){return c.push(m),m.label&&c.push(m.label),m===i?[]:_e(m.children,function(v){return v!==i})});var p=r==="top"?-120:120,u=r==="top"?i.y:i.y+i.height,d=u+(r==="top"?10:-10),f=r==="top"?"n":"s",h=t.calculateAdjustments(c,"y",p,d);t.makeSpace(h.movingShapes,h.resizingShapes,{x:0,y:p},f,d),e.newLane=n.createShape({type:"bpmn:Lane"},{x:i.x+(a?Vi:0),y:u-(r==="top"?120:0),width:i.width-(a?Vi:0),height:120},l)};function Bc(e,t){this._modeling=e,this._translate=t}Bc.$inject=["modeling","translate"];Bc.prototype.preExecute=function(e){var t=this._modeling,n=this._translate,i=e.shape,r=e.count,o=Kn(i),a=o.length;if(a>r)throw new Error(n("more than {count} child lanes",{count:r}));var l=Math.round(i.height/r),s,c,p,u,d;for(d=0;d<r;d++)s=i.y+d*l,d===r-1?c=i.height-l*d:c=l,p={x:i.x+Vi,y:s,width:i.width-Vi,height:c},d<a?t.resizeShape(o[d],p):(u={type:"bpmn:Lane"},t.createShape(u,p,i))};function Xr(e,t){this._modeling=e,this._spaceTool=t}Xr.$inject=["modeling","spaceTool"];Xr.prototype.preExecute=function(e){var t=e.shape,n=e.newBounds,i=e.balanced;i!==!1?this.resizeBalanced(t,n):this.resizeSpace(t,n)};Xr.prototype.resizeBalanced=function(e,t){var n=this._modeling,i=sE(e,t);n.resizeShape(e,t),i.forEach(function(r){n.resizeShape(r.shape,r.newBounds)})};Xr.prototype.resizeSpace=function(e,t){var n=this._spaceTool,i=ae(e),r=ae(t),o=mh(r,i),a=Mt(e),l=[],s=[];ha(a,function(h){return l.push(h),(y(h,"bpmn:Lane")||y(h,"bpmn:Participant"))&&s.push(h),h.children});var c,p,u,d,f;(o.bottom||o.top)&&(c=o.bottom||o.top,p=e.y+(o.bottom?e.height:0)+(o.bottom?-10:10),u=o.bottom?"s":"n",d=o.top>0||o.bottom<0?-c:c,f=n.calculateAdjustments(l,"y",d,p),n.makeSpace(f.movingShapes,f.resizingShapes,{x:0,y:c},u)),(o.left||o.right)&&(c=o.right||o.left,p=e.x+(o.right?e.width:0)+(o.right?-10:100),u=o.right?"e":"w",d=o.left>0||o.right<0?-c:c,f=n.calculateAdjustments(s,"x",d,p),n.makeSpace(f.movingShapes,f.resizingShapes,{x:c,y:0},u))};var Ar="flowNodeRef",jc="lanes";function Zr(e){this._elementRegistry=e}Zr.$inject=["elementRegistry"];Zr.prototype._computeUpdates=function(e,t){var n=[],i=[],r={},o=[];function a(p,u){var d=ae(u),f={x:p.x+p.width/2,y:p.y+p.height/2};return f.x>d.left&&f.x<d.right&&f.y>d.top&&f.y<d.bottom}function l(p){n.indexOf(p)===-1&&(o.push(p),n.push(p))}function s(p){var u=Mt(p);return r[u.id]||(r[u.id]=Ta(u)),r[u.id]}function c(p){if(!p.parent)return[];var u=s(p);return u.filter(function(d){return a(p,d)}).map(function(d){return d.businessObject})}return t.forEach(function(p){var u=Mt(p);if(!(!u||n.indexOf(u)!==-1)){var d=u.children.filter(function(f){return y(f,"bpmn:FlowNode")});d.forEach(l),n.push(u)}}),e.forEach(l),o.forEach(function(p){var u=p.businessObject,d=u.get(jc),f=d.slice(),h=c(p);i.push({flowNode:u,remove:f,add:h})}),t.forEach(function(p){var u=p.businessObject;p.parent||u.get(Ar).forEach(function(d){i.push({flowNode:d,remove:[u],add:[]})})}),i};Zr.prototype.execute=function(e){var t=e.updates;return t||(t=e.updates=this._computeUpdates(e.flowNodeShapes,e.laneShapes)),t.forEach(function(n){var i=n.flowNode,r=i.get(jc);n.remove.forEach(function(o){Xe(r,o),Xe(o.get(Ar),i)}),n.add.forEach(function(o){Je(r,o),Je(o.get(Ar),i)})}),[]};Zr.prototype.revert=function(e){var t=e.updates;return t.forEach(function(n){var i=n.flowNode,r=i.get(jc);n.add.forEach(function(o){Xe(r,o),Xe(o.get(Ar),i)}),n.remove.forEach(function(o){Je(r,o),Je(o.get(Ar),i)})}),[]};function Wa(e){this._moddle=e}Wa.$inject=["moddle"];Wa.prototype.execute=function(e){var t=this._moddle.ids,n=e.id,i=e.element,r=e.claiming;return r?t.claim(n,i):t.unclaim(n),[]};Wa.prototype.revert=function(e){var t=this._moddle.ids,n=e.id,i=e.element,r=e.claiming;return r?t.unclaim(n):t.claim(n,i),[]};var Aw={fill:void 0,stroke:void 0};function Vc(e){this._commandStack=e,this._normalizeColor=function(t){if(t){if(pa(t)){var n=Mw(t);if(n)return n}throw new Error("invalid color value: "+t)}}}Vc.$inject=["commandStack"];Vc.prototype.postExecute=function(e){var t=e.elements,n=e.colors||Aw,i=this,r={};"fill"in n&&L(r,{"background-color":this._normalizeColor(n.fill)}),"stroke"in n&&L(r,{"border-color":this._normalizeColor(n.stroke)}),M(t,function(o){var a=Ae(o)?nn(r,["border-color"]):r,l=Me(o);if(Iw(a),xe(o))i._commandStack.execute("element.updateModdleProperties",{element:o,moddleElement:l.label,properties:{color:r["border-color"]}});else{if(!ve(l,["bpmndi:BPMNEdge","bpmndi:BPMNShape"]))return;i._commandStack.execute("element.updateProperties",{element:o,properties:{di:a}})}})};function Mw(e){var t=document.createElement("canvas").getContext("2d");return t.fillStyle="transparent",t.fillStyle=e,/^#[0-9a-fA-F]{6}$/.test(t.fillStyle)?t.fillStyle:null}function Iw(e){"border-color"in e&&(e.stroke=e["border-color"]),"background-color"in e&&(e.fill=e["background-color"])}var Nw={width:0,height:0};function vm(e,t,n){function i(s,c){var p=s.label||s,u=s.labelTarget||s;return dg(p,c),[p,u]}function r(s){var c=s.element,p=c.businessObject,u=s.newLabel;if(!xe(c)&&zi(c)&&!fa(c)&&!Gp(u)){var d=7,f=of(c);f={x:f.x,y:f.y+d},e.createLabel(c,f,{id:p.id+"_label",businessObject:p,di:c.di})}}function o(s){return s.oldLabel=Hn(s.element),i(s.element,s.newLabel)}function a(s){return i(s.element,s.oldLabel)}function l(s){var c=s.element,p=c.label||c,u=s.newLabel,d=s.newBounds,f=s.hints||{};if(!(!xe(p)&&!y(p,"bpmn:TextAnnotation"))){if(xe(p)&&Gp(u)){f.removeShape!==!1&&e.removeShape(p,{unsetLabel:!1});return}var h=Hn(c);typeof d>"u"&&(d=t.getExternalLabelBounds(p,h)),d&&e.resizeShape(p,d,Nw)}}this.preExecute=r,this.execute=o,this.revert=a,this.postExecute=l}vm.$inject=["modeling","textRenderer","bpmnFactory"];function Gp(e){return!e||!e.trim()}function dt(e,t,n,i){Re.call(this,e,t,n),this._bpmnRules=i}te(dt,Re);dt.$inject=["eventBus","elementFactory","commandStack","bpmnRules"];dt.prototype.getHandlers=function(){var e=Re.prototype.getHandlers.call(this);return e["element.updateModdleProperties"]=qr,e["element.updateProperties"]=Kr,e["canvas.updateRoot"]=Ga,e["lane.add"]=$c,e["lane.resize"]=Xr,e["lane.split"]=Bc,e["lane.updateRefs"]=Zr,e["id.updateClaim"]=Wa,e["element.setColor"]=Vc,e["element.updateLabel"]=vm,e};dt.prototype.updateLabel=function(e,t,n,i){this._commandStack.execute("element.updateLabel",{element:e,newLabel:t,newBounds:n,hints:i||{}})};dt.prototype.connect=function(e,t,n,i){var r=this._bpmnRules;if(n||(n=r.canConnect(e,t)),!!n)return this.createConnection(e,t,n,e.parent,i)};dt.prototype.updateModdleProperties=function(e,t,n){this._commandStack.execute("element.updateModdleProperties",{element:e,moddleElement:t,properties:n})};dt.prototype.updateProperties=function(e,t){this._commandStack.execute("element.updateProperties",{element:e,properties:t})};dt.prototype.resizeLane=function(e,t,n){this._commandStack.execute("lane.resize",{shape:e,newBounds:t,balanced:n})};dt.prototype.addLane=function(e,t){var n={shape:e,location:t};return this._commandStack.execute("lane.add",n),n.newLane};dt.prototype.splitLane=function(e,t){this._commandStack.execute("lane.split",{shape:e,count:t})};dt.prototype.makeCollaboration=function(){var e=this._create("root",{type:"bpmn:Collaboration"}),t={newRoot:e};return this._commandStack.execute("canvas.updateRoot",t),e};dt.prototype.makeProcess=function(){var e=this._create("root",{type:"bpmn:Process"}),t={newRoot:e};this._commandStack.execute("canvas.updateRoot",t)};dt.prototype.updateLaneRefs=function(e,t){this._commandStack.execute("lane.updateRefs",{flowNodeShapes:e,laneShapes:t})};dt.prototype.claimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t,claiming:!0})};dt.prototype.unclaimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t})};dt.prototype.setColor=function(e,t){e.length||(e=[e]),this._commandStack.execute("element.setColor",{elements:e,colors:t})};function gm(){}gm.prototype.layoutConnection=function(e,t){return t=t||{},[t.connectionStart||de(t.source||e.source),t.connectionEnd||de(t.target||e.target)]};var ko=20,Ow=5,oa=Math.round,Wp=20,Lw={"h:h":20,"v:v":20,"h:v":-10,"v:h":-10};function $w(e,t){return!{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/./,v:/./}[t].test(e)}function Bw(e,t){return{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/left|right/,v:/top|bottom/}[e].test(t)}function ym(e,t,n){var i=pt(t,e,Ow),r=n.split(":")[0],o=oa((t.x-e.x)/2+e.x),a=oa((t.y-e.y)/2+e.y),l,s,c=Bw(r,i),p=/h|r|l/.test(r),u=!1,d=!1;return c?(l=p?{x:o,y:e.y}:{x:e.x,y:a},s=p?"h:h":"v:v"):(u=$w(i,r),s=p?"h:v":"v:h",u?p?(d=a===e.y,l={x:e.x+ko*(/l/.test(r)?-1:1),y:d?a+ko:a}):(d=o===e.x,l={x:d?o+ko:o,y:e.y+ko*(/t/.test(r)?-1:1)}):l={x:o,y:a}),{waypoints:Fc(e,l,s).concat(l),directions:s,turnNextDirections:d}}function jw(e,t,n){return ym(e,t,n)}function Vw(e,t,n){var i=ym(t,e,Yp(n));return{waypoints:i.waypoints.slice().reverse(),directions:Yp(i.directions),turnNextDirections:i.turnNextDirections}}function Fw(e,t){var n=e.directions.split(":")[1],i=t.directions.split(":")[0];e.turnNextDirections&&(n=n=="h"?"v":"h"),t.turnNextDirections&&(i=i=="h"?"v":"h");var r=n+":"+i,o=Fc(e.waypoints[e.waypoints.length-1],t.waypoints[0],r);return{waypoints:o,directions:r}}function Yp(e){return e.split(":").reverse().join(":")}function Hw(e,t,n){var i=oa((t.x-e.x)/2+e.x),r=oa((t.y-e.y)/2+e.y);if(n==="h:v")return[{x:t.x,y:e.y}];if(n==="v:h")return[{x:e.x,y:t.y}];if(n==="h:h")return[{x:i,y:e.y},{x:i,y:t.y}];if(n==="v:v")return[{x:e.x,y:r},{x:t.x,y:r}];throw new Error("invalid directions: can only handle varians of [hv]:[hv]")}function Fc(e,t,n){if(n=n||"h:h",!Zw(n))throw new Error("unknown directions: <"+n+">: must be specified as <start>:<end> with start/end in { h,v,t,r,b,l }");if(_m(n)){var i=jw(e,t,n),r=Vw(e,t,n),o=Fw(i,r);return[].concat(i.waypoints,o.waypoints,r.waypoints)}return Hw(e,t,n)}function zw(e,t,n){var i=Fc(e,t,n);return i.unshift(e),i.push(t),bm(i)}function Uw(e,t,n,i,r){var o=r&&r.preferredLayouts||[],a=fg(o,"straight")[0]||"h:h",l=Lw[a]||0,s=pt(e,t,l),c=Xw(s,a);n=n||de(e),i=i||de(t);var p=c.split(":"),u=Kp(n,e,p[0],Qw(s)),d=Kp(i,t,p[1],s);return zw(u,d,c)}function Gw(e,t,n,i,r,o){Te(n)&&(r=n,o=i,n=de(e),i=de(t)),o=L({preferredLayouts:[]},o),r=r||[];var a=o.preferredLayouts,l=a.indexOf("straight")!==-1,s;return s=l&&Yw(e,t,n,i,o),s||(s=o.connectionEnd&&Kw(t,e,i,r),s)||(s=o.connectionStart&&qw(e,t,n,r),s)?s:!o.connectionStart&&!o.connectionEnd&&r&&r.length?r:Uw(e,t,n,i,o)}function Ww(e,t,n){return e>=t&&e<=n}function qp(e,t,n){var i={x:"width",y:"height"};return Ww(t[e],n[e],n[e]+n[i[e]])}function Yw(e,t,n,i,r){var o={},a,l;return l=pt(e,t),/^(top|bottom|left|right)$/.test(l)?(/top|bottom/.test(l)&&(a="x"),/left|right/.test(l)&&(a="y"),r.preserveDocking==="target"?qp(a,i,e)?(o[a]=i[a],[{x:o.x!==void 0?o.x:n.x,y:o.y!==void 0?o.y:n.y,original:{x:o.x!==void 0?o.x:n.x,y:o.y!==void 0?o.y:n.y}},{x:i.x,y:i.y}]):null:qp(a,n,t)?(o[a]=n[a],[{x:n.x,y:n.y},{x:o.x!==void 0?o.x:i.x,y:o.y!==void 0?o.y:i.y,original:{x:o.x!==void 0?o.x:i.x,y:o.y!==void 0?o.y:i.y}}]):null):null}function qw(e,t,n,i){return Hc(e,t,n,i)}function Kw(e,t,n,i){var r=i.slice().reverse();return r=Hc(e,t,n,r),r?r.reverse():null}function Hc(e,t,n,i){function r(p){return p.length<3?!0:p.length>4?!1:!!Oe(p,function(u,d){var f=p[d-1];return f&&Xd(u,f)<3})}function o(p,u,d){var f=pn(u,p);switch(f){case"v":return{x:d.x,y:p.y};case"h":return{x:p.x,y:d.y}}return{x:p.x,y:p.y}}function a(p,u,d){var f;for(f=p.length-2;f!==0;f--)if(pu(p[f],u,Wp)||pu(p[f],d,Wp))return p.slice(f);return p}if(r(i))return null;var l=i[0],s=i.slice(),c;return s[0]=n,s[1]=o(s[1],l,n),c=a(s,e,t),c!==s&&(s=Hc(e,t,n,c)),s&&pn(s)?null:s}function Xw(e,t){if(_m(t))return t;switch(e){case"intersect":return"t:t";case"top":case"bottom":return"v:v";case"left":case"right":return"h:h";default:return t}}function Zw(e){return e&&/^h|v|t|r|b|l:h|v|t|r|b|l$/.test(e)}function _m(e){return e&&/t|r|b|l/.test(e)}function Qw(e){return{top:"bottom",bottom:"top",left:"right",right:"left","top-left":"bottom-right","bottom-right":"top-left","top-right":"bottom-left","bottom-left":"top-right"}[e]}function Kp(e,t,n,i){if(n==="h"&&(n=/left/.test(i)?"l":"r"),n==="v"&&(n=/top/.test(i)?"t":"b"),n==="t")return{original:e,x:e.x,y:t.y};if(n==="r")return{original:e,x:t.x+t.width,y:e.y};if(n==="b")return{original:e,x:e.x,y:t.y+t.height};if(n==="l")return{original:e,x:t.x,y:e.y};throw new Error("unexpected dockingDirection: <"+n+">")}function bm(e){return e.reduce(function(t,n,i){var r=t[t.length-1],o=e[i+1];return Zd(r,o,n,0)||t.push(n),t},[])}var Jw=-10,e0=40,zc={top:"bottom","top-right":"bottom-left","top-left":"bottom-right",right:"left",bottom:"top","bottom-right":"top-left","bottom-left":"top-right",left:"right"},Uo={top:"t",right:"r",bottom:"b",left:"l"};function Uc(){}te(Uc,gm);Uc.prototype.layoutConnection=function(e,t){t||(t={});var n=t.source||e.source,i=t.target||e.target,r=t.waypoints||e.waypoints,o=t.connectionStart,a=t.connectionEnd,l,s;return o||(o=Xp(r&&r[0],n)),a||(a=Xp(r&&r[r.length-1],i)),(y(e,"bpmn:Association")||y(e,"bpmn:DataAssociation"))&&r&&!Zp(n,i)?[].concat([o],r.slice(1,-1),[a]):(y(e,"bpmn:MessageFlow")?l=n0(n,i):(y(e,"bpmn:SequenceFlow")||Zp(n,i))&&(n===i?l={preferredLayouts:u0(n,e)}:y(n,"bpmn:BoundaryEvent")?l={preferredLayouts:p0(n,i,a)}:Mr(n)||Mr(i)?l=r0(n):y(n,"bpmn:Gateway")?l={preferredLayouts:["v:h"]}:y(i,"bpmn:Gateway")?l={preferredLayouts:["h:v"]}:l={preferredLayouts:["h:h"]}),l&&(l=L(l,t),s=bm(Gw(n,i,o,a,r,l))),s||[o,a])};function t0(e){var t=e.host;return pt(de(e),t,Jw)}function n0(e,t){return{preferredLayouts:["straight","v:v"],preserveDocking:i0(e,t)}}function i0(e,t){return y(t,"bpmn:Participant")?"source":y(e,"bpmn:Participant")?"target":Mr(t)?"source":Mr(e)||y(t,"bpmn:Event")?"target":y(e,"bpmn:Event")?"source":null}function r0(e){return{preferredLayouts:["straight","h:h"],preserveDocking:o0(e)}}function o0(e){return Mr(e)?"target":"source"}function Xp(e,t){return e?e.original||e:de(t)}function Zp(e,t){return y(t,"bpmn:Activity")&&y(e,"bpmn:BoundaryEvent")&&t.businessObject.isForCompensation}function Mr(e){return y(e,"bpmn:SubProcess")&&Se(e)}function br(e,t){return e===t}function a0(e,t){return t.indexOf(e)!==-1}function Er(e){var t=/right|left/.exec(e);return t&&t[0]}function mi(e){var t=/top|bottom/.exec(e);return t&&t[0]}function s0(e,t){return zc[e]===t}function l0(e,t){var n=Er(e),i=zc[n];return t.indexOf(i)!==-1}function c0(e,t){var n=mi(e),i=zc[n];return t.indexOf(i)!==-1}function rl(e){return e==="right"||e==="left"}function u0(e,t){var n=t.waypoints,i=n&&n.length&&pt(n[0],e);return i==="top"?["t:r"]:i==="right"?["r:b"]:i==="left"?["l:t"]:["b:l"]}function p0(e,t,n){var i=de(e),r=de(t),o=t0(e),a,l,s=br(e.host,t),c=a0(o,["top","right","bottom","left"]),p=pt(r,i,{x:e.width/2+t.width/2,y:e.height/2+t.height/2});return s?d0(o,c,e,t,n):(a=f0(o,p,c),l=h0(o,p,c),[a+":"+l])}function d0(e,t,n,i,r){var o=t?e:mi(e),a=Uo[o],l;return t?rl(e)?l=Qp("y",n,i,r)?"h":"b":l=Qp("x",n,i,r)?"v":"l":l="v",[a+":"+l]}function Qp(e,t,n,i){var r=e0;return!(Ss(e,i,n,r)||Ss(e,i,{x:n.x+n.width,y:n.y+n.height},r)||Ss(e,i,de(t),r))}function Ss(e,t,n,i){return Math.abs(t[e]-n[e])<i}function f0(e,t,n){return n?Uo[e]:br(mi(e),mi(t))||s0(Er(e),Er(t))?Uo[mi(e)]:Uo[Er(e)]}function h0(e,t,n){return n?rl(e)?l0(e,t)||br(e,t)?"h":"v":c0(e,t)||br(e,t)?"v":"h":rl(t)||br(mi(e),mi(t))&&Er(t)?"h":"v"}function Jp(e){return L({original:e.point.original||e.point},e.actual)}function ei(e,t){this._elementRegistry=e,this._graphicsFactory=t}ei.$inject=["elementRegistry","graphicsFactory"];ei.prototype.getCroppedWaypoints=function(e,t,n){t=t||e.source,n=n||e.target;var i=this.getDockingPoint(e,t,!0),r=this.getDockingPoint(e,n),o=e.waypoints.slice(i.idx+1,r.idx);return o.unshift(Jp(i)),o.push(Jp(r)),o};ei.prototype.getDockingPoint=function(e,t,n){var i=e.waypoints,r,o,a;return r=n?0:i.length-1,o=i[r],a=this._getIntersection(t,e,n),{point:o,actual:a||o,idx:r}};ei.prototype._getIntersection=function(e,t,n){var i=this._getShapePath(e),r=this._getConnectionPath(t);return Ls(i,r,n)};ei.prototype._getConnectionPath=function(e){return this._graphicsFactory.getConnectionPath(e)};ei.prototype._getShapePath=function(e){return this._graphicsFactory.getShapePath(e)};ei.prototype._getGfx=function(e){return this._elementRegistry.getGraphics(e)};const Em={__init__:["modeling","bpmnUpdater"],__depends__:[cx,Px,Dx,kx,nm,rw,aw,dw,En,af,om],bpmnFactory:["type",jt],bpmnUpdater:["type",Pt],elementFactory:["type",Zn],modeling:["type",dt],layouter:["type",Uc],connectionDocking:["type",ei]},ed=Math.round;function Ya(e,t,n,i,r,o){this._complexPreview=e,this._connectionDocking=t,this._elementFactory=n,this._eventBus=i,this._layouter=r,this._rules=o}Ya.prototype.create=function(e,t,n){const i=this._complexPreview,r=this._connectionDocking,o=this._elementFactory,a=this._eventBus,l=this._layouter,s=this._rules,c=o.createShape(L({type:t},n)),p=a.fire("autoPlace",{source:e,shape:c});if(!p)return;L(c,{x:p.x-ed(c.width/2),y:p.y-ed(c.height/2)});const u=s.allowed("connection.create",{source:e,target:c,hints:{targetParent:e.parent}});let d=null;u&&(d=o.createConnection(u),d.waypoints=l.layoutConnection(d,{source:e,target:c}),d.waypoints=r.getCroppedWaypoints(d,e,c)),i.create({created:[c,d].filter(f=>!Os(f))})};Ya.prototype.cleanUp=function(){this._complexPreview.cleanUp()};Ya.$inject=["complexPreview","connectionDocking","elementFactory","eventBus","layouter","rules"];const m0={__depends__:[Ll,Fb,Em],__init__:["appendPreview"],appendPreview:["type",Ya]};function xm(e,t){return(hg(e)||e).button===t}function wm(e){return xm(e,0)}function v0(e){return xm(e,1)}function g0(e){return e.flat().join(",").replace(/,?([A-z]),?/g,"$1")}function y0(e){return["M",e.x,e.y]}function Cs(e){return["L",e.x,e.y]}function _0(e,t,n){return["C",e.x,e.y,t.x,t.y,n.x,n.y]}function b0(e,t){const n=e.length,i=[y0(e[0])];for(let r=1;r<n;r++){const o=e[r-1],a=e[r],l=e[r+1];if(!l||!t){i.push(Cs(a));continue}const s=Math.min(t,ol(a.x-o.x,a.y-o.y),ol(l.x-a.x,l.y-a.y));if(!s){i.push(Cs(a));continue}const c=Ao(a,o,s),p=Ao(a,o,s*.5),u=Ao(a,l,s),d=Ao(a,l,s*.5);i.push(Cs(c)),i.push(_0(p,d,u))}return i}function Ao(e,t,n){const i=t.x-e.x,r=t.y-e.y,o=ol(i,r),a=n/o;return{x:e.x+i*a,y:e.y+r*a}}function ol(e,t){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2))}function E0(e,t,n){ye(t)&&(n=t,t=null),t||(t={});const i=be("path",t);return ye(n)&&(i.dataset.cornerRadius=String(n)),Sm(i,e)}function Sm(e,t){const n=parseInt(e.dataset.cornerRadius,10)||0;return ie(e,{d:g0(b0(t,n))}),e}function x0(e){return!0}function Mo(e){return wm(e)||v0(e)}var td=500;function Cm(e,t,n){var i=this;function r(A,I,$){if(!l(A,I)){var V,X,U;$?X=t.getGraphics($):(V=I.delegateTarget||I.target,V&&(X=V,$=t.get(X))),!(!X||!$)&&(U=e.fire(A,{element:$,gfx:X,originalEvent:I}),U===!1&&(I.stopPropagation(),I.preventDefault()))}}var o={};function a(A){return o[A]}function l(A,I){var $=c[A]||wm;return!$(I)}var s={click:"element.click",contextmenu:"element.contextmenu",dblclick:"element.dblclick",mousedown:"element.mousedown",mousemove:"element.mousemove",mouseover:"element.hover",mouseout:"element.out",mouseup:"element.mouseup"},c={"element.contextmenu":x0,"element.mousedown":Mo,"element.mouseup":Mo,"element.click":Mo,"element.dblclick":Mo};function p(A,I,$){var V=s[A];if(!V)throw new Error("unmapped DOM event name <"+A+">");return r(V,I,$)}var u="svg, .djs-element";function d(A,I,$,V){var X=o[$]=function(U){r($,U)};V&&(c[$]=V),X.$delegate=Rt.bind(A,u,I,X)}function f(A,I,$){var V=a($);V&&Rt.unbind(A,I,V.$delegate)}function h(A){M(s,function(I,$){d(A,$,I)})}function m(A){M(s,function(I,$){f(A,$,I)})}e.on("canvas.destroy",function(A){m(A.svg)}),e.on("canvas.init",function(A){h(A.svg)}),e.on(["shape.added","connection.added"],function(A){var I=A.element,$=A.gfx;e.fire("interactionEvents.createHit",{element:I,gfx:$})}),e.on(["shape.changed","connection.changed"],td,function(A){var I=A.element,$=A.gfx;e.fire("interactionEvents.updateHit",{element:I,gfx:$})}),e.on("interactionEvents.createHit",td,function(A){var I=A.element,$=A.gfx;i.createDefaultHit(I,$)}),e.on("interactionEvents.updateHit",function(A){var I=A.element,$=A.gfx;i.updateDefaultHit(I,$)});var v=R("djs-hit djs-hit-stroke"),S=R("djs-hit djs-hit-click-stroke"),b=R("djs-hit djs-hit-all"),w=R("djs-hit djs-hit-no-move"),C={all:b,"click-stroke":S,stroke:v,"no-move":w};function R(A,I){return I=L({stroke:"white",strokeWidth:15},I||{}),n.cls(A,["no-fill","no-border"],I)}function D(A,I){var $=C[I];if(!$)throw new Error("invalid hit type <"+I+">");return ie(A,$),A}function F(A,I){Ce(A,I)}this.removeHits=function(A){var I=Ns(".djs-hit",A);M(I,rt)},this.createDefaultHit=function(A,I){var $=A.waypoints,V=A.isFrame,X;return $?this.createWaypointsHit(I,$):(X=V?"stroke":"all",this.createBoxHit(I,X,{width:A.width,height:A.height}))},this.createWaypointsHit=function(A,I){var $=E0(I);return D($,"stroke"),F(A,$),$},this.createBoxHit=function(A,I,$){$=L({x:0,y:0},$);var V=be("rect");return D(V,I),ie(V,$),F(A,V),V},this.updateDefaultHit=function(A,I){var $=nt(".djs-hit",I);if($)return A.waypoints?Sm($,A.waypoints):ie($,{width:A.width,height:A.height}),$},this.fire=r,this.triggerMouseEvent=p,this.mouseHandler=a,this.registerEvent=d,this.unregisterEvent=f}Cm.$inject=["eventBus","elementRegistry","styles"];const w0={__init__:["interactionEvents"],interactionEvents:["type",Cm]};var nd=Math.min,id=Math.max;function Ts(e){e.preventDefault()}function xr(e){e.stopPropagation()}function S0(e){return e.nodeType===Node.TEXT_NODE}function C0(e){return[].slice.call(e)}function qt(e){this.container=e.container,this.parent=ot('<div class="djs-direct-editing-parent"><div class="djs-direct-editing-content" contenteditable="true"></div></div>'),this.content=nt("[contenteditable]",this.parent),this.keyHandler=e.keyHandler||function(){},this.resizeHandler=e.resizeHandler||function(){},this.autoResize=gi(this.autoResize,this),this.handlePaste=gi(this.handlePaste,this)}qt.prototype.create=function(e,t,n,i){var r=this,o=this.parent,a=this.content,l=this.container;i=this.options=i||{},t=this.style=t||{};var s=nn(t,["width","height","maxWidth","maxHeight","minWidth","minHeight","left","top","backgroundColor","position","overflow","border","wordWrap","textAlign","outline","transform"]);L(o.style,{width:e.width+"px",height:e.height+"px",maxWidth:e.maxWidth+"px",maxHeight:e.maxHeight+"px",minWidth:e.minWidth+"px",minHeight:e.minHeight+"px",left:e.x+"px",top:e.y+"px",backgroundColor:"#ffffff",position:"absolute",overflow:"visible",border:"1px solid #ccc",boxSizing:"border-box",wordWrap:"normal",textAlign:"center",outline:"none"},s);var c=nn(t,["fontFamily","fontSize","fontWeight","lineHeight","padding","paddingTop","paddingRight","paddingBottom","paddingLeft"]);return L(a.style,{boxSizing:"border-box",width:"100%",outline:"none",wordWrap:"break-word"},c),i.centerVertically&&L(a.style,{position:"absolute",top:"50%",transform:"translate(0, -50%)"},c),a.innerText=n,ce.bind(a,"keydown",this.keyHandler),ce.bind(a,"mousedown",xr),ce.bind(a,"paste",r.handlePaste),i.autoResize&&ce.bind(a,"input",this.autoResize),i.resizable&&this.resizable(t),l.appendChild(o),this.setSelection(a.lastChild,a.lastChild&&a.lastChild.length),o};qt.prototype.handlePaste=function(e){var t=this.options,n=this.style;e.preventDefault();var i;if(e.clipboardData?i=e.clipboardData.getData("text/plain"):i=window.clipboardData.getData("Text"),this.insertText(i),t.autoResize){var r=this.autoResize(n);r&&this.resizeHandler(r)}};qt.prototype.insertText=function(e){e=T0(e);var t=document.execCommand("insertText",!1,e);t||this._insertTextIE(e)};qt.prototype._insertTextIE=function(e){var t=this.getSelection(),n=t.startContainer,i=t.endContainer,r=t.startOffset,o=t.endOffset,a=t.commonAncestorContainer,l=C0(a.childNodes),s,c;if(S0(a)){var p=n.textContent;n.textContent=p.substring(0,r)+e+p.substring(o),s=n,c=r+e.length}else if(n===this.content&&i===this.content){var u=document.createTextNode(e);this.content.insertBefore(u,l[r]),s=u,c=u.textContent.length}else{var d=l.indexOf(n),f=l.indexOf(i);l.forEach(function(h,m){m===d?h.textContent=n.textContent.substring(0,r)+e+i.textContent.substring(o):m>d&&m<=f&&Hi(h)}),s=n,c=r+e.length}s&&c!==void 0&&setTimeout(function(){self.setSelection(s,c)})};qt.prototype.autoResize=function(){var e=this.parent,t=this.content,n=parseInt(this.style.fontSize)||12;if(t.scrollHeight>e.offsetHeight||t.scrollHeight<e.offsetHeight-n){var i=e.getBoundingClientRect(),r=t.scrollHeight;e.style.height=r+"px",this.resizeHandler({width:i.width,height:i.height,dx:0,dy:r-i.height})}};qt.prototype.resizable=function(){var e=this,t=this.parent,n=this.resizeHandle,i=parseInt(this.style.minWidth)||0,r=parseInt(this.style.minHeight)||0,o=parseInt(this.style.maxWidth)||1/0,a=parseInt(this.style.maxHeight)||1/0;if(!n){n=this.resizeHandle=ot('<div class="djs-direct-editing-resize-handle"></div>');var l,s,c,p,u=function(h){Ts(h),xr(h),l=h.clientX,s=h.clientY;var m=t.getBoundingClientRect();c=m.width,p=m.height,ce.bind(document,"mousemove",d),ce.bind(document,"mouseup",f)},d=function(h){Ts(h),xr(h);var m=nd(id(c+h.clientX-l,i),o),v=nd(id(p+h.clientY-s,r),a);t.style.width=m+"px",t.style.height=v+"px",e.resizeHandler({width:c,height:p,dx:h.clientX-l,dy:h.clientY-s})},f=function(h){Ts(h),xr(h),ce.unbind(document,"mousemove",d,!1),ce.unbind(document,"mouseup",f,!1)};ce.bind(n,"mousedown",u)}L(n.style,{position:"absolute",bottom:"0px",right:"0px",cursor:"nwse-resize",width:"0",height:"0",borderTop:(parseInt(this.style.fontSize)/4||3)+"px solid transparent",borderRight:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderBottom:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderLeft:(parseInt(this.style.fontSize)/4||3)+"px solid transparent"}),t.appendChild(n)};qt.prototype.destroy=function(){var e=this.parent,t=this.content,n=this.resizeHandle;t.innerText="",e.removeAttribute("style"),t.removeAttribute("style"),ce.unbind(t,"keydown",this.keyHandler),ce.unbind(t,"mousedown",xr),ce.unbind(t,"input",this.autoResize),ce.unbind(t,"paste",this.handlePaste),n&&(n.removeAttribute("style"),Hi(n)),Hi(e)};qt.prototype.getValue=function(){return this.content.innerText.trim()};qt.prototype.getSelection=function(){var e=window.getSelection(),t=e.getRangeAt(0);return t};qt.prototype.setSelection=function(e,t){var n=document.createRange();e===null?n.selectNodeContents(this.content):(n.setStart(e,t),n.setEnd(e,t));var i=window.getSelection();i.removeAllRanges(),i.addRange(n)};function T0(e){return e.replace(/\r\n|\r|\n/g,`
`)}function Vt(e,t){this._eventBus=e,this._providers=[],this._textbox=new qt({container:t.getContainer(),keyHandler:gi(this._handleKey,this),resizeHandler:gi(this._handleResize,this)})}Vt.$inject=["eventBus","canvas"];Vt.prototype.registerProvider=function(e){this._providers.push(e)};Vt.prototype.isActive=function(e){return!!(this._active&&(!e||this._active.element===e))};Vt.prototype.cancel=function(){this._active&&(this._fire("cancel"),this.close())};Vt.prototype._fire=function(e,t){this._eventBus.fire("directEditing."+e,t||{active:this._active})};Vt.prototype.close=function(){this._textbox.destroy(),this._fire("deactivate"),this._active=null,this.resizable=void 0};Vt.prototype.complete=function(){var e=this._active;if(e){var t,n=e.context.bounds,i=this.$textbox.getBoundingClientRect(),r=this.getValue(),o=e.context.text;(r!==o||i.height!==n.height||i.width!==n.width)&&(t=this._textbox.container.getBoundingClientRect(),e.provider.update(e.element,r,e.context.text,{x:i.left-t.left,y:i.top-t.top,width:i.width,height:i.height})),this._fire("complete"),this.close()}};Vt.prototype.getValue=function(){return this._textbox.getValue()};Vt.prototype._handleKey=function(e){e.stopPropagation();var t=e.keyCode||e.charCode;if(t===27)return e.preventDefault(),this.cancel();if(t===13&&!e.shiftKey)return e.preventDefault(),this.complete()};Vt.prototype._handleResize=function(e){this._fire("resize",e)};Vt.prototype.activate=function(e){this.isActive()&&this.cancel();var t,n=Oe(this._providers,function(i){return(t=i.activate(e))?i:null});return t&&(this.$textbox=this._textbox.create(t.bounds,t.style,t.text,t.options),this._active={element:e,context:t,provider:n},t.options&&t.options.resizable&&(this.resizable=!0),this._fire("activate")),!!t};const Tm={__depends__:[w0],__init__:["directEditing"],directEditing:["type",Vt]};function rd(e){return function(t){var n=t.target,i=Q(e),r=i.eventDefinitions&&i.eventDefinitions[0],o=i.$type===n.type,a=(r&&r.$type)===n.eventDefinitionType,l=!!n.triggeredByEvent==!!i.triggeredByEvent,s=n.isExpanded===void 0||n.isExpanded===Se(e);return!o||!a||!l||!s}}var P0=[{label:"Start event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"replace-with-none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message start event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer start event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Conditional start event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Signal start event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],R0=[{label:"Start event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"replace-with-none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}}],D0=[{label:"Start event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message intermediate catch event",actionName:"replace-with-message-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message intermediate throw event",actionName:"replace-with-message-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-message",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer intermediate catch event",actionName:"replace-with-timer-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Escalation intermediate throw event",actionName:"replace-with-escalation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-escalation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Conditional intermediate catch event",actionName:"replace-with-conditional-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Link intermediate catch event",actionName:"replace-with-link-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-link",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Link intermediate throw event",actionName:"replace-with-link-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-link",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Compensation intermediate throw event",actionName:"replace-with-compensation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-compensation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal intermediate catch event",actionName:"replace-with-signal-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal intermediate throw event",actionName:"replace-with-signal-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-signal",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],k0=[{label:"Start event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message end event",actionName:"replace-with-message-end",className:"bpmn-icon-end-event-message",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Escalation end event",actionName:"replace-with-escalation-end",className:"bpmn-icon-end-event-escalation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Error end event",actionName:"replace-with-error-end",className:"bpmn-icon-end-event-error",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Cancel end event",actionName:"replace-with-cancel-end",className:"bpmn-icon-end-event-cancel",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CancelEventDefinition"}},{label:"Compensation end event",actionName:"replace-with-compensation-end",className:"bpmn-icon-end-event-compensation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal end event",actionName:"replace-with-signal-end",className:"bpmn-icon-end-event-signal",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Terminate end event",actionName:"replace-with-terminate-end",className:"bpmn-icon-end-event-terminate",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:TerminateEventDefinition"}}],A0=[{label:"Exclusive gateway",actionName:"replace-with-exclusive-gateway",className:"bpmn-icon-gateway-xor",target:{type:"bpmn:ExclusiveGateway"}},{label:"Parallel gateway",actionName:"replace-with-parallel-gateway",className:"bpmn-icon-gateway-parallel",target:{type:"bpmn:ParallelGateway"}},{label:"Inclusive gateway",actionName:"replace-with-inclusive-gateway",className:"bpmn-icon-gateway-or",target:{type:"bpmn:InclusiveGateway"}},{label:"Complex gateway",actionName:"replace-with-complex-gateway",className:"bpmn-icon-gateway-complex",target:{type:"bpmn:ComplexGateway"}},{label:"Event-based gateway",actionName:"replace-with-event-based-gateway",className:"bpmn-icon-gateway-eventbased",target:{type:"bpmn:EventBasedGateway",instantiate:!1,eventGatewayType:"Exclusive"}}],M0=[{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Event sub-process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}},{label:"Sub-process (collapsed)",actionName:"replace-with-collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}}],Pm=[{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Sub-process",actionName:"replace-with-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Event sub-process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}}],I0=Pm,od=[{label:"Task",actionName:"replace-with-task",className:"bpmn-icon-task",target:{type:"bpmn:Task"}},{label:"User task",actionName:"replace-with-user-task",className:"bpmn-icon-user",target:{type:"bpmn:UserTask"}},{label:"Service task",actionName:"replace-with-service-task",className:"bpmn-icon-service",target:{type:"bpmn:ServiceTask"}},{label:"Send task",actionName:"replace-with-send-task",className:"bpmn-icon-send",target:{type:"bpmn:SendTask"}},{label:"Receive task",actionName:"replace-with-receive-task",className:"bpmn-icon-receive",target:{type:"bpmn:ReceiveTask"}},{label:"Manual task",actionName:"replace-with-manual-task",className:"bpmn-icon-manual",target:{type:"bpmn:ManualTask"}},{label:"Business rule task",actionName:"replace-with-rule-task",className:"bpmn-icon-business-rule",target:{type:"bpmn:BusinessRuleTask"}},{label:"Script task",actionName:"replace-with-script-task",className:"bpmn-icon-script",target:{type:"bpmn:ScriptTask"}},{label:"Call activity",actionName:"replace-with-call-activity",className:"bpmn-icon-call-activity",target:{type:"bpmn:CallActivity"}},{label:"Sub-process (collapsed)",actionName:"replace-with-collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}},{label:"Sub-process (expanded)",actionName:"replace-with-expanded-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}}],N0=[{label:"Data store reference",actionName:"replace-with-data-store-reference",className:"bpmn-icon-data-store",target:{type:"bpmn:DataStoreReference"}}],O0=[{label:"Data object reference",actionName:"replace-with-data-object-reference",className:"bpmn-icon-data-object",target:{type:"bpmn:DataObjectReference"}}],L0=[{label:"Message boundary event",actionName:"replace-with-message-boundary",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition",cancelActivity:!0}},{label:"Timer boundary event",actionName:"replace-with-timer-boundary",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition",cancelActivity:!0}},{label:"Escalation boundary event",actionName:"replace-with-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",cancelActivity:!0}},{label:"Conditional boundary event",actionName:"replace-with-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",cancelActivity:!0}},{label:"Error boundary event",actionName:"replace-with-error-boundary",className:"bpmn-icon-intermediate-event-catch-error",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ErrorEventDefinition",cancelActivity:!0}},{label:"Cancel boundary event",actionName:"replace-with-cancel-boundary",className:"bpmn-icon-intermediate-event-catch-cancel",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CancelEventDefinition",cancelActivity:!0}},{label:"Signal boundary event",actionName:"replace-with-signal-boundary",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition",cancelActivity:!0}},{label:"Compensation boundary event",actionName:"replace-with-compensation-boundary",className:"bpmn-icon-intermediate-event-catch-compensation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CompensateEventDefinition",cancelActivity:!0}},{label:"Message boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-message-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition",cancelActivity:!1}},{label:"Timer boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition",cancelActivity:!1}},{label:"Escalation boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",cancelActivity:!1}},{label:"Conditional boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",cancelActivity:!1}},{label:"Signal boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition",cancelActivity:!1}}],$0=[{label:"Message start event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition",isInterrupting:!0}},{label:"Timer start event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition",isInterrupting:!0}},{label:"Conditional start event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",isInterrupting:!0}},{label:"Signal start event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition",isInterrupting:!0}},{label:"Error start event",actionName:"replace-with-error-start",className:"bpmn-icon-start-event-error",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ErrorEventDefinition",isInterrupting:!0}},{label:"Escalation start event",actionName:"replace-with-escalation-start",className:"bpmn-icon-start-event-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",isInterrupting:!0}},{label:"Compensation start event",actionName:"replace-with-compensation-start",className:"bpmn-icon-start-event-compensation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:CompensateEventDefinition",isInterrupting:!0}},{label:"Message start event (non-interrupting)",actionName:"replace-with-non-interrupting-message-start",className:"bpmn-icon-start-event-non-interrupting-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition",isInterrupting:!1}},{label:"Timer start event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-start",className:"bpmn-icon-start-event-non-interrupting-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition",isInterrupting:!1}},{label:"Conditional start event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-start",className:"bpmn-icon-start-event-non-interrupting-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",isInterrupting:!1}},{label:"Signal start event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-start",className:"bpmn-icon-start-event-non-interrupting-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition",isInterrupting:!1}},{label:"Escalation start event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-start",className:"bpmn-icon-start-event-non-interrupting-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",isInterrupting:!1}}],B0=[{label:"Sequence flow",actionName:"replace-with-sequence-flow",className:"bpmn-icon-connection"},{label:"Default flow",actionName:"replace-with-default-flow",className:"bpmn-icon-default-flow"},{label:"Conditional flow",actionName:"replace-with-conditional-flow",className:"bpmn-icon-conditional-flow"}],j0=[{label:"Expanded pool/participant",actionName:"replace-with-expanded-pool",className:"bpmn-icon-participant",target:{type:"bpmn:Participant",isExpanded:!0}},{label:function(e){var t="Empty pool/participant";return e.children&&e.children.length&&(t+=" (removes content)"),t},actionName:"replace-with-collapsed-pool",className:"bpmn-icon-lane",target:{type:"bpmn:Participant",isExpanded:!1}}];const ad={"start-event-non-interrupting":`
  <svg viewBox="0 0 2048 2048" xmlns="http://www.w3.org/2000/svg">
    <g transform="translate(0 995.64)">
      <path d="m1899 28.357c21.545 567.43-598.38 1023.5-1133.6 835.92-548.09-147.21-801.57-873.95-463.59-1330 302.62-480.3 1071.7-507.54 1407.6-49.847 122.14 153.12 190.07 348.07 189.59 543.91z" fill="none" stroke="currentColor" stroke-dasharray="418.310422, 361.2328165" stroke-linecap="round" stroke-width="100"/>
    </g>
  </svg>`,"intermediate-event-non-interrupting":`
  <svg viewBox="0 0 2048 2048" xmlns="http://www.w3.org/2000/svg">
     <g transform="translate(0 995.64)" fill="none" stroke="currentColor" stroke-linecap="round">
        <circle cx="1024" cy="28.357" r="875" stroke-dasharray="418.310422, 361.2328165" stroke-width="100"/>
        <circle cx="1024" cy="28.357" r="685" stroke-dasharray="348.31044857,261.23283643" stroke-dashoffset="500" stroke-width="100"/>
     </g>
  </svg>`};function kt(e,t,n,i,r,o,a,l){this._bpmnFactory=e,this._popupMenu=t,this._modeling=n,this._moddle=i,this._bpmnReplace=r,this._rules=o,this._translate=a,this._moddleCopy=l,this._register()}kt.$inject=["bpmnFactory","popupMenu","modeling","moddle","bpmnReplace","rules","translate","moddleCopy"];kt.prototype._register=function(){this._popupMenu.registerProvider("bpmn-replace",this)};kt.prototype.getPopupMenuEntries=function(e){var t=e.businessObject,n=this._rules,i=[];if(Te(e)||!n.allowed("shape.replace",{element:e}))return{};var r=rd(e);return y(t,"bpmn:DataObjectReference")?this._createEntries(e,N0):y(t,"bpmn:DataStoreReference")&&!y(e.parent,"bpmn:Collaboration")?this._createEntries(e,O0):y(t,"bpmn:StartEvent")&&!y(t.$parent,"bpmn:SubProcess")?(i=_e(P0,r),this._createEntries(e,i)):y(t,"bpmn:Participant")?(i=_e(j0,function(o){return Se(e)!==o.target.isExpanded}),this._createEntries(e,i)):y(t,"bpmn:StartEvent")&&mt(t.$parent)?(i=_e($0,function(o){var a=o.target,l=a.isInterrupting!==!1,s=t.isInterrupting===l;return r(o)||!r(o)&&!s}),this._createEntries(e,i)):y(t,"bpmn:StartEvent")&&!mt(t.$parent)&&y(t.$parent,"bpmn:SubProcess")?(i=_e(R0,r),this._createEntries(e,i)):y(t,"bpmn:EndEvent")?(i=_e(k0,function(o){var a=o.target;return a.eventDefinitionType=="bpmn:CancelEventDefinition"&&!y(t.$parent,"bpmn:Transaction")?!1:r(o)}),this._createEntries(e,i)):y(t,"bpmn:BoundaryEvent")?(i=_e(L0,function(o){var a=o.target;if(a.eventDefinitionType=="bpmn:CancelEventDefinition"&&!y(t.attachedToRef,"bpmn:Transaction"))return!1;var l=a.cancelActivity!==!1,s=t.cancelActivity==l;return r(o)||!r(o)&&!s}),this._createEntries(e,i)):y(t,"bpmn:IntermediateCatchEvent")||y(t,"bpmn:IntermediateThrowEvent")?(i=_e(D0,r),this._createEntries(e,i)):y(t,"bpmn:Gateway")?(i=_e(A0,r),this._createEntries(e,i)):y(t,"bpmn:Transaction")?(i=_e(Pm,r),this._createEntries(e,i)):mt(t)&&Se(e)?(i=_e(I0,r),this._createEntries(e,i)):y(t,"bpmn:SubProcess")&&Se(e)?(i=_e(M0,r),this._createEntries(e,i)):y(t,"bpmn:AdHocSubProcess")&&!Se(e)?(i=_e(od,function(o){var a=o.target,l=a.type==="bpmn:SubProcess",s=a.isExpanded===!0;return rd(a)&&(!l||s)}),this._createEntries(e,i)):y(t,"bpmn:SequenceFlow")?this._createSequenceFlowEntries(e,B0):y(t,"bpmn:FlowNode")?(i=_e(od,r),y(t,"bpmn:SubProcess")&&!Se(e)&&(i=_e(i,function(o){return o.label!=="Sub-process (collapsed)"})),this._createEntries(e,i)):{}};kt.prototype.getPopupMenuHeaderEntries=function(e){var t={};return y(e,"bpmn:Activity")&&!mt(e)&&(t={...t,...this._getLoopCharacteristicsHeaderEntries(e)}),y(e,"bpmn:DataObjectReference")&&(t={...t,...this._getCollectionHeaderEntries(e)}),y(e,"bpmn:Participant")&&(t={...t,...this._getParticipantMultiplicityHeaderEntries(e)}),y(e,"bpmn:SubProcess")&&!y(e,"bpmn:Transaction")&&!mt(e)&&(t={...t,...this._getAdHocHeaderEntries(e)}),Ch(e)&&(t={...t,...this._getNonInterruptingHeaderEntries(e)}),t};kt.prototype._createEntries=function(e,t){var n={},i=this;return M(t,function(r){n[r.actionName]=i._createEntry(r,e)}),n};kt.prototype._createSequenceFlowEntries=function(e,t){var n=Q(e),i={},r=this._modeling,o=this._moddle,a=this;return M(t,function(l){switch(l.actionName){case"replace-with-default-flow":n.sourceRef.default!==n&&(y(n.sourceRef,"bpmn:ExclusiveGateway")||y(n.sourceRef,"bpmn:InclusiveGateway")||y(n.sourceRef,"bpmn:ComplexGateway")||y(n.sourceRef,"bpmn:Activity"))&&(i={...i,[l.actionName]:a._createEntry(l,e,function(){r.updateProperties(e.source,{default:n})})});break;case"replace-with-conditional-flow":!n.conditionExpression&&y(n.sourceRef,"bpmn:Activity")&&(i={...i,[l.actionName]:a._createEntry(l,e,function(){var s=o.create("bpmn:FormalExpression",{body:""});r.updateProperties(e,{conditionExpression:s})})});break;default:y(n.sourceRef,"bpmn:Activity")&&n.conditionExpression&&(i={...i,[l.actionName]:a._createEntry(l,e,function(){r.updateProperties(e,{conditionExpression:void 0})})}),(y(n.sourceRef,"bpmn:ExclusiveGateway")||y(n.sourceRef,"bpmn:InclusiveGateway")||y(n.sourceRef,"bpmn:ComplexGateway")||y(n.sourceRef,"bpmn:Activity"))&&n.sourceRef.default===n&&(i={...i,[l.actionName]:a._createEntry(l,e,function(){r.updateProperties(e.source,{default:void 0})})})}}),i};kt.prototype._createEntry=function(e,t,n){var i=this._translate,r=this._bpmnReplace.replaceElement,o=function(){return r(t,e.target)},a=e.label;return a&&typeof a=="function"&&(a=a(t)),n=n||o,{label:i(a),className:e.className,action:n}};kt.prototype._getLoopCharacteristicsHeaderEntries=function(e){var t=this,n=this._translate;function i(c,p){if(p.active){t._modeling.updateProperties(e,{loopCharacteristics:void 0});return}const u=e.businessObject.get("loopCharacteristics"),d=t._moddle.create(p.options.loopCharacteristics);u&&t._moddleCopy.copyElement(u,d),d.set("isSequential",p.options.isSequential),t._modeling.updateProperties(e,{loopCharacteristics:d})}var r=Q(e),o=r.loopCharacteristics,a,l,s;return o&&(a=o.isSequential,l=o.isSequential===void 0,s=o.isSequential!==void 0&&!o.isSequential),{"toggle-parallel-mi":{className:"bpmn-icon-parallel-mi-marker",title:n("Parallel multi-instance"),active:s,action:i,options:{loopCharacteristics:"bpmn:MultiInstanceLoopCharacteristics",isSequential:!1}},"toggle-sequential-mi":{className:"bpmn-icon-sequential-mi-marker",title:n("Sequential multi-instance"),active:a,action:i,options:{loopCharacteristics:"bpmn:MultiInstanceLoopCharacteristics",isSequential:!0}},"toggle-loop":{className:"bpmn-icon-loop-marker",title:n("Loop"),active:l,action:i,options:{loopCharacteristics:"bpmn:StandardLoopCharacteristics"}}}};kt.prototype._getCollectionHeaderEntries=function(e){var t=this,n=this._translate,i=e.businessObject.dataObjectRef;if(!i)return{};function r(a,l){t._modeling.updateModdleProperties(e,i,{isCollection:!l.active})}var o=i.isCollection;return{"toggle-is-collection":{className:"bpmn-icon-parallel-mi-marker",title:n("Collection"),active:o,action:r}}};kt.prototype._getParticipantMultiplicityHeaderEntries=function(e){var t=this,n=this._bpmnFactory,i=this._translate;function r(a,l){var s=l.active,c;s||(c=n.create("bpmn:ParticipantMultiplicity")),t._modeling.updateProperties(e,{participantMultiplicity:c})}var o=e.businessObject.participantMultiplicity;return{"toggle-participant-multiplicity":{className:"bpmn-icon-parallel-mi-marker",title:i("Participant multiplicity"),active:!!o,action:r}}};kt.prototype._getAdHocHeaderEntries=function(e){var t=this._translate,n=Q(e),i=y(n,"bpmn:AdHocSubProcess"),r=this._bpmnReplace.replaceElement;return{"toggle-adhoc":{className:"bpmn-icon-ad-hoc-marker",title:t("Ad-hoc"),active:i,action:function(o,a){return i?r(e,{type:"bpmn:SubProcess"},{autoResize:!1,layoutConnection:!1}):r(e,{type:"bpmn:AdHocSubProcess"},{autoResize:!1,layoutConnection:!1})}}}};kt.prototype._getNonInterruptingHeaderEntries=function(e){const t=this._translate,n=Q(e),i=this,r=Th(e),o=y(e,"bpmn:BoundaryEvent")?ad["intermediate-event-non-interrupting"]:ad["start-event-non-interrupting"],a=!n[r];return{"toggle-non-interrupting":{imageHtml:o,title:t("Toggle non-interrupting"),active:a,action:function(){i._modeling.updateProperties(e,{[r]:!!a})}}}};const V0={__depends__:[Il,nm,Ll],__init__:["replaceMenuProvider"],replaceMenuProvider:["type",kt]};function tr(e,t,n,i,r,o,a,l,s,c,p,u,d){e=e||{},i.registerProvider(this),this._contextPad=i,this._modeling=r,this._elementFactory=o,this._connect=a,this._create=l,this._popupMenu=s,this._canvas=c,this._rules=p,this._translate=u,this._eventBus=n,this._appendPreview=d,e.autoPlace!==!1&&(this._autoPlace=t.get("autoPlace",!1)),n.on("create.end",250,function(f){var h=f.context,m=h.shape;if(!(!Tr(f)||!i.isOpen(m))){var v=i.getEntries(m);v.replace&&v.replace.action.click(f,m)}})}tr.$inject=["config.contextPad","injector","eventBus","contextPad","modeling","elementFactory","connect","create","popupMenu","canvas","rules","translate","appendPreview"];tr.prototype.getMultiElementContextPadEntries=function(e){var t=this._modeling,n={};return this._isDeleteAllowed(e)&&L(n,{delete:{group:"edit",className:"bpmn-icon-trash",title:this._translate("Delete"),action:{click:function(i,r){t.removeElements(r.slice())}}}}),n};tr.prototype._isDeleteAllowed=function(e){var t=this._rules.allowed("elements.delete",{elements:e});return Te(t)?vl(t,function(n){return F0(t,n)}):t};tr.prototype.getContextPadEntries=function(e){var t=this._contextPad,n=this._modeling,i=this._elementFactory,r=this._connect,o=this._create,a=this._popupMenu,l=this._rules,s=this._autoPlace,c=this._translate,p=this._appendPreview,u={};if(e.type==="label")return u;var d=e.businessObject;function f(C,R){r.start(C,R)}function h(C,R){n.removeElements([R])}function m(C){var R=5,D=t.getPad(C).html,F=D.getBoundingClientRect(),A={x:F.left,y:F.bottom+R};return A}function v(C,R,D,F){function A(V,X){var U=i.createShape(L({type:C},F));o.start(V,U,{source:X}),p.cleanUp()}var I=s?function(V,X){var U=i.createShape(L({type:C},F));s.append(X,U),p.cleanUp()}:A,$=s?function(V,X){return p.create(X,C,F),()=>{p.cleanUp()}}:null;return{group:"model",className:R,title:D,action:{dragstart:A,click:I,hover:$}}}function S(C){return function(R,D){n.splitLane(D,C),t.open(D,!0)}}if(ve(d,["bpmn:Lane","bpmn:Participant"])&&Se(e)){var b=Kn(e);L(u,{"lane-insert-above":{group:"lane-insert-above",className:"bpmn-icon-lane-insert-above",title:c("Add lane above"),action:{click:function(C,R){n.addLane(R,"top")}}}}),b.length<2&&(e.height>=120&&L(u,{"lane-divide-two":{group:"lane-divide",className:"bpmn-icon-lane-divide-two",title:c("Divide into two lanes"),action:{click:S(2)}}}),e.height>=180&&L(u,{"lane-divide-three":{group:"lane-divide",className:"bpmn-icon-lane-divide-three",title:c("Divide into three lanes"),action:{click:S(3)}}})),L(u,{"lane-insert-below":{group:"lane-insert-below",className:"bpmn-icon-lane-insert-below",title:c("Add lane below"),action:{click:function(C,R){n.addLane(R,"bottom")}}}})}y(d,"bpmn:FlowNode")&&(y(d,"bpmn:EventBasedGateway")?L(u,{"append.receive-task":v("bpmn:ReceiveTask","bpmn-icon-receive-task",c("Append receive task")),"append.message-intermediate-event":v("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-message",c("Append message intermediate catch event"),{eventDefinitionType:"bpmn:MessageEventDefinition"}),"append.timer-intermediate-event":v("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-timer",c("Append timer intermediate catch event"),{eventDefinitionType:"bpmn:TimerEventDefinition"}),"append.condition-intermediate-event":v("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-condition",c("Append conditional intermediate catch event"),{eventDefinitionType:"bpmn:ConditionalEventDefinition"}),"append.signal-intermediate-event":v("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-signal",c("Append signal intermediate catch event"),{eventDefinitionType:"bpmn:SignalEventDefinition"})}):sd(d,"bpmn:BoundaryEvent","bpmn:CompensateEventDefinition")?L(u,{"append.compensation-activity":v("bpmn:Task","bpmn-icon-task",c("Append compensation activity"),{isForCompensation:!0})}):!y(d,"bpmn:EndEvent")&&!d.isForCompensation&&!sd(d,"bpmn:IntermediateThrowEvent","bpmn:LinkEventDefinition")&&!mt(d)&&L(u,{"append.end-event":v("bpmn:EndEvent","bpmn-icon-end-event-none",c("Append end event")),"append.gateway":v("bpmn:ExclusiveGateway","bpmn-icon-gateway-none",c("Append gateway"),{isMarkerVisible:!0}),"append.append-task":v("bpmn:Task","bpmn-icon-task",c("Append task")),"append.intermediate-event":v("bpmn:IntermediateThrowEvent","bpmn-icon-intermediate-event-none",c("Append intermediate/boundary event"))})),a.isEmpty(e,"bpmn-replace")||L(u,{replace:{group:"edit",className:"bpmn-icon-screw-wrench",title:c("Change element"),action:{click:function(C,R){var D=L(m(R),{cursor:{x:C.x,y:C.y}});a.open(R,"bpmn-replace",D,{title:c("Change element"),width:300,search:!0})}}}}),y(d,"bpmn:SequenceFlow")&&L(u,{"append.text-annotation":v("bpmn:TextAnnotation","bpmn-icon-text-annotation",c("Add text annotation"))}),ve(d,["bpmn:FlowNode","bpmn:InteractionNode","bpmn:DataObjectReference","bpmn:DataStoreReference"])&&L(u,{"append.text-annotation":v("bpmn:TextAnnotation","bpmn-icon-text-annotation",c("Add text annotation")),connect:{group:"connect",className:"bpmn-icon-connection-multi",title:c("Connect to other element"),action:{click:f,dragstart:f}}}),y(d,"bpmn:TextAnnotation")&&L(u,{connect:{group:"connect",className:"bpmn-icon-connection-multi",title:c("Connect using association"),action:{click:f,dragstart:f}}}),ve(d,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&L(u,{connect:{group:"connect",className:"bpmn-icon-connection-multi",title:c("Connect using data input association"),action:{click:f,dragstart:f}}}),y(d,"bpmn:Group")&&L(u,{"append.text-annotation":v("bpmn:TextAnnotation","bpmn-icon-text-annotation",c("Add text annotation"))});var w=l.allowed("elements.delete",{elements:[e]});return Te(w)&&(w=w[0]===e),w&&L(u,{delete:{group:"edit",className:"bpmn-icon-trash",title:c("Delete"),action:{click:h}}}),u};function sd(e,t,n){var i=e.$instanceOf(t),r=!1,o=e.eventDefinitions||[];return M(o,function(a){a.$type===n&&(r=!0)}),i&&r}function F0(e,t){return e.indexOf(t)!==-1}const H0={__depends__:[m0,Tm,Tf,En,Fl,Na,V0],__init__:["contextPadProvider"],contextPadProvider:["type",tr]};var z0={horizontal:["x","width"],vertical:["y","height"]},ld=5;function Pn(e,t){this._modeling=e,this._filters=[],this.registerFilter(function(n){var i=t.allowed("elements.distribute",{elements:n});return Te(i)?i:i?n:[]})}Pn.$inject=["modeling","rules"];Pn.prototype.registerFilter=function(e){if(typeof e!="function")throw new Error("the filter has to be a function");this._filters.push(e)};Pn.prototype.trigger=function(e,t){var n=this._modeling,i,r;if(!(e.length<3)&&(this._setOrientation(t),r=this._filterElements(e),i=this._createGroups(r),!(i.length<=2)))return n.distributeElements(i,this._axis,this._dimension),i};Pn.prototype._filterElements=function(e){var t=this._filters,n=this._axis,i=this._dimension,r=[].concat(e);return t.length?(M(t,function(o){r=o(r,n,i)}),r):e};Pn.prototype._createGroups=function(e){var t=[],n=this,i=this._axis,r=this._dimension;if(!i)throw new Error('must have a defined "axis" and "dimension"');var o=tn(e,i);return M(o,function(a,l){var s=n._findRange(a,i,r),c,p=t[t.length-1];p&&n._hasIntersection(p.range,s)?t[t.length-1].elements.push(a):(c={range:s,elements:[a]},t.push(c))}),t};Pn.prototype._setOrientation=function(e){var t=z0[e];this._axis=t[0],this._dimension=t[1]};Pn.prototype._hasIntersection=function(e,t){return Math.max(e.min,e.max)>=Math.min(t.min,t.max)&&Math.min(e.min,e.max)<=Math.max(t.min,t.max)};Pn.prototype._findRange=function(e){var t=e[this._axis],n=e[this._dimension];return{min:t+ld,max:t+n-ld}};const U0={__init__:["distributeElements"],distributeElements:["type",Pn]};function qa(e){$t.call(this,e)}qa.$inject=["eventBus"];te(qa,$t);qa.prototype.init=function(){this.addRule("elements.distribute",function(e){var t=e.elements;return t=_e(t,function(n){var i=ve(n,["bpmn:Association","bpmn:BoundaryEvent","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:Lane","bpmn:MessageFlow","bpmn:SequenceFlow","bpmn:TextAnnotation"]);return!(n.labelTarget||i)}),t=ua(t),t.length<3?!1:t})};var cd={horizontal:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">
                <polyline points="450 400 450 150 1350 150 1350 400" style="fill:none;stroke:currentColor;stroke-width:100;stroke-linejoin:round;"/>
                <rect x="150" y="450" width="600" height="1200" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
                <rect x="1050" y="450" width="600" height="800" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
              </svg>`,vertical:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">
              <polyline points="400 1350 150 1350 150 450 400 450" style="fill:none;stroke:currentColor;stroke-width:100;stroke-linejoin:round;"/>
              <rect x="450" y="150" width="1200" height="600" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
              <rect x="450" y="1050" width="800" height="600" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
            </svg>`},G0=900;function Qr(e,t,n,i){this._distributeElements=t,this._translate=n,this._popupMenu=e,this._rules=i,e.registerProvider("align-elements",G0,this)}Qr.$inject=["popupMenu","distributeElements","translate","rules"];Qr.prototype.getPopupMenuEntries=function(e){var t={};return this._isAllowed(e)&&L(t,this._getEntries(e)),t};Qr.prototype._isAllowed=function(e){return this._rules.allowed("elements.distribute",{elements:e})};Qr.prototype._getEntries=function(e){var t=this._distributeElements,n=this._translate,i=this._popupMenu,r={"distribute-elements-horizontal":{group:"distribute",title:n("Distribute elements horizontally"),className:"bjs-align-elements-menu-entry",imageHtml:cd.horizontal,action:function(o,a){t.trigger(e,"horizontal"),i.close()}},"distribute-elements-vertical":{group:"distribute",title:n("Distribute elements vertically"),imageHtml:cd.vertical,action:function(o,a){t.trigger(e,"vertical"),i.close()}}};return r};const W0={__depends__:[Il,U0],__init__:["bpmnDistributeElements","distributeElementsMenuProvider"],bpmnDistributeElements:["type",qa],distributeElementsMenuProvider:["type",Qr]};var Rm="is not a registered action",Y0="is already registered";function Ft(e,t){this._actions={};var n=this;e.on("diagram.init",function(){n._registerDefaultActions(t),e.fire("editorActions.init",{editorActions:n})})}Ft.$inject=["eventBus","injector"];Ft.prototype._registerDefaultActions=function(e){var t=e.get("commandStack",!1),n=e.get("modeling",!1),i=e.get("selection",!1),r=e.get("zoomScroll",!1),o=e.get("copyPaste",!1),a=e.get("canvas",!1),l=e.get("rules",!1),s=e.get("keyboardMove",!1),c=e.get("keyboardMoveSelection",!1);t&&(this.register("undo",function(){t.undo()}),this.register("redo",function(){t.redo()})),o&&i&&this.register("copy",function(){var p=i.get();if(p.length)return o.copy(p)}),o&&this.register("paste",function(){o.paste()}),r&&this.register("stepZoom",function(p){r.stepZoom(p.value)}),a&&this.register("zoom",function(p){a.zoom(p.value)}),n&&i&&l&&this.register("removeSelection",function(){var p=i.get();if(p.length){var u=l.allowed("elements.delete",{elements:p}),d;u!==!1&&(Te(u)?d=u:d=p,d.length&&n.removeElements(d.slice()))}}),s&&this.register("moveCanvas",function(p){s.moveCanvas(p)}),c&&this.register("moveSelection",function(p){c.moveSelection(p.direction,p.accelerated)})};Ft.prototype.trigger=function(e,t){if(!this._actions[e])throw Gc(e,Rm);return this._actions[e](t)};Ft.prototype.register=function(e,t){var n=this;if(typeof e=="string")return this._registerAction(e,t);M(e,function(i,r){n._registerAction(r,i)})};Ft.prototype._registerAction=function(e,t){if(this.isRegistered(e))throw Gc(e,Y0);this._actions[e]=t};Ft.prototype.unregister=function(e){if(!this.isRegistered(e))throw Gc(e,Rm);this._actions[e]=void 0};Ft.prototype.getActions=function(){return Object.keys(this._actions)};Ft.prototype.isRegistered=function(e){return!!this._actions[e]};function Gc(e,t){return new Error(e+" "+t)}const q0={__init__:["editorActions"],editorActions:["type",Ft]};function Ka(e){e.invoke(Ft,this)}te(Ka,Ft);Ka.$inject=["injector"];Ka.prototype._registerDefaultActions=function(e){Ft.prototype._registerDefaultActions.call(this,e);var t=e.get("canvas",!1),n=e.get("elementRegistry",!1),i=e.get("selection",!1),r=e.get("spaceTool",!1),o=e.get("lassoTool",!1),a=e.get("handTool",!1),l=e.get("globalConnect",!1),s=e.get("distributeElements",!1),c=e.get("alignElements",!1),p=e.get("directEditing",!1),u=e.get("searchPad",!1),d=e.get("modeling",!1),f=e.get("contextPad",!1);t&&n&&i&&this._registerAction("selectElements",function(){var h=t.getRootElement(),m=n.filter(function(v){return v!==h});return i.select(m),m}),r&&this._registerAction("spaceTool",function(){r.toggle()}),o&&this._registerAction("lassoTool",function(){o.toggle()}),a&&this._registerAction("handTool",function(){a.toggle()}),l&&this._registerAction("globalConnectTool",function(){l.toggle()}),i&&s&&this._registerAction("distributeElements",function(h){var m=i.get(),v=h.type;m.length&&s.trigger(m,v)}),i&&c&&this._registerAction("alignElements",function(h){var m=i.get(),v=[],S=h.type;m.length&&(v=_e(m,function(b){return!y(b,"bpmn:Lane")}),c.trigger(v,S))}),i&&d&&this._registerAction("setColor",function(h){var m=i.get();m.length&&d.setColor(m,h)}),i&&p&&this._registerAction("directEditing",function(){var h=i.get();h.length&&p.activate(h[0])}),u&&this._registerAction("find",function(){u.toggle()}),t&&d&&this._registerAction("moveToOrigin",function(){var h=t.getRootElement(),m,v;y(h,"bpmn:Collaboration")?v=n.filter(function(S){return y(S.parent,"bpmn:Collaboration")}):v=n.filter(function(S){return S!==h&&!y(S.parent,"bpmn:SubProcess")}),m=Tt(v),d.moveElements(v,{x:-m.x,y:-m.y},h)}),i&&f&&this._registerAction("replaceElement",function(h){f.triggerEntry("replace","click",h)})};const K0={__depends__:[q0],editorActions:["type",Ka]};function Dm(e){e.on(["create.init","shape.move.init"],function(t){var n=t.context,i=t.shape;ve(i,["bpmn:Participant","bpmn:SubProcess","bpmn:TextAnnotation"])&&(n.gridSnappingContext||(n.gridSnappingContext={}),n.gridSnappingContext.snapLocation="top-left")})}Dm.$inject=["eventBus"];var Go=10;function Ps(e,t,n){return n||(n="round"),Math[n](e/t)*t}var X0=1200,Z0=800;function ti(e,t,n){var i=!n||n.active!==!1;this._eventBus=t;var r=this;t.on("diagram.init",Z0,function(){r.setActive(i)}),t.on(["create.move","create.end","bendpoint.move.move","bendpoint.move.end","connect.move","connect.end","connectionSegment.move.move","connectionSegment.move.end","resize.move","resize.end","shape.move.move","shape.move.end"],X0,function(o){var a=o.originalEvent;if(!(!r.active||a&&Dt(a))){var l=o.context,s=l.gridSnappingContext;s||(s=l.gridSnappingContext={}),["x","y"].forEach(function(c){var p={},u=J0(o,c,e);u&&(p.offset=u);var d=Q0(o,c);d&&L(p,d),Wi(o,c)||r.snapEvent(o,c,p)})}})}ti.prototype.snapEvent=function(e,t,n){var i=this.snapValue(e[t],n);Ge(e,t,i)};ti.prototype.getGridSpacing=function(){return Go};ti.prototype.snapValue=function(e,t){var n=0;t&&t.offset&&(n=t.offset),e+=n,e=Ps(e,Go);var i,r;return t&&t.min&&(i=t.min,ye(i)&&(i=Ps(i+n,Go,"ceil"),e=Math.max(e,i))),t&&t.max&&(r=t.max,ye(r)&&(r=Ps(r+n,Go,"floor"),e=Math.min(e,r))),e-=n,e};ti.prototype.isActive=function(){return this.active};ti.prototype.setActive=function(e){this.active=e,this._eventBus.fire("gridSnapping.toggle",{active:e})};ti.prototype.toggleActive=function(){this.setActive(!this.active)};ti.$inject=["elementRegistry","eventBus","config.gridSnapping"];function Q0(e,t){var n=e.context,i=n.createConstraints,r=n.resizeConstraints||{},o=n.gridSnappingContext,a=o.snapConstraints;if(a&&a[t])return a[t];a||(a=o.snapConstraints={}),a[t]||(a[t]={});var l=n.direction;i&&(Wo(t)?(a.x.min=i.left,a.x.max=i.right):(a.y.min=i.top,a.y.max=i.bottom));var s=r.min,c=r.max;return s&&(Wo(t)?pd(l)?a.x.max=s.left:a.x.min=s.right:ud(l)?a.y.max=s.top:a.y.min=s.bottom),c&&(Wo(t)?pd(l)?a.x.min=c.left:a.x.max=c.right:ud(l)?a.y.min=c.top:a.y.max=c.bottom),a[t]}function J0(e,t,n){var i=e.context,r=e.shape,o=i.gridSnappingContext,a=o.snapLocation,l=o.snapOffset;return l&&ye(l[t])||(l||(l=o.snapOffset={}),ye(l[t])||(l[t]=0),!r)||(n.get(r.id)||(Wo(t)?l[t]+=r[t]+r.width/2:l[t]+=r[t]+r.height/2),!a)||(t==="x"?/left/.test(a)?l[t]-=r.width/2:/right/.test(a)&&(l[t]+=r.width/2):/top/.test(a)?l[t]-=r.height/2:/bottom/.test(a)&&(l[t]+=r.height/2)),l[t]}function Wo(e){return e==="x"}function ud(e){return e.indexOf("n")!==-1}function pd(e){return e.indexOf("w")!==-1}function Pi(e,t){Y.call(this,e),this._gridSnapping=t;var n=this;this.preExecute("shape.resize",function(i){var r=i.context,o=r.hints||{},a=o.autoResize;if(a){var l=r.shape,s=r.newBounds;pa(a)?r.newBounds=n.snapComplex(s,a):r.newBounds=n.snapSimple(l,s)}})}Pi.$inject=["eventBus","gridSnapping","modeling"];te(Pi,Y);Pi.prototype.snapSimple=function(e,t){var n=this._gridSnapping;return t.width=n.snapValue(t.width,{min:t.width}),t.height=n.snapValue(t.height,{min:t.height}),t.x=e.x+e.width/2-t.width/2,t.y=e.y+e.height/2-t.height/2,t};Pi.prototype.snapComplex=function(e,t){return/w|e/.test(t)&&(e=this.snapHorizontally(e,t)),/n|s/.test(t)&&(e=this.snapVertically(e,t)),e};Pi.prototype.snapHorizontally=function(e,t){var n=this._gridSnapping,i=/w/.test(t),r=/e/.test(t),o={};return o.width=n.snapValue(e.width,{min:e.width}),r&&(i?(o.x=n.snapValue(e.x,{max:e.x}),o.width+=n.snapValue(e.x-o.x,{min:e.x-o.x})):e.x=e.x+e.width-o.width),L(e,o),e};Pi.prototype.snapVertically=function(e,t){var n=this._gridSnapping,i=/n/.test(t),r=/s/.test(t),o={};return o.height=n.snapValue(e.height,{min:e.height}),i&&(r?(o.y=n.snapValue(e.y,{max:e.y}),o.height+=n.snapValue(e.y-o.y,{min:e.y-o.y})):e.y=e.y+e.height-o.height),L(e,o),e};var eS=2e3;function km(e,t){e.on(["spaceTool.move","spaceTool.end"],eS,function(n){var i=n.context;if(i.initialized){var r=i.axis,o;r==="x"?(o=t.snapValue(n.dx),n.x=n.x+o-n.dx,n.dx=o):(o=t.snapValue(n.dy),n.y=n.y+o-n.dy,n.dy=o)}})}km.$inject=["eventBus","gridSnapping"];const tS={__init__:["gridSnappingResizeBehavior","gridSnappingSpaceToolBehavior"],gridSnappingResizeBehavior:["type",Pi],gridSnappingSpaceToolBehavior:["type",km]},nS={__depends__:[tS],__init__:["gridSnapping"],gridSnapping:["type",ti]};var iS=2e3;function Am(e,t){e.on("autoPlace",iS,function(n){var i=n.source,r=de(i),o=n.shape,a=Wf(i,o);return["x","y"].forEach(function(l){var s={};a[l]!==r[l]&&(a[l]>r[l]?s.min=a[l]:s.max=a[l],y(o,"bpmn:TextAnnotation")&&(rS(l)?s.offset=-o.width/2:s.offset=-o.height/2),a[l]=t.snapValue(a[l],s))}),a})}Am.$inject=["eventBus","gridSnapping"];function rS(e){return e==="x"}var oS=1750;function Mm(e,t,n){t.on(["create.start","shape.move.start"],oS,function(i){var r=i.context,o=r.shape,a=e.getRootElement();if(!(!y(o,"bpmn:Participant")||!y(a,"bpmn:Process")||!a.children.length)){var l=r.createConstraints;l&&(o.width=n.snapValue(o.width,{min:o.width}),o.height=n.snapValue(o.height,{min:o.height}))}})}Mm.$inject=["canvas","eventBus","gridSnapping"];var aS=3e3;function Xa(e,t,n){Y.call(this,e),this._gridSnapping=t;var i=this;this.postExecuted(["connection.create","connection.layout"],aS,function(r){var o=r.context,a=o.connection,l=o.hints||{},s=a.waypoints;l.connectionStart||l.connectionEnd||l.createElementsBehavior===!1||sS(s)&&n.updateWaypoints(a,i.snapMiddleSegments(s))})}Xa.$inject=["eventBus","gridSnapping","modeling"];te(Xa,Y);Xa.prototype.snapMiddleSegments=function(e){var t=this._gridSnapping,n;e=e.slice();for(var i=1;i<e.length-2;i++)n=uS(t,e[i],e[i+1]),e[i]=n[0],e[i+1]=n[1];return e};function sS(e){return e.length>3}function lS(e){return e==="h"}function cS(e){return e==="v"}function uS(e,t,n){var i=pn(t,n),r={};return lS(i)&&(r.y=e.snapValue(t.y)),cS(i)&&(r.x=e.snapValue(t.x)),("x"in r||"y"in r)&&(t=L({},t,r),n=L({},n,r)),[t,n]}const pS={__init__:["gridSnappingAutoPlaceBehavior","gridSnappingParticipantBehavior","gridSnappingLayoutConnectionBehavior"],gridSnappingAutoPlaceBehavior:["type",Am],gridSnappingParticipantBehavior:["type",Mm],gridSnappingLayoutConnectionBehavior:["type",Xa]},dS={__depends__:[nS,pS],__init__:["bpmnGridSnapping"],bpmnGridSnapping:["type",Dm]};var fS=30,hS=30;function Jr(e,t){this._interactionEvents=t;var n=this;e.on(["interactionEvents.createHit","interactionEvents.updateHit"],function(i){var r=i.element,o=i.gfx;if(y(r,"bpmn:Lane"))return n._createParticipantHit(r,o);if(y(r,"bpmn:Participant"))return Se(r)?n._createParticipantHit(r,o):n._createDefaultHit(r,o);if(y(r,"bpmn:SubProcess"))return Se(r)?n._createSubProcessHit(r,o):n._createDefaultHit(r,o)})}Jr.$inject=["eventBus","interactionEvents"];Jr.prototype._createDefaultHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createDefaultHit(e,t),!0};Jr.prototype._createParticipantHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createBoxHit(t,"no-move",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"click-stroke",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"all",{width:fS,height:e.height}),!0};Jr.prototype._createSubProcessHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createBoxHit(t,"no-move",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"click-stroke",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"all",{width:e.width,height:hS}),!0};const mS={__init__:["bpmnInteractionEvents"],bpmnInteractionEvents:["type",Jr]};function Za(e){e.invoke(Xi,this)}te(Za,Xi);Za.$inject=["injector"];Za.prototype.registerBindings=function(e,t){Xi.prototype.registerBindings.call(this,e,t);function n(i,r){t.isRegistered(i)&&e.addListener(r)}n("selectElements",function(i){var r=i.keyEvent;if(e.isKey(["a","A"],r)&&e.isCmd(r))return t.trigger("selectElements"),!0}),n("find",function(i){var r=i.keyEvent;if(e.isKey(["f","F"],r)&&e.isCmd(r))return t.trigger("find"),!0}),n("spaceTool",function(i){var r=i.keyEvent;if(!e.hasModifier(r)&&e.isKey(["s","S"],r))return t.trigger("spaceTool"),!0}),n("lassoTool",function(i){var r=i.keyEvent;if(!e.hasModifier(r)&&e.isKey(["l","L"],r))return t.trigger("lassoTool"),!0}),n("handTool",function(i){var r=i.keyEvent;if(!e.hasModifier(r)&&e.isKey(["h","H"],r))return t.trigger("handTool"),!0}),n("globalConnectTool",function(i){var r=i.keyEvent;if(!e.hasModifier(r)&&e.isKey(["c","C"],r))return t.trigger("globalConnectTool"),!0}),n("directEditing",function(i){var r=i.keyEvent;if(!e.hasModifier(r)&&e.isKey(["e","E"],r))return t.trigger("directEditing"),!0}),n("replaceElement",function(i){var r=i.keyEvent;if(!e.hasModifier(r)&&e.isKey(["r","R"],r))return t.trigger("replaceElement",r),!0})};const vS={__depends__:[Cl],__init__:["keyboardBindings"],keyboardBindings:["type",Za]};var gS={moveSpeed:1,moveSpeedAccelerated:10},yS=1500,dd="left",fd="up",hd="right",md="down",_S={ArrowLeft:dd,Left:dd,ArrowUp:fd,Up:fd,ArrowRight:hd,Right:hd,ArrowDown:md,Down:md},bS={left:function(e){return{x:-e,y:0}},up:function(e){return{x:0,y:-e}},right:function(e){return{x:e,y:0}},down:function(e){return{x:0,y:e}}};function Im(e,t,n,i,r){var o=this;this._config=L({},gS,e||{}),t.addListener(yS,function(a){var l=a.keyEvent,s=_S[l.key];if(s&&!t.isCmd(l)){var c=t.isShift(l);return o.moveSelection(s,c),!0}}),this.moveSelection=function(a,l){var s=r.get();if(s.length){var c=this._config[l?"moveSpeedAccelerated":"moveSpeed"],p=bS[a](c),u=i.allowed("elements.move",{shapes:s});u&&n.moveElements(s,p)}}}Im.$inject=["config.keyboardMoveSelection","keyboard","modeling","rules","selection"];const ES={__depends__:[Cl,En],__init__:["keyboardMoveSelection"],keyboardMoveSelection:["type",Im]};var vd=10;function eo(e,t,n,i){this._dragging=i,this._rules=t;var r=this;function o(s,c){var p=s.shape,u=s.direction,d=s.resizeConstraints,f;s.delta=c,f=Jb(p,u,c),s.newBounds=tE(f,d),s.canExecute=r.canResize(s)}function a(s){var c=s.resizeConstraints,p=s.minBounds;c===void 0&&(p===void 0&&(p=r.computeMinResizeBox(s)),s.resizeConstraints={min:ae(p)})}function l(s){var c=s.shape,p=s.canExecute,u=s.newBounds;if(p){if(u=ef(u),!xS(c,u))return;n.resizeShape(c,u)}}e.on("resize.start",function(s){a(s.context)}),e.on("resize.move",function(s){var c={x:s.dx,y:s.dy};o(s.context,c)}),e.on("resize.end",function(s){l(s.context)})}eo.prototype.canResize=function(e){var t=this._rules,n=nn(e,["newBounds","shape","delta","direction"]);return t.allowed("shape.resize",n)};eo.prototype.activate=function(e,t,n){var i=this._dragging,r,o;if(typeof n=="string"&&(n={direction:n}),r=L({shape:t},n),o=r.direction,!o)throw new Error("must provide a direction (n|w|s|e|nw|se|ne|sw)");i.init(e,Nm(t,o),"resize",{autoActivate:!0,cursor:wS(o),data:{shape:t,context:r}})};eo.prototype.computeMinResizeBox=function(e){var t=e.shape,n=e.direction,i,r;return i=e.minDimensions||{width:vd,height:vd},r=vh(t,e.childrenBoxPadding),nE(n,t,i,r)};eo.$inject=["eventBus","rules","modeling","dragging"];function xS(e,t){return e.x!==t.x||e.y!==t.y||e.width!==t.width||e.height!==t.height}function Nm(e,t){var n=de(e),i=ae(e),r={x:n.x,y:n.y};return t.indexOf("n")!==-1?r.y=i.top:t.indexOf("s")!==-1&&(r.y=i.bottom),t.indexOf("e")!==-1?r.x=i.right:t.indexOf("w")!==-1&&(r.x=i.left),r}function wS(e){var t="resize-";return e==="n"||e==="s"?t+"ns":e==="e"||e==="w"?t+"ew":e==="nw"||e==="se"?t+"nwse":t+"nesw"}var gd="djs-resizing",yd="resize-not-ok",SS=500;function Om(e,t,n){function i(o){var a=o.shape,l=o.newBounds,s=o.frame;s||(s=o.frame=n.addFrame(a,t.getActiveLayer()),t.addMarker(a,gd)),l.width>5&&ie(s,{x:l.x,width:l.width}),l.height>5&&ie(s,{y:l.y,height:l.height}),o.canExecute?Ne(s).remove(yd):Ne(s).add(yd)}function r(o){var a=o.shape,l=o.frame;l&&rt(o.frame),t.removeMarker(a,gd)}e.on("resize.move",SS,function(o){i(o.context)}),e.on("resize.cleanup",function(o){r(o.context)})}Om.$inject=["eventBus","canvas","previewSupport"];var Io=-6,No=8,Oo=20,gr="djs-resizer",CS=["n","w","s","e","nw","ne","se","sw"];function ni(e,t,n,i){this._resize=i,this._canvas=t;var r=this;e.on("selection.changed",function(o){var a=o.newSelection;r.removeResizers(),a.length===1&&M(a,gi(r.addResizer,r))}),e.on("shape.changed",function(o){var a=o.element;n.isSelected(a)&&(r.removeResizers(),r.addResizer(a))})}ni.prototype.makeDraggable=function(e,t,n){var i=this._resize;function r(o){_l(o)&&i.activate(o,e,n)}ce.bind(t,"mousedown",r),ce.bind(t,"touchstart",r)};ni.prototype._createResizer=function(e,t,n,i){var r=this._getResizersParent(),o=TS(i),a=be("g");Ne(a).add(gr),Ne(a).add(gr+"-"+e.id),Ne(a).add(gr+"-"+i),Ce(r,a);var l=be("rect");ie(l,{x:-No/2+o.x,y:-No/2+o.y,width:No,height:No}),Ne(l).add(gr+"-visual"),Ce(a,l);var s=be("rect");return ie(s,{x:-Oo/2+o.x,y:-Oo/2+o.y,width:Oo,height:Oo}),Ne(s).add(gr+"-hit"),Ce(a,s),mg(a,t,n),a};ni.prototype.createResizer=function(e,t){var n=Nm(e,t),i=this._createResizer(e,n.x,n.y,t);this.makeDraggable(e,i,t)};ni.prototype.addResizer=function(e){var t=this;Ae(e)||!this._resize.canResize({shape:e})||M(CS,function(n){t.createResizer(e,n)})};ni.prototype.removeResizers=function(){var e=this._getResizersParent();bl(e)};ni.prototype._getResizersParent=function(){return this._canvas.getLayer("resizers")};ni.$inject=["eventBus","canvas","selection","resize"];function TS(e){var t={x:0,y:0};return e.indexOf("e")!==-1?t.x=-Io:e.indexOf("w")!==-1&&(t.x=Io),e.indexOf("s")!==-1?t.y=-Io:e.indexOf("n")!==-1&&(t.y=Io),t}const Lm={__depends__:[on,Sn,er],__init__:["resize","resizePreview","resizeHandles"],resize:["type",eo],resizePreview:["type",Om],resizeHandles:["type",ni]};var PS=2e3;function to(e,t,n,i,r,o,a){this._bpmnFactory=t,this._canvas=n,this._modeling=r,this._textRenderer=a,i.registerProvider(this),e.on("element.dblclick",function(s){l(s.element,!0)}),e.on(["autoPlace.start","canvas.viewbox.changing","drag.init","element.mousedown","popupMenu.open","root.set","selection.changed"],function(){i.isActive()&&i.complete()}),e.on(["shape.remove","connection.remove"],PS,function(s){i.isActive(s.element)&&i.cancel()}),e.on(["commandStack.changed"],function(s){i.isActive()&&i.cancel()}),e.on("directEditing.activate",function(s){o.removeResizers()}),e.on("create.end",500,function(s){var c=s.context,p=c.shape,u=s.context.canExecute,d=s.isTouch;d||u&&(c.hints&&c.hints.createElementsBehavior===!1||l(p))}),e.on("autoPlace.end",500,function(s){l(s.shape)});function l(s,c){(c||ve(s,["bpmn:Task","bpmn:TextAnnotation","bpmn:Participant"])||Wc(s))&&i.activate(s)}}to.$inject=["eventBus","bpmnFactory","canvas","directEditing","modeling","resizeHandles","textRenderer"];to.prototype.activate=function(e){var t=Hn(e);if(t!==void 0){var n={text:t},i=this.getEditingBBox(e);L(n,i);var r={};return(ve(e,["bpmn:Task","bpmn:Participant","bpmn:Lane","bpmn:CallActivity"])||Wc(e))&&L(r,{centerVertically:!0}),zi(e)&&L(r,{autoResize:!0}),y(e,"bpmn:TextAnnotation")&&L(r,{resizable:!0,autoResize:!0}),L(n,{options:r}),n}};to.prototype.getEditingBBox=function(e){var t=this._canvas,n=e.label||e,i=t.getAbsoluteBBox(n),r={x:i.x+i.width/2,y:i.y+i.height/2},o={x:i.x,y:i.y},a=t.zoom(),l=this._textRenderer.getDefaultStyle(),s=this._textRenderer.getExternalStyle(),c=s.fontSize*a,p=s.lineHeight,u=l.fontSize*a,d=l.lineHeight,f={fontFamily:this._textRenderer.getDefaultStyle().fontFamily,fontWeight:this._textRenderer.getDefaultStyle().fontWeight};if(y(e,"bpmn:Lane")||kS(e)){var h=gn(e),m=h?{width:i.height,height:30*a,x:i.x-i.height/2+15*a,y:r.y-30*a/2}:{width:i.width,height:30*a};L(o,m),L(f,{fontSize:u+"px",lineHeight:d,paddingTop:7*a+"px",paddingBottom:7*a+"px",paddingLeft:5*a+"px",paddingRight:5*a+"px",transform:h?"rotate(-90deg)":null})}if(DS(e)){var v=gn(e),S=v?{width:i.width,height:i.height}:{width:i.height,height:i.width,x:r.x-i.height/2,y:r.y-i.width/2};L(o,S),L(f,{fontSize:u+"px",lineHeight:d,paddingTop:7*a+"px",paddingBottom:7*a+"px",paddingLeft:5*a+"px",paddingRight:5*a+"px",transform:v?null:"rotate(-90deg)"})}(ve(e,["bpmn:Task","bpmn:CallActivity"])||Wc(e))&&(L(o,{width:i.width,height:i.height}),L(f,{fontSize:u+"px",lineHeight:d,paddingTop:7*a+"px",paddingBottom:7*a+"px",paddingLeft:5*a+"px",paddingRight:5*a+"px"})),RS(e)&&(L(o,{width:i.width,x:i.x}),L(f,{fontSize:u+"px",lineHeight:d,paddingTop:7*a+"px",paddingBottom:7*a+"px",paddingLeft:5*a+"px",paddingRight:5*a+"px"}));var b=90*a,w=7*a,C=4*a;if(n.labelTarget&&(L(o,{width:b,height:i.height+w+C,x:r.x-b/2,y:i.y-w}),L(f,{fontSize:c+"px",lineHeight:p,paddingTop:w+"px",paddingBottom:C+"px"})),zi(n)&&!fa(n)&&!xe(n)){var R=of(e),D=t.getAbsoluteBBox({x:R.x,y:R.y,width:0,height:0}),F=c+w+C;L(o,{width:b,height:F,x:D.x-b/2,y:D.y-F/2}),L(f,{fontSize:c+"px",lineHeight:p,paddingTop:w+"px",paddingBottom:C+"px"})}return y(e,"bpmn:TextAnnotation")&&(L(o,{width:i.width,height:i.height,minWidth:30*a,minHeight:10*a}),L(f,{textAlign:"left",paddingTop:5*a+"px",paddingBottom:7*a+"px",paddingLeft:7*a+"px",paddingRight:5*a+"px",fontSize:u+"px",lineHeight:d})),{bounds:o,style:f}};to.prototype.update=function(e,t,n,i){var r,o;y(e,"bpmn:TextAnnotation")&&(o=this._canvas.getAbsoluteBBox(e),r={x:e.x,y:e.y,width:e.width/o.width*i.width,height:e.height/o.height*i.height}),AS(t)&&(t=null),this._modeling.updateLabel(e,t,r)};function Wc(e){return y(e,"bpmn:SubProcess")&&!Se(e)}function RS(e){return y(e,"bpmn:SubProcess")&&Se(e)}function DS(e){return y(e,"bpmn:Participant")&&!Se(e)}function kS(e){return y(e,"bpmn:Participant")&&Se(e)}function AS(e){return!e||!e.trim()}var _d="djs-element-hidden",bd="djs-label-hidden";function $m(e,t,n){var i=this,r=t.getDefaultLayer(),o,a,l;e.on("directEditing.activate",function(s){var c=s.active;if(o=c.element.label||c.element,y(o,"bpmn:TextAnnotation")){a=t.getAbsoluteBBox(o),l=be("g");var p=n.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:o.width,containerHeight:o.height,position:{mx:0,my:0}}),u=i.path=be("path");ie(u,{d:p,strokeWidth:2,stroke:MS(o)}),Ce(l,u),Ce(r,l),ht(l,o.x,o.y)}y(o,"bpmn:TextAnnotation")||o.labelTarget?t.addMarker(o,_d):(y(o,"bpmn:Task")||y(o,"bpmn:CallActivity")||y(o,"bpmn:SubProcess")||y(o,"bpmn:Participant"))&&t.addMarker(o,bd)}),e.on("directEditing.resize",function(s){if(y(o,"bpmn:TextAnnotation")){var c=s.height,p=s.dy,u=Math.max(o.height/a.height*(c+p),0),d=n.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:o.width,containerHeight:u,position:{mx:0,my:0}});ie(i.path,{d})}}),e.on(["directEditing.complete","directEditing.cancel"],function(s){var c=s.active;c&&(t.removeMarker(c.element.label||c.element,_d),t.removeMarker(o,bd)),o=void 0,a=void 0,l&&(rt(l),l=void 0)})}$m.$inject=["eventBus","canvas","pathMap"];function MS(e,t){var n=Me(e);return n.get("stroke")||t||"black"}const IS={__depends__:[af,Lm,Tm],__init__:["labelEditingProvider","labelEditingPreview"],labelEditingProvider:["type",to],labelEditingPreview:["type",$m]};var NS=new vg("tt");function OS(e){var t=ot('<div class="djs-tooltip-container" />');return ma(t,{position:"absolute",width:"0",height:"0"}),e.insertBefore(t,e.firstChild),t}function LS(e,t,n){ma(e,{left:t+"px",top:n+"px"})}function Yc(e,t){e.style.display=t===!1?"none":""}var Bm="djs-tooltip",Rs="."+Bm;function wt(e,t){this._eventBus=e,this._canvas=t,this._ids=NS,this._tooltipDefaults={show:{minZoom:.7,maxZoom:5}},this._tooltips={},this._tooltipRoot=OS(t.getContainer());var n=this;Rt.bind(this._tooltipRoot,Rs,"mousedown",function(i){i.stopPropagation()}),Rt.bind(this._tooltipRoot,Rs,"mouseover",function(i){n.trigger("mouseover",i)}),Rt.bind(this._tooltipRoot,Rs,"mouseout",function(i){n.trigger("mouseout",i)}),this._init()}wt.$inject=["eventBus","canvas"];wt.prototype.add=function(e){if(!e.position)throw new Error("must specifiy tooltip position");if(!e.html)throw new Error("must specifiy tooltip html");var t=this._ids.next();return e=L({},this._tooltipDefaults,e,{id:t}),this._addTooltip(e),e.timeout&&this.setTimeout(e),t};wt.prototype.trigger=function(e,t){var n=t.delegateTarget||t.target,i=this.get(_t(n,"data-tooltip-id"));i&&(e==="mouseover"&&i.timeout&&this.clearTimeout(i),e==="mouseout"&&i.timeout&&(i.timeout=1e3,this.setTimeout(i)))};wt.prototype.get=function(e){return typeof e!="string"&&(e=e.id),this._tooltips[e]};wt.prototype.clearTimeout=function(e){if(e=this.get(e),!!e){var t=e.removeTimer;t&&(clearTimeout(t),e.removeTimer=null)}};wt.prototype.setTimeout=function(e){if(e=this.get(e),!!e){this.clearTimeout(e);var t=this;e.removeTimer=setTimeout(function(){t.remove(e)},e.timeout)}};wt.prototype.remove=function(e){var t=this.get(e);t&&(Hi(t.html),Hi(t.htmlContainer),delete t.htmlContainer,delete this._tooltips[t.id])};wt.prototype.show=function(){Yc(this._tooltipRoot)};wt.prototype.hide=function(){Yc(this._tooltipRoot,!1)};wt.prototype._updateRoot=function(e){var t=e.scale||1,n=e.scale||1,i="matrix("+t+",0,0,"+n+","+-1*e.x*t+","+-1*e.y*n+")";this._tooltipRoot.style.transform=i,this._tooltipRoot.style["-ms-transform"]=i};wt.prototype._addTooltip=function(e){var t=e.id,n=e.html,i,r=this._tooltipRoot;n.get&&n.constructor.prototype.jquery&&(n=n.get(0)),pa(n)&&(n=ot(n)),i=ot('<div data-tooltip-id="'+t+'" class="'+Bm+'">'),ma(i,{position:"absolute"}),i.appendChild(n),e.type&&Et(i).add("djs-tooltip-"+e.type),e.className&&Et(i).add(e.className),e.htmlContainer=i,r.appendChild(i),this._tooltips[t]=e,this._updateTooltip(e)};wt.prototype._updateTooltip=function(e){var t=e.position,n=e.htmlContainer;LS(n,t.x,t.y)};wt.prototype._updateTooltipVisibilty=function(e){M(this._tooltips,function(t){var n=t.show,i=t.htmlContainer,r=!0;n&&((n.minZoom>e.scale||n.maxZoom<e.scale)&&(r=!1),Yc(i,r))})};wt.prototype._init=function(){var e=this;function t(n){e._updateRoot(n),e._updateTooltipVisibilty(n),e.show()}this._eventBus.on("canvas.viewbox.changing",function(n){e.hide()}),this._eventBus.on("canvas.viewbox.changed",function(n){t(n.viewbox)})};const $S={__init__:["tooltips"],tooltips:["type",wt]};var BS="flow elements must be children of pools/participants";function jm(e,t,n){function i(r,o,a){t.add({position:{x:r.x+5,y:r.y+5},type:"error",timeout:2e3,html:"<div>"+o+"</div>"})}e.on(["shape.move.rejected","create.rejected"],function(r){var o=r.context,a=o.shape,l=o.target;y(l,"bpmn:Collaboration")&&y(a,"bpmn:FlowNode")&&i(r,n(BS))})}jm.$inject=["eventBus","tooltips","translate"];const jS={__depends__:[$S],__init__:["modelingFeedback"],modelingFeedback:["type",jm]};var VS=500,FS=1250,HS=1500,aa=Math.round;function zS(e){return{x:e.x+aa(e.width/2),y:e.y+aa(e.height/2)}}function Vm(e,t,n,i,r){function o(l,s,c,p){return r.allowed("elements.move",{shapes:l,delta:s,position:c,target:p})}e.on("shape.move.start",HS,function(l){var s=l.context,c=l.shape,p=i.get().slice();p.indexOf(c)===-1&&(p=[c]),p=US(p),L(s,{shapes:p,validatedShapes:p,shape:c})}),e.on("shape.move.start",FS,function(l){var s=l.context,c=s.validatedShapes,p;if(p=s.canExecute=o(c),!p)return!1}),e.on("shape.move.move",VS,function(l){var s=l.context,c=s.validatedShapes,p=l.hover,u={x:l.dx,y:l.dy},d={x:l.x,y:l.y},f;if(f=o(c,u,d,p),s.delta=u,s.canExecute=f,f===null){s.target=null;return}s.target=p}),e.on("shape.move.end",function(l){var s=l.context,c=s.delta,p=s.canExecute,u=p==="attach",d=s.shapes;if(p===!1)return!1;c.x=aa(c.x),c.y=aa(c.y),!(c.x===0&&c.y===0)&&n.moveElements(d,c,s.target,{primaryShape:s.shape,attach:u})}),e.on("element.mousedown",function(l){if(_l(l)){var s=Kd(l);if(!s)throw new Error("must supply DOM mousedown event");return a(s,l.element)}});function a(l,s,c,p){if(vn(c)&&(p=c,c=!1),!(s.waypoints||!s.parent)&&!Ne(l.target).has("djs-hit-no-move")){var u=zS(s);return t.init(l,u,"shape.move",{cursor:"grabbing",autoActivate:c,data:{shape:s,context:p||{}}}),!0}}this.start=a}Vm.$inject=["eventBus","dragging","modeling","selection","rules"];function US(e){var t=da(e,"id");return _e(e,function(n){for(;n=n.parent;)if(t[n.id])return!1;return!0})}var Ed=499,Ds="djs-dragging",xd="drop-ok",wd="drop-not-ok",Sd="new-parent",Cd="attach-ok";function Fm(e,t,n,i){function r(s){var c=o(s),p=GS(c);return p}function o(s){var c=Nr(s,!0),p=bt(c,function(u){return(u.incoming||[]).concat(u.outgoing||[])});return qo(c.concat(p))}function a(s,c){[Cd,xd,wd,Sd].forEach(function(p){p===c?t.addMarker(s,p):t.removeMarker(s,p)})}function l(s,c,p){i.addDragger(c,s.dragGroup),p&&t.addMarker(c,Ds),s.allDraggedElements?s.allDraggedElements.push(c):s.allDraggedElements=[c]}e.on("shape.move.start",Ed,function(s){var c=s.context,p=c.shapes,u=c.allDraggedElements,d=r(p);if(!c.dragGroup){var f=be("g");ie(f,n.cls("djs-drag-group",["no-events"]));var h=t.getActiveLayer();Ce(h,f),c.dragGroup=f}d.forEach(function(m){i.addDragger(m,c.dragGroup)}),u?u=qo([u,o(p)]):u=o(p),M(u,function(m){t.addMarker(m,Ds)}),c.allDraggedElements=u,c.differentParents=WS(p)}),e.on("shape.move.move",Ed,function(s){var c=s.context,p=c.dragGroup,u=c.target,d=c.shape.parent,f=c.canExecute;u&&(f==="attach"?a(u,Cd):c.canExecute&&u&&u.id!==d.id?a(u,Sd):a(u,c.canExecute?xd:wd)),ht(p,s.dx,s.dy)}),e.on(["shape.move.out","shape.move.cleanup"],function(s){var c=s.context,p=c.target;p&&a(p,null)}),e.on("shape.move.cleanup",function(s){var c=s.context,p=c.allDraggedElements,u=c.dragGroup;M(p,function(d){t.removeMarker(d,Ds)}),u&&rt(u)}),this.makeDraggable=l}Fm.$inject=["eventBus","canvas","styles","previewSupport"];function GS(e){var t=_e(e,function(n){return Ae(n)?Oe(e,dn({id:n.source.id}))&&Oe(e,dn({id:n.target.id})):!0});return t}function WS(e){return gg(da(e,function(t){return t.parent&&t.parent.id}))!==1}const YS={__depends__:[ml,En,sf,on,Sn,er],__init__:["move","movePreview"],move:["type",Vm],movePreview:["type",Fm]},qS="M44.7648 11.3263L36.9892 2.64074C36.0451 1.58628 34.5651 0.988708 33.1904 0.988708H5.98667C3.22688 0.988708 0.989624 3.34892 0.989624 6.26039V55.0235C0.989624 57.9349 3.22688 60.2952 5.98667 60.2952H40.966C43.7257 60.2952 45.963 57.9349 45.963 55.0235V14.9459C45.963 13.5998 45.6407 12.3048 44.7648 11.3263Z",KS="M1.03845 48.1347C1.03845 49.3511 1.07295 50.758 1.38342 52.064C1.69949 53.3938 2.32428 54.7154 3.56383 55.6428C6.02533 57.4841 10.1161 58.7685 14.8212 59.6067C19.5772 60.4538 25.1388 60.8738 30.6831 60.8738C36.2276 60.8738 41.7891 60.4538 46.545 59.6067C51.2504 58.7687 55.3412 57.4842 57.8028 55.6429C59.0424 54.7156 59.6673 53.3938 59.9834 52.064C60.2938 50.7579 60.3285 49.351 60.3285 48.1344V13.8415C60.3285 12.6249 60.2938 11.218 59.9834 9.91171C59.6673 8.58194 59.0423 7.2602 57.8027 6.33294C55.341 4.49168 51.2503 3.20723 46.545 2.36914C41.7891 1.522 36.2276 1.10204 30.6831 1.10205C25.1388 1.10206 19.5772 1.52206 14.8213 2.36923C10.1162 3.20734 6.02543 4.49183 3.5639 6.33314C2.32433 7.26038 1.69951 8.58206 1.38343 9.91181C1.07295 11.2179 1.03845 12.6247 1.03845 13.8411V48.1347Z",XS={width:36,height:50},ZS={width:50,height:50};function Td(e,t,n){return be("path",{d:e,strokeWidth:2,transform:`translate(${t.x}, ${t.y})`,...n})}const $n=5;function Qa(e,t){this._styles=t,e.registerProvider(this)}Qa.$inject=["outline","styles"];Qa.prototype.getOutline=function(e){const t=this._styles.cls("djs-outline",["no-fill"]);var n;if(!xe(e))return y(e,"bpmn:Gateway")?(n=be("rect"),L(n.style,{"transform-box":"fill-box",transform:"rotate(45deg)","transform-origin":"center"}),ie(n,L({x:2,y:2,rx:4,width:e.width-4,height:e.height-4},t))):ve(e,["bpmn:Task","bpmn:SubProcess","bpmn:Group"])?(n=be("rect"),ie(n,L({x:-$n,y:-$n,rx:14,width:e.width+$n*2,height:e.height+$n*2},t))):y(e,"bpmn:EndEvent")?(n=be("circle"),ie(n,L({cx:e.width/2,cy:e.height/2,r:e.width/2+$n+1},t))):y(e,"bpmn:Event")?(n=be("circle"),ie(n,L({cx:e.width/2,cy:e.height/2,r:e.width/2+$n},t))):y(e,"bpmn:DataObjectReference")&&Pd(e,"bpmn:DataObjectReference")?n=Td(qS,{x:-6,y:-6},t):y(e,"bpmn:DataStoreReference")&&Pd(e,"bpmn:DataStoreReference")&&(n=Td(KS,{x:-6,y:-6},t)),n};Qa.prototype.updateOutline=function(e,t){if(!xe(e))return ve(e,["bpmn:SubProcess","bpmn:Group"])?(ie(t,{width:e.width+$n*2,height:e.height+$n*2}),!0):!!ve(e,["bpmn:Event","bpmn:Gateway","bpmn:DataStoreReference","bpmn:DataObjectReference"])};function Pd(e,t){var n;return t==="bpmn:DataObjectReference"?n=XS:t==="bpmn:DataStoreReference"&&(n=ZS),e.width===n.width&&e.height===n.height}const QS={__depends__:[sf],__init__:["outlineProvider"],outlineProvider:["type",Qa]};var Hm=".djs-palette-toggle",zm=".entry",JS=Hm+", "+zm,al="djs-palette-",e1="shown",sl="open",Rd="two-column",t1=1e3;function We(e,t){this._eventBus=e,this._canvas=t;var n=this;e.on("tool-manager.update",function(i){var r=i.tool;n.updateToolHighlight(r)}),e.on("i18n.changed",function(){n._update()}),e.on("diagram.init",function(){n._diagramInitialized=!0,n._rebuild()})}We.$inject=["eventBus","canvas"];We.prototype.registerProvider=function(e,t){t||(t=e,e=t1),this._eventBus.on("palette.getProviders",e,function(n){n.providers.push(t)}),this._rebuild()};We.prototype.getEntries=function(){var e=this._getProviders();return e.reduce(i1,{})};We.prototype._rebuild=function(){if(this._diagramInitialized){var e=this._getProviders();e.length&&(this._container||this._init(),this._update())}};We.prototype._init=function(){var e=this,t=this._eventBus,n=this._getParentContainer(),i=this._container=ot(We.HTML_MARKUP);n.appendChild(i),Et(n).add(al+e1),Rt.bind(i,JS,"click",function(r){var o=r.delegateTarget;if(hl(o,Hm))return e.toggle();e.trigger("click",r)}),ce.bind(i,"mousedown",function(r){r.stopPropagation()}),Rt.bind(i,zm,"dragstart",function(r){e.trigger("dragstart",r)}),t.on("canvas.resized",this._layoutChanged,this),t.fire("palette.create",{container:i})};We.prototype._getProviders=function(e){var t=this._eventBus.createEvent({type:"palette.getProviders",providers:[]});return this._eventBus.fire(t),t.providers};We.prototype._toggleState=function(e){e=e||{};var t=this._getParentContainer(),n=this._container,i=this._eventBus,r,o=Et(n),a=Et(t);"twoColumn"in e?r=e.twoColumn:r=this._needsCollapse(t.clientHeight,this._entries||{}),o.toggle(Rd,r),a.toggle(al+Rd,r),"open"in e&&(o.toggle(sl,e.open),a.toggle(al+sl,e.open)),i.fire("palette.changed",{twoColumn:r,open:this.isOpen()})};We.prototype._update=function(){var e=nt(".djs-palette-entries",this._container),t=this._entries=this.getEntries();lf(e),M(t,function(n,i){var r=n.group||"default",o=nt("[data-group="+Sr(r)+"]",e);o||(o=ot('<div class="group"></div>'),_t(o,"data-group",r),e.appendChild(o));var a=n.html||(n.separator?'<hr class="separator" />':'<div class="entry" draggable="true"></div>'),l=ot(a);if(o.appendChild(l),!n.separator&&(_t(l,"data-action",i),n.title&&_t(l,"title",n.title),n.className&&n1(l,n.className),n.imageUrl)){var s=ot("<img>");_t(s,"src",n.imageUrl),l.appendChild(s)}}),this.open()};We.prototype.trigger=function(e,t,n){var i,r,o=t.delegateTarget||t.target;return o?(i=_t(o,"data-action"),r=t.originalEvent||t,this.triggerEntry(i,e,r,n)):t.preventDefault()};We.prototype.triggerEntry=function(e,t,n,i){var r=this._entries,o,a;if(o=r[e],!!o&&(a=o.action,this._eventBus.fire("palette.trigger",{entry:o,event:n})!==!1)){if(en(a)){if(t==="click")return a(n,i)}else if(a[t])return a[t](n,i);n.preventDefault()}};We.prototype._layoutChanged=function(){this._toggleState({})};We.prototype._needsCollapse=function(e,t){var n=50,i=Object.keys(t).length*46;return e<i+n};We.prototype.close=function(){this._toggleState({open:!1,twoColumn:!1})};We.prototype.open=function(){this._toggleState({open:!0})};We.prototype.toggle=function(){this.isOpen()?this.close():this.open()};We.prototype.isActiveTool=function(e){return e&&this._activeTool===e};We.prototype.updateToolHighlight=function(e){var t,n;this._toolsContainer||(t=nt(".djs-palette-entries",this._container),this._toolsContainer=nt("[data-group=tools]",t)),n=this._toolsContainer,M(n.children,function(i){var r=i.getAttribute("data-action");if(r){var o=Et(i);r=r.replace("-tool",""),o.contains("entry")&&r===e?o.add("highlighted-entry"):o.remove("highlighted-entry")}})};We.prototype.isOpen=function(){return Et(this._container).has(sl)};We.prototype._getParentContainer=function(){return this._canvas.getContainer()};We.HTML_MARKUP='<div class="djs-palette"><div class="djs-palette-entries"></div><div class="djs-palette-toggle"></div></div>';function n1(e,t){var n=Et(e),i=Te(t)?t:t.split(/\s+/g);i.forEach(function(r){n.add(r)})}function i1(e,t){var n=t.getPaletteEntries();return en(n)?n(e):(M(n,function(i,r){e[r]=i}),e)}const r1={__init__:["palette"],palette:["type",We]};var Um="crosshair";function Ri(e,t,n,i,r,o,a){this._selection=r,this._dragging=n,this._mouse=a;var l=this,s={create:function(c){var p=t.getActiveLayer(),u;u=c.frame=be("rect"),ie(u,{class:"djs-lasso-overlay",width:1,height:1,x:0,y:0}),Ce(p,u)},update:function(c){var p=c.frame,u=c.bbox;ie(p,{x:u.x,y:u.y,width:u.width,height:u.height})},remove:function(c){c.frame&&rt(c.frame)}};o.registerTool("lasso",{tool:"lasso.selection",dragging:"lasso"}),e.on("lasso.selection.end",function(c){var p=c.originalEvent.target;!c.hover&&!(p instanceof SVGElement)||e.once("lasso.selection.ended",function(){l.activateLasso(c.originalEvent,!0)})}),e.on("lasso.end",function(c){var p=ks(c),u=i.filter(function(d){return d});l.select(u,p)}),e.on("lasso.start",function(c){var p=c.context;p.bbox=ks(c),s.create(p)}),e.on("lasso.move",function(c){var p=c.context;p.bbox=ks(c),s.update(p)}),e.on("lasso.cleanup",function(c){var p=c.context;s.remove(p)}),e.on("element.mousedown",1500,function(c){if(rf(c))return l.activateLasso(c.originalEvent),!0})}Ri.$inject=["eventBus","canvas","dragging","elementRegistry","selection","toolManager","mouse"];Ri.prototype.activateLasso=function(e,t){this._dragging.init(e,"lasso",{autoActivate:t,cursor:Um,data:{context:{}}})};Ri.prototype.activateSelection=function(e,t){this._dragging.init(e,"lasso.selection",{trapClick:!1,autoActivate:t,cursor:Um,data:{context:{}}})};Ri.prototype.select=function(e,t){var n=yg(e,t);this._selection.select(gl(n))};Ri.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateSelection(e,!!e)};Ri.prototype.isActive=function(){var e=this._dragging.context();return e&&/^lasso/.test(e.prefix)};function ks(e){var t={x:e.x-e.dx,y:e.y-e.dy},n={x:e.x,y:e.y},i;return t.x<=n.x&&t.y<n.y||t.x<n.x&&t.y<=n.y?i={x:t.x,y:t.y,width:n.x-t.x,height:n.y-t.y}:t.x>=n.x&&t.y<n.y||t.x>n.x&&t.y<=n.y?i={x:n.x,y:t.y,width:t.x-n.x,height:n.y-t.y}:t.x<=n.x&&t.y>n.y||t.x<n.x&&t.y>=n.y?i={x:t.x,y:n.y,width:n.x-t.x,height:t.y-n.y}:t.x>=n.x&&t.y>n.y||t.x>n.x&&t.y>=n.y?i={x:n.x,y:n.y,width:t.x-n.x,height:t.y-n.y}:i={x:n.x,y:n.y,width:0,height:0},i}const o1={__depends__:[Oa,Vr],__init__:["lassoTool"],lassoTool:["type",Ri]};var As=1500,Gm="grab";function nr(e,t,n,i,r,o){this._dragging=n,this._mouse=o;var a=this,l=i.get("keyboard",!1);r.registerTool("hand",{tool:"hand",dragging:"hand.move"}),e.on("element.mousedown",As,function(s){if(Tr(s))return a.activateMove(s.originalEvent,!0),!1}),l&&l.addListener(As,function(s){if(!(!Dd(s.keyEvent)||a.isActive())){var c=a._mouse.getLastMoveEvent();a.activateMove(c,!!c)}},"keyboard.keydown"),l&&l.addListener(As,function(s){!Dd(s.keyEvent)||!a.isActive()||a.toggle()},"keyboard.keyup"),e.on("hand.end",function(s){var c=s.originalEvent.target;if(!s.hover&&!(c instanceof SVGElement))return!1;e.once("hand.ended",function(){a.activateMove(s.originalEvent,{reactivate:!0})})}),e.on("hand.move.move",function(s){var c=t.viewbox().scale;t.scroll({dx:s.dx*c,dy:s.dy*c})}),e.on("hand.move.end",function(s){var c=s.context,p=c.reactivate;return!Tr(s)&&p&&e.once("hand.move.ended",function(u){a.activateHand(u.originalEvent,!0,!0)}),!1})}nr.$inject=["eventBus","canvas","dragging","injector","toolManager","mouse"];nr.prototype.activateMove=function(e,t,n){typeof t=="object"&&(n=t,t=!1),this._dragging.init(e,"hand.move",{autoActivate:t,cursor:Gm,data:{context:n||{}}})};nr.prototype.activateHand=function(e,t,n){this._dragging.init(e,"hand",{trapClick:!1,autoActivate:t,cursor:Gm,data:{context:{reactivate:n}}})};nr.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateHand(e,!!e)};nr.prototype.isActive=function(){var e=this._dragging.context();return e?/^(hand|hand\.move)$/.test(e.prefix):!1};function Dd(e){return tt("Space",e)}const a1={__depends__:[Oa,Vr],__init__:["handTool"],handTool:["type",nr]};var kd="connect-ok",Ad="connect-not-ok";function ir(e,t,n,i,r,o,a){var l=this;this._dragging=t,this._rules=o,this._mouse=a,r.registerTool("global-connect",{tool:"global-connect",dragging:"global-connect.drag"}),e.on("global-connect.hover",function(s){var c=s.context,p=s.hover,u=c.canStartConnect=l.canStartConnect(p);u!==null&&(c.startTarget=p,i.addMarker(p,u?kd:Ad))}),e.on(["global-connect.out","global-connect.cleanup"],function(s){var c=s.context.startTarget,p=s.context.canStartConnect;c&&i.removeMarker(c,p?kd:Ad)}),e.on(["global-connect.ended"],function(s){var c=s.context,p=c.startTarget,u={x:s.x,y:s.y},d=l.canStartConnect(p);if(d)return e.once("element.out",function(){e.once(["connect.ended","connect.canceled"],function(){e.fire("global-connect.drag.ended")}),n.start(null,p,u)}),!1})}ir.$inject=["eventBus","dragging","connect","canvas","toolManager","rules","mouse"];ir.prototype.start=function(e,t){this._dragging.init(e,"global-connect",{autoActivate:t,trapClick:!1,data:{context:{}}})};ir.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();return this.start(e,!!e)};ir.prototype.isActive=function(){var e=this._dragging.context();return e&&/^global-connect/.test(e.prefix)};ir.prototype.canStartConnect=function(e){return this._rules.allowed("connection.start",{source:e})};const s1={__depends__:[Fl,on,Sn,Oa,Vr],globalConnect:["type",ir]};function Ja(e,t,n,i,r,o,a,l){this._palette=e,this._create=t,this._elementFactory=n,this._spaceTool=i,this._lassoTool=r,this._handTool=o,this._globalConnect=a,this._translate=l,e.registerProvider(this)}Ja.$inject=["palette","create","elementFactory","spaceTool","lassoTool","handTool","globalConnect","translate"];Ja.prototype.getPaletteEntries=function(){var e={},t=this._create,n=this._elementFactory,i=this._spaceTool,r=this._lassoTool,o=this._handTool,a=this._globalConnect,l=this._translate;function s(u,d,f,h,m){function v(S){var b=n.createShape(L({type:u},m));t.start(S,b)}return{group:d,className:f,title:h,action:{dragstart:v,click:v}}}function c(u){var d=n.createShape({type:"bpmn:SubProcess",x:0,y:0,isExpanded:!0}),f=n.createShape({type:"bpmn:StartEvent",x:40,y:82,parent:d});t.start(u,[d,f],{hints:{autoSelect:[d]}})}function p(u){t.start(u,n.createParticipantShape())}return L(e,{"hand-tool":{group:"tools",className:"bpmn-icon-hand-tool",title:l("Activate hand tool"),action:{click:function(u){o.activateHand(u)}}},"lasso-tool":{group:"tools",className:"bpmn-icon-lasso-tool",title:l("Activate lasso tool"),action:{click:function(u){r.activateSelection(u)}}},"space-tool":{group:"tools",className:"bpmn-icon-space-tool",title:l("Activate create/remove space tool"),action:{click:function(u){i.activateSelection(u)}}},"global-connect-tool":{group:"tools",className:"bpmn-icon-connection-multi",title:l("Activate global connect tool"),action:{click:function(u){a.start(u)}}},"tool-separator":{group:"tools",separator:!0},"create.start-event":s("bpmn:StartEvent","event","bpmn-icon-start-event-none",l("Create start event")),"create.intermediate-event":s("bpmn:IntermediateThrowEvent","event","bpmn-icon-intermediate-event-none",l("Create intermediate/boundary event")),"create.end-event":s("bpmn:EndEvent","event","bpmn-icon-end-event-none",l("Create end event")),"create.exclusive-gateway":s("bpmn:ExclusiveGateway","gateway","bpmn-icon-gateway-none",l("Create gateway"),{isMarkerVisible:!0}),"create.task":s("bpmn:Task","activity","bpmn-icon-task",l("Create task")),"create.data-object":s("bpmn:DataObjectReference","data-object","bpmn-icon-data-object",l("Create data object reference")),"create.data-store":s("bpmn:DataStoreReference","data-store","bpmn-icon-data-store",l("Create data store reference")),"create.subprocess-expanded":{group:"activity",className:"bpmn-icon-subprocess-expanded",title:l("Create expanded sub-process"),action:{dragstart:c,click:c}},"create.participant-expanded":{group:"collaboration",className:"bpmn-icon-participant",title:l("Create pool/participant"),action:{dragstart:p,click:p}},"create.group":s("bpmn:Group","artifact","bpmn-icon-group",l("Create group"))}),e};const l1={__depends__:[r1,Na,om,o1,a1,s1,tf],__init__:["paletteProvider"],paletteProvider:["type",Ja]};var c1=250;function qc(e,t,n,i,r){Y.call(this,e);function o(l){var s=l.canExecute.replacements;M(s,function(c){var p=c.oldElementId,u={type:c.newElementType};if(!l.visualReplacements[p]){var d=t.get(p);L(u,{x:d.x,y:d.y});var f=n.createShape(u);i.addShape(f,d.parent);var h=nt('[data-element-id="'+Sr(d.id)+'"]',l.dragGroup);h&&ie(h,{display:"none"});var m=r.addDragger(f,l.dragGroup);l.visualReplacements[p]=m,i.removeShape(f)}})}function a(l){var s=l.visualReplacements;M(s,function(c,p){var u=nt('[data-element-id="'+Sr(p)+'"]',l.dragGroup);u&&ie(u,{display:"inline"}),c.remove(),s[p]&&delete s[p]})}e.on("shape.move.move",c1,function(l){var s=l.context,c=s.canExecute;s.visualReplacements||(s.visualReplacements={}),c&&c.replacements?o(s):a(s)})}qc.$inject=["eventBus","elementRegistry","elementFactory","canvas","previewSupport"];te(qc,Y);const u1={__depends__:[er],__init__:["bpmnReplacePreview"],bpmnReplacePreview:["type",qc]};var p1=1250,Ms=40,d1=20,f1=10,Md=20,Wm=["x","y"],h1=Math.abs;function Ym(e){e.on(["connect.hover","connect.move","connect.end"],p1,function(t){var n=t.context,i=n.canExecute,r=n.start,o=n.hover,a=n.source,l=n.target;t.originalEvent&&Dt(t.originalEvent)||(n.initialConnectionStart||(n.initialConnectionStart=n.connectionStart),i&&o&&m1(t,o,_1(o)),o&&y1(i,["bpmn:Association","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:SequenceFlow"])?(n.connectionStart=Nt(r),ve(o,["bpmn:Event","bpmn:Gateway"])&&Id(t,Nt(o)),ve(o,["bpmn:Task","bpmn:SubProcess"])&&v1(t,o),y(a,"bpmn:BoundaryEvent")&&l===a.host&&g1(t)):qm(i,"bpmn:MessageFlow")?(y(r,"bpmn:Event")&&(n.connectionStart=Nt(r)),y(o,"bpmn:Event")&&Id(t,Nt(o))):n.connectionStart=n.initialConnectionStart)})}Ym.$inject=["eventBus"];function m1(e,t,n){Wm.forEach(function(i){var r=Km(i,t);e[i]<t[i]+n?Ge(e,i,t[i]+n):e[i]>t[i]+r-n&&Ge(e,i,t[i]+r-n)})}function v1(e,t){var n=Nt(t);Wm.forEach(function(i){b1(e,t,i)&&Ge(e,i,n[i])})}function g1(e){var t=e.context,n=t.source,i=t.target;if(!E1(t)){var r=Nt(n),o=pt(r,i,-10),a=[];/top|bottom/.test(o)&&a.push("x"),/left|right/.test(o)&&a.push("y"),a.forEach(function(l){var s=e[l],c;h1(s-r[l])<Ms&&(s>r[l]?c=r[l]+Ms:c=r[l]-Ms,Ge(e,l,c))})}}function Id(e,t){Ge(e,"x",t.x),Ge(e,"y",t.y)}function qm(e,t){return e&&e.type===t}function y1(e,t){return Ki(t,function(n){return qm(e,n)})}function Km(e,t){return e==="x"?t.width:t.height}function _1(e){return y(e,"bpmn:Task")?f1:d1}function b1(e,t,n){return e[n]>t[n]+Md&&e[n]<t[n]+Km(n,t)-Md}function E1(e){var t=e.hover,n=e.source;return t&&n&&t===n}function ii(){this._targets={},this._snapOrigins={},this._snapLocations=[],this._defaultSnaps={}}ii.prototype.getSnapOrigin=function(e){return this._snapOrigins[e]};ii.prototype.setSnapOrigin=function(e,t){this._snapOrigins[e]=t,this._snapLocations.indexOf(e)===-1&&this._snapLocations.push(e)};ii.prototype.addDefaultSnap=function(e,t){var n=this._defaultSnaps[e];n||(n=this._defaultSnaps[e]=[]),n.push(t)};ii.prototype.getSnapLocations=function(){return this._snapLocations};ii.prototype.setSnapLocations=function(e){this._snapLocations=e};ii.prototype.pointsForTarget=function(e){var t=e.id||e,n=this._targets[t];return n||(n=this._targets[t]=new es,n.initDefaults(this._defaultSnaps)),n};function es(){this._snapValues={}}es.prototype.add=function(e,t){var n=this._snapValues[e];n||(n=this._snapValues[e]={x:[],y:[]}),n.x.indexOf(t.x)===-1&&n.x.push(t.x),n.y.indexOf(t.y)===-1&&n.y.push(t.y)};es.prototype.snap=function(e,t,n,i){var r=this._snapValues[t];return r&&Cb(e[n],r[n],i)};es.prototype.initDefaults=function(e){var t=this;M(e||{},function(n,i){M(n,function(r){t.add(i,r)})})};var x1=1250;function an(e,t,n){var i=this;this._elementRegistry=e,t.on(["create.start","shape.move.start"],function(r){i.initSnap(r)}),t.on(["create.move","create.end","shape.move.move","shape.move.end"],x1,function(r){var o=r.context,a=o.shape,l=o.snapContext,s=o.target;if(!(r.originalEvent&&Dt(r.originalEvent))&&!(Wi(r)||!s)){var c=l.pointsForTarget(s);c.initialized||(c=i.addSnapTargetPoints(c,a,s),c.initialized=!0),n.snap(r,c)}}),t.on(["create.cleanup","shape.move.cleanup"],function(){n.hide()})}an.$inject=["elementRegistry","eventBus","snapping"];an.prototype.initSnap=function(e){var t=this._elementRegistry,n=e.context,i=n.shape,r=n.snapContext;r||(r=n.snapContext=new ii);var o;t.get(i.id)?o=Nt(i,e):o={x:e.x+Nt(i).x,y:e.y+Nt(i).y};var a={x:o.x-i.width/2,y:o.y-i.height/2},l={x:o.x+i.width/2,y:o.y+i.height/2};return r.setSnapOrigin("mid",{x:o.x-e.x,y:o.y-e.y}),xe(i)||(r.setSnapOrigin("top-left",{x:a.x-e.x,y:a.y-e.y}),r.setSnapOrigin("bottom-right",{x:l.x-e.x,y:l.y-e.y})),r};an.prototype.addSnapTargetPoints=function(e,t,n){var i=this.getSnapTargets(t,n);return M(i,function(r){if(xe(r)){xe(t)&&e.add("mid",Nt(r));return}if(Ae(r)){if(r.waypoints.length<3)return;var o=r.waypoints.slice(1,-1);M(o,function(a){e.add("mid",a)});return}e.add("mid",Nt(r))}),!ye(t.x)||!ye(t.y)||this._elementRegistry.get(t.id)&&e.add("mid",Nt(t)),e};an.prototype.getSnapTargets=function(e,t){return lh(t).filter(function(n){return!w1(n)})};function w1(e){return!!e.hidden}var Nd=1500;function rr(e,t){t.invoke(an,this),e.on(["create.move","create.end"],Nd,P1),e.on(["create.move","create.end","shape.move.move","shape.move.end"],Nd,function(n){var i=n.context,r=i.canExecute,o=i.target,a=r&&(r==="attach"||r.attach);a&&!Wi(n)&&S1(n,o)})}te(rr,an);rr.$inject=["eventBus","injector"];rr.prototype.initSnap=function(e){var t=an.prototype.initSnap.call(this,e),n=e.shape,i=!!this._elementRegistry.get(n.id);return M(n.outgoing,function(r){var o=r.waypoints[0];o=o.original||o,t.setSnapOrigin(r.id+"-docking",Ld(o,i,e))}),M(n.incoming,function(r){var o=r.waypoints[r.waypoints.length-1];o=o.original||o,t.setSnapOrigin(r.id+"-docking",Ld(o,i,e))}),y(n,"bpmn:Participant")&&t.setSnapLocations(["top-left","bottom-right","mid"]),t};rr.prototype.addSnapTargetPoints=function(e,t,n){an.prototype.addSnapTargetPoints.call(this,e,t,n);var i=this.getSnapTargets(t,n);M(i,function(o){(T1(o)||C1([t,o],"bpmn:TextAnnotation"))&&(e.add("top-left",ah(o)),e.add("bottom-right",sh(o)))});var r=this._elementRegistry;return M(t.incoming,function(o){if(r.get(t.id)){Od(i,o.source)||e.add("mid",de(o.source));var a=o.waypoints[0];e.add(o.id+"-docking",a.original||a)}}),M(t.outgoing,function(o){if(r.get(t.id)){Od(i,o.target)||e.add("mid",de(o.target));var a=o.waypoints[o.waypoints.length-1];e.add(o.id+"-docking",a.original||a)}}),y(n,"bpmn:SequenceFlow")&&(e=this.addSnapTargetPoints(e,t,n.parent)),e};rr.prototype.getSnapTargets=function(e,t){return an.prototype.getSnapTargets.call(this,e,t).filter(function(n){return!y(n,"bpmn:Lane")})};function S1(e,t){var n=ae(t),i=Nh(e,t),r=e.context,o=r.shape,a;o.parent?a={x:0,y:0}:a=de(o),/top/.test(i)?Ge(e,"y",n.top-a.y):/bottom/.test(i)&&Ge(e,"y",n.bottom-a.y),/left/.test(i)?Ge(e,"x",n.left-a.x):/right/.test(i)&&Ge(e,"x",n.right-a.x)}function C1(e,t){return e.every(function(n){return y(n,t)})}function T1(e){return y(e,"bpmn:SubProcess")&&Se(e)?!0:y(e,"bpmn:Participant")}function P1(e){var t=e.context,n=t.createConstraints;if(n){var i=n.top,r=n.right,o=n.bottom,a=n.left;(a&&a>=e.x||r&&r<=e.x)&&Ge(e,"x",e.x),(i&&i>=e.y||o&&o<=e.y)&&Ge(e,"y",e.y)}}function Od(e,t){return e.indexOf(t)!==-1}function Ld(e,t,n){return t?{x:e.x-n.x,y:e.y-n.y}:{x:e.x,y:e.y}}var R1=1250;function no(e,t){var n=this;e.on(["resize.start"],function(i){n.initSnap(i)}),e.on(["resize.move","resize.end"],R1,function(i){var r=i.context,o=r.shape,a=o.parent,l=r.direction,s=r.snapContext;if(!(i.originalEvent&&Dt(i.originalEvent))&&!Wi(i)){var c=s.pointsForTarget(a);c.initialized||(c=n.addSnapTargetPoints(c,o,a,l),c.initialized=!0),A1(l)&&Ge(i,"x",i.x),M1(l)&&Ge(i,"y",i.y),t.snap(i,c)}}),e.on(["resize.cleanup"],function(){t.hide()})}no.prototype.initSnap=function(e){var t=e.context,n=t.shape,i=t.direction,r=t.snapContext;r||(r=t.snapContext=new ii);var o=Xm(n,i);return r.setSnapOrigin("corner",{x:o.x-e.x,y:o.y-e.y}),r};no.prototype.addSnapTargetPoints=function(e,t,n,i){var r=this.getSnapTargets(t,n);return M(r,function(o){e.add("corner",sh(o)),e.add("corner",ah(o))}),e.add("corner",Xm(t,i)),e};no.$inject=["eventBus","snapping"];no.prototype.getSnapTargets=function(e,t){return lh(t).filter(function(n){return!D1(n,e)&&!Ae(n)&&!k1(n)&&!xe(n)})};function Xm(e,t){var n=de(e),i=ae(e),r={x:n.x,y:n.y};return t.indexOf("n")!==-1?r.y=i.top:t.indexOf("s")!==-1&&(r.y=i.bottom),t.indexOf("e")!==-1?r.x=i.right:t.indexOf("w")!==-1&&(r.x=i.left),r}function D1(e,t){return e.host===t}function k1(e){return!!e.hidden}function A1(e){return e==="n"||e==="s"}function M1(e){return e==="e"||e==="w"}var I1=7,N1=1e3;function ri(e){this._canvas=e,this._asyncHide=_g(gi(this.hide,this),N1)}ri.$inject=["canvas"];ri.prototype.snap=function(e,t){var n=e.context,i=n.snapContext,r=i.getSnapLocations(),o={x:Wi(e,"x"),y:Wi(e,"y")};M(r,function(a){var l=i.getSnapOrigin(a),s={x:e.x+l.x,y:e.y+l.y};if(M(["x","y"],function(c){var p;o[c]||(p=t.snap(s,a,c,I1),p!==void 0&&(o[c]={value:p,originValue:p-l[c]}))}),o.x&&o.y)return!1}),this.showSnapLine("vertical",o.x&&o.x.value),this.showSnapLine("horizontal",o.y&&o.y.value),M(["x","y"],function(a){var l=o[a];vn(l)&&Ge(e,a,l.originValue)})};ri.prototype._createLine=function(e){var t=this._canvas.getLayer("snap"),n=be("path");return ie(n,{d:"M0,0 L0,0"}),Ne(n).add("djs-snap-line"),Ce(t,n),{update:function(i){ye(i)?e==="horizontal"?ie(n,{d:"M-100000,"+i+" L+100000,"+i,display:""}):ie(n,{d:"M "+i+",-100000 L "+i+", +100000",display:""}):ie(n,{display:"none"})}}};ri.prototype._createSnapLines=function(){this._snapLines={horizontal:this._createLine("horizontal"),vertical:this._createLine("vertical")}};ri.prototype.showSnapLine=function(e,t){var n=this.getSnapLine(e);n&&n.update(t),this._asyncHide()};ri.prototype.getSnapLine=function(e){return this._snapLines||this._createSnapLines(),this._snapLines[e]};ri.prototype.hide=function(){M(this._snapLines,function(e){e.update()})};const O1={__init__:["createMoveSnapping","resizeSnapping","snapping"],createMoveSnapping:["type",an],resizeSnapping:["type",no],snapping:["type",ri]},L1={__depends__:[O1],__init__:["connectSnapping","createMoveSnapping"],connectSnapping:["type",Ym],createMoveSnapping:["type",rr]};function ue(e,t,n,i){this._open=!1,this._results=[],this._eventMaps=[],this._canvas=e,this._eventBus=t,this._overlays=n,this._selection=i,this._container=ot(ue.BOX_HTML),this._searchInput=nt(ue.INPUT_SELECTOR,this._container),this._resultsContainer=nt(ue.RESULTS_CONTAINER_SELECTOR,this._container),this._canvas.getContainer().appendChild(this._container),t.on(["canvas.destroy","diagram.destroy"],this.close,this)}ue.$inject=["canvas","eventBus","overlays","selection"];ue.prototype._bindEvents=function(){var e=this;function t(n,i,r,o){e._eventMaps.push({el:n,type:r,listener:Rt.bind(n,i,r,o)})}t(document,"html","click",function(n){e.close()}),t(this._container,ue.INPUT_SELECTOR,"click",function(n){n.stopPropagation(),n.delegateTarget.focus()}),t(this._container,ue.RESULT_SELECTOR,"mouseover",function(n){n.stopPropagation(),e._scrollToNode(n.delegateTarget),e._preselect(n.delegateTarget)}),t(this._container,ue.RESULT_SELECTOR,"click",function(n){n.stopPropagation(),e._select(n.delegateTarget)}),t(this._container,ue.INPUT_SELECTOR,"keydown",function(n){tt("ArrowUp",n)&&n.preventDefault(),tt("ArrowDown",n)&&n.preventDefault()}),t(this._container,ue.INPUT_SELECTOR,"keyup",function(n){if(tt("Escape",n))return e.close();if(tt("Enter",n)){var i=e._getCurrentResult();return i?e._select(i):e.close()}if(tt("ArrowUp",n))return e._scrollToDirection(!0);if(tt("ArrowDown",n))return e._scrollToDirection();tt(["ArrowLeft","ArrowRight"],n)||e._search(n.delegateTarget.value)})};ue.prototype._unbindEvents=function(){this._eventMaps.forEach(function(e){Rt.unbind(e.el,e.type,e.listener)})};ue.prototype._search=function(e){var t=this;if(this._clearResults(),!(!e||e==="")){var n=this._searchProvider.find(e);if(n.length){n.forEach(function(r){var o=r.element.id,a=t._createResultNode(r,o);t._results[o]={element:r.element,node:a}});var i=nt(ue.RESULT_SELECTOR,this._resultsContainer);this._scrollToNode(i),this._preselect(i)}}};ue.prototype._scrollToDirection=function(e){var t=this._getCurrentResult();if(t){var n=e?t.previousElementSibling:t.nextElementSibling;n&&(this._scrollToNode(n),this._preselect(n))}};ue.prototype._scrollToNode=function(e){if(!(!e||e===this._getCurrentResult())){var t=e.offsetTop,n=this._resultsContainer.scrollTop,i=t-this._resultsContainer.clientHeight+e.clientHeight;t<n?this._resultsContainer.scrollTop=t:n<i&&(this._resultsContainer.scrollTop=i)}};ue.prototype._clearResults=function(){lf(this._resultsContainer),this._results=[],this._resetOverlay(),this._eventBus.fire("searchPad.cleared")};ue.prototype._getCurrentResult=function(){return nt(ue.RESULT_SELECTED_SELECTOR,this._resultsContainer)};ue.prototype._createResultNode=function(e,t){var n=ot(ue.RESULT_HTML);return e.primaryTokens.length>0&&$d(n,e.primaryTokens,ue.RESULT_PRIMARY_HTML),$d(n,e.secondaryTokens,ue.RESULT_SECONDARY_HTML),_t(n,ue.RESULT_ID_ATTRIBUTE,t),this._resultsContainer.appendChild(n),n};ue.prototype.registerProvider=function(e){this._searchProvider=e};ue.prototype.open=function(){if(!this._searchProvider)throw new Error("no search provider registered");this.isOpen()||(this._bindEvents(),this._open=!0,Et(this._container).add("open"),this._searchInput.focus(),this._eventBus.fire("searchPad.opened"))};ue.prototype.close=function(){this.isOpen()&&(this._unbindEvents(),this._open=!1,Et(this._container).remove("open"),this._clearResults(),this._searchInput.value="",this._searchInput.blur(),this._resetOverlay(),this._eventBus.fire("searchPad.closed"))};ue.prototype.toggle=function(){this.isOpen()?this.close():this.open()};ue.prototype.isOpen=function(){return this._open};ue.prototype._preselect=function(e){var t=this._getCurrentResult();if(e!==t){t&&Et(t).remove(ue.RESULT_SELECTED_CLASS);var n=_t(e,ue.RESULT_ID_ATTRIBUTE),i=this._results[n].element;Et(e).add(ue.RESULT_SELECTED_CLASS),this._resetOverlay(i),this._canvas.scrollToElement(i,{top:400}),this._selection.select(i),this._eventBus.fire("searchPad.preselected",i)}};ue.prototype._select=function(e){var t=_t(e,ue.RESULT_ID_ATTRIBUTE),n=this._results[t].element;this.close(),this._resetOverlay(),this._canvas.scrollToElement(n,{top:400}),this._selection.select(n),this._eventBus.fire("searchPad.selected",n)};ue.prototype._resetOverlay=function(e){if(this._overlayId&&this._overlays.remove(this._overlayId),e){var t=Tt(e),n=$1(t);this._overlayId=this._overlays.add(e,n)}};function $1(e){var t=6,n=e.width+t*2,i=e.height+t*2,r={width:n+"px",height:i+"px"},o=ot('<div class="'+ue.OVERLAY_CLASS+'"></div>');return ma(o,r),{position:{bottom:i-t,right:n-t},show:!0,html:o}}function $d(e,t,n){var i=B1(t),r=ot(n);r.innerHTML=i,e.appendChild(r)}function B1(e){var t="";return e.forEach(function(n){n.matched?t+='<strong class="'+ue.RESULT_HIGHLIGHT_CLASS+'">'+du(n.matched)+"</strong>":t+=du(n.normal)}),t!==""?t:null}ue.CONTAINER_SELECTOR=".djs-search-container";ue.INPUT_SELECTOR=".djs-search-input input";ue.RESULTS_CONTAINER_SELECTOR=".djs-search-results";ue.RESULT_SELECTOR=".djs-search-result";ue.RESULT_SELECTED_CLASS="djs-search-result-selected";ue.RESULT_SELECTED_SELECTOR="."+ue.RESULT_SELECTED_CLASS;ue.RESULT_ID_ATTRIBUTE="data-result-id";ue.RESULT_HIGHLIGHT_CLASS="djs-search-highlight";ue.OVERLAY_CLASS="djs-search-overlay";ue.BOX_HTML='<div class="djs-search-container djs-draggable djs-scrollable"><div class="djs-search-input"><input type="text"/></div><div class="djs-search-results"></div></div>';ue.RESULT_HTML='<div class="djs-search-result"></div>';ue.RESULT_PRIMARY_HTML='<div class="djs-search-result-primary"></div>';ue.RESULT_SECONDARY_HTML='<p class="djs-search-result-secondary"></p>';const j1={__depends__:[qd,En],searchPad:["type",ue]};function Kc(e,t,n){this._elementRegistry=e,this._canvas=n,t.registerProvider(this)}Kc.$inject=["elementRegistry","searchPad","canvas"];Kc.prototype.find=function(e){var t=this._canvas.getRootElement(),n=this._elementRegistry.filter(function(i){return!i.labelTarget});return n=_e(n,function(i){return i!==t}),n=bt(n,function(i){return{primaryTokens:jd(Hn(i),e),secondaryTokens:jd(i.id,e),element:i}}),n=_e(n,function(i){return Bd(i.primaryTokens)||Bd(i.secondaryTokens)}),n=tn(n,function(i){return Hn(i.element)+i.element.id}),n};function Bd(e){var t=_e(e,function(n){return!!n.matched});return t.length>0}function jd(e,t){var n=[],i=e;if(!e)return n;e=e.toLowerCase(),t=t.toLowerCase();var r=e.indexOf(t);return r>-1?(r!==0&&n.push({normal:i.substr(0,r)}),n.push({matched:i.substr(r,t.length)}),t.length+r<e.length&&n.push({normal:i.substr(t.length+r,e.length)})):n.push({normal:i}),n}const V1={__depends__:[j1],__init__:["bpmnSearch"],bpmnSearch:["type",Kc]};var F1='<?xml version="1.0" encoding="UTF-8"?><bpmn:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" targetNamespace="http://bpmn.io/schema/bpmn" id="Definitions_1"><bpmn:process id="Process_1" isExecutable="false"><bpmn:startEvent id="StartEvent_1"/></bpmn:process><bpmndi:BPMNDiagram id="BPMNDiagram_1"><bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_1"><bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1"><dc:Bounds height="36.0" width="36.0" x="173.0" y="102.0"/></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></bpmn:definitions>';function Jt(e){Or.call(this,e)}te(Jt,Or);Jt.Viewer=Ir;Jt.NavigatedViewer=Pr;Jt.prototype.createDiagram=function(){return this.importXML(F1)};Jt.prototype._interactionModules=[mf,_f,u_,xf];Jt.prototype._modelingModules=[$_,Ll,sb,tb,Pb,Fl,Ib,H0,Jh,Na,W0,K0,dS,mS,vS,ES,IS,Em,jS,YS,QS,l1,u1,Lm,L1,V1];Jt.prototype._modules=[].concat(Ir.prototype._modules,Jt.prototype._interactionModules,Jt.prototype._modelingModules);function Vd(){return`Process_${Math.random().toString(36).slice(2,12)}`}const H1=`<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:bioc="http://bpmn.io/schema/bpmn/biocolor/1.0" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:flowable="http://flowable.org/bpmn" targetNamespace="http://www.flowable.org/processdef">
  <process id="process_${Vd()}" name="name_${Vd()}">
    <startEvent id="startNode1" name="开始" />
  </process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_flow">
    <bpmndi:BPMNPlane id="BPMNPlane_flow" bpmnElement="T-2d89e7a3-ba79-4abd-9f64-ea59621c258c">
      <bpmndi:BPMNShape id="BPMNShape_startNode1" bpmnElement="startNode1" bioc:stroke="">
        <omgdc:Bounds x="240" y="200" width="30" height="30" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="242" y="237" width="23" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</definitions>`,z1={name:"Flowable",uri:"http://flowable.org/bpmn",prefix:"flowable",xml:{tagAlias:"lowerCase"},associations:[],types:[{name:"flowable:extCandidateUsers",isAbstract:!0,extends:[],superClass:["Element"],meta:{allowedIn:["*"]},properties:[{name:"body",type:"String",isBody:!0}]},{name:"flowable:extAssignee",isAbstract:!0,extends:[],superClass:["Element"],meta:{allowedIn:["*"]},properties:[{name:"body",type:"String",isBody:!0}]},{name:"flowable:property",superClass:["Element"],properties:[{name:"id",isAttr:!0,type:"String"},{name:"name",isAttr:!0,type:"String"},{name:"value",isAttr:!0,type:"String"}]},{name:"flowable:properties",isAbstract:!0,extends:[],superClass:["Element"],meta:{allowedIn:["*"]},properties:[{name:"values",type:"flowable:property",isMany:!0}]},{name:"InOutBinding",superClass:["Element"],isAbstract:!0,properties:[{name:"source",isAttr:!0,type:"String"},{name:"sourceExpression",isAttr:!0,type:"String"},{name:"target",isAttr:!0,type:"String"},{name:"businessKey",isAttr:!0,type:"String"},{name:"local",isAttr:!0,type:"Boolean",default:!1},{name:"variables",isAttr:!0,type:"String"}]},{name:"In",superClass:["InOutBinding"],meta:{allowedIn:["bpmn:CallActivity"]}},{name:"Out",superClass:["InOutBinding"],meta:{allowedIn:["bpmn:CallActivity"]}},{name:"AsyncCapable",isAbstract:!0,extends:["bpmn:Activity","bpmn:Gateway","bpmn:Event"],properties:[{name:"async",isAttr:!0,type:"Boolean",default:!1},{name:"asyncBefore",isAttr:!0,type:"Boolean",default:!1},{name:"asyncAfter",isAttr:!0,type:"Boolean",default:!1},{name:"exclusive",isAttr:!0,type:"Boolean",default:!0}]},{name:"flowable:in",superClass:["Element"],properties:[{name:"source",type:"string",isAttr:!0},{name:"target",type:"string",isAttr:!0}]},{name:"flowable:out",superClass:["Element"],properties:[{name:"source",type:"string",isAttr:!0},{name:"target",type:"string",isAttr:!0}]},{name:"BoundaryEvent",superClass:["CatchEvent"],properties:[{name:"cancelActivity",default:!0,isAttr:!0,type:"Boolean"},{name:"attachedToRef",type:"Activity",isAttr:!0,isReference:!0}]},{name:"JobPriorized",isAbstract:!0,extends:["bpmn:Process","flowable:AsyncCapable"],properties:[{name:"jobPriority",isAttr:!0,type:"String"}]},{name:"SignalEventDefinition",isAbstract:!0,extends:["bpmn:SignalEventDefinition"],properties:[{name:"async",isAttr:!0,type:"Boolean",default:!1}]},{name:"ErrorEventDefinition",isAbstract:!0,extends:["bpmn:ErrorEventDefinition"],properties:[{name:"errorCodeVariable",isAttr:!0,type:"String"},{name:"errorMessageVariable",isAttr:!0,type:"String"}]},{name:"Error",isAbstract:!0,extends:["bpmn:Error"],properties:[{name:"flowable:errorMessage",isAttr:!0,type:"String"}]},{name:"PotentialStarter",superClass:["Element"],properties:[{name:"resourceAssignmentExpression",type:"bpmn:ResourceAssignmentExpression"}]},{name:"UserTask",isAbstract:!0,extends:["bpmn:UserTask"],properties:[{name:"timerEventDefinition",type:"Expression"},{name:"multiInstanceLoopCharacteristics",type:"MultiInstanceLoopCharacteristics"}]},{name:"StartEvent",isAbstract:!0,extends:["bpmn:StartEvent"],properties:[{name:"timerEventDefinition",type:"Expression"}]},{name:"FormSupported",isAbstract:!0,extends:["bpmn:StartEvent","bpmn:UserTask"],properties:[{name:"formHandlerClass",isAttr:!0,type:"String"},{name:"formKey",isAttr:!0,type:"String"}]},{name:"TemplateSupported",isAbstract:!0,extends:["bpmn:Process","bpmn:FlowElement"],properties:[{name:"modelerTemplate",isAttr:!0,type:"String"}]},{name:"Initiator",isAbstract:!0,extends:["bpmn:StartEvent"],properties:[{name:"initiator",isAttr:!0,type:"String"}]},{name:"ScriptTask",isAbstract:!0,extends:["bpmn:ScriptTask"],properties:[{name:"resultVariable",isAttr:!0,type:"String"},{name:"resource",isAttr:!0,type:"String"}]},{name:"Process",isAbstract:!0,extends:["bpmn:Process"],properties:[{name:"candidateStarterGroups",isAttr:!0,type:"String"},{name:"candidateStarterUsers",isAttr:!0,type:"String"},{name:"versionTag",isAttr:!0,type:"String"},{name:"historyTimeToLive",isAttr:!0,type:"String"},{name:"isStartableInTasklist",isAttr:!0,type:"Boolean",default:!0}]},{name:"EscalationEventDefinition",isAbstract:!0,extends:["bpmn:EscalationEventDefinition"],properties:[{name:"escalationCodeVariable",isAttr:!0,type:"String"}]},{name:"FormalExpression",isAbstract:!0,extends:["bpmn:FormalExpression"],properties:[{name:"resource",isAttr:!0,type:"String"}]},{name:"Assignable",extends:["bpmn:UserTask"],properties:[{name:"candidateGroups",isAttr:!0,type:"String"},{name:"dueDate",isAttr:!0,type:"String"},{name:"followUpDate",isAttr:!0,type:"String"},{name:"priority",isAttr:!0,type:"String"}]},{name:"CallActivity",extends:["bpmn:CallActivity"],properties:[{name:"calledElementBinding",isAttr:!0,type:"String",default:"latest"},{name:"calledElementVersion",isAttr:!0,type:"String"},{name:"calledElementVersionTag",isAttr:!0,type:"String"},{name:"calledElementTenantId",isAttr:!0,type:"String"},{name:"caseRef",isAttr:!0,type:"String"},{name:"caseBinding",isAttr:!0,type:"String",default:"latest"},{name:"caseVersion",isAttr:!0,type:"String"},{name:"caseTenantId",isAttr:!0,type:"String"},{name:"variableMappingClass",isAttr:!0,type:"String"},{name:"variableMappingDelegateExpression",isAttr:!0,type:"String"}]},{name:"ServiceTaskLike",extends:["bpmn:ServiceTask","bpmn:BusinessRuleTask","bpmn:SendTask","bpmn:MessageEventDefinition"],properties:[{name:"expression",isAttr:!0,type:"String"},{name:"class",isAttr:!0,type:"String"},{name:"delegateExpression",isAttr:!0,type:"String"},{name:"resultVariable",isAttr:!0,type:"String"}]},{name:"ExclusiveGateway",isAbstract:!0,extends:["bpmn:ExclusiveGateway"],properties:[{name:"serviceClass",isAttr:!0,type:"String"}]},{name:"DmnCapable",extends:["bpmn:BusinessRuleTask"],properties:[{name:"decisionRef",isAttr:!0,type:"String"},{name:"decisionRefBinding",isAttr:!0,type:"String",default:"latest"},{name:"decisionRefVersion",isAttr:!0,type:"String"},{name:"mapDecisionResult",isAttr:!0,type:"String",default:"resultList"},{name:"decisionRefTenantId",isAttr:!0,type:"String"}]},{name:"ExternalCapable",extends:["flowable:ServiceTaskLike"],properties:[{name:"type",isAttr:!0,type:"String"},{name:"topic",isAttr:!0,type:"String"}]},{name:"TaskPriorized",extends:["bpmn:Process","flowable:ExternalCapable"],properties:[{name:"taskPriority",isAttr:!0,type:"String"}]},{name:"Properties",superClass:["Element"],meta:{allowedIn:["*"]},properties:[{name:"values",type:"Property",isMany:!0}]},{name:"Property",superClass:["Element"],properties:[{name:"id",type:"String",isAttr:!0},{name:"name",type:"String",isAttr:!0},{name:"value",type:"String",isAttr:!0}]},{name:"Connector",superClass:["Element"],meta:{allowedIn:["flowable:ServiceTaskLike"]},properties:[{name:"inputOutput",type:"InputOutput"},{name:"connectorId",type:"String"}]},{name:"InputOutput",superClass:["Element"],meta:{allowedIn:["bpmn:FlowNode","flowable:Connector"]},properties:[{name:"inputOutput",type:"InputOutput"},{name:"connectorId",type:"String"},{name:"inputParameters",isMany:!0,type:"InputParameter"},{name:"outputParameters",isMany:!0,type:"OutputParameter"}]},{name:"InputOutputParameter",properties:[{name:"name",isAttr:!0,type:"String"},{name:"value",isBody:!0,type:"String"},{name:"definition",type:"InputOutputParameterDefinition"}]},{name:"InputOutputParameterDefinition",isAbstract:!0},{name:"List",superClass:["InputOutputParameterDefinition"],properties:[{name:"items",isMany:!0,type:"InputOutputParameterDefinition"}]},{name:"Map",superClass:["InputOutputParameterDefinition"],properties:[{name:"entries",isMany:!0,type:"Entry"}]},{name:"Entry",properties:[{name:"key",isAttr:!0,type:"String"},{name:"value",isBody:!0,type:"String"},{name:"definition",type:"InputOutputParameterDefinition"}]},{name:"Value",superClass:["InputOutputParameterDefinition"],properties:[{name:"id",isAttr:!0,type:"String"},{name:"name",isAttr:!0,type:"String"},{name:"value",isBody:!0,type:"String"}]},{name:"Script",superClass:["InputOutputParameterDefinition"],properties:[{name:"scriptFormat",isAttr:!0,type:"String"},{name:"resource",isAttr:!0,type:"String"},{name:"value",isBody:!0,type:"String"}]},{name:"Field",superClass:["Element"],meta:{allowedIn:["flowable:ServiceTaskLike","flowable:ExecutionListener","flowable:TaskListener"]},properties:[{name:"name",isAttr:!0,type:"String"},{name:"expression",isAttr:!0,type:"expression"},{name:"string",type:"string"},{name:"stringValue",isAttr:!0,type:"String"}]},{name:"string",superClass:["Element"],meta:{allowedIn:["flowable:Field"]},properties:[{name:"body",isBody:!0,type:"String"}]},{name:"expression",superClass:["Element"],meta:{allowedIn:["flowable:Field"]},properties:[{name:"body",isBody:!0,type:"String"}]},{name:"InputParameter",superClass:["InputOutputParameter"]},{name:"OutputParameter",superClass:["InputOutputParameter"]},{name:"Collectable",isAbstract:!0,extends:["bpmn:MultiInstanceLoopCharacteristics"],superClass:["flowable:AsyncCapable"],properties:[{name:"collection",isAttr:!0,type:"String"},{name:"elementVariable",isAttr:!0,type:"String"}]},{name:"SequenceFlow",superClass:["FlowElement"],properties:[{name:"isImmediate",isAttr:!0,type:"Boolean"},{name:"conditionExpression",type:"Expression"},{name:"sourceRef",type:"FlowNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"FlowNode",isAttr:!0,isReference:!0}]},{name:"MultiInstanceLoopCharacteristics",superClass:["LoopCharacteristics"],properties:[{name:"isSequential",default:!1,isAttr:!0,type:"Boolean"},{name:"behavior",type:"MultiInstanceBehavior",default:"All",isAttr:!0},{name:"loopCardinality",type:"Expression",xml:{serialize:"xsi:type"}},{name:"loopDataInputRef",type:"ItemAwareElement",isReference:!0},{name:"loopDataOutputRef",type:"ItemAwareElement",isReference:!0},{name:"inputDataItem",type:"DataInput",xml:{serialize:"property"}},{name:"outputDataItem",type:"DataOutput",xml:{serialize:"property"}},{name:"complexBehaviorDefinition",type:"ComplexBehaviorDefinition",isMany:!0},{name:"completionCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"oneBehaviorEventRef",type:"EventDefinition",isAttr:!0,isReference:!0},{name:"noneBehaviorEventRef",type:"EventDefinition",isAttr:!0,isReference:!0}]},{name:"FailedJobRetryTimeCycle",superClass:["Element"],meta:{allowedIn:["flowable:AsyncCapable","bpmn:MultiInstanceLoopCharacteristics"]},properties:[{name:"body",isBody:!0,type:"String"}]},{name:"ExecutionListener",superClass:["Element"],meta:{allowedIn:["bpmn:Task","bpmn:ServiceTask","bpmn:UserTask","bpmn:BusinessRuleTask","bpmn:ScriptTask","bpmn:ReceiveTask","bpmn:ManualTask","bpmn:ExclusiveGateway","bpmn:SequenceFlow","bpmn:ParallelGateway","bpmn:InclusiveGateway","bpmn:EventBasedGateway","bpmn:StartEvent","bpmn:IntermediateCatchEvent","bpmn:IntermediateThrowEvent","bpmn:EndEvent","bpmn:BoundaryEvent","bpmn:CallActivity","bpmn:SubProcess","bpmn:Process"]},properties:[{name:"expression",isAttr:!0,type:"String"},{name:"class",isAttr:!0,type:"String"},{name:"delegateExpression",isAttr:!0,type:"String"},{name:"event",isAttr:!0,type:"String"},{name:"script",type:"Script"},{name:"fields",type:"Field",isMany:!0}]},{name:"TaskListener",superClass:["Element"],meta:{allowedIn:["bpmn:UserTask"]},properties:[{name:"expression",isAttr:!0,type:"String"},{name:"class",isAttr:!0,type:"String"},{name:"delegateExpression",isAttr:!0,type:"String"},{name:"event",isAttr:!0,type:"String"},{name:"script",type:"Script"},{name:"fields",type:"Field",isMany:!0}]},{name:"FormProperty",superClass:["Element"],meta:{allowedIn:["bpmn:StartEvent","bpmn:UserTask"]},properties:[{name:"id",type:"String",isAttr:!0},{name:"name",type:"String",isAttr:!0},{name:"type",type:"String",isAttr:!0},{name:"required",type:"String",isAttr:!0},{name:"readable",type:"String",isAttr:!0},{name:"writable",type:"String",isAttr:!0},{name:"variable",type:"String",isAttr:!0},{name:"expression",type:"String",isAttr:!0},{name:"datePattern",type:"String",isAttr:!0},{name:"default",type:"String",isAttr:!0},{name:"values",type:"Value",isMany:!0}]},{name:"FormData",superClass:["Element"],meta:{allowedIn:["bpmn:StartEvent","bpmn:UserTask"]},properties:[{name:"fields",type:"FormField",isMany:!0},{name:"businessKey",type:"String",isAttr:!0}]},{name:"FormField",superClass:["Element"],properties:[{name:"id",type:"String",isAttr:!0},{name:"label",type:"String",isAttr:!0},{name:"type",type:"String",isAttr:!0},{name:"datePattern",type:"String",isAttr:!0},{name:"defaultValue",type:"String",isAttr:!0},{name:"properties",type:"Properties"},{name:"validation",type:"Validation"},{name:"values",type:"Value",isMany:!0}]},{name:"Validation",superClass:["Element"],properties:[{name:"constraints",type:"Constraint",isMany:!0}]},{name:"Constraint",superClass:["Element"],properties:[{name:"name",type:"String",isAttr:!0},{name:"config",type:"String",isAttr:!0}]},{name:"ConditionalEventDefinition",isAbstract:!0,extends:["bpmn:ConditionalEventDefinition"],properties:[{name:"variableName",isAttr:!0,type:"String"},{name:"variableEvent",isAttr:!0,type:"String"}]}],emumerations:[]},U1=(e,t)=>(t=t||{},e=Ag[e]||e,e.replace(/{([^}]+)}/g,function(n,i){return t[i]||"{"+i+"}"})),G1={translate:["value",U1]};class Zm extends Ja{constructor(n,i,r,o,a,l,s,c){super(n,i,r,o,a,l,s,c);Qe(this,"_palette");Qe(this,"_create");Qe(this,"_elementFactory");Qe(this,"_spaceTool");Qe(this,"_lassoTool");Qe(this,"_handTool");Qe(this,"_globalConnect");Qe(this,"_translate");this._palette=n,this._create=i,this._elementFactory=r,this._spaceTool=o,this._lassoTool=a,this._handTool=l,this._globalConnect=s,this._translate=c}getPaletteEntries(){const n={},i=this._create,r=this._elementFactory,o=this._translate;function a(s,c,p,u,d){function f(m){const v=r.createShape(L({type:s},d));i.start(m,v,null)}const h=s.replace(/^bpmn:/,"");return{group:c,className:p,title:u||o("Create {type}",{type:h}),action:{dragstart:f,click:f}}}function l(s){const c=zn().getBpmnFactory(),p=c.create("bpmn:UserTask",{isForCompensation:!1});p.loopCharacteristics=c.create("bpmn:MultiInstanceLoopCharacteristics");const u=r.createShape({type:"bpmn:UserTask",businessObject:p});i.start(s,u,{})}return L(n,{"create.parallel-gateway":a("bpmn:ParallelGateway","gateway","bpmn-icon-gateway-parallel","并行网关"),"create.event-base-gateway":a("bpmn:EventBasedGateway","gateway","bpmn-icon-gateway-eventbased","事件网关"),"gateway-separator":{group:"gateway",separator:!0},"create.user-task":a("bpmn:UserTask","activity","bpmn-icon-user-task","创建用户任务"),"create.multi-instance-user-task":{group:"activity",type:"bpmn:UserTask",className:"bpmn-icon-user task-multi-instance",title:"创建多实例用户任务",action:{click:l,dragstart:l}},"task-separator":{group:"activity",separator:!0}}),n}}Zm.$inject=["palette","create","elementFactory","spaceTool","lassoTool","handTool","globalConnect","translate"];var W1=1e3;function or(e,t){var n=this;t=t||W1,e.on(["render.shape","render.connection"],t,function(i,r){var o=i.type,a=r.element,l=r.gfx,s=r.attrs;if(n.canRender(a))return o==="render.shape"?n.drawShape(l,a,s):n.drawConnection(l,a,s)}),e.on(["render.getShapePath","render.getConnectionPath"],t,function(i,r){if(n.canRender(r))return i.type==="render.getShapePath"?n.getShapePath(r):n.getConnectionPath(r)})}or.prototype.canRender=function(e){};or.prototype.drawShape=function(e,t){};or.prototype.drawConnection=function(e,t){};or.prototype.getShapePath=function(e){};or.prototype.getConnectionPath=function(e){};const Y1=1500;class Qm extends or{constructor(n,i,r){super(n,Y1);Qe(this,"bpmnRenderer");Qe(this,"modeling");this.bpmnRenderer=i,this.modeling=r}canRender(n){return!n.labelTarget}drawShape(n,i){const r=this.bpmnRenderer.drawShape(n,i),{type:o,width:a,height:l}=i;return o==="bpmn:StartEvent"?(ie(r,{fill:"#77DF6D"}),r):o==="bpmn:EndEvent"?(ie(r,{fill:"#EE7B77"}),r):(o==="bpmn:UserTask"&&ie(r,{fill:"#A9C4F8"}),r)}getShapePath(n){return this.bpmnRenderer.getShapePath(n)}}Qm.$inject=["eventBus","bpmnRenderer"];class q1 extends tr{constructor(n,i,r,o,a,l,s,c,p,u,d,f){super(n,i,r,o,a,l,s,c,p,u,d,f);Qe(this,"_contextPad");Qe(this,"_modeling");Qe(this,"_elementFactory");Qe(this,"_autoPlace");Qe(this,"_connect");Qe(this,"_create");Qe(this,"_popupMenu");Qe(this,"_canvas");Qe(this,"_rules");this._contextPad=o,this._modeling=a,this._elementFactory=l,this._connect=s,this._create=c,this._popupMenu=p,this._canvas=u,this._rules=d,this._autoPlace=i.get("autoPlace",!1)}getContextPadEntries(n){const i={},r=(s,c)=>{const p=this._elementFactory.createShape({type:"bpmn:UserTask"});this._create.start(s,p,{source:c})},o=(s,c)=>{const u=zn().getModeler().get("bpmnFactory"),d=u.create("bpmn:UserTask",{isForCompensation:!1});d.loopCharacteristics=u.create("bpmn:MultiInstanceLoopCharacteristics");const f=this._elementFactory.createShape({type:"bpmn:UserTask",businessObject:d});this._create.start(s,f,{source:c})},a=this._autoPlace?(s,c)=>{const p=zn().getModeler().get("bpmnFactory"),u=p.create("bpmn:UserTask",{isForCompensation:!1});u.loopCharacteristics=p.create("bpmn:MultiInstanceLoopCharacteristics");const d=this._elementFactory.createShape({type:"bpmn:UserTask",businessObject:u});this._autoPlace.append(c,d)}:o,l=this._autoPlace?(s,c)=>{const p=this._elementFactory.createShape({type:"bpmn:UserTask"});this._autoPlace.append(c,p)}:r;return i["append.append-user-task"]={group:"model",className:"bpmn-icon-user-task",title:"用户任务",action:{dragstart:r,click:l}},i["append.append-multi-instance-user-task"]={group:"model",className:"bpmn-icon-user",title:"多实例用户任务",action:{dragstart:o,click:a}},i}}const K1=[{__init__:["customPaletteProvider","customContextPadProvider","customRenderer"],customPaletteProvider:["type",Zm],customRenderer:["type",Qm],customContextPadProvider:["type",q1]},G1],X1={class:"containers-bpmn"},Z1={width:"0",height:"0",style:{position:"absolute"}},Q1=W("defs",null,[W("marker",{id:"markerArrow-dark-mode",viewBox:"0 0 20 20",refX:"11",refY:"10",markerWidth:"10",markerHeight:"10",orient:"auto"},[W("path",{d:"M 1 5 L 11 10 L 1 15 Z",class:"arrow-dark"})])],-1),J1=[Q1],eC={class:"app-containers-bpmn"},tC={class:"process-toolbar"},nC={class:"open-bar"},iC={key:0,class:"panel-content"},rC=["innerHTML"],oC=et({name:"BpmnDesign"}),aC=et({...oC,emits:["closeCallBack","saveCallBack"],setup(e,{expose:t,emit:n}){const i=n,{visible:r,title:o,openDialog:a,closeDialog:l}=xi({title:"编辑流程"}),s=zn(),{proxy:c}=yn(),p=H(!1),u=H(!0),d=H(),f=H(),h=H(),m=H(1),v=H(!1),S=H(!1),b=H(""),w=H(""),C=H(!1),R=()=>{p.value=!p.value,setTimeout(()=>{u.value=!p.value},100)},D=()=>{h.value=new Jt({container:d.value,keyboard:{bindTo:window},propertiesPanel:{parent:f.value},additionalModules:K1,moddleExtensions:{flowable:z1}})},F=()=>{s.getModeler()&&(s.getModeler().destroy(),s.setModeler(void 0)),s.setModeler(h.value)},A=Z=>{Z||(Z=H1),h.value.importXML(Z)},I=()=>{m.value=h.value.get("canvas").zoom("fit-viewport");const Z=document.querySelector(".app-containers-bpmn .viewport").getBBox(),pe=h.value.get("canvas").viewbox(),oe={x:Z.x+Z.width/2-65,y:Z.y+Z.height/2};h.value.get("canvas").viewbox({x:oe.x-pe.width/2,y:oe.y-pe.height/2,width:pe.width,height:pe.height}),m.value=Z.width/pe.width*1.8},$=(Z=!0)=>{m.value=h.value.get("canvas").zoom(),m.value+=Z?.1:-.1,h.value.get("canvas").zoom(m.value)},V=async()=>{try{const{xml:Z}=await h.value.saveXML({format:!0});B(`${q().name}.bpmn20.xml`,Z,"application/xml")}catch(Z){c==null||c.$modal.msgError(Z)}},X=async()=>{try{const{svg:Z}=await h.value.saveSVG();B(q().name,Z,"image/svg+xml")}catch(Z){c==null||c.$modal.msgError(Z)}},U=async()=>{try{const{xml:Z}=await h.value.saveXML({format:!0});b.value=Z,v.value=!0}catch(Z){c==null||c.$modal.msgError(Z)}},O=async()=>{try{const{svg:Z}=await h.value.saveSVG();w.value=Z,S.value=!0}catch(Z){c==null||c.$modal.msgError(Z)}};wr({curType:"",curNode:"",expValue:""});const B=(Z,pe,oe)=>{const De=document.createElement("a"),lt=window.URL.createObjectURL(new Blob([pe],{type:oe}));De.href=lt,De.download=Z,De.click(),window.URL.revokeObjectURL(lt)},q=()=>{var pe;const Z=(pe=h.value)==null?void 0:pe.getDefinitions().rootElements;for(let oe=0;oe<Z.length;oe++)if(Z[oe].$type==="bpmn:Process")return Z[oe]},re=()=>{const Z=q();return{id:Z.id,name:Z.name}},ne=async()=>{const{xml:Z}=await h.value.saveXML({format:!0}),{svg:pe}=await h.value.saveSVG(),oe=re();let De={xml:Z,svg:pe,key:oe.id,name:oe.name,loading:C};i("saveCallBack",De)},ge=Z=>{a(),Zt(()=>{A(Z)})},Le=()=>{l()};return yi(()=>{Zt(()=>{D(),F()})}),t({initDiagram:A,saveXml:ne,open:ge,close:Le}),(Z,pe)=>{const oe=Gn,De=qi,lt=Iv,j=Nv,k=Ov,ee=Lv,fe=$v,me=Bv,K=jv,he=Vv,Ie=we("highlightjs"),ct=_i,Ht=dl;return le(),Pe(Gt,null,[W("div",X1,[(le(),Pe("svg",Z1,J1)),It((le(),Pe("div",eC,[g(me,{class:"h-full"},{default:x(()=>[g(me,{style:{"align-items":"stretch"}},{default:x(()=>[g(fe,null,{default:x(()=>[W("div",tC,[g(lt,{wrap:"",size:10},{default:x(()=>[g(De,{effect:"dark",content:"自适应屏幕",placement:"bottom"},{default:x(()=>[g(oe,{size:"small",icon:"Rank",onClick:I})]),_:1}),g(De,{effect:"dark",content:"放大",placement:"bottom"},{default:x(()=>[g(oe,{size:"small",icon:"ZoomIn",onClick:pe[0]||(pe[0]=ke=>$(!0))})]),_:1}),g(De,{effect:"dark",content:"缩小",placement:"bottom"},{default:x(()=>[g(oe,{size:"small",icon:"ZoomOut",onClick:pe[1]||(pe[1]=ke=>$(!1))})]),_:1}),g(De,{effect:"dark",content:"后退",placement:"bottom"},{default:x(()=>[g(oe,{size:"small",icon:"Back",onClick:pe[2]||(pe[2]=ke=>T(h).get("commandStack").undo())})]),_:1}),g(De,{effect:"dark",content:"前进",placement:"bottom"},{default:x(()=>[g(oe,{size:"small",icon:"Right",onClick:pe[3]||(pe[3]=ke=>T(h).get("commandStack").redo())})]),_:1})]),_:1}),g(lt,{wrap:"",size:10,style:{float:"right","padding-right":"10px"}},{default:x(()=>[g(oe,{size:"small",type:"primary",onClick:ne},{default:x(()=>[G("保 存")]),_:1}),g(ee,{size:"small"},{dropdown:x(()=>[g(k,null,{default:x(()=>[g(j,{icon:"Document",onClick:U},{default:x(()=>[G("XML预览")]),_:1}),g(j,{icon:"View",onClick:O},{default:x(()=>[G(" SVG预览")]),_:1})]),_:1})]),default:x(()=>[g(oe,{size:"small",type:"primary"},{default:x(()=>[G(" 预 览 ")]),_:1})]),_:1}),g(ee,{size:"small"},{dropdown:x(()=>[g(k,null,{default:x(()=>[g(j,{icon:"Download",onClick:V},{default:x(()=>[G("下载XML")]),_:1}),g(j,{icon:"Download",onClick:X},{default:x(()=>[G(" 下载SVG")]),_:1})]),_:1})]),default:x(()=>[g(oe,{size:"small",type:"primary"},{default:x(()=>[G(" 下 载 ")]),_:1})]),_:1})]),_:1})])]),_:1}),W("div",{ref_key:"canvas",ref:d,class:"canvas"},null,512)]),_:1}),W("div",{class:Mv({"process-panel":!0,hide:T(p)})},[W("div",{class:"process-panel-bar",onClick:R},[W("div",nC,[g(he,{type:"default",underline:!1},{default:x(()=>[g(K,{"class-name":"open-bar","icon-class":T(p)?"caret-back":"caret-forward"},null,8,["icon-class"])]),_:1})])]),g(ll,{"enter-active-class":"animate__animated animate__fadeIn"},{default:x(()=>[T(h)?It((le(),Pe("div",iC,[g(By,{modeler:T(h)},null,8,["modeler"])],512)),[[un,T(u)]]):Ye("",!0)]),_:1})],2)]),_:1})])),[[Ht,T(C)]])]),W("div",null,[g(ct,{modelValue:T(v),"onUpdate:modelValue":pe[4]||(pe[4]=ke=>ze(v)?v.value=ke:null),title:"XML预览",width:"80%","append-to-body":""},{default:x(()=>[g(Ie,{code:T(b),language:"XML"},null,8,["code"])]),_:1},8,["modelValue"])]),W("div",null,[g(ct,{modelValue:T(S),"onUpdate:modelValue":pe[5]||(pe[5]=ke=>ze(S)?S.value=ke:null),title:"SVG预览",width:"80%","append-to-body":""},{default:x(()=>[W("div",{style:{"text-align":"center"},innerHTML:T(w)},null,8,rC)]),_:1},8,["modelValue"])])],64)}}}),sC={class:"design"},lC={class:"modeler"},cC=et({name:"Design"}),uC=et({...cC,emits:["closeCallBack"],setup(e,{expose:t,emit:n}){const{proxy:i}=yn(),r=H(),o=H(),a=n,{visible:l,title:s}=xi({title:"编辑流程"}),c=H(""),p=async d=>{l.value=!0,c.value=d;const{data:f}=await cf(d);o.value=f,r.value.initDiagram(o.value.xml)},u=async d=>{await(i==null?void 0:i.$modal.confirm("是否确认保存？")),d.loading.value=!0,o.value.id=c.value,o.value.xml=d.xml,o.value.svg=d.svg,o.value.key=d.key,o.value.name=d.name,Tg(o.value).then(f=>{f.code===200&&(l.value=!1,i==null||i.$modal.msgSuccess("保存成功"),a("closeCallBack",d))}),d.loading.value=!1};return t({open:p}),(d,f)=>{const h=_i;return le(),Pe("div",sC,[g(h,{modelValue:T(l),"onUpdate:modelValue":f[0]||(f[0]=m=>ze(l)?l.value=m:null),width:"100%",fullscreen:"",title:T(s)},{default:x(()=>[W("div",lC,[g(aC,{ref_key:"bpmnDesignRef",ref:r,onSaveCallBack:u},null,512)])]),_:1},8,["modelValue","title"])])}}}),pC=ca(uC,[["__scopeId","data-v-58bcc757"]]),dC={class:"p-2"},fC={class:"mb-[10px]"},hC={class:"dialog-footer"},mC=et({name:"Model"}),HC=et({...mC,setup(e){const{proxy:t}=yn(),n=H(),i=H(),r=H(),o=H(),a=H(!1),l=H(!0),s=H([]),c=H(!0),p=H(!0),u=H(!0),d=H(0),f=H([]),h=H([]),m=H(""),v=H(""),S=wr({visible:!1,title:""}),b={id:"",name:"",key:"",categoryCode:"",xml:"",svg:"",description:""},w=wr({form:{...b},queryParams:{pageNum:1,pageSize:10,name:"",key:"",categoryCode:""},rules:{name:[{required:!0,message:"模型不能为空",trigger:"blur"}],key:[{required:!0,message:"模型KEY不能为空",trigger:"blur"}],categoryCode:[{required:!0,message:"流程分类不能为空",trigger:"blur"}]}}),{queryParams:C,form:R,rules:D}=Fd(w);yi(()=>{X(),oe()});const F=j=>{C.value.categoryCode=j.categoryCode,j.categoryCode==="ALL"&&(C.value.categoryCode=""),I()},A=(j,k)=>j?k.categoryName.indexOf(j)!==-1:!0;Fv(()=>{var j;(j=r.value)==null||j.filter(m.value)},{flush:"post"});const I=()=>{C.value.pageNum=1,X()},$=()=>{var j;(j=i.value)==null||j.resetFields(),C.value.categoryCode="",C.value.pageNum=1,C.value.pageSize=10,I()},V=j=>{s.value=j.map(k=>k.id),c.value=j.length!==1,p.value=!j.length},X=async()=>{l.value=!0;const j=await wg(C.value);f.value=j.rows,d.value=j.total,l.value=!1},U=async j=>{const k=(j==null?void 0:j.id)||s.value;await(t==null?void 0:t.$modal.confirm("是否确认删除模型id为【"+k+"】的数据项？")),l.value=!0,await Pg(k).finally(()=>l.value=!1),await X(),t==null||t.$modal.msgSuccess("删除成功")},O=async(j,k)=>{await(t==null?void 0:t.$modal.confirm("是否部署模型key为【"+k+"】流程？")),l.value=!0,await Rg(j).finally(()=>l.value=!1),await X(),t==null||t.$modal.msgSuccess("部署成功")},B=()=>{v.value="add",s.value=[],oe(),R.value={...b},S.visible=!0,S.title="新增模型"},q=()=>{v.value="update",S.title="修改模型",Zt(async()=>{await oe();const j=s.value[0],k=await cf(j);Object.assign(R.value,k.data),S.visible=!0})},re=j=>{v.value="copy",S.title="复制模型",Zt(async()=>{await oe(),R.value={...b},R.value.id=j.id,S.visible=!0})},ne=()=>{n.value.validate(async j=>{j&&(a.value=!0,v.value==="copy"?(await Dg(R.value),t==null||t.$modal.msgSuccess("操作成功")):s.value&&s.value.length>0&&v.value==="update"?(R.value.id=s.value[0],await Cg(R.value),t==null||t.$modal.msgSuccess("操作成功")):(lt(R.value.key,R.value.name),R.value.xml=De.value,await Sg(R.value),t==null||t.$modal.msgSuccess("操作成功")),S.visible=!1,await X())})},ge=()=>{Le(),S.visible=!1},Le=()=>{R.value={...b},n.value.resetFields()},Z=async j=>{await o.value.open(j)},pe=()=>{t==null||t.$download.zip("/workflow/model/export/zip/"+s.value,"模型")},oe=async()=>{const j=await xg();h.value=[];const k={categoryCode:"ALL",categoryName:"顶级节点",children:[]};k.children=t==null?void 0:t.handleTree(j.data,"id","parentId"),h.value.push(k)},De=H(""),lt=async(j,k)=>(De.value=`<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:bioc="http://bpmn.io/schema/bpmn/biocolor/1.0" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:flowable="http://flowable.org/bpmn" targetNamespace="http://www.flowable.org/processdef">
  <process id="${j}" name="${k}">
    <startEvent id="startNode1" name="开始" />
  </process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_flow">
    <bpmndi:BPMNPlane id="BPMNPlane_flow" bpmnElement="T-2d89e7a3-ba79-4abd-9f64-ea59621c258c">
      <bpmndi:BPMNShape id="BPMNShape_startNode1" bpmnElement="startNode1" bioc:stroke="">
        <omgdc:Bounds x="240" y="200" width="30" height="30" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="242" y="237" width="23" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</definitions>`,De);return(j,k)=>{const ee=Wt,fe=Hv,me=zd,K=zv,he=Ot,Ie=Gn,ct=Lt,Ht=qv,ke=Uv,Fe=Gv,oi=Wv,Di=Yd,Rn=Yv,ft=_i,ar=dl;return le(),Pe("div",dC,[g(ke,{gutter:20},{default:x(()=>[g(K,{lg:4,xs:24,style:{}},{default:x(()=>[g(me,{shadow:"hover"},{default:x(()=>[g(ee,{modelValue:T(m),"onUpdate:modelValue":k[0]||(k[0]=Ze=>ze(m)?m.value=Ze:null),placeholder:"请输入流程分类名","prefix-icon":"Search",clearable:""},null,8,["modelValue"]),g(fe,{ref_key:"categoryTreeRef",ref:r,class:"mt-2","node-key":"id",data:T(h),props:{label:"categoryName",children:"children"},"expand-on-click-node":!1,"filter-node-method":A,"highlight-current":"","default-expand-all":"",onNodeClick:F},null,8,["data"])]),_:1})]),_:1}),g(K,{lg:20,xs:24},{default:x(()=>{var Ze,Dn;return[g(ll,{"enter-active-class":(Ze=T(t))==null?void 0:Ze.animate.searchAnimate.enter,"leave-active-class":(Dn=T(t))==null?void 0:Dn.animate.searchAnimate.leave},{default:x(()=>[It(W("div",fC,[g(me,{shadow:"hover"},{default:x(()=>[It(g(ct,{ref_key:"queryFormRef",ref:i,model:T(C),inline:!0},{default:x(()=>[g(he,{label:"模型名称",prop:"name"},{default:x(()=>[g(ee,{modelValue:T(C).name,"onUpdate:modelValue":k[1]||(k[1]=$e=>T(C).name=$e),placeholder:"请输入模型名称",clearable:"",onKeyup:Yo(I,["enter"])},null,8,["modelValue"])]),_:1}),g(he,{label:"模型KEY",prop:"key"},{default:x(()=>[g(ee,{modelValue:T(C).key,"onUpdate:modelValue":k[2]||(k[2]=$e=>T(C).key=$e),placeholder:"请输入模型KEY",clearable:"",onKeyup:Yo(I,["enter"])},null,8,["modelValue"])]),_:1}),g(he,null,{default:x(()=>[g(Ie,{type:"primary",icon:"Search",onClick:I},{default:x(()=>[G("搜索")]),_:1}),g(Ie,{icon:"Refresh",onClick:$},{default:x(()=>[G("重置")]),_:1})]),_:1})]),_:1},8,["model"]),[[un,T(u)]])]),_:1})],512),[[un,T(u)]])]),_:1},8,["enter-active-class","leave-active-class"]),g(me,{shadow:"hover"},{header:x(()=>[g(ke,{gutter:10,class:"mb8"},{default:x(()=>[g(K,{span:1.5},{default:x(()=>[g(Ie,{type:"primary",plain:"",icon:"Plus",onClick:B},{default:x(()=>[G("新增")]),_:1})]),_:1}),g(K,{span:1.5},{default:x(()=>[g(Ie,{type:"success",plain:"",icon:"Edit",disabled:T(c),onClick:k[3]||(k[3]=$e=>q())},{default:x(()=>[G("修改")]),_:1},8,["disabled"])]),_:1}),g(K,{span:1.5},{default:x(()=>[g(Ie,{type:"danger",plain:"",icon:"Delete",disabled:T(p),onClick:k[4]||(k[4]=$e=>U())},{default:x(()=>[G("删除")]),_:1},8,["disabled"])]),_:1}),g(K,{span:1.5},{default:x(()=>[g(Ie,{type:"primary",plain:"",disabled:T(p),icon:"Download",onClick:k[5]||(k[5]=$e=>pe())},{default:x(()=>[G("导出")]),_:1},8,["disabled"])]),_:1}),g(Ht,{showSearch:T(u),"onUpdate:showSearch":k[6]||(k[6]=$e=>ze(u)?u.value=$e:null),onQueryTable:X},null,8,["showSearch"])]),_:1})]),default:x(()=>[It((le(),He(oi,{border:"",data:T(f),onSelectionChange:V},{default:x(()=>[g(Fe,{type:"selection",width:"55",align:"center"}),g(Fe,{fixed:"",align:"center",type:"index",label:"序号",width:"80"}),g(Fe,{align:"center","show-overflow-tooltip":!0,prop:"name",label:"模型名称",width:"200"}),g(Fe,{align:"center",prop:"key",label:"模型KEY"}),g(Fe,{align:"center",prop:"version",label:"版本号",width:"90"},{default:x($e=>[G(" v"+mn($e.row.version)+".0",1)]),_:1}),g(Fe,{align:"center",prop:"metaInfo",label:"备注说明","min-width":"130"}),g(Fe,{align:"center","show-overflow-tooltip":!0,prop:"createTime",label:"创建时间",width:"160"}),g(Fe,{align:"center","show-overflow-tooltip":!0,prop:"lastUpdateTime",label:"更新时间",width:"160"}),g(Fe,{fixed:"right",label:"操作",align:"center",width:"170","class-name":"small-padding fixed-width"},{default:x($e=>[g(ke,{gutter:10,class:"mb8"},{default:x(()=>[g(K,{span:1.5},{default:x(()=>[g(Ie,{link:"",type:"primary",size:"small",icon:"Pointer",onClick:ai=>Z($e.row.id)},{default:x(()=>[G("设计流程")]),_:2},1032,["onClick"])]),_:2},1024),g(K,{span:1.5},{default:x(()=>[g(Ie,{link:"",type:"primary",size:"small",icon:"Delete",onClick:ai=>U($e.row)},{default:x(()=>[G("删除")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024),g(ke,{gutter:10,class:"mb8"},{default:x(()=>[g(K,{span:1.5},{default:x(()=>[g(Ie,{link:"",type:"primary",size:"small",icon:"ScaleToOriginal",onClick:ai=>O($e.row.id,$e.row.key)},{default:x(()=>[G(" 流程部署 ")]),_:2},1032,["onClick"])]),_:2},1024),g(K,{span:1.5},{default:x(()=>[g(Ie,{link:"",type:"primary",size:"small",icon:"CopyDocument",onClick:ai=>re($e.row)},{default:x(()=>[G(" 复制模型 ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[ar,T(l)]]),It(g(Di,{page:T(C).pageNum,"onUpdate:page":k[7]||(k[7]=$e=>T(C).pageNum=$e),limit:T(C).pageSize,"onUpdate:limit":k[8]||(k[8]=$e=>T(C).pageSize=$e),total:T(d),onPagination:X},null,8,["page","limit","total"]),[[un,T(d)>0]])]),_:1})]}),_:1})]),_:1}),g(pC,{ref_key:"designRef",ref:o,onCloseCallBack:I},null,512),g(ft,{modelValue:T(S).visible,"onUpdate:modelValue":k[13]||(k[13]=Ze=>T(S).visible=Ze),title:T(S).title,width:"650px","append-to-body":"","close-on-click-modal":!1},{footer:x(()=>[W("span",hC,[g(Ie,{type:"primary",onClick:ne},{default:x(()=>[G("确 定")]),_:1}),g(Ie,{onClick:ge},{default:x(()=>[G("取 消")]),_:1})])]),default:x(()=>[g(ct,{ref_key:"formRef",ref:n,model:T(R),rules:T(D),"label-width":"100px"},{default:x(()=>[g(he,{label:"模型名称：",prop:"name"},{default:x(()=>[g(ee,{modelValue:T(R).name,"onUpdate:modelValue":k[9]||(k[9]=Ze=>T(R).name=Ze),disabled:T(s)&&T(s).length>0&&T(v)==="update",maxlength:"20","show-word-limit":""},null,8,["modelValue","disabled"])]),_:1}),g(he,{label:"模型KEY：",prop:"key"},{default:x(()=>[g(ee,{modelValue:T(R).key,"onUpdate:modelValue":k[10]||(k[10]=Ze=>T(R).key=Ze),disabled:T(s)&&T(s).length>0&&T(v)==="update",maxlength:"20","show-word-limit":""},null,8,["modelValue","disabled"])]),_:1}),g(he,{label:"流程分类",prop:"categoryCode"},{default:x(()=>[g(Rn,{modelValue:T(R).categoryCode,"onUpdate:modelValue":k[11]||(k[11]=Ze=>T(R).categoryCode=Ze),data:T(h),props:{value:"categoryCode",label:"categoryName",children:"children"},"value-key":"categoryCode",placeholder:"请选择流程分类","check-strictly":""},null,8,["modelValue","data"])]),_:1}),g(he,{label:"备注：",prop:"description"},{default:x(()=>[g(ee,{modelValue:T(R).description,"onUpdate:modelValue":k[12]||(k[12]=Ze=>T(R).description=Ze),type:"textarea",maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{HC as default};
