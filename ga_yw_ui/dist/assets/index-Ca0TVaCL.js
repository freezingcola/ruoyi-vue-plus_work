import{d as le,V as Ve,aa as Y,r as _,Y as j,b as Ce,$ as we,o as i,c as E,k as e,m as l,w as b,x as $,e as o,t as J,M as q,N as A,p as h,y as v,a7 as ke,ab as Ne,a3 as Ie,T as Z,q as Ee,D as De,C as Te,O as Ue,P as Re,G as Se,H as Fe,a0 as $e,W as qe,X as Ae,a8 as Pe,ac as Be,a9 as xe,au as Le,al as Oe,ao as Ke,a2 as Qe,am as Ge,v as Me}from"./index-BoCONcAc.js";/* empty css                       *//* empty css                 *//* empty css                        *//* empty css                *//* empty css                    *//* empty css                       *//* empty css                 */import{_ as ze}from"./index-BXJ8XT-L.js";/* empty css                        *//* empty css               */import{_ as He}from"./index-B4NenLWv.js";/* empty css               *//* empty css                *//* empty css                */import"./el-form-item-l0sNRNKZ.js";import{l as ee,g as We,a as Xe,u as Ye,b as je,d as Je}from"./index-jsIzrHGa.js";import{h as Ze}from"./index-JZ_QvNlG.js";const el={class:"p-2"},ll={class:"mb-[10px]"},al={class:"dialog-footer"},tl=le({name:"Dept"}),wl=le({...tl,setup(ol){const{proxy:s}=Ve(),{sys_normal_disable:D}=Y(s==null?void 0:s.useDict("sys_normal_disable")),T=_([]),U=_(!0),V=_(!0),C=_([]),w=_(!0),P=_([]),m=j({visible:!1,title:""}),B=_(),x=_(),R=_(),L={deptId:void 0,parentId:void 0,deptName:void 0,deptCategory:void 0,orderNum:0,leader:void 0,phone:void 0,email:void 0,status:"0"},ae={form:{...L},queryParams:{pageNum:1,pageSize:10,deptName:void 0,deptCategory:void 0,status:void 0},rules:{parentId:[{required:!0,message:"上级部门不能为空",trigger:"blur"}],deptName:[{required:!0,message:"部门名称不能为空",trigger:"blur"}],orderNum:[{required:!0,message:"显示排序不能为空",trigger:"blur"}],email:[{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}],phone:[{pattern:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,message:"请输入正确的手机号码",trigger:"blur"}]}},te=j(ae),{queryParams:f,form:d,rules:oe}=Y(te),y=async()=>{U.value=!0;const n=await ee(f.value),t=s==null?void 0:s.handleTree(n.data,"deptId");t&&(T.value=t),U.value=!1};async function ne(n){if(n!==null&&n!==""&&n!==void 0){const t=await Ze(n);P.value=t.data}}const de=()=>{S(),m.visible=!1},S=()=>{var n;d.value={...L},(n=R.value)==null||n.resetFields()},k=()=>{y()},se=()=>{var n;(n=x.value)==null||n.resetFields(),k()},re=()=>{w.value=!w.value,O(T.value,w.value)},O=(n,t)=>{n.forEach(u=>{var r;(r=B.value)==null||r.toggleRowExpansion(u,t),u.children&&u.children.length>0&&O(u.children,t)})},K=async n=>{S();const t=await ee(),u=s==null?void 0:s.handleTree(t.data,"deptId");u&&(C.value=u,n&&n.deptId&&(d.value.parentId=n==null?void 0:n.deptId),m.visible=!0,m.title="添加部门")},ue=async n=>{S(),ne(n.deptId);const t=await We(n.deptId);d.value=t.data;const u=await Xe(n.deptId),r=s==null?void 0:s.handleTree(u.data,"deptId");if(r&&(C.value=r,r.length===0)){const N={deptId:t.data.parentId,deptName:t.data.parentName,children:[]};C.value.push(N)}m.visible=!0,m.title="修改部门"},pe=()=>{var n;(n=R.value)==null||n.validate(async t=>{t&&(d.value.deptId?await Ye(d.value):await je(d.value),s==null||s.$modal.msgSuccess("操作成功"),m.visible=!1,await y())})},ie=async n=>{await(s==null?void 0:s.$modal.confirm('是否确认删除名称为"'+n.deptName+'"的数据项?')),await Je(n.deptId),await y(),s==null||s.$modal.msgSuccess("删除成功")};return Ce(()=>{y()}),(n,t)=>{var H,W;const u=De,r=Te,N=Ue,Q=Re,c=Se,G=Fe,M=$e,p=qe,me=He,z=Ae,g=Pe,ce=ze,F=Be,_e=xe,fe=Le,ve=Oe,ge=Ke,be=Qe,he=Ge,I=we("hasPermi"),ye=Me;return i(),E("div",el,[e(Ne,{"enter-active-class":(H=o(s))==null?void 0:H.animate.searchAnimate.enter,"leave-active-class":(W=o(s))==null?void 0:W.animate.searchAnimate.leave},{default:l(()=>[b($("div",ll,[e(M,{shadow:"hover"},{default:l(()=>[e(G,{ref_key:"queryFormRef",ref:x,model:o(f),inline:!0},{default:l(()=>[e(r,{label:"部门名称",prop:"deptName"},{default:l(()=>[e(u,{modelValue:o(f).deptName,"onUpdate:modelValue":t[0]||(t[0]=a=>o(f).deptName=a),placeholder:"请输入部门名称",clearable:"",onKeyup:J(k,["enter"])},null,8,["modelValue"])]),_:1}),e(r,{label:"类别编码",prop:"deptCategory"},{default:l(()=>[e(u,{modelValue:o(f).deptCategory,"onUpdate:modelValue":t[1]||(t[1]=a=>o(f).deptCategory=a),placeholder:"请输入类别编码",clearable:"",style:{width:"240px"},onKeyup:J(k,["enter"])},null,8,["modelValue"])]),_:1}),e(r,{label:"状态",prop:"status"},{default:l(()=>[e(Q,{modelValue:o(f).status,"onUpdate:modelValue":t[2]||(t[2]=a=>o(f).status=a),placeholder:"部门状态",clearable:""},{default:l(()=>[(i(!0),E(q,null,A(o(D),a=>(i(),h(N,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(r,null,{default:l(()=>[e(c,{type:"primary",icon:"Search",onClick:k},{default:l(()=>[v("搜索")]),_:1}),e(c,{icon:"Refresh",onClick:se},{default:l(()=>[v("重置")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})],512),[[ke,o(V)]])]),_:1},8,["enter-active-class","leave-active-class"]),e(M,{shadow:"hover"},{header:l(()=>[e(z,{gutter:10},{default:l(()=>[e(p,{span:1.5},{default:l(()=>[b((i(),h(c,{type:"primary",plain:"",icon:"Plus",onClick:t[3]||(t[3]=a=>K())},{default:l(()=>[v("新增 ")]),_:1})),[[I,["system:dept:add"]]])]),_:1}),e(p,{span:1.5},{default:l(()=>[e(c,{type:"info",plain:"",icon:"Sort",onClick:re},{default:l(()=>[v("展开/折叠")]),_:1})]),_:1}),e(me,{showSearch:o(V),"onUpdate:showSearch":t[4]||(t[4]=a=>Ie(V)?V.value=a:null),onQueryTable:y},null,8,["showSearch"])]),_:1})]),default:l(()=>[b((i(),h(_e,{ref_key:"deptTableRef",ref:B,data:o(T),"row-key":"deptId","tree-props":{children:"children",hasChildren:"hasChildren"},"default-expand-all":o(w)},{default:l(()=>[e(g,{prop:"deptName",label:"部门名称",width:"260"}),e(g,{prop:"deptCategory",align:"center",label:"类别编码",width:"200"}),e(g,{prop:"orderNum",align:"center",label:"排序",width:"200"}),e(g,{prop:"status",align:"center",label:"状态",width:"100"},{default:l(a=>[e(ce,{options:o(D),value:a.row.status},null,8,["options","value"])]),_:1}),e(g,{label:"创建时间",align:"center",prop:"createTime",width:"200"},{default:l(a=>[$("span",null,Z(n.parseTime(a.row.createTime)),1)]),_:1}),e(g,{fixed:"right",align:"center",label:"操作"},{default:l(a=>[e(F,{content:"修改",placement:"top"},{default:l(()=>[b(e(c,{link:"",type:"primary",icon:"Edit",onClick:X=>ue(a.row)},null,8,["onClick"]),[[I,["system:dept:edit"]]])]),_:2},1024),e(F,{content:"新增",placement:"top"},{default:l(()=>[b(e(c,{link:"",type:"primary",icon:"Plus",onClick:X=>K(a.row)},null,8,["onClick"]),[[I,["system:dept:add"]]])]),_:2},1024),e(F,{content:"删除",placement:"top"},{default:l(()=>[b(e(c,{link:"",type:"primary",icon:"Delete",onClick:X=>ie(a.row)},null,8,["onClick"]),[[I,["system:dept:remove"]]])]),_:2},1024)]),_:1})]),_:1},8,["data","default-expand-all"])),[[ye,o(U)]])]),_:1}),e(he,{modelValue:o(m).visible,"onUpdate:modelValue":t[13]||(t[13]=a=>o(m).visible=a),title:o(m).title,"destroy-on-close":"","append-to-body":"",width:"600px"},{footer:l(()=>[$("div",al,[e(c,{type:"primary",onClick:pe},{default:l(()=>[v("确 定")]),_:1}),e(c,{onClick:de},{default:l(()=>[v("取 消")]),_:1})])]),default:l(()=>[e(G,{ref_key:"deptFormRef",ref:R,model:o(d),rules:o(oe),"label-width":"80px"},{default:l(()=>[e(z,null,{default:l(()=>[o(d).parentId!==0?(i(),h(p,{key:0,span:24},{default:l(()=>[e(r,{label:"上级部门",prop:"parentId"},{default:l(()=>[e(fe,{modelValue:o(d).parentId,"onUpdate:modelValue":t[5]||(t[5]=a=>o(d).parentId=a),data:o(C),props:{value:"deptId",label:"deptName",children:"children"},"value-key":"deptId",placeholder:"选择上级部门","check-strictly":""},null,8,["modelValue","data"])]),_:1})]),_:1})):Ee("",!0),e(p,{span:12},{default:l(()=>[e(r,{label:"部门名称",prop:"deptName"},{default:l(()=>[e(u,{modelValue:o(d).deptName,"onUpdate:modelValue":t[6]||(t[6]=a=>o(d).deptName=a),placeholder:"请输入部门名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:12},{default:l(()=>[e(r,{label:"类别编码",prop:"deptCategory"},{default:l(()=>[e(u,{modelValue:o(d).deptCategory,"onUpdate:modelValue":t[7]||(t[7]=a=>o(d).deptCategory=a),placeholder:"请输入类别编码"},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:12},{default:l(()=>[e(r,{label:"显示排序",prop:"orderNum"},{default:l(()=>[e(ve,{modelValue:o(d).orderNum,"onUpdate:modelValue":t[8]||(t[8]=a=>o(d).orderNum=a),"controls-position":"right",min:0},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:12},{default:l(()=>[e(r,{label:"负责人",prop:"leader"},{default:l(()=>[e(Q,{modelValue:o(d).leader,"onUpdate:modelValue":t[9]||(t[9]=a=>o(d).leader=a),placeholder:"请选择负责人"},{default:l(()=>[(i(!0),E(q,null,A(o(P),a=>(i(),h(N,{key:a.userId,label:a.userName,value:a.userId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(p,{span:12},{default:l(()=>[e(r,{label:"联系电话",prop:"phone"},{default:l(()=>[e(u,{modelValue:o(d).phone,"onUpdate:modelValue":t[10]||(t[10]=a=>o(d).phone=a),placeholder:"请输入联系电话",maxlength:"11"},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:12},{default:l(()=>[e(r,{label:"邮箱",prop:"email"},{default:l(()=>[e(u,{modelValue:o(d).email,"onUpdate:modelValue":t[11]||(t[11]=a=>o(d).email=a),placeholder:"请输入邮箱",maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:12},{default:l(()=>[e(r,{label:"部门状态"},{default:l(()=>[e(be,{modelValue:o(d).status,"onUpdate:modelValue":t[12]||(t[12]=a=>o(d).status=a)},{default:l(()=>[(i(!0),E(q,null,A(o(D),a=>(i(),h(ge,{key:a.value,value:a.value},{default:l(()=>[v(Z(a.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{wl as default};
