import{d as P,u as Z,V as x,aa as ee,r as c,Y as ae,b as te,$ as oe,o as h,c as le,k as e,m as a,w as p,x as T,e as o,t as $,y as _,a7 as A,ab as ne,p as y,a3 as se,T as re,D as ie,C as ce,G as ue,H as me,W as pe,X as de,a8 as _e,ac as fe,a9 as he,a0 as ve,v as ge}from"./index-BoCONcAc.js";/* empty css                */import{_ as we}from"./index-B1KNwlHH.js";/* empty css                 *//* empty css                    */import{_ as be}from"./index-BXJ8XT-L.js";/* empty css                        *//* empty css               */import{_ as Ce}from"./index-B4NenLWv.js";/* empty css               *//* empty css                */import"./el-form-item-l0sNRNKZ.js";import{a as ye,b as ke,c as Ie}from"./index-hgsK1_Ho.js";import{_ as Se}from"./selectUser.vue_vue_type_script_setup_true_name_SelectUser_lang-BJmx2FMg.js";/* empty css                */const Ne={class:"p-2"},Ue={class:"search"},Ee=P({name:"AuthUser"}),He=P({...Ee,setup(Ve){const F=Z(),{proxy:t}=x(),{sys_normal_disable:B}=ee(t==null?void 0:t.useDict("sys_normal_disable")),k=c([]),v=c(!0),f=c(!0),I=c(!0),g=c(0),S=c([]),N=c(),U=c(),s=ae({pageNum:1,pageSize:10,roleId:F.params.roleId,userName:void 0,phonenumber:void 0}),u=async()=>{v.value=!0;const l=await ye(s);k.value=l.rows,g.value=l.total,v.value=!1},D=()=>{const l={path:"/system/role",fullPath:"",hash:"",matched:[],meta:void 0,name:void 0,params:void 0,query:void 0,redirectedFrom:void 0};t==null||t.$tab.closeOpenPage(l)},d=()=>{s.pageNum=1,u()},q=()=>{var l;(l=N.value)==null||l.resetFields(),d()},L=l=>{S.value=l.map(r=>r.userId),I.value=!l.length},z=()=>{var l;(l=U.value)==null||l.show()},K=async l=>{await(t==null?void 0:t.$modal.confirm('确认要取消该用户"'+l.userName+'"角色吗？')),await ke({userId:l.userId,roleId:s.roleId}),await u(),t==null||t.$modal.msgSuccess("取消授权成功")},Q=async()=>{const l=s.roleId,r=S.value.join(",");await(t==null?void 0:t.$modal.confirm("是否取消选中用户授权数据项?")),await Ie({roleId:l,userIds:r}),await u(),t==null||t.$modal.msgSuccess("取消授权成功")};return te(()=>{u()}),(l,r)=>{var V,R;const E=ie,w=ce,m=ue,j=me,b=pe,O=Ce,G=de,i=_e,H=be,M=fe,W=he,X=we,Y=ve,C=oe("hasPermi"),J=ge;return h(),le("div",Ne,[e(ne,{"enter-active-class":(V=o(t))==null?void 0:V.animate.searchAnimate.enter,"leave-active-class":(R=o(t))==null?void 0:R.animate.searchAnimate.leave},{default:a(()=>[p(T("div",Ue,[e(j,{ref_key:"queryFormRef",ref:N,model:o(s),inline:!0},{default:a(()=>[e(w,{label:"用户名称",prop:"userName"},{default:a(()=>[e(E,{modelValue:o(s).userName,"onUpdate:modelValue":r[0]||(r[0]=n=>o(s).userName=n),placeholder:"请输入用户名称",clearable:"",onKeyup:$(d,["enter"])},null,8,["modelValue"])]),_:1}),e(w,{label:"手机号码",prop:"phonenumber"},{default:a(()=>[e(E,{modelValue:o(s).phonenumber,"onUpdate:modelValue":r[1]||(r[1]=n=>o(s).phonenumber=n),placeholder:"请输入手机号码",clearable:"",onKeyup:$(d,["enter"])},null,8,["modelValue"])]),_:1}),e(w,null,{default:a(()=>[e(m,{type:"primary",icon:"Search",onClick:d},{default:a(()=>[_("搜索")]),_:1}),e(m,{icon:"Refresh",onClick:q},{default:a(()=>[_("重置")]),_:1})]),_:1})]),_:1},8,["model"])],512),[[A,o(f)]])]),_:1},8,["enter-active-class","leave-active-class"]),e(Y,{shadow:"never"},{header:a(()=>[e(G,{gutter:10},{default:a(()=>[e(b,{span:1.5},{default:a(()=>[p((h(),y(m,{type:"primary",plain:"",icon:"Plus",onClick:z},{default:a(()=>[_("添加用户")]),_:1})),[[C,["system:role:add"]]])]),_:1}),e(b,{span:1.5},{default:a(()=>[p((h(),y(m,{type:"danger",plain:"",icon:"CircleClose",disabled:o(I),onClick:Q},{default:a(()=>[_(" 批量取消授权 ")]),_:1},8,["disabled"])),[[C,["system:role:remove"]]])]),_:1}),e(b,{span:1.5},{default:a(()=>[e(m,{type:"warning",plain:"",icon:"Close",onClick:D},{default:a(()=>[_("关闭")]),_:1})]),_:1}),e(O,{showSearch:o(f),"onUpdate:showSearch":r[2]||(r[2]=n=>se(f)?f.value=n:null),search:!0,onQueryTable:u},null,8,["showSearch"])]),_:1})]),default:a(()=>[p((h(),y(W,{data:o(k),onSelectionChange:L},{default:a(()=>[e(i,{type:"selection",width:"55",align:"center"}),e(i,{label:"用户名称",prop:"userName","show-overflow-tooltip":!0}),e(i,{label:"用户昵称",prop:"nickName","show-overflow-tooltip":!0}),e(i,{label:"邮箱",prop:"email","show-overflow-tooltip":!0}),e(i,{label:"手机",prop:"phonenumber","show-overflow-tooltip":!0}),e(i,{label:"状态",align:"center",prop:"status"},{default:a(n=>[e(H,{options:o(B),value:n.row.status},null,8,["options","value"])]),_:1}),e(i,{label:"创建时间",align:"center",prop:"createTime",width:"180"},{default:a(n=>[T("span",null,re(n.row.createTime),1)]),_:1}),e(i,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:a(n=>[e(M,{content:"取消授权",placement:"top"},{default:a(()=>[p(e(m,{link:"",type:"primary",icon:"CircleClose",onClick:Re=>K(n.row)},null,8,["onClick"]),[[C,["system:role:remove"]]])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[J,o(v)]]),p(e(X,{page:o(s).pageNum,"onUpdate:page":r[3]||(r[3]=n=>o(s).pageNum=n),limit:o(s).pageSize,"onUpdate:limit":r[4]||(r[4]=n=>o(s).pageSize=n),total:o(g),onPagination:u},null,8,["page","limit","total"]),[[A,o(g)>0]]),e(Se,{ref_key:"selectRef",ref:U,"role-id":o(s).roleId,onOk:d},null,8,["role-id"])]),_:1})])}}});export{He as default};
